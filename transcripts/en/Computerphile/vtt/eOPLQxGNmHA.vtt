WEBVTT
Kind: captions
Language: en

00:00:00.060 --> 00:00:03.000
There's been this article recently a report about a hardware hack

00:00:03.000 --> 00:00:08.189
I just thought the interesting sort sure about what you think about it and whether it's something that is easy to do or always

00:00:08.260 --> 00:00:10.739
possible the original article alleged that

00:00:12.429 --> 00:00:16.019
Certain servers being supplied to companies were being

00:00:17.080 --> 00:00:21.600
doctored for developers with extra Hardware being added so that they could then be used to

00:00:22.240 --> 00:00:27.180
Exfiltrate information from the companies. The report seems to have been discredited quite heavily by

00:00:27.699 --> 00:00:32.129
Other parties whether it actually happened or not. I don't know. I'm not seen any of the servers

00:00:32.130 --> 00:00:37.259
I'm not a hardware or cyber security expert but it's certainly an interesting question to talk about

00:00:37.260 --> 00:00:42.030
Well, what would you be wanting to do? And why would you want to say perhaps do it in?

00:00:42.940 --> 00:00:44.940
hardware

00:00:45.670 --> 00:00:52.620
So, I've got a server motherboard here so it's a standard machine but often servers come with extra support to make them configurable

00:00:52.620 --> 00:00:53.680
So this is an Intel Xeon

00:00:53.680 --> 00:00:57.389
Processor and this is a for management control when installing lots of servers

00:00:57.390 --> 00:01:00.660
You will put them in racks of places in your data center

00:01:00.660 --> 00:01:01.390
you've got

00:01:01.390 --> 00:01:06.510
Necessary storage cooling and things and one of the things you don't have to do is when something goes wrong

00:01:06.510 --> 00:01:09.809
You need to reboot your machine to have to sort of find out where the machine is

00:01:10.990 --> 00:01:15.299
Turn it off and on again plug a keyboard and monitor in it to do any sort of maintenance on it

00:01:15.610 --> 00:01:23.249
So what modern servers do is they have these chips on there which generally computers in their own?

00:01:23.250 --> 00:01:26.009
Right and they enable you to connect to the machine?

00:01:26.009 --> 00:01:33.479
Even when it's switched off and do certain things with it, like turn it on turn it off and even interact with it

00:01:33.479 --> 00:01:38.249
So I've got a machine at home with all of these things in and if I just bring it up

00:01:38.250 --> 00:01:43.259
I'm now connected to it and it's got those things so I can look at the sensors see what the fan speed is

00:01:43.259 --> 00:01:48.089
I've got options to turn it off. Turn it up. Turn it back on again reset it

00:01:48.610 --> 00:01:50.560
On some of them I can either

00:01:50.560 --> 00:01:51.759
reflash the

00:01:51.759 --> 00:01:59.369
BIOS or the UEFI in this case and generally managed to the server and to the full extent that I can actually

00:02:00.250 --> 00:02:03.869
Bring up effectively a virtual console a virtual keyboard and display

00:02:04.750 --> 00:02:08.369
as it's done here where I can interact with the machine so I could

00:02:08.679 --> 00:02:13.589
Login put a ISO image of a CD or a DVD in there and install the operating system

00:02:14.239 --> 00:02:15.739
Why would you be wanting to do this?

00:02:15.739 --> 00:02:22.158
And why would you decide to do it via hardware rather than just getting someone to run some malware?

00:02:22.159 --> 00:02:28.339
And so we need to sort of clot back and think about this. So the alleged what's happened, is that the third party?

00:02:28.980 --> 00:02:31.129
Needed this decided they wanted to infiltrate

00:02:31.319 --> 00:02:35.598
Hackney computers Hackney computers made up an identification with actually be the company's live-in go to see should be

00:02:35.670 --> 00:02:39.109
Animals were harmed in making this completely absurd Hackney computers that ordered I say

00:02:39.239 --> 00:02:43.249
Several thousand servers and so because when you're building that menu it's going to be a special order

00:02:43.250 --> 00:02:46.789
so, you know probably who they're going to and the

00:02:47.549 --> 00:02:54.319
The story goes that an extra chip was inserted onto the motherboard of those machines that were destined for

00:02:54.419 --> 00:02:57.469
Hackney computers, I fully believe that it's possible to do this

00:02:57.470 --> 00:03:00.799
I think there's enough ways. You could connect things and actually what we want you to do

00:03:00.799 --> 00:03:03.529
We want you to get our code running inside their

00:03:04.260 --> 00:03:06.260
environment now if you think about a traditional

00:03:06.450 --> 00:03:08.450
companies where they traditionally lay out

00:03:09.299 --> 00:03:14.779
Their data centers and their networks is that you'll have a perimeter firewall around things to stop things getting in

00:03:14.780 --> 00:03:18.799
It's a bit like the old fashioned medieval castle right once you're inside the castle wall

00:03:18.810 --> 00:03:23.780
you've got a moat around it and the drawbridge of the trough was just pulled up then you can't get in but if you've got

00:03:23.780 --> 00:03:25.199
someone inside already

00:03:25.199 --> 00:03:29.359
Perhaps is away by a shining light shooting an arrow over the walls that they could communicate

00:03:29.819 --> 00:03:33.649
One possibility is that they've added a little bit of extra code

00:03:33.959 --> 00:03:39.439
Into the board management control and that ship contains that extra code and then they've got a machine

00:03:39.900 --> 00:03:40.400
Ok

00:03:40.400 --> 00:03:42.500
Very low powered one on the inside of the network

00:03:42.659 --> 00:03:48.168
While that forward management control of the BMC is likely to be on a network which is limited in what it can connect to

00:03:48.359 --> 00:03:52.159
It's probably likely to be able to connect to other board management controllers on the same network

00:03:52.159 --> 00:03:55.069
And of course as we've seen you can connect to the board management controller

00:03:55.979 --> 00:03:58.879
You can then log into the machine. So one potential

00:03:59.639 --> 00:04:00.989
thing is that they

00:04:00.989 --> 00:04:06.078
Use the board management control in the same way that we might put a Raspberry Pi or the cheap computer on the network

00:04:06.180 --> 00:04:12.049
And then we can use it as a staging pose to connect to other things these board management controls that can also

00:04:12.329 --> 00:04:18.469
Do things like flash the BIOS? And so it's potential that actually this is used as a sort of a

00:04:19.889 --> 00:04:23.269
Staging post to actually attack the machine itself

00:04:23.270 --> 00:04:27.799
And again, I think you would we have to assume that they didn't actually know what was going to be running here

00:04:27.800 --> 00:04:32.120
They could probably hazard a guess at the operating system and unlike the board management controller

00:04:32.760 --> 00:04:37.639
That machine probably is likely to be able to connect directly out to the internet perhaps to download software

00:04:38.580 --> 00:04:41.870
updates and things so normally when a machine is running you have

00:04:42.270 --> 00:04:45.199
different modes a CPU can be executing in you have a

00:04:45.389 --> 00:04:50.478
Sort of mode where the machine has access to everything and that's where your operating system works and depending whether you're on

00:04:50.610 --> 00:04:54.199
x86 and armor six eight thousand machine it might make me known as

00:04:54.810 --> 00:04:57.500
ring zero kernel mode supervisor mode

00:04:57.840 --> 00:05:03.799
But at that level you've got full control of the hardware the machine if you can do that you can then stop it being seen

00:05:03.800 --> 00:05:07.340
By people using the machines you can hide it sort of rootkit as it tends to be known

00:05:07.340 --> 00:05:09.530
but you think I'll probably get it running as

00:05:10.889 --> 00:05:14.929
Supervisor mode and there's two ways. You can do it one. You can find some sort of exploit

00:05:15.600 --> 00:05:21.679
Some part of the operating system that isn't well written so that you can get it tricky to start running your code

00:05:21.680 --> 00:05:23.840
And so that's where you see the sort of exploits

00:05:24.120 --> 00:05:29.419
things you find some way of tricking the software to do something that didn't intend to do make use of that to

00:05:29.760 --> 00:05:31.760
Take control of the system

00:05:32.160 --> 00:05:36.049
The other option is that you just get the code loaded in the place. It's the operating system

00:05:36.050 --> 00:05:40.579
So you modify the operating system itself when this machine shipped to hack me computers

00:05:40.770 --> 00:05:46.789
Then pack free computers will install that operating system of choice and see what you can't modify that then

00:05:47.910 --> 00:05:53.779
But how does that operating system get loaded off? Well that gets loaded off disk by another program called the bootloader and

00:05:54.300 --> 00:05:57.260
The bootloader is a program on the disk

00:05:57.260 --> 00:06:04.909
which gets loaded by the bios or the UEFI and the bios of the UEFI depending on the machine is on an EEPROM on

00:06:05.130 --> 00:06:08.689
The motherboard which can be flashed by the board management controller

00:06:09.389 --> 00:06:15.319
And so you can see another potential way that you could hack the machine is that you say, okay

00:06:15.990 --> 00:06:19.760
I'll put some hardware on the machine which modifies the board management controller

00:06:20.099 --> 00:06:20.729
to

00:06:20.729 --> 00:06:24.139
modify the bios of the ufi to modify the bootloader

00:06:24.210 --> 00:06:30.530
after it's been loaded because the voice has the permission to do that at that point to modify the operating system after that's loaded to

00:06:30.530 --> 00:06:31.310
Embed the malware

00:06:31.310 --> 00:06:35.599
I want to get executed and so it'd be a nightmare to be over because he running software

00:06:35.969 --> 00:06:39.379
Which modifies software which modifies software?

00:06:39.810 --> 00:06:43.410
Which modifies and I think I've got the right number of levels of indirection there

00:06:43.410 --> 00:06:47.369
Actually, there is another way you could potentially trick things there in that

00:06:47.530 --> 00:06:55.410
We talk about ring zero being the lowest level but actually when we've added support for virtual machines and hypervisors is now a ring

00:06:55.780 --> 00:07:00.750
Minus one as it tends to be referred to and so it's potentially possible that you could actually get a hypervisor

00:07:01.690 --> 00:07:03.340
running before

00:07:03.340 --> 00:07:07.769
Anything else on the machine and so the machine was running in a virtualized environment that they didn't know about

00:07:07.900 --> 00:07:13.620
So that's another potential way of doing it and again you then have access to be able to scrape memory and find

00:07:14.230 --> 00:07:18.899
things that were the software you can put it on let it run delete it and

00:07:19.840 --> 00:07:23.820
It's as if it was never there type sort of thing with the hardware

00:07:24.220 --> 00:07:28.529
You can't really get into the dead center necessarily and take all the chips out that you've put in there

00:07:29.680 --> 00:07:36.180
So you probably will make the chips look like they're meant to be there like they're something else or hide them

00:07:36.180 --> 00:07:43.410
So the way a modern printed circuit board is constructed is a printed circuit board that Scott several layers of fiberglass sandwiched together

00:07:43.810 --> 00:07:47.220
With traces of the tracks of the circuit running through them

00:07:47.220 --> 00:07:52.679
So you got the top layer and the bottom layer but often several three or four layers inside as well

00:07:52.680 --> 00:07:54.810
These only got six layer PCBs and things

00:07:54.910 --> 00:08:01.739
the story goes that actually now the chips are so small that they're embedded between the layers of the printed circuit board so that actually

00:08:01.740 --> 00:08:04.109
You wouldn't necessarily notice it. I think you'd want to design your

00:08:04.840 --> 00:08:08.070
Hardware exploit still make it look like it was meant to be there

00:08:08.070 --> 00:08:11.730
it's only if you had sort of one with it and one without it that you perhaps

00:08:12.160 --> 00:08:14.609
Noticed that there was something odd about that machine

00:08:15.190 --> 00:08:17.549
Detecting it would be difficult. I mean the stories

00:08:18.100 --> 00:08:22.409
They've been sort of suggested are that they're detecting it mainly through odd network access

00:08:22.410 --> 00:08:28.950
And so again that suggests what the software is doing it is connecting just other machines that I was not expected to

00:08:29.380 --> 00:08:32.249
either inside the company or outside the company and

00:08:33.099 --> 00:08:37.739
accessing things in a way that you wouldn't expect you to do and that is probably your sort of best bet for

00:08:37.930 --> 00:08:42.719
Detecting these sort of things is all these machines doing what you want them to do

00:08:42.719 --> 00:08:46.919
And the best way to do that is to sort of monitor your network and run software

00:08:46.920 --> 00:08:53.789
Which is sort of learning what's expected traffic and non expected traffic and liking things because obviously if you've got a huge data center

00:08:54.390 --> 00:08:56.929
Thousands of machines in it spotting the needle in the haystack

00:08:57.570 --> 00:09:02.299
Is a tricky problem so they may not connect directly to a server and upload it all

00:09:02.640 --> 00:09:06.529
But it may well be that they just do a domain name lookup on

00:09:06.870 --> 00:09:13.429
Certain domains depending on certain bits of data being there. And so and that's enough to tell people that actually ok

00:09:13.430 --> 00:09:17.149
This machine here is just that requested a specific domain that

00:09:17.790 --> 00:09:18.649
Doesn't exist

00:09:18.649 --> 00:09:26.569
that means that it's found what we asked it to look for and we've just returned a specific IP address perhaps that says go and

00:09:26.910 --> 00:09:30.469
Destroy all the machines at Hackney computers or whatever is you wanted to do

00:09:30.930 --> 00:09:34.669
Which means that we don't tend to use it very often horse is much further up the list

00:09:34.770 --> 00:09:41.029
So a correct and batteries further up the list as well. I mean, we all have phones we talk about batteries all the time. So

00:09:41.820 --> 00:09:49.010
If you hypothetically picked for words that were in the top 500 then suddenly the search base is 500 to the power 4

