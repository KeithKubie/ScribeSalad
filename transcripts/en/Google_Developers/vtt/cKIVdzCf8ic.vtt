WEBVTT
Kind: captions
Language: en

00:00:07.110 --> 00:00:08.109
MALE SPEAKER: You there.

00:00:08.109 --> 00:00:08.817
What's your name?

00:00:08.817 --> 00:00:09.785
WES CHUN: Uh, it's Wes.

00:00:09.785 --> 00:00:10.743
MALE SPEAKER: Wes, huh?

00:00:10.743 --> 00:00:11.930
You know, I'm not really
a fan of employees

00:00:11.930 --> 00:00:12.930
with one syllable names.

00:00:12.930 --> 00:00:14.550
It implies a certain
lack of conviction.

00:00:14.550 --> 00:00:15.480
What's your last name?

00:00:15.480 --> 00:00:16.499
WES CHUN: Chun, sir.

00:00:16.499 --> 00:00:18.040
MALE SPEAKER: You're
killing me here.

00:00:18.040 --> 00:00:18.490
All right, Wes Chun.

00:00:18.490 --> 00:00:19.360
I got a question for you.

00:00:19.360 --> 00:00:21.500
We got dozens of videos on
our YouTube channel, right?

00:00:21.500 --> 00:00:22.020
WES CHUN: Yes, sir.

00:00:22.020 --> 00:00:23.190
MALE SPEAKER: Well, I need
information about them.

00:00:23.190 --> 00:00:23.790
Who are our users?

00:00:23.790 --> 00:00:24.440
Where are they coming from?

00:00:24.440 --> 00:00:24.900
What are they doing?

00:00:24.900 --> 00:00:25.860
Are they eating anything?

00:00:25.860 --> 00:00:26.370
If so.

00:00:26.370 --> 00:00:26.950
Is it cereal.

00:00:26.950 --> 00:00:27.947
And if so, what kind?

00:00:27.947 --> 00:00:29.030
And is there a toy inside?

00:00:29.030 --> 00:00:29.697
You got that?

00:00:29.697 --> 00:00:30.280
You know what?

00:00:30.280 --> 00:00:30.820
Scratch that.

00:00:30.820 --> 00:00:32.200
Just give me view
counts of our views

00:00:32.200 --> 00:00:34.060
and those of our competitors,
and somebody around here

00:00:34.060 --> 00:00:34.851
get me some cereal.

00:00:34.851 --> 00:00:36.250
I am starving.

00:00:36.250 --> 00:00:39.350
Oh, and Wes, I'm going to
need that by lunchtime today.

00:00:39.350 --> 00:00:40.290
WES CHUN: Lunch, sir?

00:00:40.290 --> 00:00:41.050
MALE SPEAKER: Wes,
I'm not saying

00:00:41.050 --> 00:00:42.760
you're going to be fired if
you can't get it done by lunch,

00:00:42.760 --> 00:00:44.690
but I'm not saying you're not
going to be fired, either.

00:00:44.690 --> 00:00:46.100
Oh, and put some pants on.

00:00:46.100 --> 00:00:48.514
I'm running a business,
not a summer camp.

00:00:48.514 --> 00:00:49.498
WES CHUN: Yes, sir.

00:00:54.430 --> 00:00:55.010
Geez.

00:00:55.010 --> 00:00:57.960
Going to each video to get the
view count is taking forever.

00:00:57.960 --> 00:01:00.752
How am I supposed to
finish by lunch time?

00:01:00.752 --> 00:01:01.720
MALE SPEAKER: Hey.

00:01:01.720 --> 00:01:03.620
Google Apps Script.

00:01:03.620 --> 00:01:04.663
It talks to YouTube.

00:01:09.852 --> 00:01:12.310
MALE SPEAKER: Wes Chun, what
is wrong with these view count

00:01:12.310 --> 00:01:12.690
reports?

00:01:12.690 --> 00:01:14.106
It's just a bunch
of gobbledygook.

00:01:14.106 --> 00:01:15.329
Is this secret code?

00:01:15.329 --> 00:01:16.120
WES CHUN: Yes, sir.

00:01:16.120 --> 00:01:17.980
Let me refresh your
screen for you.

00:01:17.980 --> 00:01:19.010
MALE SPEAKER: Oh.

00:01:19.010 --> 00:01:20.150
Oh, that is nice.

00:01:20.150 --> 00:01:21.050
Good job, Wes Chun.

00:01:21.050 --> 00:01:22.140
I think you're going to
find a little something

00:01:22.140 --> 00:01:23.600
extra in your
paycheck this week.

00:01:23.600 --> 00:01:25.017
It's a ladybug.

00:01:25.017 --> 00:01:26.100
My daughters into insects.

00:01:26.100 --> 00:01:26.891
It's a whole thing.

00:01:26.891 --> 00:01:27.742
Anyway, nice work.

00:01:27.742 --> 00:01:29.950
Hey, everybody, we're going
to break early for lunch.

00:01:29.950 --> 00:01:30.980
Wes's treating.

00:01:30.980 --> 00:01:32.970
WES CHUN: Actually,
it's Wesley, sir.

00:01:32.970 --> 00:01:34.682
MALE SPEAKER: Oh,
two syllable man.

00:01:34.682 --> 00:01:36.140
I knew I liked the
cut of your jib.

00:01:36.140 --> 00:01:37.040
Good job, Wesley.

00:01:39.049 --> 00:01:40.590
WES CHUN: Do you
want this to be you?

00:01:40.590 --> 00:01:42.620
Of course you do.

00:01:42.620 --> 00:01:43.820
New to Apps Script?

00:01:43.820 --> 00:01:46.840
It's a programmatic way to
access data in Google Apps.

00:01:46.840 --> 00:01:48.060
Already use it?

00:01:48.060 --> 00:01:50.110
Think it's only for
Google Docs and Sheets?

00:01:50.110 --> 00:01:51.360
Think again.

00:01:51.360 --> 00:01:55.100
With the YouTube data APA, you
could be your boss's hero, too.

00:01:55.100 --> 00:01:56.780
This is Google
engineer Wesley Chun,

00:01:56.780 --> 00:01:59.238
and I'm going to help you get
started on making an app just

00:01:59.238 --> 00:02:00.240
like the one you saw.

00:02:00.240 --> 00:02:01.920
Start by going to
your Google Drive

00:02:01.920 --> 00:02:03.670
and creating a Google Sheet.

00:02:03.670 --> 00:02:07.230
Now put on your coding hat,
and let's go to the computer.

00:02:07.230 --> 00:02:09.169
So I've created a
brand new sheet here,

00:02:09.169 --> 00:02:13.110
and I've already added three
columns-- video ID, the title,

00:02:13.110 --> 00:02:15.000
and the number of views.

00:02:15.000 --> 00:02:16.950
So go ahead and
make one of those,

00:02:16.950 --> 00:02:19.140
and add those three
columns as well.

00:02:19.140 --> 00:02:22.260
And then think of a video that
you want to get information on.

00:02:22.260 --> 00:02:25.500
I've already got one in mind,
so if you have one, too,

00:02:25.500 --> 00:02:29.180
just go to YouTube and then
go up to the top in the URL.

00:02:29.180 --> 00:02:31.210
You can find the video ID.

00:02:31.210 --> 00:02:32.940
And then grab that
and paste that

00:02:32.940 --> 00:02:37.074
into the very first
available cell, which is A2.

00:02:37.074 --> 00:02:38.490
Now let's take a
look at some code

00:02:38.490 --> 00:02:41.730
by pulling down Tools
and Script Editor.

00:02:41.730 --> 00:02:43.530
And what you'll
get, as you've seen

00:02:43.530 --> 00:02:46.090
before in previous
episodes, is you're

00:02:46.090 --> 00:02:48.270
going to get presented
with a bunch of templates,

00:02:48.270 --> 00:02:51.590
and you're going to just choose
Blank Project because our code

00:02:51.590 --> 00:02:53.590
is going to be pretty short.

00:02:53.590 --> 00:02:55.320
And what you're
going to do is you're

00:02:55.320 --> 00:02:56.970
going to enter code
like this, but wait

00:02:56.970 --> 00:03:00.180
until I describe each line
first before you type them in.

00:03:00.180 --> 00:03:03.520
So change the name of the
function to Get Video Info.

00:03:03.520 --> 00:03:04.610
That's the first step.

00:03:04.610 --> 00:03:09.170
On lines two and three, we
grab the current active sheet

00:03:09.170 --> 00:03:11.260
and the data item in cell A2.

00:03:11.260 --> 00:03:13.760
So this is code that
we've already seen before.

00:03:13.760 --> 00:03:15.640
You need to talk to
the sheet, and then you

00:03:15.640 --> 00:03:17.890
need to get the range
of cells, and then

00:03:17.890 --> 00:03:20.240
you need to pull out
the specific values.

00:03:20.240 --> 00:03:22.710
In this particular case, we're
only looking at one cell,

00:03:22.710 --> 00:03:24.610
and that's A2.

00:03:24.610 --> 00:03:26.700
The magic happens
on line four, which

00:03:26.700 --> 00:03:29.030
calls the YouTube data API.

00:03:29.030 --> 00:03:32.170
And you do that by calling
YouTube.videos, then

00:03:32.170 --> 00:03:33.560
its list method.

00:03:33.560 --> 00:03:37.200
The first parameter in the
call to the list method

00:03:37.200 --> 00:03:40.150
are the video resources
that you're interested in.

00:03:40.150 --> 00:03:42.970
Each video has multiple
data sets to choose from.

00:03:42.970 --> 00:03:47.070
For example, Statistics has
information like view count,

00:03:47.070 --> 00:03:50.840
likes, and dislikes, while
Snippet has the publish date,

00:03:50.840 --> 00:03:52.740
title, and description.

00:03:52.740 --> 00:03:55.410
There are others with useful
information, too, not just

00:03:55.410 --> 00:03:57.040
the pair that we're
requesting here.

00:03:57.040 --> 00:03:58.930
The second parameter is easier.

00:03:58.930 --> 00:04:02.760
This is just the ID of the video
that we want to get data on.

00:04:02.760 --> 00:04:05.240
Since we're only
asking for one video,

00:04:05.240 --> 00:04:08.330
we get back a JavaScript
array that only has one row,

00:04:08.330 --> 00:04:10.305
so we save it in line five.

00:04:10.305 --> 00:04:13.010
On line six, we pull
out the two items

00:04:13.010 --> 00:04:15.350
that we're interested
in-- the title, which

00:04:15.350 --> 00:04:17.370
comes from Snippet, and
the view count, which

00:04:17.370 --> 00:04:18.611
comes from Statistics.

00:04:18.611 --> 00:04:20.610
Finally, they're written
back to the spreadsheet

00:04:20.610 --> 00:04:25.160
in cells B2 and C2 by using
the set values method call.

00:04:25.160 --> 00:04:25.870
And that's it.

00:04:25.870 --> 00:04:28.950
But before we run the script,
we need to first enable access

00:04:28.950 --> 00:04:30.520
to the YouTube data API.

00:04:30.520 --> 00:04:32.660
Otherwise, we're
not going anywhere.

00:04:32.660 --> 00:04:35.010
So go up to the Resources
menu and pull down

00:04:35.010 --> 00:04:36.830
Advanced Google Services.

00:04:36.830 --> 00:04:39.340
Before we do that, we have
to enter a project name.

00:04:39.340 --> 00:04:41.730
So let's call it Get Video Info.

00:04:44.740 --> 00:04:48.270
Now, once you have the Advanced
Google Services dialog box,

00:04:48.270 --> 00:04:51.470
scroll all the way down and
find the YouTube data API,

00:04:51.470 --> 00:04:52.670
and turn it on.

00:04:52.670 --> 00:04:54.810
Now, this yellow
dialog box pops up

00:04:54.810 --> 00:04:57.690
that says, "You must enable
this in the Google Developers

00:04:57.690 --> 00:04:58.560
Console," as well.

00:04:58.560 --> 00:05:00.300
So go ahead and click that.

00:05:00.300 --> 00:05:02.760
And then here, on
the API Library page,

00:05:02.760 --> 00:05:06.210
look for YouTube data API,
select it, and then press

00:05:06.210 --> 00:05:08.430
the blue Enable API button.

00:05:08.430 --> 00:05:10.370
Once it's done, you
can go back and confirm

00:05:10.370 --> 00:05:13.370
that it has been turned on by
clicking on the Enabled APIs

00:05:13.370 --> 00:05:14.580
link up at the top.

00:05:14.580 --> 00:05:16.030
And there it is.

00:05:16.030 --> 00:05:16.530
All right.

00:05:16.530 --> 00:05:17.700
That part is done.

00:05:17.700 --> 00:05:19.780
Let's go back to the
Advanced Google Services

00:05:19.780 --> 00:05:23.320
and then click OK
to accept that.

00:05:23.320 --> 00:05:23.820
All right.

00:05:23.820 --> 00:05:28.800
So once we're back here, we
can click Run to execute it.

00:05:28.800 --> 00:05:30.550
And there's the
yellow dialog box.

00:05:30.550 --> 00:05:32.550
But ah, here comes
the OAuth, where

00:05:32.550 --> 00:05:36.050
we need to give
authorization to this script

00:05:36.050 --> 00:05:38.610
to get access to your
spreadsheet data,

00:05:38.610 --> 00:05:41.440
as well as to talk to
the YouTube data API.

00:05:41.440 --> 00:05:42.780
So click Continue.

00:05:42.780 --> 00:05:45.650
You'll see the familiar
OAuth 2 dialog,

00:05:45.650 --> 00:05:48.580
and we want this access, so
we're going to click Allow.

00:05:48.580 --> 00:05:51.250
And once the authorization
has gone through,

00:05:51.250 --> 00:05:54.520
you'll see the dialog box
run, and once it's done,

00:05:54.520 --> 00:05:55.880
it disappears.

00:05:55.880 --> 00:05:59.840
And if we're lucky, we
will see the YouTube video

00:05:59.840 --> 00:06:02.370
title and its view count.

00:06:02.370 --> 00:06:02.870
Cool.

00:06:02.870 --> 00:06:05.050
Now all we have to do
is name this thing,

00:06:05.050 --> 00:06:06.680
and then we'll be done.

00:06:06.680 --> 00:06:07.990
Call it anything you want.

00:06:07.990 --> 00:06:11.270
I'll call mine Video Statistics.

00:06:11.270 --> 00:06:12.059
So great.

00:06:12.059 --> 00:06:13.600
You were able to
write an Apps Script

00:06:13.600 --> 00:06:15.160
app that talks to
the YouTube data

00:06:15.160 --> 00:06:18.390
API that pulls down information
that you're looking for.

00:06:18.390 --> 00:06:20.710
Now you can impress
your boss, too.

00:06:20.710 --> 00:06:22.480
Wow, wasn't that cool?

00:06:22.480 --> 00:06:25.340
This isn't as complex as the
one I ran earlier for my boss,

00:06:25.340 --> 00:06:26.930
but it's your jump start.

00:06:26.930 --> 00:06:29.110
The point is to show
you that automation,

00:06:29.110 --> 00:06:32.060
like using the YouTube data
API, is one of the main reasons

00:06:32.060 --> 00:06:33.400
to use Apps Script.

00:06:33.400 --> 00:06:35.600
By the way, if the code
was too hard to see,

00:06:35.600 --> 00:06:37.852
it's also in the Google
Sheet that you can copy.

00:06:37.852 --> 00:06:39.310
The link is also
in the description

00:06:39.310 --> 00:06:40.484
below if you're on mobile.

00:06:40.484 --> 00:06:42.150
Speaking of which,
did you know that you

00:06:42.150 --> 00:06:44.670
can run your scripts from
anywhere using Apps Script's

00:06:44.670 --> 00:06:46.667
execution API?

00:06:46.667 --> 00:06:48.250
What else can you
do with Apps Script?

00:06:48.250 --> 00:06:50.708
Well, check out the Docs which
include various quick starts

00:06:50.708 --> 00:06:51.690
to get you going.

00:06:51.690 --> 00:06:53.960
Want to know more about
the YouTube data API?

00:06:53.960 --> 00:06:57.150
Well, its Docs will let you
know what parameters to pass in

00:06:57.150 --> 00:06:59.250
and what to expect
from API calls.

00:06:59.250 --> 00:07:01.220
If you can't get enough,
the link at the bottom

00:07:01.220 --> 00:07:04.869
points you to more of these and
other Google Developer videos.

00:07:04.869 --> 00:07:06.660
Hope we've shown you
what a great tool Apps

00:07:06.660 --> 00:07:09.760
Script is for automating
laborious tasks-- in this case,

00:07:09.760 --> 00:07:11.930
getting information
on a bunch of videos.

00:07:11.930 --> 00:07:13.200
Want to learn more?

00:07:13.200 --> 00:07:15.150
In addition to the
Docs, stay tuned.

00:07:15.150 --> 00:07:17.940
In a few seconds, we'll link you
to other Apps Script episodes

00:07:17.940 --> 00:07:20.747
so you can see what
else you can do with it.

00:07:20.747 --> 00:07:21.830
MALE SPEAKER: Hey, Wesley.

00:07:21.830 --> 00:07:22.530
Put these on.

00:07:22.530 --> 00:07:24.155
We're going somewhere fancy.

00:07:24.155 --> 00:07:25.780
WES CHUN: This is
Wesley Chun, and I'll

00:07:25.780 --> 00:07:29.055
see you the next time on
"The Launch Pad Online."

