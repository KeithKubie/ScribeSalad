WEBVTT
Kind: captions
Language: en

00:00:00.089 --> 00:00:02.389
 
in this video we'll see how to compute

00:00:02.389 --> 00:00:02.399
in this video we'll see how to compute
 

00:00:02.399 --> 00:00:05.180
in this video we'll see how to compute
the gradient of the last function with

00:00:05.180 --> 00:00:05.190
the gradient of the last function with
 

00:00:05.190 --> 00:00:07.610
the gradient of the last function with
respect to the parameters of the log

00:00:07.610 --> 00:00:07.620
respect to the parameters of the log
 

00:00:07.620 --> 00:00:09.890
respect to the parameters of the log
unary factors in a conditional random

00:00:09.890 --> 00:00:09.900
unary factors in a conditional random
 

00:00:09.900 --> 00:00:17.060
unary factors in a conditional random
field so we are deriving the stochastic

00:00:17.060 --> 00:00:17.070
field so we are deriving the stochastic
 

00:00:17.070 --> 00:00:18.769
field so we are deriving the stochastic
gradient descent training algorithm for

00:00:18.769 --> 00:00:18.779
gradient descent training algorithm for
 

00:00:18.779 --> 00:00:20.660
gradient descent training algorithm for
conditional random field a linear chain

00:00:20.660 --> 00:00:20.670
conditional random field a linear chain
 

00:00:20.670 --> 00:00:22.490
conditional random field a linear chain
conditional random field we've seen the

00:00:22.490 --> 00:00:22.500
conditional random field we've seen the
 

00:00:22.500 --> 00:00:24.679
conditional random field we've seen the
last function before and now we're going

00:00:24.679 --> 00:00:24.689
last function before and now we're going
 

00:00:24.689 --> 00:00:26.990
last function before and now we're going
to start looking at how to compute the

00:00:26.990 --> 00:00:27.000
to start looking at how to compute the
 

00:00:27.000 --> 00:00:28.759
to start looking at how to compute the
gradients with respect to the different

00:00:28.759 --> 00:00:28.769
gradients with respect to the different
 

00:00:28.769 --> 00:00:30.679
gradients with respect to the different
parameters of the log linear conditional

00:00:30.679 --> 00:00:30.689
parameters of the log linear conditional
 

00:00:30.689 --> 00:00:34.520
parameters of the log linear conditional
random field before we've defined the

00:00:34.520 --> 00:00:34.530
random field before we've defined the
 

00:00:34.530 --> 00:00:37.729
random field before we've defined the
loss as the negative log of the

00:00:37.729 --> 00:00:37.739
loss as the negative log of the
 

00:00:37.739 --> 00:00:40.790
loss as the negative log of the
probability of the true label sequence

00:00:40.790 --> 00:00:40.800
probability of the true label sequence
 

00:00:40.800 --> 00:00:43.069
probability of the true label sequence
given the input sequence so let's look

00:00:43.069 --> 00:00:43.079
given the input sequence so let's look
 

00:00:43.079 --> 00:00:48.470
given the input sequence so let's look
at the gradient alright so we'll focus

00:00:48.470 --> 00:00:48.480
at the gradient alright so we'll focus
 

00:00:48.480 --> 00:00:51.830
at the gradient alright so we'll focus
now on the gradient with respect to the

00:00:51.830 --> 00:00:51.840
now on the gradient with respect to the
 

00:00:51.840 --> 00:00:56.119
now on the gradient with respect to the
unary log factors that is au of YK prime

00:00:56.119 --> 00:00:56.129
unary log factors that is au of YK prime
 

00:00:56.129 --> 00:00:59.599
unary log factors that is au of YK prime
where YK prime can be any class label so

00:00:59.599 --> 00:00:59.609
where YK prime can be any class label so
 

00:00:59.609 --> 00:01:01.520
where YK prime can be any class label so
it's not necessarily the observed class

00:01:01.520 --> 00:01:01.530
it's not necessarily the observed class
 

00:01:01.530 --> 00:01:04.729
it's not necessarily the observed class
labels or any class label so the partial

00:01:04.729 --> 00:01:04.739
labels or any class label so the partial
 

00:01:04.739 --> 00:01:08.030
labels or any class label so the partial
derivative of the negative log of the

00:01:08.030 --> 00:01:08.040
derivative of the negative log of the
 

00:01:08.040 --> 00:01:10.160
derivative of the negative log of the
property of the given sequence Y given

00:01:10.160 --> 00:01:10.170
property of the given sequence Y given
 

00:01:10.170 --> 00:01:13.250
property of the given sequence Y given
some input sequence X with respect to

00:01:13.250 --> 00:01:13.260
some input sequence X with respect to
 

00:01:13.260 --> 00:01:16.749
some input sequence X with respect to
the unary factor for some arbitrary

00:01:16.749 --> 00:01:16.759
the unary factor for some arbitrary
 

00:01:16.759 --> 00:01:21.590
the unary factor for some arbitrary
label Y Prime at position K is going to

00:01:21.590 --> 00:01:21.600
label Y Prime at position K is going to
 

00:01:21.600 --> 00:01:23.330
label Y Prime at position K is going to
be actually quite similar to the

00:01:23.330 --> 00:01:23.340
be actually quite similar to the
 

00:01:23.340 --> 00:01:26.149
be actually quite similar to the
gradient of the pre activation at the

00:01:26.149 --> 00:01:26.159
gradient of the pre activation at the
 

00:01:26.159 --> 00:01:27.950
gradient of the pre activation at the
output layer of a neural network it's

00:01:27.950 --> 00:01:27.960
output layer of a neural network it's
 

00:01:27.960 --> 00:01:33.170
output layer of a neural network it's
going to be minus the the identity

00:01:33.170 --> 00:01:33.180
going to be minus the the identity
 

00:01:33.180 --> 00:01:36.380
going to be minus the the identity
function of whether Y K so the K F label

00:01:36.380 --> 00:01:36.390
function of whether Y K so the K F label
 

00:01:36.390 --> 00:01:39.590
function of whether Y K so the K F label
and Y here is equal to Y prime K which

00:01:39.590 --> 00:01:39.600
and Y here is equal to Y prime K which
 

00:01:39.600 --> 00:01:41.690
and Y here is equal to Y prime K which
is the label for which we are

00:01:41.690 --> 00:01:41.700
is the label for which we are
 

00:01:41.700 --> 00:01:46.280
is the label for which we are
considering the parameters of the unary

00:01:46.280 --> 00:01:46.290
considering the parameters of the unary
 

00:01:46.290 --> 00:01:50.840
considering the parameters of the unary
factors minus the probability according

00:01:50.840 --> 00:01:50.850
factors minus the probability according
 

00:01:50.850 --> 00:01:54.139
factors minus the probability according
to our model of actually observing for

00:01:54.139 --> 00:01:54.149
to our model of actually observing for
 

00:01:54.149 --> 00:01:57.490
to our model of actually observing for
the K label the actual value y prime K

00:01:57.490 --> 00:01:57.500
the K label the actual value y prime K
 

00:01:57.500 --> 00:02:00.590
the K label the actual value y prime K
for the given input so again we have

00:02:00.590 --> 00:02:00.600
for the given input so again we have
 

00:02:00.600 --> 00:02:03.410
for the given input so again we have
this formula which is essentially minus

00:02:03.410 --> 00:02:03.420
this formula which is essentially minus
 

00:02:03.420 --> 00:02:07.310
this formula which is essentially minus
what we would like to see which is that

00:02:07.310 --> 00:02:07.320
what we would like to see which is that
 

00:02:07.320 --> 00:02:09.499
what we would like to see which is that
well oh sorry what we actually observe

00:02:09.499 --> 00:02:09.509
well oh sorry what we actually observe
 

00:02:09.509 --> 00:02:14.119
well oh sorry what we actually observe
which is a label of YK minus y

00:02:14.119 --> 00:02:14.129
which is a label of YK minus y
 

00:02:14.129 --> 00:02:16.610
which is a label of YK minus y
we currently predict so we have

00:02:16.610 --> 00:02:16.620
we currently predict so we have
 

00:02:16.620 --> 00:02:19.940
we currently predict so we have
essentially a term here which is only

00:02:19.940 --> 00:02:19.950
essentially a term here which is only
 

00:02:19.950 --> 00:02:22.399
essentially a term here which is only
one when we're considering the Union

00:02:22.399 --> 00:02:22.409
one when we're considering the Union
 

00:02:22.409 --> 00:02:24.800
one when we're considering the Union
factor for the correct answer minus the

00:02:24.800 --> 00:02:24.810
factor for the correct answer minus the
 

00:02:24.810 --> 00:02:28.460
factor for the correct answer minus the
probability distribution of the current

00:02:28.460 --> 00:02:28.470
probability distribution of the current
 

00:02:28.470 --> 00:02:29.660
probability distribution of the current
value for the current value of the

00:02:29.660 --> 00:02:29.670
value for the current value of the
 

00:02:29.670 --> 00:02:31.610
value for the current value of the
parameters of the conditional random

00:02:31.610 --> 00:02:31.620
parameters of the conditional random
 

00:02:31.620 --> 00:02:35.000
parameters of the conditional random
field for the kieth label because that's

00:02:35.000 --> 00:02:35.010
field for the kieth label because that's
 

00:02:35.010 --> 00:02:36.619
field for the kieth label because that's
actually quite similar to the neural

00:02:36.619 --> 00:02:36.629
actually quite similar to the neural
 

00:02:36.629 --> 00:02:40.520
actually quite similar to the neural
network reactivation value at the output

00:02:40.520 --> 00:02:40.530
network reactivation value at the output
 

00:02:40.530 --> 00:02:43.039
network reactivation value at the output
layer for classification that we seen

00:02:43.039 --> 00:02:43.049
layer for classification that we seen
 

00:02:43.049 --> 00:02:47.150
layer for classification that we seen
before so if we consider the specific

00:02:47.150 --> 00:02:47.160
before so if we consider the specific
 

00:02:47.160 --> 00:02:48.860
before so if we consider the specific
case of a conditional random field where

00:02:48.860 --> 00:02:48.870
case of a conditional random field where
 

00:02:48.870 --> 00:02:51.890
case of a conditional random field where
we have for a given context of ages one

00:02:51.890 --> 00:02:51.900
we have for a given context of ages one
 

00:02:51.900 --> 00:02:54.470
we have for a given context of ages one
three different neural networks one that

00:02:54.470 --> 00:02:54.480
three different neural networks one that
 

00:02:54.480 --> 00:02:56.839
three different neural networks one that
computes some pre activation based on

00:02:56.839 --> 00:02:56.849
computes some pre activation based on
 

00:02:56.849 --> 00:03:00.080
computes some pre activation based on
the current position another one based

00:03:00.080 --> 00:03:00.090
the current position another one based
 

00:03:00.090 --> 00:03:02.630
the current position another one based
on the input on the left and then the

00:03:02.630 --> 00:03:02.640
on the input on the left and then the
 

00:03:02.640 --> 00:03:04.430
on the input on the left and then the
one based on the input on the look right

00:03:04.430 --> 00:03:04.440
one based on the input on the look right
 

00:03:04.440 --> 00:03:06.319
one based on the input on the look right
so we consider the gradient with respect

00:03:06.319 --> 00:03:06.329
so we consider the gradient with respect
 

00:03:06.329 --> 00:03:10.699
so we consider the gradient with respect
to all of these pre activation function

00:03:10.699 --> 00:03:10.709
to all of these pre activation function
 

00:03:10.709 --> 00:03:12.050
to all of these pre activation function
at the output layer of these three

00:03:12.050 --> 00:03:12.060
at the output layer of these three
 

00:03:12.060 --> 00:03:15.110
at the output layer of these three
neural networks that would give us the

00:03:15.110 --> 00:03:15.120
neural networks that would give us the
 

00:03:15.120 --> 00:03:18.740
neural networks that would give us the
following gradients with the minus the

00:03:18.740 --> 00:03:18.750
following gradients with the minus the
 

00:03:18.750 --> 00:03:22.460
following gradients with the minus the
one hot vector with a one at the real

00:03:22.460 --> 00:03:22.470
one hot vector with a one at the real
 

00:03:22.470 --> 00:03:25.759
one hot vector with a one at the real
value of the label at position K minus

00:03:25.759 --> 00:03:25.769
value of the label at position K minus
 

00:03:25.769 --> 00:03:29.180
value of the label at position K minus
the vector of marginal probabilities for

00:03:29.180 --> 00:03:29.190
the vector of marginal probabilities for
 

00:03:29.190 --> 00:03:32.830
the vector of marginal probabilities for
what the label might be according to the

00:03:32.830 --> 00:03:32.840
what the label might be according to the
 

00:03:32.840 --> 00:03:35.330
what the label might be according to the
current conditional random field for

00:03:35.330 --> 00:03:35.340
current conditional random field for
 

00:03:35.340 --> 00:03:38.960
current conditional random field for
position okay so that's for the neural

00:03:38.960 --> 00:03:38.970
position okay so that's for the neural
 

00:03:38.970 --> 00:03:42.020
position okay so that's for the neural
network that looks at the input at the

00:03:42.020 --> 00:03:42.030
network that looks at the input at the
 

00:03:42.030 --> 00:03:45.680
network that looks at the input at the
current position K and if we for the one

00:03:45.680 --> 00:03:45.690
current position K and if we for the one
 

00:03:45.690 --> 00:03:47.420
current position K and if we for the one
that's looking on the left well the

00:03:47.420 --> 00:03:47.430
that's looking on the left well the
 

00:03:47.430 --> 00:03:50.629
that's looking on the left well the
green is gonna be 0 if K is equal to 1

00:03:50.629 --> 00:03:50.639
green is gonna be 0 if K is equal to 1
 

00:03:50.639 --> 00:03:52.250
green is gonna be 0 if K is equal to 1
so if it's not greater than 1 and that's

00:03:52.250 --> 00:03:52.260
so if it's not greater than 1 and that's
 

00:03:52.260 --> 00:03:55.069
so if it's not greater than 1 and that's
because and for K equals 1 there is no

00:03:55.069 --> 00:03:55.079
because and for K equals 1 there is no
 

00:03:55.079 --> 00:03:57.559
because and for K equals 1 there is no
neural net trying to predict from X 0

00:03:57.559 --> 00:03:57.569
neural net trying to predict from X 0
 

00:03:57.569 --> 00:04:00.319
neural net trying to predict from X 0
since X 0 doesn't exist and similarly we

00:04:00.319 --> 00:04:00.329
since X 0 doesn't exist and similarly we
 

00:04:00.329 --> 00:04:03.050
since X 0 doesn't exist and similarly we
have also an indicator function for the

00:04:03.050 --> 00:04:03.060
have also an indicator function for the
 

00:04:03.060 --> 00:04:06.289
have also an indicator function for the
one that looks to the right so that the

00:04:06.289 --> 00:04:06.299
one that looks to the right so that the
 

00:04:06.299 --> 00:04:10.509
one that looks to the right so that the
green it is 0 if K is equal to capital K

00:04:10.509 --> 00:04:10.519
green it is 0 if K is equal to capital K
 

00:04:10.519 --> 00:04:13.879
green it is 0 if K is equal to capital K
so now let's look at the derivation for

00:04:13.879 --> 00:04:13.889
so now let's look at the derivation for
 

00:04:13.889 --> 00:04:17.990
so now let's look at the derivation for
this formula for how so let's try to see

00:04:17.990 --> 00:04:18.000
this formula for how so let's try to see
 

00:04:18.000 --> 00:04:21.339
this formula for how so let's try to see
why this is true

00:04:21.339 --> 00:04:21.349
 
 

00:04:21.349 --> 00:04:24.260
 
alright so we're looking at the partial

00:04:24.260 --> 00:04:24.270
alright so we're looking at the partial
 

00:04:24.270 --> 00:04:27.110
alright so we're looking at the partial
derivative of the negative log

00:04:27.110 --> 00:04:27.120
derivative of the negative log
 

00:04:27.120 --> 00:04:30.379
derivative of the negative log
probability of some vector of labels Y

00:04:30.379 --> 00:04:30.389
probability of some vector of labels Y
 

00:04:30.389 --> 00:04:34.210
probability of some vector of labels Y
given some input X with respect to the

00:04:34.210 --> 00:04:34.220
given some input X with respect to the
 

00:04:34.220 --> 00:04:39.020
given some input X with respect to the
log factor the unary lock factor and its

00:04:39.020 --> 00:04:39.030
log factor the unary lock factor and its
 

00:04:39.030 --> 00:04:43.040
log factor the unary lock factor and its
value for some given label y prime K so

00:04:43.040 --> 00:04:43.050
value for some given label y prime K so
 

00:04:43.050 --> 00:04:45.110
value for some given label y prime K so
ok it means we're looking at the

00:04:45.110 --> 00:04:45.120
ok it means we're looking at the
 

00:04:45.120 --> 00:04:46.850
ok it means we're looking at the
position K in the sequence and write

00:04:46.850 --> 00:04:46.860
position K in the sequence and write
 

00:04:46.860 --> 00:04:48.950
position K in the sequence and write
prime K would be some value between 1

00:04:48.950 --> 00:04:48.960
prime K would be some value between 1
 

00:04:48.960 --> 00:04:54.530
prime K would be some value between 1
and capital C so here the only thing

00:04:54.530 --> 00:04:54.540
and capital C so here the only thing
 

00:04:54.540 --> 00:04:57.290
and capital C so here the only thing
I've done is just write what is minus

00:04:57.290 --> 00:04:57.300
I've done is just write what is minus
 

00:04:57.300 --> 00:05:00.320
I've done is just write what is minus
the log of P of Y given X for a log

00:05:00.320 --> 00:05:00.330
the log of P of Y given X for a log
 

00:05:00.330 --> 00:05:04.520
the log of P of Y given X for a log
linear sorry for a linear chain CRF so

00:05:04.520 --> 00:05:04.530
linear sorry for a linear chain CRF so
 

00:05:04.530 --> 00:05:06.140
linear sorry for a linear chain CRF so
remember we have the log of the

00:05:06.140 --> 00:05:06.150
remember we have the log of the
 

00:05:06.150 --> 00:05:07.879
remember we have the log of the
exponential of these terms so we just

00:05:07.879 --> 00:05:07.889
exponential of these terms so we just
 

00:05:07.889 --> 00:05:09.730
exponential of these terms so we just
have these terms once we apply the log

00:05:09.730 --> 00:05:09.740
have these terms once we apply the log
 

00:05:09.740 --> 00:05:13.100
have these terms once we apply the log
minus the log of set because before we

00:05:13.100 --> 00:05:13.110
minus the log of set because before we
 

00:05:13.110 --> 00:05:15.080
minus the log of set because before we
had divided divided by the partition

00:05:15.080 --> 00:05:15.090
had divided divided by the partition
 

00:05:15.090 --> 00:05:17.360
had divided divided by the partition
function so the log of that would be

00:05:17.360 --> 00:05:17.370
function so the log of that would be
 

00:05:17.370 --> 00:05:22.900
function so the log of that would be
minus the log of the partition function

00:05:22.900 --> 00:05:22.910
 
 

00:05:22.910 --> 00:05:27.469
 
now the gradients of this sorry the

00:05:27.469 --> 00:05:27.479
now the gradients of this sorry the
 

00:05:27.479 --> 00:05:28.520
now the gradients of this sorry the
partial derivative of this whole

00:05:28.520 --> 00:05:28.530
partial derivative of this whole
 

00:05:28.530 --> 00:05:31.040
partial derivative of this whole
expression with respect to that term is

00:05:31.040 --> 00:05:31.050
expression with respect to that term is
 

00:05:31.050 --> 00:05:34.490
expression with respect to that term is
going to be 1 if the care label is

00:05:34.490 --> 00:05:34.500
going to be 1 if the care label is
 

00:05:34.500 --> 00:05:37.100
going to be 1 if the care label is
actually Y prime K otherwise that

00:05:37.100 --> 00:05:37.110
actually Y prime K otherwise that
 

00:05:37.110 --> 00:05:40.070
actually Y prime K otherwise that
particular expression is not gonna be

00:05:40.070 --> 00:05:40.080
particular expression is not gonna be
 

00:05:40.080 --> 00:05:42.320
particular expression is not gonna be
it's not gonna appear here okay so the

00:05:42.320 --> 00:05:42.330
it's not gonna appear here okay so the
 

00:05:42.330 --> 00:05:44.300
it's not gonna appear here okay so the
gradient for any other position then K

00:05:44.300 --> 00:05:44.310
gradient for any other position then K
 

00:05:44.310 --> 00:05:47.900
gradient for any other position then K
of these terms here is zero the green

00:05:47.900 --> 00:05:47.910
of these terms here is zero the green
 

00:05:47.910 --> 00:05:51.140
of these terms here is zero the green
the derivative with respect to that of

00:05:51.140 --> 00:05:51.150
the derivative with respect to that of
 

00:05:51.150 --> 00:05:53.060
the derivative with respect to that of
that sorry with respect to this is also

00:05:53.060 --> 00:05:53.070
that sorry with respect to this is also
 

00:05:53.070 --> 00:05:55.850
that sorry with respect to this is also
zero so it's only the case for the same

00:05:55.850 --> 00:05:55.860
zero so it's only the case for the same
 

00:05:55.860 --> 00:05:58.400
zero so it's only the case for the same
K which is important and if YK is equal

00:05:58.400 --> 00:05:58.410
K which is important and if YK is equal
 

00:05:58.410 --> 00:06:01.219
K which is important and if YK is equal
to prime prime K then we'll have exactly

00:06:01.219 --> 00:06:01.229
to prime prime K then we'll have exactly
 

00:06:01.229 --> 00:06:03.620
to prime prime K then we'll have exactly
the same term so the relief of that is

00:06:03.620 --> 00:06:03.630
the same term so the relief of that is
 

00:06:03.630 --> 00:06:06.320
the same term so the relief of that is
going to be 1 otherwise it going to be 0

00:06:06.320 --> 00:06:06.330
going to be 1 otherwise it going to be 0
 

00:06:06.330 --> 00:06:08.390
going to be 1 otherwise it going to be 0
and then minus the derivative of the log

00:06:08.390 --> 00:06:08.400
and then minus the derivative of the log
 

00:06:08.400 --> 00:06:12.529
and then minus the derivative of the log
partition function so we're just by the

00:06:12.529 --> 00:06:12.539
partition function so we're just by the
 

00:06:12.539 --> 00:06:14.839
partition function so we're just by the
narrative to this minus iterative to of

00:06:14.839 --> 00:06:14.849
narrative to this minus iterative to of
 

00:06:14.849 --> 00:06:20.240
narrative to this minus iterative to of
that so let's do that specific term the

00:06:20.240 --> 00:06:20.250
that so let's do that specific term the
 

00:06:20.250 --> 00:06:21.980
that so let's do that specific term the
derivative of the log partition function

00:06:21.980 --> 00:06:21.990
derivative of the log partition function
 

00:06:21.990 --> 00:06:25.719
derivative of the log partition function
so derivative of the log is just 1 over

00:06:25.719 --> 00:06:25.729
so derivative of the log is just 1 over
 

00:06:25.729 --> 00:06:29.170
so derivative of the log is just 1 over
that 1 over Z times the derivative of

00:06:29.170 --> 00:06:29.180
that 1 over Z times the derivative of
 

00:06:29.180 --> 00:06:31.930
that 1 over Z times the derivative of
whatever we're taking the logarithm in

00:06:31.930 --> 00:06:31.940
whatever we're taking the logarithm in
 

00:06:31.940 --> 00:06:36.950
whatever we're taking the logarithm in
logarithm of now here I'm just writing

00:06:36.950 --> 00:06:36.960
logarithm of now here I'm just writing
 

00:06:36.960 --> 00:06:38.390
logarithm of now here I'm just writing
the expression for the partition

00:06:38.390 --> 00:06:38.400
the expression for the partition
 

00:06:38.400 --> 00:06:40.430
the expression for the partition
function so because I've used the symbol

00:06:40.430 --> 00:06:40.440
function so because I've used the symbol
 

00:06:40.440 --> 00:06:40.879
function so because I've used the symbol
Y

00:06:40.879 --> 00:06:40.889
Y
 

00:06:40.889 --> 00:06:42.800
Y
prime K I'll use instead of Y prime

00:06:42.800 --> 00:06:42.810
prime K I'll use instead of Y prime
 

00:06:42.810 --> 00:06:46.070
prime K I'll use instead of Y prime
prime for reference to the sequence of

00:06:46.070 --> 00:06:46.080
prime for reference to the sequence of
 

00:06:46.080 --> 00:06:48.559
prime for reference to the sequence of
always over which I'm taking this sum

00:06:48.559 --> 00:06:48.569
always over which I'm taking this sum
 

00:06:48.569 --> 00:06:55.820
always over which I'm taking this sum
here the nest at some now I can push the

00:06:55.820 --> 00:06:55.830
here the nest at some now I can push the
 

00:06:55.830 --> 00:06:59.540
here the nest at some now I can push the
so the derivative of the sum is the sum

00:06:59.540 --> 00:06:59.550
so the derivative of the sum is the sum
 

00:06:59.550 --> 00:07:01.309
so the derivative of the sum is the sum
of the derivative so I can push that

00:07:01.309 --> 00:07:01.319
of the derivative so I can push that
 

00:07:01.319 --> 00:07:04.249
of the derivative so I can push that
there the inside here so right here

00:07:04.249 --> 00:07:04.259
there the inside here so right here
 

00:07:04.259 --> 00:07:10.450
there the inside here so right here
that's what I've done right here and now

00:07:10.450 --> 00:07:10.460
that's what I've done right here and now
 

00:07:10.460 --> 00:07:15.140
that's what I've done right here and now
the narrative of the exponentiated sum

00:07:15.140 --> 00:07:15.150
the narrative of the exponentiated sum
 

00:07:15.150 --> 00:07:20.089
the narrative of the exponentiated sum
of factors a lot of factors well if here

00:07:20.089 --> 00:07:20.099
of factors a lot of factors well if here
 

00:07:20.099 --> 00:07:23.510
of factors a lot of factors well if here
a uy prime K does not appear that it's

00:07:23.510 --> 00:07:23.520
a uy prime K does not appear that it's
 

00:07:23.520 --> 00:07:26.390
a uy prime K does not appear that it's
zero and its it won't have it won't

00:07:26.390 --> 00:07:26.400
zero and its it won't have it won't
 

00:07:26.400 --> 00:07:29.119
zero and its it won't have it won't
appear if Y prime K is not equal in the

00:07:29.119 --> 00:07:29.129
appear if Y prime K is not equal in the
 

00:07:29.129 --> 00:07:31.580
appear if Y prime K is not equal in the
sequence Y prime is not equal to Y prime

00:07:31.580 --> 00:07:31.590
sequence Y prime is not equal to Y prime
 

00:07:31.590 --> 00:07:35.149
sequence Y prime is not equal to Y prime
prime K also in the sequence Y prime

00:07:35.149 --> 00:07:35.159
prime K also in the sequence Y prime
 

00:07:35.159 --> 00:07:39.379
prime K also in the sequence Y prime
prime K if at the position K its value

00:07:39.379 --> 00:07:39.389
prime K if at the position K its value
 

00:07:39.389 --> 00:07:42.969
prime K if at the position K its value
is not the value of y prime K then the

00:07:42.969 --> 00:07:42.979
is not the value of y prime K then the
 

00:07:42.979 --> 00:07:45.679
is not the value of y prime K then the
then the third F of that is going to be

00:07:45.679 --> 00:07:45.689
then the third F of that is going to be
 

00:07:45.689 --> 00:07:46.999
then the third F of that is going to be
zero it's going in because it's going to

00:07:46.999 --> 00:07:47.009
zero it's going in because it's going to
 

00:07:47.009 --> 00:07:48.679
zero it's going in because it's going to
be constant with respect to that

00:07:48.679 --> 00:07:48.689
be constant with respect to that
 

00:07:48.689 --> 00:07:52.249
be constant with respect to that
variable however if it does appear then

00:07:52.249 --> 00:07:52.259
variable however if it does appear then
 

00:07:52.259 --> 00:07:55.219
variable however if it does appear then
the derivative of the exponential is the

00:07:55.219 --> 00:07:55.229
the derivative of the exponential is the
 

00:07:55.229 --> 00:07:57.260
the derivative of the exponential is the
exponential itself so it's gonna be that

00:07:57.260 --> 00:07:57.270
exponential itself so it's gonna be that
 

00:07:57.270 --> 00:07:58.939
exponential itself so it's gonna be that
term and times the derivative of the

00:07:58.939 --> 00:07:58.949
term and times the derivative of the
 

00:07:58.949 --> 00:08:01.369
term and times the derivative of the
argument well it's just gonna be one

00:08:01.369 --> 00:08:01.379
argument well it's just gonna be one
 

00:08:01.379 --> 00:08:04.070
argument well it's just gonna be one
much like it was one right here

00:08:04.070 --> 00:08:04.080
much like it was one right here
 

00:08:04.080 --> 00:08:07.010
much like it was one right here
so essentially what we'll get is the

00:08:07.010 --> 00:08:07.020
so essentially what we'll get is the
 

00:08:07.020 --> 00:08:09.469
so essentially what we'll get is the
indicator function of whether y prime K

00:08:09.469 --> 00:08:09.479
indicator function of whether y prime K
 

00:08:09.479 --> 00:08:12.290
indicator function of whether y prime K
is equal to Y prime prime K times the

00:08:12.290 --> 00:08:12.300
is equal to Y prime prime K times the
 

00:08:12.300 --> 00:08:14.629
is equal to Y prime prime K times the
exponential of the sum of all log

00:08:14.629 --> 00:08:14.639
exponential of the sum of all log
 

00:08:14.639 --> 00:08:19.519
exponential of the sum of all log
factors now let's notice that here

00:08:19.519 --> 00:08:19.529
factors now let's notice that here
 

00:08:19.529 --> 00:08:23.719
factors now let's notice that here
that's the numerator of the probability

00:08:23.719 --> 00:08:23.729
that's the numerator of the probability
 

00:08:23.729 --> 00:08:25.839
that's the numerator of the probability
the conditional probability in the

00:08:25.839 --> 00:08:25.849
the conditional probability in the
 

00:08:25.849 --> 00:08:29.540
the conditional probability in the
conditional random field and that's the

00:08:29.540 --> 00:08:29.550
conditional random field and that's the
 

00:08:29.550 --> 00:08:33.110
conditional random field and that's the
partition function so I can just remove

00:08:33.110 --> 00:08:33.120
partition function so I can just remove
 

00:08:33.120 --> 00:08:37.569
partition function so I can just remove
it here and just divide by it here and

00:08:37.569 --> 00:08:37.579
it here and just divide by it here and
 

00:08:37.579 --> 00:08:39.500
it here and just divide by it here and
then what do I get

00:08:39.500 --> 00:08:39.510
then what do I get
 

00:08:39.510 --> 00:08:42.439
then what do I get
well I get that this whole term here is

00:08:42.439 --> 00:08:42.449
well I get that this whole term here is
 

00:08:42.449 --> 00:08:45.829
well I get that this whole term here is
just the probability of observing as the

00:08:45.829 --> 00:08:45.839
just the probability of observing as the
 

00:08:45.839 --> 00:08:48.829
just the probability of observing as the
sequence of labels Y prime prime 1

00:08:48.829 --> 00:08:48.839
sequence of labels Y prime prime 1
 

00:08:48.839 --> 00:08:51.829
sequence of labels Y prime prime 1
followed by Y prime 2 up to Y prime

00:08:51.829 --> 00:08:51.839
followed by Y prime 2 up to Y prime
 

00:08:51.839 --> 00:08:54.079
followed by Y prime 2 up to Y prime
prime capital K

00:08:54.079 --> 00:08:54.089
prime capital K
 

00:08:54.089 --> 00:09:00.049
prime capital K
and then this term here is here and now

00:09:00.049 --> 00:09:00.059
and then this term here is here and now
 

00:09:00.059 --> 00:09:02.540
and then this term here is here and now
if I take the sum over all possible

00:09:02.540 --> 00:09:02.550
if I take the sum over all possible
 

00:09:02.550 --> 00:09:07.639
if I take the sum over all possible
sequences of and I only consider the

00:09:07.639 --> 00:09:07.649
sequences of and I only consider the
 

00:09:07.649 --> 00:09:10.309
sequences of and I only consider the
terms where in all these sequences I

00:09:10.309 --> 00:09:10.319
terms where in all these sequences I
 

00:09:10.319 --> 00:09:12.590
terms where in all these sequences I
don't consider the sequences such that Y

00:09:12.590 --> 00:09:12.600
don't consider the sequences such that Y
 

00:09:12.600 --> 00:09:15.439
don't consider the sequences such that Y
prime prime K is equal to Y prime K then

00:09:15.439 --> 00:09:15.449
prime prime K is equal to Y prime K then
 

00:09:15.449 --> 00:09:17.329
prime prime K is equal to Y prime K then
I'm just summing the probability of all

00:09:17.329 --> 00:09:17.339
I'm just summing the probability of all
 

00:09:17.339 --> 00:09:21.110
I'm just summing the probability of all
sequences which satisfy this condition

00:09:21.110 --> 00:09:21.120
sequences which satisfy this condition
 

00:09:21.120 --> 00:09:23.449
sequences which satisfy this condition
so all sequences such that the key

00:09:23.449 --> 00:09:23.459
so all sequences such that the key
 

00:09:23.459 --> 00:09:25.610
so all sequences such that the key
element in the sequence is ripe ranking

00:09:25.610 --> 00:09:25.620
element in the sequence is ripe ranking
 

00:09:25.620 --> 00:09:28.220
element in the sequence is ripe ranking
and so the sum of all of these joint

00:09:28.220 --> 00:09:28.230
and so the sum of all of these joint
 

00:09:28.230 --> 00:09:29.929
and so the sum of all of these joint
probability is just a marginal

00:09:29.929 --> 00:09:29.939
probability is just a marginal
 

00:09:29.939 --> 00:09:34.879
probability is just a marginal
probability that Y prime K is DK table

00:09:34.879 --> 00:09:34.889
probability that Y prime K is DK table
 

00:09:34.889 --> 00:09:37.759
probability that Y prime K is DK table
in the sequence so I do obtain that this

00:09:37.759 --> 00:09:37.769
in the sequence so I do obtain that this
 

00:09:37.769 --> 00:09:41.720
in the sequence so I do obtain that this
term here is P of Y prime K given x

00:09:41.720 --> 00:09:41.730
term here is P of Y prime K given x
 

00:09:41.730 --> 00:09:45.379
term here is P of Y prime K given x
mm-hmm and so I do have that the

00:09:45.379 --> 00:09:45.389
mm-hmm and so I do have that the
 

00:09:45.389 --> 00:09:46.999
mm-hmm and so I do have that the
gradients the parts of the other would

00:09:46.999 --> 00:09:47.009
gradients the parts of the other would
 

00:09:47.009 --> 00:09:49.579
gradients the parts of the other would
respect to the log unary factor is the

00:09:49.579 --> 00:09:49.589
respect to the log unary factor is the
 

00:09:49.589 --> 00:09:51.410
respect to the log unary factor is the
indicator function minus the probability

00:09:51.410 --> 00:09:51.420
indicator function minus the probability
 

00:09:51.420 --> 00:09:57.410
indicator function minus the probability
under the model so that's great I know

00:09:57.410 --> 00:09:57.420
under the model so that's great I know
 

00:09:57.420 --> 00:10:00.829
under the model so that's great I know
we now have the gradient of the and the

00:10:00.829 --> 00:10:00.839
we now have the gradient of the and the
 

00:10:00.839 --> 00:10:02.780
we now have the gradient of the and the
partial derivative with respect to the

00:10:02.780 --> 00:10:02.790
partial derivative with respect to the
 

00:10:02.790 --> 00:10:05.119
partial derivative with respect to the
log unary factor but we don't have it

00:10:05.119 --> 00:10:05.129
log unary factor but we don't have it
 

00:10:05.129 --> 00:10:07.129
log unary factor but we don't have it
with respect to the parameters in the

00:10:07.129 --> 00:10:07.139
with respect to the parameters in the
 

00:10:07.139 --> 00:10:09.410
with respect to the parameters in the
log in every factor fortunately we've

00:10:09.410 --> 00:10:09.420
log in every factor fortunately we've
 

00:10:09.420 --> 00:10:12.049
log in every factor fortunately we've
seen that the back propagation allows us

00:10:12.049 --> 00:10:12.059
seen that the back propagation allows us
 

00:10:12.059 --> 00:10:14.179
seen that the back propagation allows us
to very efficiently apply the chain rule

00:10:14.179 --> 00:10:14.189
to very efficiently apply the chain rule
 

00:10:14.189 --> 00:10:16.549
to very efficiently apply the chain rule
and back propagate the gradients to all

00:10:16.549 --> 00:10:16.559
and back propagate the gradients to all
 

00:10:16.559 --> 00:10:19.519
and back propagate the gradients to all
the parameters so essentially from the

00:10:19.519 --> 00:10:19.529
the parameters so essentially from the
 

00:10:19.529 --> 00:10:21.650
the parameters so essentially from the
parameters of the log linear factors

00:10:21.650 --> 00:10:21.660
parameters of the log linear factors
 

00:10:21.660 --> 00:10:24.799
parameters of the log linear factors
that gives me essentially the the

00:10:24.799 --> 00:10:24.809
that gives me essentially the the
 

00:10:24.809 --> 00:10:26.720
that gives me essentially the the
partial derivative with respect to the

00:10:26.720 --> 00:10:26.730
partial derivative with respect to the
 

00:10:26.730 --> 00:10:29.600
partial derivative with respect to the
pre activation values at the output

00:10:29.600 --> 00:10:29.610
pre activation values at the output
 

00:10:29.610 --> 00:10:32.389
pre activation values at the output
layer of the neural Nets inside this

00:10:32.389 --> 00:10:32.399
layer of the neural Nets inside this
 

00:10:32.399 --> 00:10:34.100
layer of the neural Nets inside this
area and then I can just take those

00:10:34.100 --> 00:10:34.110
area and then I can just take those
 

00:10:34.110 --> 00:10:36.169
area and then I can just take those
gradients those partial derivatives and

00:10:36.169 --> 00:10:36.179
gradients those partial derivatives and
 

00:10:36.179 --> 00:10:38.150
gradients those partial derivatives and
back propagate them towards all the

00:10:38.150 --> 00:10:38.160
back propagate them towards all the
 

00:10:38.160 --> 00:10:41.150
back propagate them towards all the
parameters of the model now notice that

00:10:41.150 --> 00:10:41.160
parameters of the model now notice that
 

00:10:41.160 --> 00:10:43.429
parameters of the model now notice that
because it's the same neural network at

00:10:43.429 --> 00:10:43.439
because it's the same neural network at
 

00:10:43.439 --> 00:10:45.889
because it's the same neural network at
each position in the conditional random

00:10:45.889 --> 00:10:45.899
each position in the conditional random
 

00:10:45.899 --> 00:10:48.319
each position in the conditional random
field I need to accumulate all the

00:10:48.319 --> 00:10:48.329
field I need to accumulate all the
 

00:10:48.329 --> 00:10:51.710
field I need to accumulate all the
gradients for every position and the

00:10:51.710 --> 00:10:51.720
gradients for every position and the
 

00:10:51.720 --> 00:10:52.400
gradients for every position and the
sequence

00:10:52.400 --> 00:10:52.410
sequence
 

00:10:52.410 --> 00:10:53.809
sequence
so all these grains need to be

00:10:53.809 --> 00:10:53.819
so all these grains need to be
 

00:10:53.819 --> 00:10:57.590
so all these grains need to be
accumulated into the my computation of

00:10:57.590 --> 00:10:57.600
accumulated into the my computation of
 

00:10:57.600 --> 00:11:02.509
accumulated into the my computation of
the parameter gradients so let's look at

00:11:02.509 --> 00:11:02.519
the parameter gradients so let's look at
 

00:11:02.519 --> 00:11:05.689
the parameter gradients so let's look at
the specific case of linear linear chain

00:11:05.689 --> 00:11:05.699
the specific case of linear linear chain
 

00:11:05.699 --> 00:11:06.980
the specific case of linear linear chain
conditional random field so the case

00:11:06.980 --> 00:11:06.990
conditional random field so the case
 

00:11:06.990 --> 00:11:07.850
conditional random field so the case
where the

00:11:07.850 --> 00:11:07.860
where the
 

00:11:07.860 --> 00:11:11.690
where the
factors on linear so this would be the

00:11:11.690 --> 00:11:11.700
factors on linear so this would be the
 

00:11:11.700 --> 00:11:13.940
factors on linear so this would be the
neural network from the center the

00:11:13.940 --> 00:11:13.950
neural network from the center the
 

00:11:13.950 --> 00:11:16.190
neural network from the center the
computation that looks at the aligned

00:11:16.190 --> 00:11:16.200
computation that looks at the aligned
 

00:11:16.200 --> 00:11:18.560
computation that looks at the aligned
input so being linear transformation

00:11:18.560 --> 00:11:18.570
input so being linear transformation
 

00:11:18.570 --> 00:11:23.660
input so being linear transformation
plus bias then we have the computation

00:11:23.660 --> 00:11:23.670
plus bias then we have the computation
 

00:11:23.670 --> 00:11:25.819
plus bias then we have the computation
that looks at sorry that's a mistake

00:11:25.819 --> 00:11:25.829
that looks at sorry that's a mistake
 

00:11:25.829 --> 00:11:30.050
that looks at sorry that's a mistake
that should be oh no sir yeah so that's

00:11:30.050 --> 00:11:30.060
that should be oh no sir yeah so that's
 

00:11:30.060 --> 00:11:31.160
that should be oh no sir yeah so that's
one way of writing it I could have

00:11:31.160 --> 00:11:31.170
one way of writing it I could have
 

00:11:31.170 --> 00:11:34.160
one way of writing it I could have
written it K minus 1 here and K minus 1

00:11:34.160 --> 00:11:34.170
written it K minus 1 here and K minus 1
 

00:11:34.170 --> 00:11:36.949
written it K minus 1 here and K minus 1
here I could've written K plus 1 here k

00:11:36.949 --> 00:11:36.959
here I could've written K plus 1 here k
 

00:11:36.959 --> 00:11:38.750
here I could've written K plus 1 here k
plus 1 here but let's just assume now

00:11:38.750 --> 00:11:38.760
plus 1 here but let's just assume now
 

00:11:38.760 --> 00:11:43.069
plus 1 here but let's just assume now
that we have this log linear model where

00:11:43.069 --> 00:11:43.079
that we have this log linear model where
 

00:11:43.079 --> 00:11:47.030
that we have this log linear model where
the unary log factors are just linear

00:11:47.030 --> 00:11:47.040
the unary log factors are just linear
 

00:11:47.040 --> 00:11:52.670
the unary log factors are just linear
function of the context window so in

00:11:52.670 --> 00:11:52.680
function of the context window so in
 

00:11:52.680 --> 00:11:55.250
function of the context window so in
this case the gradient with respect to

00:11:55.250 --> 00:11:55.260
this case the gradient with respect to
 

00:11:55.260 --> 00:11:58.699
this case the gradient with respect to
the bias and also I just want to say

00:11:58.699 --> 00:11:58.709
the bias and also I just want to say
 

00:11:58.709 --> 00:12:02.120
the bias and also I just want to say
that notice I didn't put a bias here or

00:12:02.120 --> 00:12:02.130
that notice I didn't put a bias here or
 

00:12:02.130 --> 00:12:04.190
that notice I didn't put a bias here or
here and that's because I would just be

00:12:04.190 --> 00:12:04.200
here and that's because I would just be
 

00:12:04.200 --> 00:12:06.829
here and that's because I would just be
redundant since I mean just a single

00:12:06.829 --> 00:12:06.839
redundant since I mean just a single
 

00:12:06.839 --> 00:12:12.949
redundant since I mean just a single
bias is sufficient so the gradient

00:12:12.949 --> 00:12:12.959
bias is sufficient so the gradient
 

00:12:12.959 --> 00:12:15.769
bias is sufficient so the gradient
respect of the bias would be the

00:12:15.769 --> 00:12:15.779
respect of the bias would be the
 

00:12:15.779 --> 00:12:20.900
respect of the bias would be the
gradient with respect to the pre

00:12:20.900 --> 00:12:20.910
gradient with respect to the pre
 

00:12:20.910 --> 00:12:24.889
gradient with respect to the pre
activation function for the center of

00:12:24.889 --> 00:12:24.899
activation function for the center of
 

00:12:24.899 --> 00:12:28.370
activation function for the center of
the window but summed over all positions

00:12:28.370 --> 00:12:28.380
the window but summed over all positions
 

00:12:28.380 --> 00:12:29.329
the window but summed over all positions
so that's the queen of the pre

00:12:29.329 --> 00:12:29.339
so that's the queen of the pre
 

00:12:29.339 --> 00:12:31.639
so that's the queen of the pre
activation function at all position K so

00:12:31.639 --> 00:12:31.649
activation function at all position K so
 

00:12:31.649 --> 00:12:34.670
activation function at all position K so
for all inputs XK all position K

00:12:34.670 --> 00:12:34.680
for all inputs XK all position K
 

00:12:34.680 --> 00:12:38.170
for all inputs XK all position K
actually and we've seen before that the

00:12:38.170 --> 00:12:38.180
actually and we've seen before that the
 

00:12:38.180 --> 00:12:40.790
actually and we've seen before that the
gradient was essentially this the one

00:12:40.790 --> 00:12:40.800
gradient was essentially this the one
 

00:12:40.800 --> 00:12:43.460
gradient was essentially this the one
hot dr. minus the vector of marginal

00:12:43.460 --> 00:12:43.470
hot dr. minus the vector of marginal
 

00:12:43.470 --> 00:12:45.710
hot dr. minus the vector of marginal
probabilities for position gain so I'm

00:12:45.710 --> 00:12:45.720
probabilities for position gain so I'm
 

00:12:45.720 --> 00:12:47.949
probabilities for position gain so I'm
just summing over all positions game and

00:12:47.949 --> 00:12:47.959
just summing over all positions game and
 

00:12:47.959 --> 00:12:50.000
just summing over all positions game and
now if I want the gradient with respect

00:12:50.000 --> 00:12:50.010
now if I want the gradient with respect
 

00:12:50.010 --> 00:12:53.329
now if I want the gradient with respect
to the weights that connects the input

00:12:53.329 --> 00:12:53.339
to the weights that connects the input
 

00:12:53.339 --> 00:12:55.490
to the weights that connects the input
that's at the current position K or

00:12:55.490 --> 00:12:55.500
that's at the current position K or
 

00:12:55.500 --> 00:12:58.670
that's at the current position K or
that's to the left or to the right well

00:12:58.670 --> 00:12:58.680
that's to the left or to the right well
 

00:12:58.680 --> 00:13:00.889
that's to the left or to the right well
I get something that's essentially very

00:13:00.889 --> 00:13:00.899
I get something that's essentially very
 

00:13:00.899 --> 00:13:05.360
I get something that's essentially very
similar it's again the 100m is the

00:13:05.360 --> 00:13:05.370
similar it's again the 100m is the
 

00:13:05.370 --> 00:13:08.019
similar it's again the 100m is the
vector marginal probabilities but for

00:13:08.019 --> 00:13:08.029
vector marginal probabilities but for
 

00:13:08.029 --> 00:13:12.350
vector marginal probabilities but for
this part of the this parameter matrix a

00:13:12.350 --> 00:13:12.360
this part of the this parameter matrix a
 

00:13:12.360 --> 00:13:15.740
this part of the this parameter matrix a
multiplied by the transpose of the

00:13:15.740 --> 00:13:15.750
multiplied by the transpose of the
 

00:13:15.750 --> 00:13:19.760
multiplied by the transpose of the
vector aligned with the current position

00:13:19.760 --> 00:13:19.770
vector aligned with the current position
 

00:13:19.770 --> 00:13:21.980
vector aligned with the current position
K this one I multiplied

00:13:21.980 --> 00:13:21.990
K this one I multiplied
 

00:13:21.990 --> 00:13:24.559
K this one I multiplied
the vector to the left the transpose of

00:13:24.559 --> 00:13:24.569
the vector to the left the transpose of
 

00:13:24.569 --> 00:13:26.240
the vector to the left the transpose of
the vector to the left he transposed to

00:13:26.240 --> 00:13:26.250
the vector to the left he transposed to
 

00:13:26.250 --> 00:13:29.810
the vector to the left he transposed to
the of the vector to the right

