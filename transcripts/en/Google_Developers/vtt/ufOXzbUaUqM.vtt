WEBVTT
Kind: captions
Language: en

00:00:00.000 --> 00:00:02.970
[MUSIC PLAYING]

00:00:55.230 --> 00:00:58.170
[MUSIC PLAYING]

00:03:11.790 --> 00:03:13.830
BILL LUAN: Shanghai
GDG is a very

00:03:13.830 --> 00:03:15.910
interesting developer community.

00:03:15.910 --> 00:03:16.730
FEMALE SPEAKER: I'm
glad somebody

00:03:16.730 --> 00:03:17.970
has asked this question.

00:03:17.970 --> 00:03:19.183
MALE SPEAKER: This is where
the magic happens.

00:03:19.183 --> 00:03:20.635
FEMALE SPEAKER: This is
primarily a question and

00:03:20.635 --> 00:03:20.910
answer show.

00:03:20.910 --> 00:03:23.335
So if any of you out there would
like to ask questions--

00:03:27.450 --> 00:03:28.600
PAUL SAXMAN: Hey, everybody.

00:03:28.600 --> 00:03:31.460
Welcome to the Google
Maps Office Hours.

00:03:31.460 --> 00:03:36.520
This week is Mars Mania, because
we've been doing a lot

00:03:36.520 --> 00:03:38.730
of chatting, a lot of excitement
around the office

00:03:38.730 --> 00:03:41.220
about the Curiosity landing.

00:03:41.220 --> 00:03:43.520
And we've been looking at
interesting ways that we can

00:03:43.520 --> 00:03:47.090
actually integrate that into
our work, because I think

00:03:47.090 --> 00:03:49.790
otherwise people got a little
annoyed hearing us talk about

00:03:49.790 --> 00:03:53.850
it all the time without
any real--

00:03:53.850 --> 00:03:55.760
anything to show for it.

00:03:55.760 --> 00:03:58.520
So what we did is we went
through and we thought about

00:03:58.520 --> 00:04:01.950
different ways we can actually
use the information and the

00:04:01.950 --> 00:04:06.130
imagery that's coming from the
Curiosity Rover and some of

00:04:06.130 --> 00:04:09.220
the other imagery that's
available from Mars and do

00:04:09.220 --> 00:04:11.290
interesting things with
the Google Maps API.

00:04:11.290 --> 00:04:13.810
So we've done two things
for this week.

00:04:13.810 --> 00:04:15.850
And there's a lot of other
things that we've been playing

00:04:15.850 --> 00:04:18.640
around with, and we might be
able to show at a future day.

00:04:18.640 --> 00:04:23.590
One is, actually, we did a
Street View imagery of the

00:04:23.590 --> 00:04:26.140
panoramas that we got from the
Curiosity Rover, or the

00:04:26.140 --> 00:04:30.180
panorama that we got from NASA
of the Curiosity Rover.

00:04:30.180 --> 00:04:35.060
And the other one is actually
looking at some of the

00:04:35.060 --> 00:04:38.530
elevation data that we got
from one of the other

00:04:38.530 --> 00:04:38.970
satellites.

00:04:38.970 --> 00:04:39.385
Which one was that?

00:04:39.385 --> 00:04:40.180
That was the--

00:04:40.180 --> 00:04:41.580
BRENDAN KENNY: The Mars
Reconnaissance Orbiter.

00:04:41.580 --> 00:04:44.390
PAUL SAXMAN: Yeah, the MRO,
and seeing if we could do,

00:04:44.390 --> 00:04:50.910
actually, elevation analysis
using the Google Maps APIs.

00:04:50.910 --> 00:04:53.040
And we didn't introduce--

00:04:53.040 --> 00:04:56.280
I think everybody knows you
at this point, Brendan.

00:04:56.280 --> 00:04:56.750
BRENDAN KENNY: Yeah.

00:04:56.750 --> 00:04:59.620
Hi, I'm Brendan Kenny.

00:04:59.620 --> 00:05:02.910
PAUL SAXMAN: So Brendan's been
working on the elevation data.

00:05:02.910 --> 00:05:04.120
I've been working on
the Street View.

00:05:04.120 --> 00:05:09.150
And a quick couple logistic
things real quick.

00:05:09.150 --> 00:05:11.810
Usually, we set up a moderator
so that people can actually

00:05:11.810 --> 00:05:13.060
submit comments.

00:05:13.060 --> 00:05:16.410
We didn't do this this week,
because we found that people

00:05:16.410 --> 00:05:18.490
were putting comments pretty
much all over the place,

00:05:18.490 --> 00:05:21.750
either on YouTube, or on
Google+, or in Moderator.

00:05:21.750 --> 00:05:23.960
So if you have any questions
and you want us to look at

00:05:23.960 --> 00:05:28.160
them, either today or after the
session, either put them

00:05:28.160 --> 00:05:32.110
on the YouTube or Google+, and
we're going to take a look at

00:05:32.110 --> 00:05:35.040
those a little bit later.

00:05:35.040 --> 00:05:39.750
So in terms of Street View, I
guess we'll start with what we

00:05:39.750 --> 00:05:42.200
did with Street View.

00:05:42.200 --> 00:05:46.770
So basically what NASA did is
they did a stitching of some

00:05:46.770 --> 00:05:50.130
images that they took from the
Curiosity Rover, and they made

00:05:50.130 --> 00:05:53.510
a complete 360-degree
panorama.

00:05:53.510 --> 00:05:56.880
And with that panorama, what
we're able to do is actually

00:05:56.880 --> 00:06:00.830
put that into the Street View
service to actually look at

00:06:00.830 --> 00:06:03.490
that as we would Street View.

00:06:03.490 --> 00:06:06.660
Just as Street View itself, it's
not super interesting.

00:06:06.660 --> 00:06:10.610
You can just pan around and zoom
in and out of the image.

00:06:10.610 --> 00:06:13.450
But what's really curious is
when you can layer things on

00:06:13.450 --> 00:06:14.480
top of that.

00:06:14.480 --> 00:06:16.460
So what we're going to do today
is I'll show you what we

00:06:16.460 --> 00:06:19.710
did to get the imagery
into Street View.

00:06:19.710 --> 00:06:21.370
And then we'll talk a little
bit about some of the extra

00:06:21.370 --> 00:06:23.550
stuff that you can add on.

00:06:23.550 --> 00:06:25.430
And then in terms of the--

00:06:25.430 --> 00:06:28.405
what were you going to like to
talk about today with the--

00:06:28.405 --> 00:06:31.900
BRENDAN KENNY: I think just
take a look at taking the

00:06:31.900 --> 00:06:34.160
imagery, which is in kind of
a weird format, and just

00:06:34.160 --> 00:06:37.030
bringing it in in a format that
we can use easily, and

00:06:37.030 --> 00:06:41.640
then just importing it
and using WebGL to

00:06:41.640 --> 00:06:44.650
display it in real time.

00:06:44.650 --> 00:06:48.310
Unfortunately, the really
high-res imagery of where the

00:06:48.310 --> 00:06:51.820
Curiosity lander is right now
is not coming for two days.

00:06:51.820 --> 00:06:55.500
So we timed our Hangout
two days early.

00:06:55.500 --> 00:06:57.900
But we do have lots of other
imagery of Mars that we're

00:06:57.900 --> 00:06:59.050
able to take a look at.

00:06:59.050 --> 00:07:00.770
And then hopefully, in
two days, we'll be

00:07:00.770 --> 00:07:02.140
able to post the--

00:07:02.140 --> 00:07:04.900
I think it's down to 24
centimeters per pixel

00:07:04.900 --> 00:07:08.530
resolution of the landing area
in terms of elevation.

00:07:08.530 --> 00:07:12.330
They've already published
imagery itself of the area.

00:07:12.330 --> 00:07:12.640
PAUL SAXMAN: Yeah.

00:07:12.640 --> 00:07:16.740
So this Mars mission, really,
there's a lot of imagery

00:07:16.740 --> 00:07:17.870
coming out just because--

00:07:17.870 --> 00:07:18.310
BRENDAN KENNY: Tons.

00:07:18.310 --> 00:07:20.370
PAUL SAXMAN: They've had a lot
of really good cameras on the

00:07:20.370 --> 00:07:22.860
rover and the satellites both.

00:07:22.860 --> 00:07:26.130
And so it's a great
opportunity to

00:07:26.130 --> 00:07:27.040
play around with it.

00:07:27.040 --> 00:07:28.330
And there's actually been other
people that have been

00:07:28.330 --> 00:07:30.050
looking at this as well.

00:07:30.050 --> 00:07:32.640
We saw recently there's--

00:07:32.640 --> 00:07:34.530
I'm going to forget the website
off the top of my

00:07:34.530 --> 00:07:37.260
head-- but somebody actually did
a panorama very similar to

00:07:37.260 --> 00:07:39.475
what we're going to show
in Street View, but

00:07:39.475 --> 00:07:40.760
a little bit different.

00:07:40.760 --> 00:07:43.750
It's not using Street
View technology.

00:07:43.750 --> 00:07:45.020
So why don't we kick off.

00:07:45.020 --> 00:07:46.120
We'll show you--

00:07:46.120 --> 00:07:48.760
well, actually, let's cover a
little bit about the imagery.

00:07:48.760 --> 00:07:52.300
So the image that we got from
NASA is actually rather large.

00:07:52.300 --> 00:07:55.130
It's about 30,000 by--

00:07:55.130 --> 00:07:59.210
I think it was about 4,000 or
so pixels, so it's a very

00:07:59.210 --> 00:08:00.140
high-resolution image.

00:08:00.140 --> 00:08:03.100
It's a composite of quite
a few images.

00:08:03.100 --> 00:08:05.180
Like I said, they stitched
them together.

00:08:05.180 --> 00:08:08.840
And what we did is, to get it in
the Street View imagery, we

00:08:08.840 --> 00:08:12.450
actually expanded it
out horizontally--

00:08:12.450 --> 00:08:13.710
I'm sorry, vertically--

00:08:13.710 --> 00:08:16.240
to include some kind
of letter boxing.

00:08:16.240 --> 00:08:19.310
And that just allows us to put
it in a two-by-one format.

00:08:19.310 --> 00:08:21.010
And what I can do right now--
so I'm going to show you on

00:08:21.010 --> 00:08:23.200
the screen here--

00:08:23.200 --> 00:08:24.310
that's not the one I want.

00:08:24.310 --> 00:08:26.330
So this is what the original
image looks like.

00:08:26.330 --> 00:08:28.400
This is zoomed out pretty far.

00:08:28.400 --> 00:08:30.710
You've probably all seen this
if you've been following the

00:08:30.710 --> 00:08:32.470
Curiosity mission.

00:08:32.470 --> 00:08:34.169
And this is a very--
like I said, a very

00:08:34.169 --> 00:08:35.200
high-resolution image.

00:08:35.200 --> 00:08:36.600
It's about 30,000 pixels wide.

00:08:36.600 --> 00:08:41.309
So you can see, as we zoom in,
it actually maintains quality

00:08:41.309 --> 00:08:42.250
quite far in.

00:08:42.250 --> 00:08:46.660
You can actually see pretty
good detail on even these

00:08:46.660 --> 00:08:48.390
rocks that are in the
far distance.

00:08:48.390 --> 00:08:50.304
BRENDAN KENNY: You can see why
I started naming the rocks.

00:08:50.304 --> 00:08:51.110
PAUL SAXMAN: Ah, yeah.

00:08:51.110 --> 00:08:53.190
BRENDAN KENNY: Because this is
all you have to look at.

00:08:53.190 --> 00:08:55.250
PAUL SAXMAN: Yeah, we have names
for rocks, and we have

00:08:55.250 --> 00:08:56.540
names for the scorch marks.

00:08:56.540 --> 00:08:58.490
We've pretty much--

00:08:58.490 --> 00:09:00.640
I was looking, actually, for
names of some of the other--

00:09:00.640 --> 00:09:03.180
like the mountains in the
distance, and I didn't find

00:09:03.180 --> 00:09:05.700
any that were necessarily
correlated to this image yet.

00:09:05.700 --> 00:09:07.610
But if anybody has any--

00:09:07.610 --> 00:09:09.450
BRENDAN KENNY: Well, the
big one is Mount Sharp.

00:09:09.450 --> 00:09:09.990
PAUL SAXMAN: Yep.

00:09:09.990 --> 00:09:12.750
BRENDAN KENNY: And then there's
a much better name

00:09:12.750 --> 00:09:13.975
that's a Greek--

00:09:13.975 --> 00:09:15.820
something about wind, but I
don't remember what it is.

00:09:15.820 --> 00:09:16.710
PAUL SAXMAN: Oh, Gaelus?

00:09:16.710 --> 00:09:16.990
BRENDAN KENNY: Nah.

00:09:16.990 --> 00:09:18.380
It's the other one.

00:09:18.380 --> 00:09:19.210
PAUL SAXMAN: Oh, I gotcha.

00:09:19.210 --> 00:09:20.670
BRENDAN KENNY: Anyway.

00:09:20.670 --> 00:09:22.130
PAUL SAXMAN: So like I said,
what we do with this image,

00:09:22.130 --> 00:09:25.300
since this obviously is in a
two-to-one aspect ratio, it's

00:09:25.300 --> 00:09:28.040
actually quite a bit longer
than it is high.

00:09:28.040 --> 00:09:30.470
We actually padded it
out to make it a

00:09:30.470 --> 00:09:32.780
two-to-one aspect ratio.

00:09:32.780 --> 00:09:35.410
And this is what it
looks like here.

00:09:35.410 --> 00:09:37.740
The reason we did that is,
actually, it's a lot easier to

00:09:37.740 --> 00:09:41.990
manipulate in when we were doing
the tiling and actually

00:09:41.990 --> 00:09:44.950
setting things up for
the Street View.

00:09:44.950 --> 00:09:45.920
You don't have to.

00:09:45.920 --> 00:09:47.290
You can actually go.

00:09:47.290 --> 00:09:50.060
You could actually tile
up the original image.

00:09:50.060 --> 00:09:51.830
But you're just going to have
to be careful, because since

00:09:51.830 --> 00:09:56.250
it's not in an even aspect
ratio, you might end up with

00:09:56.250 --> 00:09:58.990
odd-sized tiles.

00:09:58.990 --> 00:10:01.510
Or the tiles might actually
overlap if you don't get the

00:10:01.510 --> 00:10:02.790
calculations right.

00:10:02.790 --> 00:10:06.270
Or you might not have enough
image to fill in the entire

00:10:06.270 --> 00:10:08.470
tile around the edges.

00:10:08.470 --> 00:10:09.870
So we padded it out.

00:10:09.870 --> 00:10:13.600
And it just so happens that
the 29,184 is the actual

00:10:13.600 --> 00:10:14.290
length of the image.

00:10:14.290 --> 00:10:19.180
It's very easily divisible by
16, so that ends up being

00:10:19.180 --> 00:10:22.180
about 1,824 or 2,000 pixels.

00:10:22.180 --> 00:10:23.550
So we took that.

00:10:23.550 --> 00:10:24.640
The reason we took 16--

00:10:24.640 --> 00:10:26.630
OK, well, let's take
a step back.

00:10:26.630 --> 00:10:29.460
And with the Street View,
the way it works is--

00:10:29.460 --> 00:10:32.900
let's just go to the image and
show you what it looks like.

00:10:32.900 --> 00:10:34.940
It's a lot easier.

00:10:34.940 --> 00:10:38.550
So here's, actually,
that same image,

00:10:38.550 --> 00:10:39.960
actually, in Street View.

00:10:39.960 --> 00:10:42.450
You see a couple markers here,
which we'll talk about in a

00:10:42.450 --> 00:10:43.500
little bit.

00:10:43.500 --> 00:10:45.780
But you can see, this is
actually just like Street View

00:10:45.780 --> 00:10:48.200
you'd see with--

00:10:48.200 --> 00:10:50.800
on the Google Maps product or
you can do with any other

00:10:50.800 --> 00:10:53.090
panoramic images.

00:10:53.090 --> 00:10:54.050
And what we did--

00:10:54.050 --> 00:10:56.850
so like I said, we put this in
Street View, and we tiled it

00:10:56.850 --> 00:10:59.850
up, so actually, it can maintain
the resolution of the

00:10:59.850 --> 00:11:02.750
image or the quality
of the image.

00:11:02.750 --> 00:11:08.760
So we couldn't just take the
30,000-pixel by 15,000-pixel

00:11:08.760 --> 00:11:11.910
two-to-one aspect ratio image
that we produced and drop it

00:11:11.910 --> 00:11:12.960
directly into Street View.

00:11:12.960 --> 00:11:14.160
We had to tile it up.

00:11:14.160 --> 00:11:17.120
And tiling is the same process
that you use for Maps.

00:11:17.120 --> 00:11:20.970
So as you zoom in, instead of
actually zooming in that

00:11:20.970 --> 00:11:24.360
entire image and scaling that
entire image, what it'll do is

00:11:24.360 --> 00:11:27.180
it'll just load what tiles
are relevant for the

00:11:27.180 --> 00:11:28.500
current view port.

00:11:28.500 --> 00:11:30.630
And you can see by
doing that--

00:11:30.630 --> 00:11:32.660
can't find the exact rock we
were looking at earlier, but

00:11:32.660 --> 00:11:33.975
we'll find another one.

00:11:33.975 --> 00:11:36.140
There's plenty of
rocks out there.

00:11:36.140 --> 00:11:39.120
As we zoom in, you can see
that we actually are

00:11:39.120 --> 00:11:42.540
maintaining pretty much the same
quality that we had with

00:11:42.540 --> 00:11:45.790
the original image.

00:11:45.790 --> 00:11:48.190
And that's just because we are
able to-- what we did is we

00:11:48.190 --> 00:11:50.690
tiled it up, and we made it a
little more efficient for the

00:11:50.690 --> 00:11:53.250
system to actually deal
with the images.

00:11:53.250 --> 00:11:55.634
BRENDAN KENNY: Can you scroll
down to the scorch mark?

00:11:55.634 --> 00:11:56.625
PAUL SAXMAN: The scorch mark?

00:11:56.625 --> 00:11:58.152
You want to see the--

00:11:58.152 --> 00:11:58.980
BRENDAN KENNY: It's
pretty cool.

00:11:58.980 --> 00:12:01.860
PAUL SAXMAN: I think these ones
definitely have names.

00:12:01.860 --> 00:12:03.026
I can't remember all of them.

00:12:03.026 --> 00:12:04.424
BRENDAN KENNY: Yeah, we should
have written those down.

00:12:04.424 --> 00:12:07.125
PAUL SAXMAN: I have a couple
of them, the names, as what

00:12:07.125 --> 00:12:10.370
the markers were earlier.

00:12:10.370 --> 00:12:13.530
So what I'll show you first
is the code that I used,

00:12:13.530 --> 00:12:17.360
actually, to do the tiling.

00:12:17.360 --> 00:12:20.110
So originally, I
tried to use--

00:12:20.110 --> 00:12:21.490
there's GDAL.

00:12:21.490 --> 00:12:24.450
It's actually a tool, an
open-source tool, for actually

00:12:24.450 --> 00:12:26.720
doing Maps tiles.

00:12:26.720 --> 00:12:29.060
And I ran into a little bit of
difficulty, actually, getting

00:12:29.060 --> 00:12:30.480
that running on a Mac.

00:12:30.480 --> 00:12:33.190
I put it on a Linux workstation
instead.

00:12:33.190 --> 00:12:34.430
I ran it there.

00:12:34.430 --> 00:12:36.410
Everything seemed to work fine,
but I had a little bit

00:12:36.410 --> 00:12:38.380
of trouble getting the
images looking right.

00:12:38.380 --> 00:12:41.450
So what I did is I just
defaulted back to Bash

00:12:41.450 --> 00:12:46.850
scripting and using ImageMagick
to do the tiling.

00:12:46.850 --> 00:12:50.260
So what I did for the
tiling is I'm taking

00:12:50.260 --> 00:12:51.050
the original image.

00:12:51.050 --> 00:12:55.000
So that's our full size, what
we call in the Maps, the

00:12:55.000 --> 00:12:56.590
Street View API, the World.

00:13:00.520 --> 00:13:02.050
So I'm cropping the
entire image, so

00:13:02.050 --> 00:13:03.940
that's our maximum zoom.

00:13:03.940 --> 00:13:07.110
And I'm doing that at 16-by-16
tiles, which ends up about

00:13:07.110 --> 00:13:12.730
2,000-by-900 pixels per tile at
2-to-1 aspect ratio tiles.

00:13:12.730 --> 00:13:16.880
So they're not square tiles.

00:13:16.880 --> 00:13:21.120
And then for the other zoom
level, so as you're zoomed out

00:13:21.120 --> 00:13:25.490
from the full zoom, I'm just
dividing by two each time.

00:13:25.490 --> 00:13:28.630
So the next resolution
is 8 by 8.

00:13:28.630 --> 00:13:29.600
And I didn't--

00:13:29.600 --> 00:13:32.600
actually, I did write
that down.

00:13:32.600 --> 00:13:35.770
8 by 8 is about 4,000-by-2,000
pixels.

00:13:35.770 --> 00:13:39.880
4 by 4 is about 2,000-by-1,000
pixels, and then 2 by 2,

00:13:39.880 --> 00:13:41.620
1,000-by-512.

00:13:41.620 --> 00:13:44.320
And actually, we'll do all the
way back to zero zoom, which

00:13:44.320 --> 00:13:46.210
is 512 by 256.

00:13:46.210 --> 00:13:49.310
So the first thing I'm doing
is I'm actually producing--

00:13:49.310 --> 00:13:52.360
taking that original image and
actually scaling it to all of

00:13:52.360 --> 00:13:59.320
those individual resolutions for
the different zoom levels

00:13:59.320 --> 00:14:02.720
and then tiling up those using
the constant tile size of

00:14:02.720 --> 00:14:05.410
1,824 by 912.

00:14:05.410 --> 00:14:08.760
So if I look at the code again--
so here, basically,

00:14:08.760 --> 00:14:13.490
I'm saying Taking File Input,
Identifying the--

00:14:13.490 --> 00:14:16.150
let me zoom that in a little
bit more so hopefully

00:14:16.150 --> 00:14:21.900
everybody can read it, getting
My Tools in Shape.

00:14:21.900 --> 00:14:25.880
I'll come back to this in a
minute, the MPC file format,

00:14:25.880 --> 00:14:27.910
which is something specific
to image management.

00:14:27.910 --> 00:14:30.560
Very useful, and I'll talk
about that in a minute.

00:14:30.560 --> 00:14:34.080
Here, I'm specifying
my zoom levels, the

00:14:34.080 --> 00:14:35.410
maximum number of tiles.

00:14:35.410 --> 00:14:36.830
That's for the full-size
image.

00:14:36.830 --> 00:14:39.450
I use that information
a little bit later.

00:14:39.450 --> 00:14:42.040
I'm getting the full-image
resolution out using the

00:14:42.040 --> 00:14:46.350
Identify command, which is
ImageMagick tool, and

00:14:46.350 --> 00:14:49.310
calculating the tile widths
and heights based on the

00:14:49.310 --> 00:14:52.620
full-size image and the
maximum zoom level.

00:14:52.620 --> 00:14:55.410
And then what I'm doing is I'm
just looping through the zoom

00:14:55.410 --> 00:14:56.630
levels that I want.

00:14:56.630 --> 00:14:59.940
So I'm going to go from zero
to four zoom levels.

00:14:59.940 --> 00:15:01.200
And there's a really interesting
thing to note

00:15:01.200 --> 00:15:03.010
about the zoom levels, that
the zoom levels don't

00:15:03.010 --> 00:15:08.150
necessarily correspond to the
controls on the Street View.

00:15:08.150 --> 00:15:11.610
So the Street View controls can
have zoom levels from--

00:15:11.610 --> 00:15:12.200
I don't know what it is.

00:15:12.200 --> 00:15:14.970
I think it's maybe about six
different zoom levels.

00:15:14.970 --> 00:15:18.450
But what the API does, it
actually optimizes.

00:15:18.450 --> 00:15:21.170
So if you have a really small
view port, it can actually use

00:15:21.170 --> 00:15:26.380
a higher zoom level
for the tiles.

00:15:26.380 --> 00:15:29.430
So it's a little
counterintuitive, but if you

00:15:29.430 --> 00:15:31.480
play around with this a little
bit, you'll eventually see

00:15:31.480 --> 00:15:33.910
what it's doing.

00:15:33.910 --> 00:15:35.720
So I'm going through each of
the different zoom levels.

00:15:35.720 --> 00:15:39.140
I'm calculating the width and
height for the image for that

00:15:39.140 --> 00:15:43.320
zoom level, the full-size image
for that zoom level, and

00:15:43.320 --> 00:15:45.290
I'm calculating the number of
tiles that I'm going to need

00:15:45.290 --> 00:15:46.360
for that zoom level.

00:15:46.360 --> 00:15:49.460
And since I do have 2-to-1 ratio
tiles and 2-to-1 ratio

00:15:49.460 --> 00:15:52.640
image, I can just use the same
number of tiles horizontally

00:15:52.640 --> 00:15:54.020
and vertically.

00:15:54.020 --> 00:15:55.820
And then I'm doing
a conversion.

00:15:55.820 --> 00:15:58.330
And what this conversion is
doing is taking that original

00:15:58.330 --> 00:16:02.500
TIFF image, which is really
uncompressed, rather large,

00:16:02.500 --> 00:16:07.120
and pretty hard to deal with
actually in terms of doing

00:16:07.120 --> 00:16:08.420
cropping and tiling.

00:16:08.420 --> 00:16:12.630
I'm converting it to the scaled
image but using the MPC

00:16:12.630 --> 00:16:14.240
format for ImageMagick.

00:16:14.240 --> 00:16:16.625
And like I said, that MPC
format, what it does is it

00:16:16.625 --> 00:16:19.190
allows you to--

00:16:19.190 --> 00:16:21.970
it's an optimized format for
ImageMagick so that they can

00:16:21.970 --> 00:16:25.700
actually index pixels as opposed
to actually having to

00:16:25.700 --> 00:16:28.470
uncompress the original TIFF
and work back from there.

00:16:28.470 --> 00:16:32.770
So it makes the actual
conversion a lot quicker.

00:16:32.770 --> 00:16:33.770
Before I was using MPC--

00:16:33.770 --> 00:16:36.650
I didn't know about
it originally--

00:16:36.650 --> 00:16:38.880
the conversion was taking-- or
actually, doing all the tiling

00:16:38.880 --> 00:16:42.530
for zero-to-four zoom levels, it
was taking maybe about half

00:16:42.530 --> 00:16:44.710
an hour or more.

00:16:44.710 --> 00:16:45.960
Or actually, I think
it was even longer.

00:16:45.960 --> 00:16:46.660
I think we went to lunch.

00:16:46.660 --> 00:16:48.610
It was maybe more
than an hour.

00:16:48.610 --> 00:16:51.190
With the MPC format doing the
four zoom levels, it's pretty

00:16:51.190 --> 00:16:53.160
straightforward.

00:16:53.160 --> 00:16:55.960
And then I'm actually doing
the tiling, so I'm going

00:16:55.960 --> 00:16:57.530
vertically, horizontally.

00:16:57.530 --> 00:17:02.230
And I'm just sampling out or
cropping out different tiles

00:17:02.230 --> 00:17:04.730
and saving those to files.

00:17:04.730 --> 00:17:09.599
In the HTML code--

00:17:09.599 --> 00:17:11.310
I'm going to switch over
to here real quick--

00:17:11.310 --> 00:17:14.300
this is actually going to look a
lot like some of the samples

00:17:14.300 --> 00:17:15.490
we have for Street View.

00:17:15.490 --> 00:17:17.920
I've pretty much just
picked those out.

00:17:17.920 --> 00:17:23.880
The big differences here is
what you do is you specify

00:17:23.880 --> 00:17:26.265
Custom Tile URLs.

00:17:26.265 --> 00:17:29.140
And this is actually something
that you specify when you set

00:17:29.140 --> 00:17:31.550
up the Street View options.

00:17:31.550 --> 00:17:33.060
I think it's way up here.

00:17:33.060 --> 00:17:33.950
No, I'm sorry.

00:17:33.950 --> 00:17:37.730
So when you set up the panorama
options, you specify

00:17:37.730 --> 00:17:40.630
the Panorama Provider.

00:17:40.630 --> 00:17:47.160
And the Panorama Provider
actually includes the method

00:17:47.160 --> 00:17:48.950
for getting the custom
tiles out.

00:17:48.950 --> 00:17:51.860
So you can have multiple tiles
or multiple panoramas in one

00:17:51.860 --> 00:17:56.910
display, and the same
code can be reused.

00:17:56.910 --> 00:18:00.260
And what I did here is I'm just
saying that I want to use

00:18:00.260 --> 00:18:04.230
tile with a particular zoom
level, the Tile X and Tile Y.

00:18:04.230 --> 00:18:05.730
If we go down here, this--

00:18:05.730 --> 00:18:08.480
I didn't find this
superintuitive at first, but

00:18:08.480 --> 00:18:11.050
the World Size is actually
Original Image Size or the

00:18:11.050 --> 00:18:13.690
full-size image, and
then you have to

00:18:13.690 --> 00:18:15.130
specify your tile size.

00:18:15.130 --> 00:18:19.420
And this is how the Street View
API actually optimizes,

00:18:19.420 --> 00:18:21.400
so pretty straightforward.

00:18:21.400 --> 00:18:24.002
The other stuff that I
can show up here--

00:18:24.002 --> 00:18:25.760
BRENDAN KENNY: It did show
us your markers.

00:18:25.760 --> 00:18:26.500
PAUL SAXMAN: Yep.

00:18:26.500 --> 00:18:30.890
So let me-- we'll go back to the
actual Street View that I

00:18:30.890 --> 00:18:31.830
showed you before.

00:18:31.830 --> 00:18:35.250
So these are kind of fun, and
this is stuff that I was

00:18:35.250 --> 00:18:37.530
working on pretty
much yesterday.

00:18:37.530 --> 00:18:39.780
But since this is Street View,
some of the advanced features

00:18:39.780 --> 00:18:45.500
that you can add over just a
standard image viewing tool is

00:18:45.500 --> 00:18:47.370
that we can add markers
on the display.

00:18:47.370 --> 00:18:50.590
And these markers, they look
really small, and I'll talk

00:18:50.590 --> 00:18:53.990
about why that is in a second.

00:18:53.990 --> 00:18:56.060
But you can add markers
to the display.

00:18:56.060 --> 00:19:01.640
You can add info windows, and I
think you can also do custom

00:19:01.640 --> 00:19:05.670
overlays or overlays on
top of this as well.

00:19:05.670 --> 00:19:07.540
I think we showed a couple weeks
ago, Brendan, you had

00:19:07.540 --> 00:19:09.520
that overlay view with the

00:19:09.520 --> 00:19:10.940
three-dimensional stuff in there.

00:19:10.940 --> 00:19:11.560
BRENDAN KENNY: Oh, yeah.

00:19:11.560 --> 00:19:14.390
Yeah, well, that's a very
custom overlay.

00:19:14.390 --> 00:19:16.980
But it's nice, because if you
have your map content--

00:19:16.980 --> 00:19:19.450
I mean, if you've ever used the
streaming API before, and

00:19:19.450 --> 00:19:21.280
then you switch to the
Street View, the

00:19:21.280 --> 00:19:23.580
same content is there.

00:19:23.580 --> 00:19:26.510
We just don't have an overhead
view of Mars.

00:19:26.510 --> 00:19:27.890
I guess we could've made one.

00:19:27.890 --> 00:19:28.990
PAUL SAXMAN: Oh, right.

00:19:28.990 --> 00:19:31.080
BRENDAN KENNY: What is Burn--
do you know what Burnside

00:19:31.080 --> 00:19:32.488
Scour is named for?

00:19:32.488 --> 00:19:35.850
PAUL SAXMAN: Oh, that's
a good question.

00:19:35.850 --> 00:19:37.050
BRENDAN KENNY: I'm going
to look that up.

00:19:37.050 --> 00:19:38.280
PAUL SAXMAN: I'm going to assume
it's somebody's name,

00:19:38.280 --> 00:19:43.050
because this one, I think, is
called-- the one on the right

00:19:43.050 --> 00:19:44.976
is called--

00:19:44.976 --> 00:19:46.910
I feel like I should
know this--

00:19:46.910 --> 00:19:48.480
Goulburn Scour.

00:19:48.480 --> 00:19:49.970
And actually, there's
two other scours

00:19:49.970 --> 00:19:50.780
on the other side.

00:19:50.780 --> 00:19:52.000
BRENDAN KENNY: Are they
both named burn?

00:19:52.000 --> 00:19:52.440
Is that--

00:19:52.440 --> 00:19:52.845
PAUL SAXMAN: No, no.

00:19:52.845 --> 00:19:54.225
BRENDAN KENNY: --like a
joke, do you think?

00:19:54.225 --> 00:19:55.205
Because it's like a rocket?

00:19:55.205 --> 00:19:58.060
Never mind.

00:19:58.060 --> 00:19:59.670
PAUL SAXMAN: So another thing
that's kind of fun with these

00:19:59.670 --> 00:20:02.730
markers, these are just map
markers, so you can do things.

00:20:02.730 --> 00:20:03.605
I mean, they can be animated.

00:20:03.605 --> 00:20:05.390
I didn't animate them, because
the animation is a little

00:20:05.390 --> 00:20:07.640
funny here, because
they are actually

00:20:07.640 --> 00:20:08.650
zoomed pretty far out.

00:20:08.650 --> 00:20:11.330
But you can actually make
them draggable.

00:20:11.330 --> 00:20:14.330
And this is why they're actually
pretty small, because

00:20:14.330 --> 00:20:17.770
they're pretty far out, or
the scour is actually

00:20:17.770 --> 00:20:19.290
relatively far out.

00:20:19.290 --> 00:20:20.995
So these markers, you could
make them draggable.

00:20:20.995 --> 00:20:22.120
You can move them around.

00:20:22.120 --> 00:20:25.300
And this is actually how I
identified the latitude and

00:20:25.300 --> 00:20:27.480
longitude, where
to mark these.

00:20:27.480 --> 00:20:28.520
Because the latitude--

00:20:28.520 --> 00:20:30.280
I have the latitude and
longitude for actually where

00:20:30.280 --> 00:20:32.190
the lander landed, but I didn't
have the latitude and

00:20:32.190 --> 00:20:34.520
longitude for the scours.

00:20:34.520 --> 00:20:37.610
Data's probably out there
somewhere, but--

00:20:37.610 --> 00:20:38.050
so yeah.

00:20:38.050 --> 00:20:39.310
So you can put the
markers on here.

00:20:39.310 --> 00:20:42.830
And so the other thing that we
can do in the future with this

00:20:42.830 --> 00:20:45.870
is as we do get more imagery,
we can actually

00:20:45.870 --> 00:20:48.400
do the Street View--

00:20:48.400 --> 00:20:49.820
what do you call that
when you're moving

00:20:49.820 --> 00:20:51.560
from panorama to panorama?

00:20:51.560 --> 00:20:53.290
So if we have multiple
panoramas, we can actually

00:20:53.290 --> 00:20:55.720
say, well, this is the
route to the rover.

00:20:55.720 --> 00:20:57.360
You can follow the route, and
every time it takes a

00:20:57.360 --> 00:21:00.892
panorama, we can put that
in here as well.

00:21:00.892 --> 00:21:02.270
I don't know if we'll--

00:21:02.270 --> 00:21:04.580
BRENDAN KENNY: I really want
to do that, so yeah.

00:21:04.580 --> 00:21:08.230
I might not one day when there's
thousands of them I

00:21:08.230 --> 00:21:08.870
might not do it.

00:21:08.870 --> 00:21:12.300
But I want to do it
at least once.

00:21:12.300 --> 00:21:12.660
PAUL SAXMAN: Yeah.

00:21:12.660 --> 00:21:13.120
BRENDAN KENNY: Or a few times.

00:21:13.120 --> 00:21:14.450
PAUL SAXMAN: I think it
would be a lot of fun.

00:21:14.450 --> 00:21:15.130
BRENDAN KENNY: I'm not
sure when it's

00:21:15.130 --> 00:21:16.800
supposed to start rolling.

00:21:16.800 --> 00:21:20.900
I think it's actually started
moving a little bit, but it's

00:21:20.900 --> 00:21:24.350
mostly just moving in place
while they figure out all the

00:21:24.350 --> 00:21:28.080
wheels and the motor
situation.

00:21:28.080 --> 00:21:29.200
PAUL SAXMAN: Yeah.

00:21:29.200 --> 00:21:32.300
And I did just see there is, I
think, another black-and-white

00:21:32.300 --> 00:21:34.250
panorama that came out
very recently.

00:21:34.250 --> 00:21:36.730
So the panoramas are going
to keep coming.

00:21:36.730 --> 00:21:38.830
Oh, they also have
the deck imagery.

00:21:38.830 --> 00:21:40.880
You could stitch together
quite a bit more.

00:21:40.880 --> 00:21:43.340
With the deck imagery,
I think that's how--

00:21:43.340 --> 00:21:46.760
I was mentioning before that
somebody actually did a

00:21:46.760 --> 00:21:49.560
full-view panorama.

00:21:49.560 --> 00:21:53.470
And what they did is they
actually simulated the sky, so

00:21:53.470 --> 00:21:55.520
they did simulated sky
up on the top.

00:21:55.520 --> 00:21:58.140
And then I think they also took
the deck imagery, and

00:21:58.140 --> 00:22:01.015
they put the deck imagery
along the bottom.

00:22:01.015 --> 00:22:01.520
BRENDAN KENNY: Oh, right.

00:22:01.520 --> 00:22:04.390
Yeah, I found that
a little strange.

00:22:04.390 --> 00:22:04.810
PAUL SAXMAN: Yeah.

00:22:04.810 --> 00:22:05.430
I mean, it was--

00:22:05.430 --> 00:22:06.520
BRENDAN KENNY: Well, there was
just a lot of simulated

00:22:06.520 --> 00:22:08.170
imagery, and it was-- nah.

00:22:08.170 --> 00:22:08.610
PAUL SAXMAN: Yeah.

00:22:08.610 --> 00:22:11.610
I mean, I think from a artistic
standpoint, I think

00:22:11.610 --> 00:22:13.260
it was a really, really
great thing.

00:22:13.260 --> 00:22:15.170
And I mean, it is kind
of an immersive--

00:22:15.170 --> 00:22:15.810
BRENDAN KENNY: Sure.

00:22:15.810 --> 00:22:17.500
PAUL SAXMAN: Immersive feel.

00:22:17.500 --> 00:22:21.990
So one thing that I found and
I've been toying around with a

00:22:21.990 --> 00:22:25.520
lot with the Street View API is
that the bigger this window

00:22:25.520 --> 00:22:28.490
gets, the performance actually
degrades somewhat.

00:22:28.490 --> 00:22:32.320
So that's one thing you really
want to keep aware of.

00:22:32.320 --> 00:22:35.460
And what I actually tried
is multiple--

00:22:35.460 --> 00:22:37.460
tried to use multiple different
tile sizes.

00:22:37.460 --> 00:22:39.350
I tried to make the tiles really
small or actually blow

00:22:39.350 --> 00:22:41.300
them up quite large.

00:22:41.300 --> 00:22:44.400
The performance hit was
always there as I made

00:22:44.400 --> 00:22:46.160
the View Port larger.

00:22:46.160 --> 00:22:50.550
So good View Port size I found
about 1,024 by 768.

00:22:50.550 --> 00:22:53.810
This one, I think, might
be about 800 by 600.

00:22:53.810 --> 00:22:55.990
BRENDAN KENNY: And it varies
somewhat by platform.

00:22:55.990 --> 00:22:56.706
PAUL SAXMAN: Yeah, that, too.

00:22:56.706 --> 00:22:58.850
BRENDAN KENNY: Because some
browsers have accelerated

00:22:58.850 --> 00:23:04.600
canvas, and so you get
super-smooth performance.

00:23:04.600 --> 00:23:08.820
And then some browsers rely on
the what's called HTML4 mode,

00:23:08.820 --> 00:23:10.770
where it's just displaying
the tiles directly.

00:23:10.770 --> 00:23:13.950
And so it might be a
little bit slower.

00:23:13.950 --> 00:23:19.350
And until all the browsers
catch up to more modern

00:23:19.350 --> 00:23:23.070
techniques of drawing things,
then we're going to have that

00:23:23.070 --> 00:23:24.680
kind of spread in performance.

00:23:24.680 --> 00:23:26.540
But it is nice.

00:23:26.540 --> 00:23:30.060
And I think the thing I want to
most emphasize with this is

00:23:30.060 --> 00:23:33.660
how easy it is to do a
Custom Street View.

00:23:33.660 --> 00:23:38.060
I think with going into it and
making a bunch of tiles, it

00:23:38.060 --> 00:23:39.780
does become a little
bit harder, a

00:23:39.780 --> 00:23:40.560
little bit more work.

00:23:40.560 --> 00:23:42.780
But it's actually not
very much work.

00:23:42.780 --> 00:23:45.930
And it's a skill, especially if
you want to get into more

00:23:45.930 --> 00:23:47.480
complicated mapping
applications.

00:23:47.480 --> 00:23:50.890
Like being able to make tiles at
the drop of a hat is a very

00:23:50.890 --> 00:23:51.560
important skill.

00:23:51.560 --> 00:23:54.190
And so it's a valuable
thing to invest your

00:23:54.190 --> 00:23:56.150
time in and to learn.

00:23:56.150 --> 00:23:58.650
But once you have those
tiles, it's really--

00:23:58.650 --> 00:23:59.340
it's dead simple.

00:23:59.340 --> 00:24:00.350
The API is very simple.

00:24:00.350 --> 00:24:02.200
Actually, I think it's one
of the more elegant

00:24:02.200 --> 00:24:05.610
parts of our API.

00:24:05.610 --> 00:24:08.760
And at that point, you can have
all the custom panoramas

00:24:08.760 --> 00:24:09.800
you can think of.

00:24:09.800 --> 00:24:10.180
PAUL SAXMAN: Yeah.

00:24:10.180 --> 00:24:11.240
So we'll post--

00:24:11.240 --> 00:24:12.780
a lot of the code that I got--

00:24:12.780 --> 00:24:16.940
the Bash script that I put
together was actually pulled

00:24:16.940 --> 00:24:19.750
together from some sources
on Stack Overflow.

00:24:19.750 --> 00:24:22.610
The trick with using the MPC
files actually was a trick I

00:24:22.610 --> 00:24:24.040
found on Stack Overflow.

00:24:24.040 --> 00:24:26.420
We'll either post the code out
on Stack Overflow or maybe in

00:24:26.420 --> 00:24:29.850
the Google+ following up
so that you guys can

00:24:29.850 --> 00:24:32.290
take a look at it.

00:24:32.290 --> 00:24:33.540
So what--

00:24:33.540 --> 00:24:35.250
BRENDAN KENNY: I don't know if
I'd be brave enough to post

00:24:35.250 --> 00:24:37.580
one of my Bash scripts.

00:24:37.580 --> 00:24:37.740
PAUL SAXMAN: Yeah.

00:24:37.740 --> 00:24:42.930
Bash is kind of an art form when
you're doing more complex

00:24:42.930 --> 00:24:46.210
scripting, I think, but
entirely useful.

00:24:46.210 --> 00:24:47.750
So I'm passing the
laptop over.

00:24:47.750 --> 00:24:49.620
So in the next few minutes,
we're going to--

00:24:49.620 --> 00:24:51.600
Brendan's going to switch over
and show some of the elevation

00:24:51.600 --> 00:24:57.040
work that he's been doing,
which is actually pretty

00:24:57.040 --> 00:24:58.545
amazing stuff as well.

00:24:58.545 --> 00:24:59.795
BRENDAN KENNY: See if we can--

00:25:01.910 --> 00:25:03.160
there we go.

00:25:05.390 --> 00:25:08.860
So the data I'm using comes from
the Mars Reconnaissance

00:25:08.860 --> 00:25:10.280
Orbiter, as I said earlier.

00:25:10.280 --> 00:25:13.950
And so it's been circling Mars
for several years now.

00:25:13.950 --> 00:25:16.860
And one of the most
helpful ways--

00:25:16.860 --> 00:25:18.720
or one of the most important
things it's doing is actually

00:25:18.720 --> 00:25:24.250
relaying information from
Curiosity to Earth.

00:25:24.250 --> 00:25:26.620
But it also has some really nice
cameras, and one of them

00:25:26.620 --> 00:25:28.920
is the high-rise camera.

00:25:28.920 --> 00:25:31.710
And-- oh, this is
reverse scroll.

00:25:31.710 --> 00:25:33.880
And let's see.

00:25:33.880 --> 00:25:35.760
I'll just pick one randomly.

00:25:35.760 --> 00:25:38.250
And so it has super-high
resolution.

00:25:38.250 --> 00:25:41.200
It flies fairly low over Mars,
and it has an extremely high

00:25:41.200 --> 00:25:42.450
resolution--

00:25:44.580 --> 00:25:46.170
I don't know-- capturing
apparatus.

00:25:46.170 --> 00:25:49.190
I think it's actually--
technically, it's a telescope.

00:25:49.190 --> 00:25:54.540
And so what it does is it's
called stereophotogrammetry,

00:25:54.540 --> 00:25:56.530
which is the same technique
that people use from

00:25:56.530 --> 00:26:01.600
everything from our new 3D
helicopter view in Earth on

00:26:01.600 --> 00:26:05.775
mobile to things where you take
multiple pictures, and

00:26:05.775 --> 00:26:09.830
you can extract a point cloud
and a 3D model out of that.

00:26:09.830 --> 00:26:12.240
And basically, what you do is
you use information about

00:26:12.240 --> 00:26:16.940
where the camera was from
multiple viewpoints, identify

00:26:16.940 --> 00:26:19.160
objects that are the same in
each, and then basically

00:26:19.160 --> 00:26:21.800
triangulate from each of those
photos to figure out where

00:26:21.800 --> 00:26:22.850
things are in 3D space.

00:26:22.850 --> 00:26:26.570
It's the same thing our eyes
do with binocular vision.

00:26:26.570 --> 00:26:30.310
So the satellite does that by
actually taking multiple

00:26:30.310 --> 00:26:31.330
passes over Mars.

00:26:31.330 --> 00:26:34.650
So it goes over once, and then
a few days later, or a month

00:26:34.650 --> 00:26:37.170
later, or something, it goes
over the same area from a

00:26:37.170 --> 00:26:38.030
slightly different angle.

00:26:38.030 --> 00:26:39.620
And from that, they
can extract pretty

00:26:39.620 --> 00:26:42.990
high-resolution, as I said, I
think down to 24 centimeters

00:26:42.990 --> 00:26:46.540
per pixel elevation maps.

00:26:46.540 --> 00:26:48.970
And unfortunately, they just
took one, I think, about three

00:26:48.970 --> 00:26:52.270
or four days ago of the
Curiosity area.

00:26:52.270 --> 00:26:52.840
You might have seen it.

00:26:52.840 --> 00:26:56.960
It had exaggerated color with
blue instead of gray.

00:26:56.960 --> 00:26:59.680
And so in two more days, they're
going to take another

00:26:59.680 --> 00:27:00.710
pass and have a really

00:27:00.710 --> 00:27:02.710
high-resolution view of the area.

00:27:02.710 --> 00:27:05.220
But we don't have that, so I
just picked a random area.

00:27:07.810 --> 00:27:09.540
And you can see the format
they have here.

00:27:09.540 --> 00:27:11.740
Here's a version that
turns the-- nope,

00:27:11.740 --> 00:27:12.890
that's not what I want.

00:27:12.890 --> 00:27:14.140
Color altimetry.

00:27:16.120 --> 00:27:18.540
Here's a version that turns
that altitude into color.

00:27:18.540 --> 00:27:22.010
So part of the problem
is that usually the

00:27:22.010 --> 00:27:24.550
elevation data is--

00:27:24.550 --> 00:27:27.240
it needs more precision than the
8 bits per pixel that you

00:27:27.240 --> 00:27:30.750
usually have in a grayscale
picture.

00:27:30.750 --> 00:27:31.845
So here you can tell--

00:27:31.845 --> 00:27:33.960
we have a scale down
here at the bottom.

00:27:33.960 --> 00:27:37.510
This varies over almost
1 and 1/2 kilometers.

00:27:37.510 --> 00:27:43.080
And so you only have 256 levels
in a byte, and so you

00:27:43.080 --> 00:27:43.820
actually need more than that.

00:27:43.820 --> 00:27:46.740
And so sometimes it's
16 bits or whatever.

00:27:46.740 --> 00:27:48.810
And so this is one way
of displaying it.

00:27:48.810 --> 00:27:51.370
They just map it to a color
ramp, and you can see down

00:27:51.370 --> 00:27:54.430
here is the really low areas
and the high areas.

00:27:54.430 --> 00:27:56.770
And there's a bunch of formats
that they provide.

00:27:56.770 --> 00:27:58.860
It's extremely helpful.

00:27:58.860 --> 00:28:02.550
And if you look into it, it's
called a PDS format, which I'd

00:28:02.550 --> 00:28:05.020
never heard of, and
it seemed obscure.

00:28:05.020 --> 00:28:07.320
And I couldn't find much on it,
and Google was trying to

00:28:07.320 --> 00:28:09.720
convince me that I was
looking for a PSD.

00:28:09.720 --> 00:28:11.750
But it turns out it's extremely
common in the GIS

00:28:11.750 --> 00:28:13.480
world, and so what do I know.

00:28:13.480 --> 00:28:14.920
And so GDAL supports it.

00:28:14.920 --> 00:28:18.350
And so you can use
gdal_translate to translate

00:28:18.350 --> 00:28:23.160
from the PDS or ING format
over to basically

00:28:23.160 --> 00:28:23.940
anything you want.

00:28:23.940 --> 00:28:27.175
And so it's a little bit tricky,
because WebGL right

00:28:27.175 --> 00:28:29.580
now only supports
8-bit-per-channel images.

00:28:29.580 --> 00:28:32.820
And so, really, what you want
to do is maybe pack into

00:28:32.820 --> 00:28:34.920
different color channels.

00:28:34.920 --> 00:28:39.630
But for now we can just go
with a lower-res 8-bit

00:28:39.630 --> 00:28:45.010
grayscale image and
deal with that.

00:28:45.010 --> 00:28:48.840
So what's the best
way to show this?

00:28:48.840 --> 00:28:52.310
So first you translate it into
a grayscale, and it looks a

00:28:52.310 --> 00:28:55.630
lot like this.

00:28:55.630 --> 00:28:59.590
And then we use what's
called--

00:28:59.590 --> 00:29:01.420
well, the simplest way is to
use something that's like

00:29:01.420 --> 00:29:05.110
finite differencing, which is a
way of measuring the rate of

00:29:05.110 --> 00:29:07.480
change over pixels.

00:29:07.480 --> 00:29:09.560
And it sounds really fancy,
and lots of people try and

00:29:09.560 --> 00:29:10.790
trick you and think
that it's fancy.

00:29:10.790 --> 00:29:11.430
But it's not really.

00:29:11.430 --> 00:29:14.310
It's just subtraction.

00:29:14.310 --> 00:29:17.550
It's very common, like, oh,
yeah, I got my whatever degree

00:29:17.550 --> 00:29:22.020
in finite differencing models
and modeling airflow over cars

00:29:22.020 --> 00:29:22.690
or something like that.

00:29:22.690 --> 00:29:24.870
It's just subtraction where
you're looking at the

00:29:24.870 --> 00:29:27.990
difference between two discrete
samples, like pixels,

00:29:27.990 --> 00:29:30.800
and looking at the angle as
it changes between them.

00:29:30.800 --> 00:29:35.250
And that's all a change in
elevation is, is the change in

00:29:35.250 --> 00:29:36.650
heights of this thing.

00:29:36.650 --> 00:29:38.780
And from that you can
figure out the

00:29:38.780 --> 00:29:39.840
direction of a surface.

00:29:39.840 --> 00:29:41.220
So now we have a surface
like this.

00:29:41.220 --> 00:29:43.530
And so then if we have a light
ray coming in this way, and

00:29:43.530 --> 00:29:46.160
the direction of the surface
is that way, that surface

00:29:46.160 --> 00:29:47.010
might be kind of dark.

00:29:47.010 --> 00:29:48.320
But if it's coming in
directly at the

00:29:48.320 --> 00:29:49.900
surface, it might be lighter.

00:29:49.900 --> 00:29:51.760
And that's pretty
much how we--

00:29:51.760 --> 00:29:56.550
that's the 30-second "cause
already over time" display.

00:29:56.550 --> 00:29:58.360
So there are fancier
things you can do.

00:29:58.360 --> 00:30:02.017
So one of the problems is that
just like with Maps, you have

00:30:02.017 --> 00:30:04.100
to pull in a tile for
every one of these--

00:30:07.100 --> 00:30:10.770
I don't know, a tile for
every unit of area.

00:30:10.770 --> 00:30:13.230
And if you want to pull in more
data, you have to fit

00:30:13.230 --> 00:30:15.340
into that RGBA channels.

00:30:15.340 --> 00:30:17.050
And if you want to get in even
more data, you're going to

00:30:17.050 --> 00:30:18.560
pull in another tile,
and every tile's

00:30:18.560 --> 00:30:19.770
going to slow you down.

00:30:19.770 --> 00:30:23.550
So you start figuring out ways
to pack in information into

00:30:23.550 --> 00:30:24.620
these tiles.

00:30:24.620 --> 00:30:26.470
And fortunately, game developers
are way ahead of

00:30:26.470 --> 00:30:29.100
us, because they've been dealing
with small CDs, and

00:30:29.100 --> 00:30:32.570
then DVDs, and downloadable
games for years now.

00:30:32.570 --> 00:30:33.850
And so they have lots
of tricky ways.

00:30:33.850 --> 00:30:38.350
And one of the ways I use is to
pack that surface normal,

00:30:38.350 --> 00:30:42.182
which is really a 3D vector,
into two components.

00:30:42.182 --> 00:30:46.090
And so you just have the R and
G channels used for that, and

00:30:46.090 --> 00:30:47.630
then you still have your blue
and your alpha for whatever

00:30:47.630 --> 00:30:51.370
you want, like you can bring
in other fancy data.

00:30:51.370 --> 00:30:53.925
And it's not that interesting.

00:30:53.925 --> 00:30:58.820
It's pretty much the observation
that a sphere is a

00:30:58.820 --> 00:31:01.680
surface in 3D, but it's also
we can describe it with two

00:31:01.680 --> 00:31:03.860
dimensions, like latitude
and longitude.

00:31:03.860 --> 00:31:06.320
And latitude and longitude are
inefficient, because you waste

00:31:06.320 --> 00:31:08.140
a lot of precision
at the poles.

00:31:08.140 --> 00:31:11.480
So you can actually spread it
back out, and it basically

00:31:11.480 --> 00:31:15.420
ends up being a reflection in
a parabolic dish, which is

00:31:15.420 --> 00:31:15.960
kind of fun.

00:31:15.960 --> 00:31:21.760
So if we go over here to the
demo itself, it's less

00:31:21.760 --> 00:31:23.700
exciting after all
that buildup.

00:31:23.700 --> 00:31:25.300
But here is an area--

00:31:25.300 --> 00:31:28.740
and I only extracted like two
zoom levels, and it's somewhat

00:31:28.740 --> 00:31:29.830
low resolution, as I said.

00:31:29.830 --> 00:31:34.100
But here we have some really
cool sand dunes on Mars, and

00:31:34.100 --> 00:31:36.450
it goes into some
rocks over here.

00:31:36.450 --> 00:31:37.660
And I think-- oh, wait.

00:31:37.660 --> 00:31:39.620
No, only two zoom levels.

00:31:39.620 --> 00:31:42.120
Wait.

00:31:42.120 --> 00:31:44.580
There we go.

00:31:44.580 --> 00:31:49.150
You can see pretty
much that's--

00:31:49.150 --> 00:31:50.770
and then there we have it.

00:31:50.770 --> 00:31:52.190
PAUL SAXMAN: So you actually
did the lighting?

00:31:52.190 --> 00:31:52.990
I mean, you took the--

00:31:52.990 --> 00:31:53.310
BRENDAN KENNY: Yes.

00:31:53.310 --> 00:31:54.470
So the lighting is in here.

00:31:54.470 --> 00:31:59.410
Unfortunately, to enable
it-- we're out of time.

00:31:59.410 --> 00:32:00.380
PAUL SAXMAN: Oh, no worries.

00:32:00.380 --> 00:32:04.450
Yeah, so the idea is really that
with the elevation data,

00:32:04.450 --> 00:32:05.410
you can actually--

00:32:05.410 --> 00:32:07.370
BRENDAN KENNY: Yeah, you can
light it in real time.

00:32:07.370 --> 00:32:11.810
And actually, a really cool idea
would've been the heat

00:32:11.810 --> 00:32:13.740
shield landing and
being like--

00:32:13.740 --> 00:32:15.090
we're going to do that.

00:32:15.090 --> 00:32:17.040
Maybe we'll do that
this afternoon.

00:32:17.040 --> 00:32:19.310
But I guess it didn't explode.

00:32:19.310 --> 00:32:23.770
But we can imagine it's like a
Michael Bay universe that--

00:32:23.770 --> 00:32:24.820
well, I can imagine.

00:32:24.820 --> 00:32:27.400
PAUL SAXMAN: What we're looking
at here, though, is so

00:32:27.400 --> 00:32:31.270
you took the elevation data that
was in the RGB channels,

00:32:31.270 --> 00:32:33.820
and then you actually did-- so
where did you actually plot

00:32:33.820 --> 00:32:34.700
the lighting in this one?

00:32:34.700 --> 00:32:37.370
BRENDAN KENNY: So if we look--

00:32:37.370 --> 00:32:38.880
I don't know if we
really want to--

00:32:48.070 --> 00:32:52.610
here's the actual shaders
that I'm using.

00:32:52.610 --> 00:32:53.900
So if you're familiar
with WebGL, this

00:32:53.900 --> 00:32:55.360
shouldn't be a big deal.

00:32:55.360 --> 00:32:57.110
If you're not, it's
not a big deal.

00:32:57.110 --> 00:32:59.290
It's just a different language
that's ideally

00:32:59.290 --> 00:33:02.985
suited for this stuff.

00:33:02.985 --> 00:33:04.235
It won't let me scroll.

00:33:08.690 --> 00:33:10.580
It still won't let me scroll.

00:33:10.580 --> 00:33:13.170
PAUL SAXMAN: So you took those
images You loaded them in

00:33:13.170 --> 00:33:14.310
there, and now you're--

00:33:14.310 --> 00:33:14.550
BRENDAN KENNY: Yeah.

00:33:14.550 --> 00:33:15.620
So let's see.

00:33:15.620 --> 00:33:18.830
So here's where I get the
normal, which is just the

00:33:18.830 --> 00:33:20.500
surface direction.

00:33:20.500 --> 00:33:22.040
And so the actual--

00:33:22.040 --> 00:33:25.200
well, the lighting is a little
complicated, because I do some

00:33:25.200 --> 00:33:25.830
fancy lighting.

00:33:25.830 --> 00:33:29.410
But it's pretty much this,
where we take a light

00:33:29.410 --> 00:33:32.050
direction, and this comes in
from the mouse direction,

00:33:32.050 --> 00:33:35.850
which is what I would enable
if we had a moment.

00:33:35.850 --> 00:33:39.310
But in the end, I just take
the light direction, and I

00:33:39.310 --> 00:33:41.570
take the normal, and I
dot-product them together,

00:33:41.570 --> 00:33:43.470
which gives me the angle
between them.

00:33:43.470 --> 00:33:46.550
And then I attenuate
that by the view.

00:33:46.550 --> 00:33:51.420
So if you get this angle,
that would be specular.

00:33:51.420 --> 00:33:53.520
But it's pointing away from
you, you'd get less light.

00:33:57.450 --> 00:34:00.580
So you can do quite complicated
things in here.

00:34:00.580 --> 00:34:03.720
It's just up to you
to imagine them.

00:34:03.720 --> 00:34:06.730
And I think it'd be great
to eventually show--

00:34:06.730 --> 00:34:09.250
there's no reason why you have
to limit yourself to imagery.

00:34:09.250 --> 00:34:12.780
You can start looking at turning
this into geometry and

00:34:12.780 --> 00:34:14.449
doing some interesting things.

00:34:14.449 --> 00:34:15.679
PAUL SAXMAN: So this is
being lit, though.

00:34:15.679 --> 00:34:18.770
I mean, the lighting, we can't
do it dynamically.

00:34:18.770 --> 00:34:19.870
You can't move the
mouse around to

00:34:19.870 --> 00:34:20.710
actual show the lighting.

00:34:20.710 --> 00:34:23.120
But this is actually lighting
the tiles--

00:34:23.120 --> 00:34:24.025
BRENDAN KENNY: Yes, it is.

00:34:24.025 --> 00:34:25.020
PAUL SAXMAN: --as it's
being loaded in.

00:34:25.020 --> 00:34:26.270
BRENDAN KENNY: Yeah.

00:34:33.679 --> 00:34:36.620
PAUL SAXMAN: I think the fun
thing will be to share some of

00:34:36.620 --> 00:34:41.025
the code and see what people
can do with it.

00:34:41.025 --> 00:34:43.060
BRENDAN KENNY: Let's see if
I can draw those in here.

00:34:47.969 --> 00:34:49.510
We might be able to do this.

00:34:54.960 --> 00:34:56.210
Did that work?

00:34:57.815 --> 00:34:59.065
There we go.

00:35:01.280 --> 00:35:01.540
Yeah.

00:35:01.540 --> 00:35:05.480
So this is not exactly the
most dynamic thing.

00:35:16.230 --> 00:35:17.520
It's hard to tell, but
it's actually--

00:35:20.710 --> 00:35:21.120
PAUL SAXMAN: Cool.

00:35:21.120 --> 00:35:21.950
BRENDAN KENNY: Changing.

00:35:21.950 --> 00:35:22.290
There.

00:35:22.290 --> 00:35:23.900
PAUL SAXMAN: No, we
get the idea.

00:35:23.900 --> 00:35:25.240
BRENDAN KENNY: Yeah.

00:35:25.240 --> 00:35:27.810
PAUL SAXMAN: There's some really
great imagery out there

00:35:27.810 --> 00:35:29.480
from the high-rise camera.

00:35:29.480 --> 00:35:32.110
BRENDAN KENNY: Yeah, so great
imagery, and we'll post the

00:35:32.110 --> 00:35:34.210
code to split it up.

00:35:34.210 --> 00:35:34.870
It's not great.

00:35:34.870 --> 00:35:36.520
If there's any GDAL experts--

00:35:36.520 --> 00:35:38.710
actually, we have some on our
team, so I might consult them

00:35:38.710 --> 00:35:43.850
on how to get the higher
depth to the images.

00:35:43.850 --> 00:35:47.520
But you can actually see one
of the problems with using

00:35:47.520 --> 00:35:49.480
orthographic imagery
and lighting it.

00:35:49.480 --> 00:35:51.730
I've lit it from below now, and
suddenly these mountains

00:35:51.730 --> 00:35:53.530
look like they're--

00:35:53.530 --> 00:35:53.995
PAUL SAXMAN: Oh, yeah.

00:35:53.995 --> 00:35:54.655
They're embossed.

00:35:54.655 --> 00:35:56.070
BRENDAN KENNY: Yeah, embossed,
instead of

00:35:56.070 --> 00:35:57.220
actually standing out.

00:35:57.220 --> 00:36:00.480
And so there's lots of tricks
that we don't think about in

00:36:00.480 --> 00:36:05.590
cartography that let you play
with your brain and take

00:36:05.590 --> 00:36:07.650
advantage of your brain,
sometimes without you even

00:36:07.650 --> 00:36:10.730
knowing until it looks terrible,
and people wonder

00:36:10.730 --> 00:36:11.980
what's going on.

00:36:14.440 --> 00:36:16.460
PAUL SAXMAN: So unfortunately,
today we're probably going to

00:36:16.460 --> 00:36:18.210
take the questions offline.

00:36:18.210 --> 00:36:21.060
But definitely post them if
you have any questions.

00:36:21.060 --> 00:36:22.360
We're going to post the code.

00:36:22.360 --> 00:36:26.280
We'll put that in either Stack
Overflow or follow up in some

00:36:26.280 --> 00:36:29.330
of the comments that we have,
or in the Google+ or YouTube

00:36:29.330 --> 00:36:32.010
comments, if you're looking
for something specific.

00:36:32.010 --> 00:36:32.485
And--

00:36:32.485 --> 00:36:32.960
BRENDAN KENNY: There we go.

00:36:32.960 --> 00:36:34.010
That's better.

00:36:34.010 --> 00:36:37.010
PAUL SAXMAN: Brendan, you're
still tweaking.

00:36:37.010 --> 00:36:38.340
BRENDAN KENNY: Well, now
it's not operating so--

00:36:38.340 --> 00:36:42.430
PAUL SAXMAN: And so hopefully
you guys can join us next week

00:36:42.430 --> 00:36:44.310
or actually two weeks.

00:36:44.310 --> 00:36:45.700
Brendan will be back.

00:36:45.700 --> 00:36:48.110
And Brendan, Mano will
be around, too.

00:36:48.110 --> 00:36:49.490
BRENDAN KENNY: Yeah, in two
weeks we're talking about some

00:36:49.490 --> 00:36:55.150
great HTML5 techniques with
Mano Marks, talking about

00:36:55.150 --> 00:36:58.350
things like dragging a shape
file into the browser and

00:36:58.350 --> 00:37:02.880
having it unfold on your map
right there without any server

00:37:02.880 --> 00:37:06.160
intervention or anything
like that.

00:37:06.160 --> 00:37:09.670
Yeah, just interesting ways of
displaying that kind of data,

00:37:09.670 --> 00:37:11.220
your existing geographic data.

00:37:11.220 --> 00:37:12.270
So join us then.

00:37:12.270 --> 00:37:13.480
We'll make a post.

00:37:13.480 --> 00:37:14.360
PAUL SAXMAN: Cool.

00:37:14.360 --> 00:37:14.790
All right.

00:37:14.790 --> 00:37:17.620
And any comments you have,
post them, and we'll

00:37:17.620 --> 00:37:18.550
definitely follow up.

00:37:18.550 --> 00:37:19.460
Thanks a lot.

00:37:19.460 --> 00:37:20.660
BRENDAN KENNY: Thanks.

00:37:20.660 --> 00:37:22.460
[MUSIC PLAYING]

