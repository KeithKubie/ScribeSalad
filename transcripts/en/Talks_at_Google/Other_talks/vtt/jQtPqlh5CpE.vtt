WEBVTT
Kind: captions
Language: en

00:00:24.800 --> 00:00:25.900
KIM: Hey, everyone.

00:00:25.900 --> 00:00:28.060
Thanks for coming today.

00:00:28.060 --> 00:00:29.760
It's my great
pleasure to welcome

00:00:29.760 --> 00:00:32.020
Carey Nachenberg to Google.

00:00:32.020 --> 00:00:35.130
Carey's a leading cyber security
expert and a chief architect

00:00:35.130 --> 00:00:37.760
at Symantec, where he was
notably one of the authors

00:00:37.760 --> 00:00:38.956
of Norton Security.

00:00:38.956 --> 00:00:40.705
He was named a "Computer
World Magazine's"

00:00:40.705 --> 00:00:44.370
"40 under 40, 40 Innovative
IT People to Watch,"

00:00:44.370 --> 00:00:47.050
and awarded the "Wall Street
Journal's" 2010 Technology

00:00:47.050 --> 00:00:49.390
Innovation award for his
innovations in the security

00:00:49.390 --> 00:00:50.690
field.

00:00:50.690 --> 00:00:53.830
Carey is also, in mine and
many others' humble opinion,

00:00:53.830 --> 00:00:55.990
one of the best adjunct
professors at UCLA

00:00:55.990 --> 00:00:57.580
in the Computer
Science Department,

00:00:57.580 --> 00:01:01.120
where he's been teaching
for over 15 years.

00:01:01.120 --> 00:01:03.010
He's here to talk
to us about Stuxnet,

00:01:03.010 --> 00:01:04.550
as well as his new
techno thriller,

00:01:04.550 --> 00:01:06.630
"The Florentine Deception,"
which I can certify

00:01:06.630 --> 00:01:08.290
is a terrific read.

00:01:08.290 --> 00:01:10.300
And Carey's also
donating all proceeds

00:01:10.300 --> 00:01:13.080
from the book to charities
benefiting underserved students

00:01:13.080 --> 00:01:13.740
and veterans.

00:01:13.740 --> 00:01:16.260
So the book is supporting
look a lot of good causes.

00:01:16.260 --> 00:01:18.912
And with that, I will
hand it over to Carey.

00:01:18.912 --> 00:01:20.756
[APPLAUSE]

00:01:23.530 --> 00:01:25.516
CAREY NACHENBERG:
So I'm going to talk

00:01:25.516 --> 00:01:26.640
to you about Stuxnet today.

00:01:26.640 --> 00:01:28.620
Now Stuxnet is a little
bit old news, actually.

00:01:28.620 --> 00:01:31.030
It came a number of years ago.

00:01:31.030 --> 00:01:32.970
But it's still a
fascinating story to tell.

00:01:32.970 --> 00:01:35.000
And it actually is
tied, in a small way,

00:01:35.000 --> 00:01:36.780
to my novel, which is there.

00:01:36.780 --> 00:01:38.620
You can see "The
Florentine Deception."

00:01:38.620 --> 00:01:40.360
So before I begin,
let me just give you

00:01:40.360 --> 00:01:43.370
a brief introduction my novel.

00:01:43.370 --> 00:01:45.080
Hopefully, I'll get
you excited about it.

00:01:45.080 --> 00:01:46.830
So the book is called the
"The Florentine Deception."

00:01:46.830 --> 00:01:49.310
And if you're an edge of
your seat adventure fan,

00:01:49.310 --> 00:01:52.370
you like reading adventures,
sort of Tom Clancy,

00:01:52.370 --> 00:01:54.516
or let's say "National
Treasure" would

00:01:54.516 --> 00:01:56.600
be a good example of
the type of adventure,

00:01:56.600 --> 00:01:59.920
if you like techno thrillers
that get the details right,

00:01:59.920 --> 00:02:02.360
because most techno
thrillers don't, if you

00:02:02.360 --> 00:02:04.790
want to help underserved
children and veterans,

00:02:04.790 --> 00:02:07.160
then this might be a good
thing to take a look at.

00:02:07.160 --> 00:02:09.889
And also, if you want to see
how Iran gets even for Stuxnet.

00:02:09.889 --> 00:02:12.500
Because as you know,
Stuxnet attacks Iran,

00:02:12.500 --> 00:02:15.780
and Iran does play a
small role in my novel,

00:02:15.780 --> 00:02:17.975
or maybe a larger
role, as it turns out.

00:02:17.975 --> 00:02:19.600
It's called "The
Florentine Deception."

00:02:19.600 --> 00:02:21.099
It's available in
all major formats.

00:02:21.099 --> 00:02:22.310
You can find it online.

00:02:22.310 --> 00:02:25.190
And as Kim mentioned, I'm
donating all of my proceeds

00:02:25.190 --> 00:02:28.690
to charities that either
benefit underserved students,

00:02:28.690 --> 00:02:31.830
helping them get access to
charter schools in inner city

00:02:31.830 --> 00:02:32.980
areas, as well as veterans.

00:02:32.980 --> 00:02:35.274
So providing training
to students and veterans

00:02:35.274 --> 00:02:37.690
in high tech fields, and then
placing them in internships.

00:02:37.690 --> 00:02:38.230
OK?

00:02:38.230 --> 00:02:41.320
So scholarships, charter
schools, training.

00:02:41.320 --> 00:02:43.940
And so far, I've
donated $4,500, and I

00:02:43.940 --> 00:02:45.730
hope to donate a lot more.

00:02:45.730 --> 00:02:50.090
So let me give you the
30 second elevator pitch,

00:02:50.090 --> 00:02:51.860
then I'll talk about Stuxnet.

00:02:51.860 --> 00:02:54.520
So what would you do
if while rummaging

00:02:54.520 --> 00:02:56.360
through an old
computer-- you know,

00:02:56.360 --> 00:03:00.560
poking through its files-- you
discovered a clue to a lost

00:03:00.560 --> 00:03:01.590
treasure?

00:03:01.590 --> 00:03:03.350
Well, if you had any
curiosity at all,

00:03:03.350 --> 00:03:07.040
you'd dive head first into
a hunt for that treasure.

00:03:07.040 --> 00:03:08.460
And that's exactly
what Alex Fife,

00:03:08.460 --> 00:03:11.160
who's the main character
of my novel, does.

00:03:11.160 --> 00:03:13.680
He dives head first time in
a hunt for this treasure.

00:03:13.680 --> 00:03:16.380
But what Alex finds is
that what he's hunting for

00:03:16.380 --> 00:03:19.410
may not be a treasure after all,
but in fact, something far more

00:03:19.410 --> 00:03:21.990
dangerous-- a tool,
that in the wrong hands,

00:03:21.990 --> 00:03:24.060
could be used to
decimate the internet.

00:03:24.060 --> 00:03:27.370
And when I say decimate, I mean
really, literally permanently.

00:03:27.370 --> 00:03:29.920
So it's a little bit
adventure, and a little bit

00:03:29.920 --> 00:03:30.830
to techno thriller.

00:03:30.830 --> 00:03:33.110
And hopefully, you'll
take a look and enjoy.

00:03:33.110 --> 00:03:36.142
But let's go on and
talk about Stuxnet.

00:03:36.142 --> 00:03:37.600
Now, let me just
preface everything

00:03:37.600 --> 00:03:38.810
I'm going to talk about here.

00:03:38.810 --> 00:03:41.829
There are certain things that we
know for a fact about Stuxnet.

00:03:41.829 --> 00:03:43.370
And I'll tell you
when I know things.

00:03:43.370 --> 00:03:45.430
There are certain things
that are supposition.

00:03:45.430 --> 00:03:47.180
In other words, I've
never been, actually,

00:03:47.180 --> 00:03:51.105
in a centrifuge enrichment
facility in Iran,

00:03:51.105 --> 00:03:53.480
so I'm going to basically
speculate about certain things.

00:03:53.480 --> 00:03:55.270
And there's certain things where
I'm going to just make them up,

00:03:55.270 --> 00:03:56.770
and I'll tell you
when that happens,

00:03:56.770 --> 00:03:58.310
so at least you'll know.

00:03:58.310 --> 00:04:00.960
So to my knowledge,
this is Natanz, Iran.

00:04:00.960 --> 00:04:02.460
If you've heard
about Natanz, Natanz

00:04:02.460 --> 00:04:04.294
is an area where they
do uranium enrichment.

00:04:04.294 --> 00:04:06.043
So this is where they're
spinning uranium,

00:04:06.043 --> 00:04:07.220
and we'll talk about that.

00:04:07.220 --> 00:04:08.594
This is an overhead photograph.

00:04:08.594 --> 00:04:10.760
I've never been here, so
I'll take their word for it

00:04:10.760 --> 00:04:12.530
that it's actually a
satellite photograph.

00:04:12.530 --> 00:04:13.113
This is a lie.

00:04:13.113 --> 00:04:14.770
These are not
Natanz' centrifuges.

00:04:14.770 --> 00:04:18.600
These are a Google image that I
found on a Google Image Search.

00:04:18.600 --> 00:04:20.250
But these are
centrifuges that actually

00:04:20.250 --> 00:04:22.029
are used to enrich uranium.

00:04:22.029 --> 00:04:23.490
And they spin uranium gas.

00:04:23.490 --> 00:04:26.245
I think it's uranium
hexafluoride gas.

00:04:26.245 --> 00:04:28.120
And this is how generally
they're controlled.

00:04:28.120 --> 00:04:29.530
And this is true.

00:04:29.530 --> 00:04:32.210
So what we have is a
whole control system

00:04:32.210 --> 00:04:34.090
which includes a Windows PC.

00:04:34.090 --> 00:04:35.651
Guess what?

00:04:35.651 --> 00:04:36.150
[LAUGHING]

00:04:36.150 --> 00:04:37.010
You're already
starting to laugh.

00:04:37.010 --> 00:04:37.990
Windows PC.

00:04:37.990 --> 00:04:40.380
And these Windows
PCs run software

00:04:40.380 --> 00:04:42.540
from SIEMENS called
STEP7 Software.

00:04:42.540 --> 00:04:45.350
And STEP7 Software is a
development environment

00:04:45.350 --> 00:04:47.280
for developing software
to run-- basically

00:04:47.280 --> 00:04:49.354
control programmable
logic controllers, which

00:04:49.354 --> 00:04:50.020
I'll talk about.

00:04:50.020 --> 00:04:51.770
So you have a Windows
PC that's connected

00:04:51.770 --> 00:04:54.010
to some special
hardware call a PLC.

00:04:54.010 --> 00:04:55.160
And there's a PLC.

00:04:55.160 --> 00:04:58.280
And the PLC is a
programmable device

00:04:58.280 --> 00:05:00.950
that is used to control
industrial systems.

00:05:00.950 --> 00:05:03.590
Industrial systems could
be a roller coaster.

00:05:03.590 --> 00:05:06.010
It could be a popcorn machine.

00:05:06.010 --> 00:05:08.500
It could be uranium
enrichment centrifuges.

00:05:08.500 --> 00:05:09.540
OK?

00:05:09.540 --> 00:05:12.610
And in this case, that PLC is
going to control this uranium

00:05:12.610 --> 00:05:13.870
enrichment.

00:05:13.870 --> 00:05:16.370
Now, that controller is
not directly connected

00:05:16.370 --> 00:05:17.090
to centrifuges.

00:05:17.090 --> 00:05:18.923
What happens is that
controller is connected

00:05:18.923 --> 00:05:20.780
to a set of communications
processors, which

00:05:20.780 --> 00:05:21.696
are basically routers.

00:05:21.696 --> 00:05:25.530
That's a fancy name for
a router that basically

00:05:25.530 --> 00:05:27.420
controls groups of devices.

00:05:27.420 --> 00:05:29.490
And those routers are
then connected to things

00:05:29.490 --> 00:05:30.702
called frequency converters.

00:05:30.702 --> 00:05:32.160
Now, what are
frequency converters?

00:05:32.160 --> 00:05:34.493
Well, basically what they do
is they take wall frequency

00:05:34.493 --> 00:05:36.860
of, let's say, 120
hertz or 240 hertz,

00:05:36.860 --> 00:05:39.710
and they convert it to
potentially different speeds.

00:05:39.710 --> 00:05:42.340
So 2,000 hertz, 1,000
hertz, and so on.

00:05:42.340 --> 00:05:45.540
So frequency converters actually
change the frequency in order

00:05:45.540 --> 00:05:47.860
to run on devices at
faster frequencies.

00:05:47.860 --> 00:05:50.280
And finally-- and this is
what's most interesting--

00:05:50.280 --> 00:05:51.710
are these centrifuges.

00:05:51.710 --> 00:05:54.850
So centrifuges are big
tubes, aluminum tubes,

00:05:54.850 --> 00:05:57.190
that spin at very high rates.

00:05:57.190 --> 00:05:59.440
I'll tell you a little bit
later, but very high rates.

00:05:59.440 --> 00:06:01.450
And what they do is
they spin uranium gas.

00:06:01.450 --> 00:06:04.210
Now, there are two
isotopes of uranium

00:06:04.210 --> 00:06:06.150
that are basically
found in nature.

00:06:06.150 --> 00:06:09.460
And one isotope, the lighter
isotope, if I'm not mistaken,

00:06:09.460 --> 00:06:11.370
is the one that's used
in actually producing

00:06:11.370 --> 00:06:12.500
nuclear fuel in bombs.

00:06:12.500 --> 00:06:15.550
The other isotope, the heavier
isotope, is actually not used.

00:06:15.550 --> 00:06:17.070
It's a sort of the
default isotope.

00:06:17.070 --> 00:06:19.690
I So what they do is they
spin the uranium around

00:06:19.690 --> 00:06:20.780
in these tubes.

00:06:20.780 --> 00:06:22.640
And the heavy uranium
goes to the sides,

00:06:22.640 --> 00:06:25.440
and the light uranium
stays in the center.

00:06:25.440 --> 00:06:29.290
And they basically
have, if you will,

00:06:29.290 --> 00:06:31.750
a pipeline whereas
a lighter uranium,

00:06:31.750 --> 00:06:33.330
gas is filtered to the center.

00:06:33.330 --> 00:06:35.090
It's then piped into
the next stage, which

00:06:35.090 --> 00:06:36.390
then does this process again.

00:06:36.390 --> 00:06:39.500
And they basically successively
enrich the light uranium gas.

00:06:39.500 --> 00:06:43.260
And that's then used in order
to produce fuel for bombs.

00:06:43.260 --> 00:06:43.760
OK.

00:06:43.760 --> 00:06:45.665
So that's how they're
all connected.

00:06:45.665 --> 00:06:47.040
And this is how
they're isolated.

00:06:47.040 --> 00:06:48.520
Now this is a little
bit of speculation,

00:06:48.520 --> 00:06:50.830
but this is how we understand
that things are isolated.

00:06:50.830 --> 00:06:54.190
So we believe that there is
a research network-- OK, yes,

00:06:54.190 --> 00:06:55.600
there are a little green men.

00:06:55.600 --> 00:06:58.682
They're the plastic figures
you used to play with as a kid.

00:06:58.682 --> 00:07:00.890
There's a research network,
and that research network

00:07:00.890 --> 00:07:03.340
is isolated from the
uranium enrichment network.

00:07:03.340 --> 00:07:05.279
And we think that
people were maybe

00:07:05.279 --> 00:07:07.320
connecting to the internet,
doing research and so

00:07:07.320 --> 00:07:08.730
on, on the research network.

00:07:08.730 --> 00:07:10.370
There's a firewall
out to the internet,

00:07:10.370 --> 00:07:12.970
then we have some guards
in little green uniforms,

00:07:12.970 --> 00:07:14.470
and they're literally that size.

00:07:14.470 --> 00:07:16.590
They're literally about
a couple inches tall.

00:07:16.590 --> 00:07:19.674
And then, they then would
separate an air-gapped network,

00:07:19.674 --> 00:07:22.090
which is where the uranium
enrichment process takes place.

00:07:22.090 --> 00:07:23.560
And when I say
air-gapped, I mean

00:07:23.560 --> 00:07:26.916
that we believe there were
no connections probably

00:07:26.916 --> 00:07:29.290
in and out of the two networks,
between the two networks.

00:07:29.290 --> 00:07:29.790
OK?

00:07:29.790 --> 00:07:31.730
So you get an idea.

00:07:31.730 --> 00:07:33.780
Now, this is probably,
this is a lie.

00:07:33.780 --> 00:07:38.970
But I googled Mossad programmer,
and this is what I got.

00:07:38.970 --> 00:07:40.874
So I basically made a
nice like, card there.

00:07:40.874 --> 00:07:42.540
That's probably not
the right guy there.

00:07:42.540 --> 00:07:44.873
But anyway, I got this picture
from Google Image Search.

00:07:44.873 --> 00:07:46.580
But this is probably
a Mossad guy.

00:07:46.580 --> 00:07:48.420
And let's just say he's
a Mossad programmer.

00:07:48.420 --> 00:07:50.060
And we're going to
assume for the time being

00:07:50.060 --> 00:07:51.393
that Israel is somehow involved.

00:07:51.393 --> 00:07:52.840
But maybe, maybe, they weren't.

00:07:52.840 --> 00:07:53.460
OK.

00:07:53.460 --> 00:07:56.100
So what this guy
wants to do-- OK?

00:07:56.100 --> 00:07:58.220
What this guy wants to
do-- I don't know his name.

00:07:58.220 --> 00:08:02.510
He wants to introduce this
digital time bomb, if you will,

00:08:02.510 --> 00:08:04.140
onto this computer right here.

00:08:04.140 --> 00:08:06.099
That computer is the
Windows PC, because that's

00:08:06.099 --> 00:08:07.973
where he wants to start
going, because that's

00:08:07.973 --> 00:08:09.550
the easiest thing to get to.

00:08:09.550 --> 00:08:12.450
So he wants to introduce
that onto that.

00:08:12.450 --> 00:08:12.950
OK.

00:08:12.950 --> 00:08:14.630
And how exactly is
he going to do this?

00:08:14.630 --> 00:08:17.030
How is he going to get this
onto an air-gapped network?

00:08:17.030 --> 00:08:19.490
Because remember, that
network, that network

00:08:19.490 --> 00:08:22.880
that runs those centrifuges,
is totally isolated

00:08:22.880 --> 00:08:24.130
from the rest of the internet.

00:08:24.130 --> 00:08:28.290
So how is he going to get
that onto network with those?

00:08:28.290 --> 00:08:31.250
Well, first of all, the
threat has to spread its own.

00:08:31.250 --> 00:08:31.750
OK?

00:08:31.750 --> 00:08:33.124
So there has to
be some autonomy.

00:08:33.124 --> 00:08:34.970
The threat has to
spread and actually

00:08:34.970 --> 00:08:37.090
be able to reach that
network on its own,

00:08:37.090 --> 00:08:38.055
because they're
probably not going

00:08:38.055 --> 00:08:40.013
to be able to get a spy
to sort of bring it in.

00:08:40.013 --> 00:08:41.280
Well, they might have.

00:08:41.280 --> 00:08:42.947
Until it discovers
the proper computers.

00:08:42.947 --> 00:08:44.738
So the threat has to
keep spreading 'til it

00:08:44.738 --> 00:08:46.110
discovers the proper computers.

00:08:46.110 --> 00:08:47.440
If it discovers the
wrong computers,

00:08:47.440 --> 00:08:48.120
it's not very useful.

00:08:48.120 --> 00:08:50.100
I can't disrupt your
computer or my computer.

00:08:50.100 --> 00:08:51.620
It wouldn't be very useful.

00:08:51.620 --> 00:08:53.867
Where it can then disrupt
the centrifuges-- so then

00:08:53.867 --> 00:08:55.450
it's going to disrupt
the centrifuges,

00:08:55.450 --> 00:08:56.970
all while evading detection.

00:08:56.970 --> 00:09:00.170
And Stuxnet is an amazing
threat, because it did all four

00:09:00.170 --> 00:09:01.770
of these things well.

00:09:01.770 --> 00:09:02.670
I mean, it's amazing.

00:09:02.670 --> 00:09:06.390
OK now, there was
no rocket science.

00:09:06.390 --> 00:09:08.560
There's no sort of alien
technology involved

00:09:08.560 --> 00:09:09.550
in what's Stuxnet does.

00:09:09.550 --> 00:09:11.080
Everything is regular
computer science

00:09:11.080 --> 00:09:13.455
and things that anybody here
could do, given enough time.

00:09:13.455 --> 00:09:16.620
But what's amazing is how
they got everything right.

00:09:16.620 --> 00:09:19.420
So let's talk about
each of these phases.

00:09:19.420 --> 00:09:20.910
I have to move
around a bit more.

00:09:20.910 --> 00:09:21.590
I like to move around.

00:09:21.590 --> 00:09:21.840
OK.

00:09:21.840 --> 00:09:22.447
Here we go.

00:09:22.447 --> 00:09:24.030
So Stuxnet's got to
spread on its own.

00:09:24.030 --> 00:09:27.786
So Stuxnet uses seven
different distinct mechanisms

00:09:27.786 --> 00:09:28.910
to spread to new computers.

00:09:28.910 --> 00:09:31.424
So normally, a lot of
threats don't spread at all.

00:09:31.424 --> 00:09:33.840
A lot threats will literally
come down into your computer.

00:09:33.840 --> 00:09:36.406
They'll record keystrokes,
steal your credit card

00:09:36.406 --> 00:09:38.780
numbers, your passport, and
so on, send it up, and so on.

00:09:38.780 --> 00:09:41.270
But some threats will spread
from computer to computer.

00:09:41.270 --> 00:09:42.940
We call them worms,
or attack tools

00:09:42.940 --> 00:09:45.360
can be used to spread
between computers.

00:09:45.360 --> 00:09:47.590
Stuxnet doesn't use
one technique, or two,

00:09:47.590 --> 00:09:48.340
or three, or four.

00:09:48.340 --> 00:09:50.120
It uses seven to spread.

00:09:50.120 --> 00:09:51.760
So let's see how
it might spread.

00:09:51.760 --> 00:09:54.715
So first of all, Stuxnet will
search for open drive shares

00:09:54.715 --> 00:09:56.340
on different computers
in your network.

00:09:56.340 --> 00:09:58.810
So if you share files
via drive shares,

00:09:58.810 --> 00:10:00.562
it will enumerate
those drive shares,

00:10:00.562 --> 00:10:02.270
enumerating the
computers on the network,

00:10:02.270 --> 00:10:04.140
and it will copy itself
from one computer

00:10:04.140 --> 00:10:08.021
to another over a driveshare,
and then install itself.

00:10:08.021 --> 00:10:11.740
Stuxnet will attack a hole
in the Windows print spooler.

00:10:11.740 --> 00:10:14.150
So basically, they
leverage a buffer overflow

00:10:14.150 --> 00:10:17.910
in the Windows print spooler,
to basically send a shell code

00:10:17.910 --> 00:10:20.520
over to the print spooler, and
then inject a copy of Stuxnet

00:10:20.520 --> 00:10:21.450
onto a new computer.

00:10:21.450 --> 00:10:24.920
So if you had a printer
driver, a print spooler running

00:10:24.920 --> 00:10:28.130
on a computer that was available
over the network, guess what?

00:10:28.130 --> 00:10:30.510
Stuxnet would use that
to spread as well.

00:10:30.510 --> 00:10:34.502
Now, there's one supposition,
hypothetical, that in fact,

00:10:34.502 --> 00:10:36.210
the two networks, the
air-gapped network,

00:10:36.210 --> 00:10:37.440
where the centrifuges
were running,

00:10:37.440 --> 00:10:39.148
and the research
network, might have been

00:10:39.148 --> 00:10:41.125
connected by a shared printer.

00:10:41.125 --> 00:10:43.000
And if that's the case,
that would be one way

00:10:43.000 --> 00:10:45.800
in order to get onto
the air-gapped network.

00:10:45.800 --> 00:10:47.130
But we don't know.

00:10:47.130 --> 00:10:49.680
Now in addition to spreading
via these two mechanisms,

00:10:49.680 --> 00:10:51.020
guess what?

00:10:51.020 --> 00:10:53.290
Stuxnet also attacked
the hole in Windows RPC.

00:10:53.290 --> 00:10:55.266
If you're not
familiar with RPC, RPC

00:10:55.266 --> 00:10:56.640
stands for remote
procedure call.

00:10:56.640 --> 00:10:58.970
This is a mechanism
to do remote function

00:10:58.970 --> 00:11:00.650
calls between two computers.

00:11:00.650 --> 00:11:03.020
In Stuxnet, leverage the
flaw of vulnerability

00:11:03.020 --> 00:11:04.630
to get another type
of buffer overflow

00:11:04.630 --> 00:11:07.210
to attack one computer
from another computer,

00:11:07.210 --> 00:11:08.960
and then inject itself
into that computer.

00:11:08.960 --> 00:11:11.000
So it did that as well.

00:11:11.000 --> 00:11:14.400
So now, we're on three
different mechanisms.

00:11:14.400 --> 00:11:15.690
This was an interesting one.

00:11:15.690 --> 00:11:17.690
So the SIEMENS
software that we talked

00:11:17.690 --> 00:11:21.890
about, that STEP7 Software,
it actually uses a database

00:11:21.890 --> 00:11:23.290
called WinCC.

00:11:23.290 --> 00:11:27.450
And WinCC is like a database,
standard database, like MySQL,

00:11:27.450 --> 00:11:29.020
or Oracle, and so on.

00:11:29.020 --> 00:11:29.841
What's that?

00:11:29.841 --> 00:11:30.340
A commodity.

00:11:30.340 --> 00:11:31.630
It's a database.

00:11:31.630 --> 00:11:33.400
Now that databases,
as it turns out,

00:11:33.400 --> 00:11:35.990
when you install the SIEMENS
software, at least in the past,

00:11:35.990 --> 00:11:37.840
had a default password.

00:11:37.840 --> 00:11:38.650
OK?

00:11:38.650 --> 00:11:39.890
Big surprise.

00:11:39.890 --> 00:11:42.092
And so, whoever
built Stuxnet knew

00:11:42.092 --> 00:11:44.050
that the database used
by this SIEMENS software

00:11:44.050 --> 00:11:44.980
had a default password.

00:11:44.980 --> 00:11:46.438
And so what they
did was they said,

00:11:46.438 --> 00:11:49.120
hey, try to log into that
database with the default

00:11:49.120 --> 00:11:50.620
password, and see
if you can get in.

00:11:50.620 --> 00:11:51.700
You never know.

00:11:51.700 --> 00:11:53.960
And if you can, then
send some commands over

00:11:53.960 --> 00:11:55.950
to then install Stuxnet
on that computer.

00:11:55.950 --> 00:11:58.360
So basically, they log
in through a back door.

00:11:58.360 --> 00:12:01.080
Or not back door, but
effectively a default password

00:12:01.080 --> 00:12:05.530
in the database software used
by SIEMENS STEP7, and boom,

00:12:05.530 --> 00:12:06.770
they were in as well.

00:12:06.770 --> 00:12:10.005
So if that wasn't enough,
they did that as well.

00:12:10.005 --> 00:12:12.130
And the other thing they
did-- how many people here

00:12:12.130 --> 00:12:13.960
are familiar with Visual
Studio, obviously,

00:12:13.960 --> 00:12:15.001
for software development?

00:12:15.001 --> 00:12:18.230
So Visual Studio, you might
have a project file or solution,

00:12:18.230 --> 00:12:20.090
which is a data
file that has all

00:12:20.090 --> 00:12:23.370
the information about your
source files and so on,

00:12:23.370 --> 00:12:24.400
all your dependencies.

00:12:24.400 --> 00:12:25.960
Well, the SIEMENS
software that's

00:12:25.960 --> 00:12:29.910
used to develop software
to run these PLCs,

00:12:29.910 --> 00:12:32.920
to run your roller coaster, or
whatever, it has similar data

00:12:32.920 --> 00:12:35.740
files, like solutions, and
projects, in Visual Studio.

00:12:35.740 --> 00:12:39.160
And as it turns out, Stuxnet
will locate those SIEMENS data

00:12:39.160 --> 00:12:41.210
files, and insert
a copy of itself

00:12:41.210 --> 00:12:42.730
in the SIEMENS data
files, so if you

00:12:42.730 --> 00:12:44.620
take those data files
and happen to copy them

00:12:44.620 --> 00:12:46.380
to another computer,
then Stuxnet

00:12:46.380 --> 00:12:48.300
will actually spread
through the data files,

00:12:48.300 --> 00:12:50.021
and then autolaunch
into that computer.

00:12:50.021 --> 00:12:50.520
OK?

00:12:50.520 --> 00:12:52.840
So simply sharing your
Visual Studio projects--

00:12:52.840 --> 00:12:54.570
not Visual Studio,
but the equivalent

00:12:54.570 --> 00:12:56.860
of the SIEMENS
projects, data files,

00:12:56.860 --> 00:12:58.490
will cause Stuxnet
to spread as well.

00:12:58.490 --> 00:12:59.850
And so guess what?

00:12:59.850 --> 00:13:02.510
That will help you
get in as well.

00:13:02.510 --> 00:13:03.260
OK?

00:13:03.260 --> 00:13:05.860
And if that's not enough,
because why would that

00:13:05.860 --> 00:13:08.000
be enough, Stuxnet
also has a peer-to-peer

00:13:08.000 --> 00:13:08.860
updating mechanism.

00:13:08.860 --> 00:13:11.940
So let's imagine that every one
of these infections of Stuxnet

00:13:11.940 --> 00:13:15.180
was not on a machine that's
connected to the internet,

00:13:15.180 --> 00:13:15.820
except for one.

00:13:15.820 --> 00:13:17.770
Let's just imagine
one of these machines

00:13:17.770 --> 00:13:20.510
is connected to the
internet, and that Stuxnet

00:13:20.510 --> 00:13:23.580
variant updates to Version
2.0 from Version 1.0.

00:13:23.580 --> 00:13:24.080
OK?

00:13:24.080 --> 00:13:27.350
Well, it will automatically
contact all of its buddies,

00:13:27.350 --> 00:13:29.260
and then it will update
them to Version 2.0,

00:13:29.260 --> 00:13:31.649
even if none of them
get to the internet.

00:13:31.649 --> 00:13:32.690
That's pretty impressive.

00:13:32.690 --> 00:13:33.270
Come on.

00:13:33.270 --> 00:13:35.200
That's pretty impressive.

00:13:35.200 --> 00:13:38.170
Now, I've only shown you, I
think, six different mechanism,

00:13:38.170 --> 00:13:41.160
so let's just do number seven.

00:13:41.160 --> 00:13:43.510
If the centrifuges are
air-gapped-- and frankly,

00:13:43.510 --> 00:13:46.047
you can't spread over the
network to these things

00:13:46.047 --> 00:13:47.630
if there's no printer
connected-- then

00:13:47.630 --> 00:13:50.480
how does Stuxnet get on
that air-gapped network?

00:13:50.480 --> 00:13:53.410
And the answer is, it also
spreads over USB drives,

00:13:53.410 --> 00:13:54.550
because why not?

00:13:54.550 --> 00:13:58.050
So if you stick a USB drive in
a Stuxnet infected computer,

00:13:58.050 --> 00:14:01.454
it will automatically
infect that USB drive.

00:14:01.454 --> 00:14:02.870
And then what it'll
do is when you

00:14:02.870 --> 00:14:05.280
bring that USB drive over
to this other computer here,

00:14:05.280 --> 00:14:06.670
which you would probably
do, because you want

00:14:06.670 --> 00:14:08.461
to bring something from
the outside network

00:14:08.461 --> 00:14:10.540
to the air-gapped
network, guess what?

00:14:10.540 --> 00:14:13.410
That machine will
be infected as well.

00:14:13.410 --> 00:14:16.390
And as it turns out, of
all these mechanisms used

00:14:16.390 --> 00:14:22.400
to spread, six of these
attacks basically leveraged day

00:14:22.400 --> 00:14:23.800
zero attacks.

00:14:23.800 --> 00:14:27.840
Now, if you're not familiar
with what a day zero attack is,

00:14:27.840 --> 00:14:31.260
imagine that there is some
flaw in your house lock?

00:14:31.260 --> 00:14:32.130
OK?

00:14:32.130 --> 00:14:34.630
Now, you didn't know there's
a flaw in your house lock.

00:14:34.630 --> 00:14:35.560
Basically, there
happens to be a flaw

00:14:35.560 --> 00:14:37.476
that if somebody sticks
some type of toothpick

00:14:37.476 --> 00:14:40.260
and pushes just right,
they can open your door.

00:14:40.260 --> 00:14:41.800
Open the lock.

00:14:41.800 --> 00:14:43.590
A day zero flaw
is in a case where

00:14:43.590 --> 00:14:45.490
you don't know that
that flaw exists

00:14:45.490 --> 00:14:47.100
that somebody can exploit.

00:14:47.100 --> 00:14:49.220
A non-day zero threat would
be one where, oh yeah,

00:14:49.220 --> 00:14:50.430
we know that locks
can be picked,

00:14:50.430 --> 00:14:51.790
and we know how it
can be done, and we

00:14:51.790 --> 00:14:53.373
have to try to
safeguard against that.

00:14:53.373 --> 00:14:55.700
Day zero are vulnerabilities
where we just don't even

00:14:55.700 --> 00:14:58.360
know that there's this
vulnerability, this problem

00:14:58.360 --> 00:15:00.810
with your technology.

00:15:00.810 --> 00:15:04.210
So Stuxnet, six of the
approaches it used to spread,

00:15:04.210 --> 00:15:06.880
leveraged day zero
vulnerabilities in order

00:15:06.880 --> 00:15:08.940
to infiltrate new machines.

00:15:08.940 --> 00:15:12.580
Now we're amazed when we see one
day zero vulnerability attack.

00:15:12.580 --> 00:15:16.070
When we see six,
that's unbelievable.

00:15:16.070 --> 00:15:19.000
So basically, again,
very impressive.

00:15:19.000 --> 00:15:20.250
Nothing that's rocket science.

00:15:20.250 --> 00:15:21.625
Nothing that's
out of this world.

00:15:21.625 --> 00:15:24.440
But pretty impressive they
would put all this together.

00:15:24.440 --> 00:15:26.260
Now, we just saw
how Stuxnet spreads.

00:15:26.260 --> 00:15:28.141
So we know it can go
from machine to machine,

00:15:28.141 --> 00:15:29.390
it can spread on thumb drives.

00:15:29.390 --> 00:15:30.850
Very exciting.

00:15:30.850 --> 00:15:33.810
Now, it has to then discover
the proper computers.

00:15:33.810 --> 00:15:35.955
So Stuxnet, as it turns
out, is extremely picky.

00:15:35.955 --> 00:15:38.080
You see there, we have the
slipper from Cinderella.

00:15:38.080 --> 00:15:41.794
It has to fit just right on the
foot in order for Cinderella

00:15:41.794 --> 00:15:43.460
to choose the right
person for the shoe.

00:15:43.460 --> 00:15:45.040
But Stuxnet is very similar.

00:15:45.040 --> 00:15:46.976
Stuxnet will only activate
its payload, which

00:15:46.976 --> 00:15:48.350
we'll talk about,
when it's found

00:15:48.350 --> 00:15:51.450
an exact match, an exact
match, of the computer

00:15:51.450 --> 00:15:52.750
it wants to find.

00:15:52.750 --> 00:15:56.330
So first of all, Stuxnet
looks that the Windows machine

00:15:56.330 --> 00:15:59.150
that it's on is
running STEP7 Software.

00:15:59.150 --> 00:16:00.865
So if it comes to
a machine, if it

00:16:00.865 --> 00:16:02.240
happens to find
a machine, that's

00:16:02.240 --> 00:16:03.850
not running the
STEP7 software, it

00:16:03.850 --> 00:16:06.359
knows it might be on
the right network,

00:16:06.359 --> 00:16:08.150
but it's certainly not
on the right machine

00:16:08.150 --> 00:16:09.292
to attack centrifuges.

00:16:09.292 --> 00:16:11.000
So it will basically
do nothing, and just

00:16:11.000 --> 00:16:13.390
start spreading from that
machine to other machines.

00:16:13.390 --> 00:16:15.251
So it basically might
hit your machine.

00:16:15.251 --> 00:16:17.250
And it says, oh, there's
no STEP7 Software here.

00:16:17.250 --> 00:16:18.430
I'm going to just
keep spreading.

00:16:18.430 --> 00:16:20.304
But it won't do anything
bad to your machine.

00:16:20.304 --> 00:16:22.070
So you would never
know it was there.

00:16:22.070 --> 00:16:25.500
But once it finds that STEP7
Software, it gets excited.

00:16:25.500 --> 00:16:26.850
What's it going to do?

00:16:26.850 --> 00:16:28.290
Well, what it does
is it actually

00:16:28.290 --> 00:16:29.970
checks the data files
in that computer

00:16:29.970 --> 00:16:33.490
to see if that
computer is connected

00:16:33.490 --> 00:16:38.040
to an S7-315 programmable
logic controller from SIEMENS.

00:16:38.040 --> 00:16:41.220
So it's checking to see whether
the Windows computer is hooked

00:16:41.220 --> 00:16:42.965
up to that PLC device,
that controller

00:16:42.965 --> 00:16:43.840
that we talked about.

00:16:43.840 --> 00:16:45.610
And it has to be
exactly that model.

00:16:45.610 --> 00:16:47.720
If you're hooked up to
a different model device

00:16:47.720 --> 00:16:49.719
from your Windows
computer running STEP7,

00:16:49.719 --> 00:16:51.010
Stuxnet will do nothing at all.

00:16:51.010 --> 00:16:52.570
So it's fingerprinting
the hardware

00:16:52.570 --> 00:16:54.960
that's connected to
this Windows computer.

00:16:54.960 --> 00:16:58.200
Now, as it turns out, this
PLC, the programmable logic

00:16:58.200 --> 00:17:00.090
controller, must
then be connected to

00:17:00.090 --> 00:17:04.790
at least00 it must be at
least six CP-342-5 network

00:17:04.790 --> 00:17:06.116
modules from SIEMENS.

00:17:06.116 --> 00:17:07.740
These network modules
are these routers

00:17:07.740 --> 00:17:09.740
I talked about that
basically route the traffic.

00:17:09.740 --> 00:17:11.550
So it's actually
fingerprint the PLC,

00:17:11.550 --> 00:17:14.460
and it's fingerprinting
the number of routers

00:17:14.460 --> 00:17:16.280
connected to the PLC.

00:17:16.280 --> 00:17:19.301
And finally, it fingerprints
each network module.

00:17:19.301 --> 00:17:20.800
Each router, then,
must be connected

00:17:20.800 --> 00:17:24.141
to 31 Fararo Paya or Vacon
NX frequency converters.

00:17:24.141 --> 00:17:26.140
These are the things that
convert wall frequency

00:17:26.140 --> 00:17:27.329
to the faster frequencies.

00:17:27.329 --> 00:17:29.040
OK?

00:17:29.040 --> 00:17:31.170
Exactly 31 of those.

00:17:31.170 --> 00:17:33.620
Now, what's
interesting is, if you

00:17:33.620 --> 00:17:36.460
do the math, what you'll
find is Stuxnet verifies

00:17:36.460 --> 00:17:40.480
that it discovered the PLC
that is controlling at least

00:17:40.480 --> 00:17:43.330
155 total frequency converters.

00:17:43.330 --> 00:17:44.970
If you multiply
it all out, there

00:17:44.970 --> 00:17:47.920
has to be at least 155
total frequency converters.

00:17:47.920 --> 00:17:50.360
And what we learned, not
recently, but a little while

00:17:50.360 --> 00:17:52.880
ago, is that Iran's
Uranium Enrichment

00:17:52.880 --> 00:17:56.260
Program, their cascade,
leveraged exactly 160

00:17:56.260 --> 00:17:57.071
centrifuges.

00:17:57.071 --> 00:17:58.570
So basically, this
is fingerprinting

00:17:58.570 --> 00:18:00.420
all the components,
and also making

00:18:00.420 --> 00:18:05.180
sure that there are 160
frequency converters, or 155

00:18:05.180 --> 00:18:08.070
or more frequency converters,
that are controlling something.

00:18:08.070 --> 00:18:09.680
Now, of course, they could be
controlling something other

00:18:09.680 --> 00:18:11.780
than uranium enrichment--
we don't know--

00:18:11.780 --> 00:18:13.770
but that's what
it's fingerprinting.

00:18:13.770 --> 00:18:15.790
You wonder how they
figured that out.

00:18:15.790 --> 00:18:18.134
How did they discover
exactly that configuration?

00:18:18.134 --> 00:18:20.550
So there must have been somebody
on the inside giving them

00:18:20.550 --> 00:18:21.470
this information.

00:18:21.470 --> 00:18:22.820
But we don't know.

00:18:22.820 --> 00:18:24.000
We don't know.

00:18:24.000 --> 00:18:25.120
OK.

00:18:25.120 --> 00:18:27.669
So now we know how Stuxnet
discovers the right computer.

00:18:27.669 --> 00:18:29.460
It's going to spread
over and over and over

00:18:29.460 --> 00:18:31.880
between computers, until it
finds just the right computer

00:18:31.880 --> 00:18:33.930
that is connected to just
the right hardware, or just

00:18:33.930 --> 00:18:35.638
the right number of
frequency converters.

00:18:35.638 --> 00:18:37.100
It's happy as a clam right now.

00:18:37.100 --> 00:18:38.516
And now, it gets
down to business.

00:18:38.516 --> 00:18:41.520
And this is where things
get really interesting.

00:18:41.520 --> 00:18:44.360
Now Stuxnet starts by
downloading malicious logic

00:18:44.360 --> 00:18:46.140
onto the PLC hardware.

00:18:46.140 --> 00:18:49.700
So what it does, it has a little
mini me, a little mini Stuxnet.

00:18:49.700 --> 00:18:52.880
And it sends that mini
Stuxnet over the PLC.

00:18:52.880 --> 00:18:54.580
It actually is a
separate module that

00:18:54.580 --> 00:18:56.510
runs on the hardware of PLC.

00:18:56.510 --> 00:18:58.360
Which, by the way,
is a different--

00:18:58.360 --> 00:18:59.380
it's not Intel hardware.

00:18:59.380 --> 00:19:01.911
It's a different
embedded microprocessor.

00:19:01.911 --> 00:19:02.410
OK.

00:19:02.410 --> 00:19:03.680
And what you
probably didn't know

00:19:03.680 --> 00:19:05.429
is that Stuxnet, at
least to my knowledge,

00:19:05.429 --> 00:19:07.450
is the first threat
that actually

00:19:07.450 --> 00:19:10.900
spread on embedded platforms, as
well as on traditional Windows

00:19:10.900 --> 00:19:11.540
PCs.

00:19:11.540 --> 00:19:14.096
It has different code,
different instructions set,

00:19:14.096 --> 00:19:15.720
different machine
language, everything,

00:19:15.720 --> 00:19:17.970
that it's using for both of
these different platforms.

00:19:17.970 --> 00:19:18.730
OK.

00:19:18.730 --> 00:19:21.050
So that's pretty
impressive right there.

00:19:21.050 --> 00:19:21.550
OK.

00:19:21.550 --> 00:19:24.340
So now, they have a little bit
of logic running on the PLC

00:19:24.340 --> 00:19:25.110
itself.

00:19:25.110 --> 00:19:27.420
This controller, it actually
controls the operation

00:19:27.420 --> 00:19:28.679
of all these centrifuges.

00:19:28.679 --> 00:19:30.720
But they don't know that
they're centrifuges yet.

00:19:30.720 --> 00:19:31.330
They think.

00:19:31.330 --> 00:19:34.110
They think they're
centrifuge spinning systems.

00:19:34.110 --> 00:19:37.170
But right now, all they know is
they got 155 different things

00:19:37.170 --> 00:19:38.350
they're connected to.

00:19:38.350 --> 00:19:41.820
So next, what Stuxnet does
is it measures the operating

00:19:41.820 --> 00:19:44.450
speed of the
frequency converters

00:19:44.450 --> 00:19:45.700
during their normal operation.

00:19:45.700 --> 00:19:48.600
So what Stuxnet does is it
just sits there for 13 days.

00:19:48.600 --> 00:19:50.410
It does not do
any damage at all.

00:19:50.410 --> 00:19:53.236
It just sits there, and it
watches telemetry coming back

00:19:53.236 --> 00:19:54.860
from these frequency
converters saying,

00:19:54.860 --> 00:19:56.184
how fast are you spinning?

00:19:56.184 --> 00:19:58.100
So as these frequency
converters are spinning,

00:19:58.100 --> 00:20:00.920
they're sending
telemetry up to the PLC.

00:20:00.920 --> 00:20:01.550
OK.

00:20:01.550 --> 00:20:04.130
And Stuxnet is intercepting
that telemetry.

00:20:04.130 --> 00:20:06.290
It has actually patched
code in the PLC,

00:20:06.290 --> 00:20:08.500
so it has control
part-time, and it's

00:20:08.500 --> 00:20:10.385
monitoring the
telemetry coming back

00:20:10.385 --> 00:20:12.010
from these frequency
converters, saying

00:20:12.010 --> 00:20:13.200
how fast they're spinning.

00:20:13.200 --> 00:20:16.340
And it actually saves that data.

00:20:16.340 --> 00:20:18.975
And it makes sure that the
motors are running between 807

00:20:18.975 --> 00:20:21.690
hertz and 1,210 hertz.

00:20:21.690 --> 00:20:23.820
Which, by the way, guess
what, is the frequency

00:20:23.820 --> 00:20:26.250
range for making cotton candy.

00:20:26.250 --> 00:20:27.040
No, I'm kidding.

00:20:27.040 --> 00:20:29.550
For spinning
enrichment [INAUDIBLE].

00:20:29.550 --> 00:20:31.680
So this is coincidentally
the frequency range

00:20:31.680 --> 00:20:33.382
required to run centrifuges.

00:20:33.382 --> 00:20:35.840
So it's monitoring and making
sure further that not only is

00:20:35.840 --> 00:20:39.230
it connected to more
than 155 devices,

00:20:39.230 --> 00:20:42.030
but those devices are
spinning really, really fast.

00:20:42.030 --> 00:20:44.069
As it turns out, devices
spinning at that rate

00:20:44.069 --> 00:20:45.860
are export-controlled
in the United States.

00:20:45.860 --> 00:20:47.693
You can even export
them to other countries,

00:20:47.693 --> 00:20:50.820
because they are only
used for one thing, which

00:20:50.820 --> 00:20:53.682
is centrifuging,
enrichment of uranium.

00:20:53.682 --> 00:20:55.640
And why would they do
the fingerprinting again?

00:20:55.640 --> 00:20:58.180
Why further fingerprint to make
sure the frequencies are right?

00:20:58.180 --> 00:20:59.940
Because Stuxnet wouldn't
want to take out a roller

00:20:59.940 --> 00:21:00.530
coaster or something.

00:21:00.530 --> 00:21:01.260
Because it could.

00:21:01.260 --> 00:21:03.890
Because these devices could
be connected to potentially a

00:21:03.890 --> 00:21:04.620
roller coaster.

00:21:04.620 --> 00:21:06.870
So now, they know they're
running on the right device.

00:21:06.870 --> 00:21:10.450
They measured for 13 days
exactly what was going on.

00:21:10.450 --> 00:21:11.900
Pretty cool.

00:21:11.900 --> 00:21:14.630
Now once it's sure that
it's on the right Windows

00:21:14.630 --> 00:21:19.393
PC and the PLC, Stuxnet
begins its mischief.

00:21:19.393 --> 00:21:21.380
What it does is it
ups the spin rate

00:21:21.380 --> 00:21:23.740
from the defaults spin
rate of about 1,000 Hertz

00:21:23.740 --> 00:21:26.222
to 1,410 Hertz.

00:21:26.222 --> 00:21:27.930
And it takes about 15
minutes to do this.

00:21:27.930 --> 00:21:30.240
In other words, you can't
just spin these tubes.

00:21:30.240 --> 00:21:30.950
They're heavy.

00:21:30.950 --> 00:21:33.244
They can't just spin all
of a sudden at 1,400 Hertz.

00:21:33.244 --> 00:21:35.660
So it increases the speed, and
they go faster, and faster,

00:21:35.660 --> 00:21:36.535
and faster.

00:21:36.535 --> 00:21:38.660
And in fact, we don't think
they can actually reach

00:21:38.660 --> 00:21:40.410
1,400 Hertz in 15 minutes.

00:21:40.410 --> 00:21:42.900
They might reach around
1,300 and something Hertz.

00:21:42.900 --> 00:21:43.690
They're not going
to probably reach

00:21:43.690 --> 00:21:45.250
that, because they
couldn't spend that much

00:21:45.250 --> 00:21:46.580
faster in that kind of time.

00:21:46.580 --> 00:21:47.480
But it spins them up.

00:21:47.480 --> 00:21:48.688
Spins them faster and faster.

00:21:48.688 --> 00:21:49.760
So watch the gauge.

00:21:49.760 --> 00:21:50.510
The gauge is going to go up.

00:21:50.510 --> 00:21:52.760
It sends a command to all
those frequency conversions.

00:21:52.760 --> 00:21:54.500
Say, spin faster.

00:21:54.500 --> 00:21:55.720
Increase the frequency.

00:21:55.720 --> 00:21:58.730
And they basically start
spinning up at a higher rate.

00:21:58.730 --> 00:21:59.240
OK.

00:21:59.240 --> 00:22:00.540
And then guess what?

00:22:00.540 --> 00:22:03.280
After 15 minutes, it
goes back to normal.

00:22:03.280 --> 00:22:05.170
Back to normal.

00:22:05.170 --> 00:22:06.050
And guess what?

00:22:06.050 --> 00:22:08.790
Stuxnet sleeps for 27
days after doing that.

00:22:08.790 --> 00:22:09.750
It does nothing.

00:22:09.750 --> 00:22:11.270
It does nothing else.

00:22:11.270 --> 00:22:14.304
Sets it up to 1,400 Hertz,
or tries to, 15 minutes,

00:22:14.304 --> 00:22:16.470
and then puts them back to
normal and back to sleep.

00:22:16.470 --> 00:22:17.976
So imagine you're the guard.

00:22:17.976 --> 00:22:19.350
You're sort of
walking the halls.

00:22:19.350 --> 00:22:20.200
You're walking the halls.

00:22:20.200 --> 00:22:21.908
All the stuff, everything
starts spinning

00:22:21.908 --> 00:22:24.839
like a bunch of clothes washers,
or whatever, really fast.

00:22:24.839 --> 00:22:26.380
And you're thinking,
what's going on?

00:22:26.380 --> 00:22:27.963
Maybe I should hit
the big red button.

00:22:27.963 --> 00:22:28.561
Who do I call?

00:22:28.561 --> 00:22:29.810
And everything's normal again.

00:22:29.810 --> 00:22:31.393
You're like, oh, I'm
not say anything.

00:22:31.393 --> 00:22:33.527
I don't want to get killed.

00:22:33.527 --> 00:22:34.860
I don't want have a false alarm.

00:22:34.860 --> 00:22:36.750
So it sleeps again.

00:22:36.750 --> 00:22:37.250
OK?

00:22:37.250 --> 00:22:40.700
Now, after 27 days,
because it's very patient,

00:22:40.700 --> 00:22:45.610
Stuxnet then slows the spin rate
down to 2 Hertz for 50 minutes.

00:22:45.610 --> 00:22:48.137
So again, these things,
they were going really fast,

00:22:48.137 --> 00:22:48.720
down in Hertz.

00:22:48.720 --> 00:22:53.290
And all of a sudden, 27 days
later, they're like, [PUFFING].

00:22:53.290 --> 00:22:54.675
Imagine how slow that would be.

00:22:54.675 --> 00:22:55.640
And again, the guard's
looking around.

00:22:55.640 --> 00:22:57.270
He's like, what's going on?

00:22:57.270 --> 00:22:58.460
They're running around.

00:22:58.460 --> 00:23:00.570
We have to fix this
thing, and so on.

00:23:00.570 --> 00:23:02.470
Everything's crazy.

00:23:02.470 --> 00:23:04.690
So it sends a command,
and it lowers that rate.

00:23:04.690 --> 00:23:06.650
You can watch the dial
there, down to 2 Hertz.

00:23:06.650 --> 00:23:08.358
Now, again does it
really get to 2 Hertz?

00:23:08.358 --> 00:23:10.220
Probably it might
get to two hertz.

00:23:10.220 --> 00:23:12.440
But I don't know,
because I wasn't there.

00:23:12.440 --> 00:23:13.170
And guess what?

00:23:13.170 --> 00:23:16.405
Stuxnet then goes back
to sleep for 27 days.

00:23:16.405 --> 00:23:18.280
So imagine there's this
ghost in the machine.

00:23:18.280 --> 00:23:20.220
And all of a sudden,
everything goes crazy.

00:23:20.220 --> 00:23:22.420
And then when you
start looking into it,

00:23:22.420 --> 00:23:24.970
everything goes back to normal,
and then you nothing happens,

00:23:24.970 --> 00:23:25.750
and you're waiting for it.

00:23:25.750 --> 00:23:27.680
And you're like, oh, there
must be some bug in our code.

00:23:27.680 --> 00:23:29.679
You look at the code, and
there's nothing wrong.

00:23:29.679 --> 00:23:32.230
And this is what's happening.

00:23:32.230 --> 00:23:34.780
Now, Stuxnet repeats this
process over and over and over.

00:23:34.780 --> 00:23:37.527
So God only knows how
many times it did this

00:23:37.527 --> 00:23:39.360
with uranium just simply
looking and saying,

00:23:39.360 --> 00:23:40.193
oh, what's going on?

00:23:40.193 --> 00:23:41.590
We don't know.

00:23:41.590 --> 00:23:42.940
OK.

00:23:42.940 --> 00:23:44.090
Now here's a question.

00:23:44.090 --> 00:23:47.910
Why would you push the
motors up to 1,410 Hertz?

00:23:47.910 --> 00:23:51.139
As it turns out, 1,380 Hertz
is a resonance frequency.

00:23:51.139 --> 00:23:53.430
Now, if you're not familiar
with a resonance frequency,

00:23:53.430 --> 00:23:56.120
sometimes when you're driving
down the road on a bumpy road,

00:23:56.120 --> 00:23:58.140
and the bumps are
sort of evenly spaced,

00:23:58.140 --> 00:24:01.390
and the car starts vibrating
[BUZZING NOISE] over time,

00:24:01.390 --> 00:24:02.840
that's a resonance frequency.

00:24:02.840 --> 00:24:05.030
And as you get into
a resonance frequency

00:24:05.030 --> 00:24:07.565
with uranium enrichment
tubes, guess what?

00:24:07.565 --> 00:24:09.940
They start vibrating, and they
start vibrating violently,

00:24:09.940 --> 00:24:11.550
and they will actually explode.

00:24:11.550 --> 00:24:12.770
I haven't tried this at home.

00:24:12.770 --> 00:24:13.936
But this is what we're told.

00:24:13.936 --> 00:24:18.040
So basically, 1,380 Hertz
is a resonance frequency

00:24:18.040 --> 00:24:20.210
that should cause
these tubes to explode.

00:24:20.210 --> 00:24:23.620
So even if they don't
reach 1,410 Hertz,

00:24:23.620 --> 00:24:26.010
if they get fast enough,
they could actually

00:24:26.010 --> 00:24:28.850
cause a lot of damage, just
because the vibrations become

00:24:28.850 --> 00:24:31.070
so, so strong.

00:24:31.070 --> 00:24:33.770
Now, why reduce the
motors to 2 Hertz?

00:24:33.770 --> 00:24:34.734
Anybody have an idea?

00:24:37.617 --> 00:24:38.700
Not a resonance frequency.

00:24:38.700 --> 00:24:40.130
It's just sort of like this.

00:24:40.130 --> 00:24:41.781
It's not really exciting.

00:24:41.781 --> 00:24:42.280
OK.

00:24:42.280 --> 00:24:45.786
So why would you reduce
the motors to 2 Hertz?

00:24:45.786 --> 00:24:46.285
What's that?

00:24:46.285 --> 00:24:47.430
AUDIENCE: [INAUDIBLE].

00:24:47.430 --> 00:24:49.180
CAREY NACHENBERG: Well,
the gas would mix,

00:24:49.180 --> 00:24:51.420
but it'll start spinning
again for 27 days,

00:24:51.420 --> 00:24:53.670
and it'll fix it up again.

00:24:57.747 --> 00:24:59.580
I heard something about
a preschool, but I--

00:24:59.580 --> 00:25:00.900
AUDIENCE: [INAUDIBLE].

00:25:00.900 --> 00:25:02.316
CAREY NACHENBERG:
Oh, [INAUDIBLE].

00:25:02.316 --> 00:25:04.480
Oh, well, that's interesting.

00:25:04.480 --> 00:25:05.510
Well, this is guess.

00:25:05.510 --> 00:25:08.790
We don't know, but I think
you're on the right track.

00:25:08.790 --> 00:25:10.509
So if you reduce it
to roughly 2 Hertz,

00:25:10.509 --> 00:25:12.050
you're going to be
going really slow.

00:25:12.050 --> 00:25:12.990
And if you think--
oops, hold on.

00:25:12.990 --> 00:25:14.740
And if you think about
a top, what happens

00:25:14.740 --> 00:25:16.830
when a top starts slowing down?

00:25:16.830 --> 00:25:18.396
It begins to wobble.

00:25:18.396 --> 00:25:21.020
So we think this would actually,
for prolonged periods of time,

00:25:21.020 --> 00:25:23.527
would cause the centrifuges
to wobble on their axes,

00:25:23.527 --> 00:25:25.110
and then basically
damage the bearings

00:25:25.110 --> 00:25:27.850
and damage the base
of the centrifuge.

00:25:27.850 --> 00:25:29.180
We don't know.

00:25:29.180 --> 00:25:31.770
But this is what Stuxnet did.

00:25:31.770 --> 00:25:34.190
OK.

00:25:34.190 --> 00:25:37.090
Now, you might say, what about
Iranian fail-safe systems?

00:25:37.090 --> 00:25:37.590
Right?

00:25:37.590 --> 00:25:39.270
In other words,
the Iranians must

00:25:39.270 --> 00:25:41.635
have been monitoring everything,
and all the red lights

00:25:41.635 --> 00:25:43.010
must have been
going off, and you

00:25:43.010 --> 00:25:46.320
have sirens going off when
the frequencies went too high.

00:25:46.320 --> 00:25:48.085
So surely by now,
you're thinking

00:25:48.085 --> 00:25:49.960
that the alarm bells
would have been ringing,

00:25:49.960 --> 00:25:51.350
and that somebody would
have come running in.

00:25:51.350 --> 00:25:54.150
It wouldn't have just been the
night guard who had seen this.

00:25:54.150 --> 00:25:56.680
So maybe Stuxnet pulled
a "Mission Impossible."

00:25:56.680 --> 00:25:58.430
You know, like "Mission
Impossible," where

00:25:58.430 --> 00:26:01.060
they put the fake video
up in front of the camera,

00:26:01.060 --> 00:26:03.944
so that basically, you couldn't
see what was really happening.

00:26:03.944 --> 00:26:05.360
Maybe you did
something like this,

00:26:05.360 --> 00:26:06.940
and you got the guy
falling down the stairs.

00:26:06.940 --> 00:26:09.010
And the guy monitoring it is
like, oh, nothing's happening.

00:26:09.010 --> 00:26:09.926
Everything looks fine.

00:26:09.926 --> 00:26:11.850
And meanwhile, the
guy's following.

00:26:11.850 --> 00:26:13.320
Maybe they did
that kind of thing.

00:26:13.320 --> 00:26:15.640
Wouldn't that be great
if Stuxnet did that.

00:26:15.640 --> 00:26:16.940
Well, guess what?

00:26:16.940 --> 00:26:19.850
That's what Stuxnet did.

00:26:19.850 --> 00:26:21.310
So it wasn't quite as exciting.

00:26:21.310 --> 00:26:22.768
It wasn't actually
recording video,

00:26:22.768 --> 00:26:25.390
because there was no video
involved in centrifuging.

00:26:25.390 --> 00:26:25.890
OK?

00:26:25.890 --> 00:26:28.630
But in fact, these facilities,
as we understand it,

00:26:28.630 --> 00:26:31.120
do have watchdog systems
that are watching

00:26:31.120 --> 00:26:34.870
to make sure the systems don't
go out of the right spin rates.

00:26:34.870 --> 00:26:36.750
And they trigger a
shut down supposedly

00:26:36.750 --> 00:26:38.980
if things go out of kilter.

00:26:38.980 --> 00:26:39.925
But worry not stuck.

00:26:39.925 --> 00:26:41.050
Stuxnet takes care of this.

00:26:41.050 --> 00:26:43.420
And how does it do it?

00:26:43.420 --> 00:26:46.900
Well, as I told you, Stuxnet
is recording telemetry

00:26:46.900 --> 00:26:50.090
as the centrifuges run,
normally for 13 days, right?

00:26:50.090 --> 00:26:51.870
So as these centrifuges
run, it's actually

00:26:51.870 --> 00:26:55.640
recording normal behavior
that normal telemetry that's

00:26:55.640 --> 00:26:57.810
coming up, and it stores it.

00:26:57.810 --> 00:26:58.310
OK.

00:26:58.310 --> 00:26:59.950
And as you can
see, that telemetry

00:26:59.950 --> 00:27:02.780
is also going back to
the Windows system.

00:27:02.780 --> 00:27:05.002
However, once Stuxnet
flips a switch

00:27:05.002 --> 00:27:06.710
and starts changing
the frequency to say,

00:27:06.710 --> 00:27:11.060
1,400 Hertz, as the bad data
is coming back, that says,

00:27:11.060 --> 00:27:13.490
hey, I'm spinning
at 1,380 Hertz,

00:27:13.490 --> 00:27:15.520
what Stuxnet sends to
the Windows computer

00:27:15.520 --> 00:27:19.640
is the original recorded data of
the original 1,000 Hertz speed.

00:27:19.640 --> 00:27:20.930
So watch the following.

00:27:20.930 --> 00:27:22.570
If you look at the
dial-- OK, if you

00:27:22.570 --> 00:27:24.260
look at the dial on
the screens, you'll

00:27:24.260 --> 00:27:26.595
notice the dial will be
at about 1,400 Hertz,

00:27:26.595 --> 00:27:27.970
because that's
where we're going.

00:27:27.970 --> 00:27:30.350
That's what's really happening
with these centrifuges.

00:27:30.350 --> 00:27:32.380
But if you look at the
dial on the Windows PC,

00:27:32.380 --> 00:27:34.710
which shows what the Windows
monitoring software thinks

00:27:34.710 --> 00:27:38.827
is happening, that's going
to be at still 1,000 Hertz.

00:27:38.827 --> 00:27:39.410
So watch this.

00:27:39.410 --> 00:27:42.410
So Stuxnet sends out the command
that says, spin really fast.

00:27:42.410 --> 00:27:45.020
You can see that things
start spinning really fast.

00:27:45.020 --> 00:27:47.500
However, Stuxnet's sending
back the green telemetry,

00:27:47.500 --> 00:27:50.020
the original telemetry, back
to the monitoring system,

00:27:50.020 --> 00:27:52.290
so it thinks that
nothing's wrong.

00:27:52.290 --> 00:27:54.910
So in fact, it will not
trigger any alarm bells.

00:27:54.910 --> 00:27:55.750
That's unbelievable.

00:27:55.750 --> 00:27:56.666
I mean, come on, guys.

00:27:56.666 --> 00:27:58.870
That's pretty impressive,
that it would do that.

00:27:58.870 --> 00:27:59.370
OK?

00:27:59.370 --> 00:28:01.030
But if gets more impressive.

00:28:01.030 --> 00:28:02.610
As it turns out,
Stuxnet actually

00:28:02.610 --> 00:28:04.190
disables the
emergency kill switch.

00:28:04.190 --> 00:28:05.780
[LAUGHING]

00:28:05.780 --> 00:28:08.930
So let's imagine that even
though the sirens are blaring,

00:28:08.930 --> 00:28:11.800
you say, hey, wait a second,
these things are spinning.

00:28:11.800 --> 00:28:13.881
They're like fast speed
at the laundromat.

00:28:13.881 --> 00:28:14.880
Something's going wrong.

00:28:14.880 --> 00:28:16.680
Maybe I should hit
that big red button.

00:28:16.680 --> 00:28:18.513
Well, as it turns out,
that big red button's

00:28:18.513 --> 00:28:21.592
connected to the PLC, but
it's connected digitally.

00:28:21.592 --> 00:28:23.550
There's a wire, but
there's also a digital sort

00:28:23.550 --> 00:28:25.970
of shut off that's connected
to that big red button.

00:28:25.970 --> 00:28:27.960
At least, this is as
we understand it--

00:28:27.960 --> 00:28:30.320
and it actually severs--
watch the little line there.

00:28:30.320 --> 00:28:31.900
It actually severs-- come on.

00:28:31.900 --> 00:28:32.430
Let's sever.

00:28:32.430 --> 00:28:33.070
Sever.

00:28:33.070 --> 00:28:33.360
OK.

00:28:33.360 --> 00:28:34.430
It severs that digitally.

00:28:34.430 --> 00:28:36.888
So you could hit that button
all you, playing whack-a-mole,

00:28:36.888 --> 00:28:40.580
and things aren't going to
stop spinning really fast.

00:28:40.580 --> 00:28:42.241
So, pretty impressive.

00:28:42.241 --> 00:28:42.740
OK.

00:28:42.740 --> 00:28:45.323
So they're hiding stuff with the
digital video camera sort of.

00:28:45.323 --> 00:28:47.690
They're severing
the kill switch.

00:28:47.690 --> 00:28:48.726
That's impressive.

00:28:48.726 --> 00:28:50.100
Like, I can't make
this stuff up.

00:28:50.100 --> 00:28:54.430
My book's not quite this
creative, but it's pretty good.

00:28:54.430 --> 00:28:59.490
So what's amazing, though,
is Stuxnet evaded detection

00:28:59.490 --> 00:29:00.501
for several years.

00:29:00.501 --> 00:29:01.000
Right?

00:29:01.000 --> 00:29:03.000
So it did all the things
we were talking about,

00:29:03.000 --> 00:29:04.240
all while evading detection.

00:29:04.240 --> 00:29:06.060
Now, how did it evade detection?

00:29:06.060 --> 00:29:09.395
Well, it uses five distinct
mechanisms to conceal itself,

00:29:09.395 --> 00:29:11.770
because one would not be
enough, two would not be enough.

00:29:11.770 --> 00:29:14.690
So let's just go for
five, because why not?

00:29:14.690 --> 00:29:17.840
So, number five Stuxnet
hides its own files

00:29:17.840 --> 00:29:21.180
on affected drives, thumb
drives, using two rootkits.

00:29:21.180 --> 00:29:23.134
It actually uses two
different root kits.

00:29:23.134 --> 00:29:25.300
Now, you may not be familiar
with what a rootkit is,

00:29:25.300 --> 00:29:26.900
but a rootkit is a
piece of software

00:29:26.900 --> 00:29:29.650
whose only purpose
is to basically hide

00:29:29.650 --> 00:29:31.510
other software in
a computer system.

00:29:31.510 --> 00:29:33.270
So the root kit is
typically a driver,

00:29:33.270 --> 00:29:35.228
although it doesn't always
need to be a driver,

00:29:35.228 --> 00:29:37.870
and it runs, and it
will monitor access

00:29:37.870 --> 00:29:41.070
as users use APIs to look
for files, like Find First,

00:29:41.070 --> 00:29:44.510
Find Next, to enumerate files
on a file system, and so on.

00:29:44.510 --> 00:29:47.070
And what Stuxnet will do is,
if it sees somebody trying

00:29:47.070 --> 00:29:48.582
to enumerate its
files, it will say,

00:29:48.582 --> 00:29:50.540
oh, these aren't the
droids you're looking for.

00:29:50.540 --> 00:29:51.650
There's no files here.

00:29:51.650 --> 00:29:53.230
It will actually hide the files.

00:29:53.230 --> 00:29:55.060
It uses two different rootkids.

00:29:55.060 --> 00:29:57.040
Now, let me show you what
this might look like.

00:29:57.040 --> 00:29:59.440
And it's actually
really interesting.

00:29:59.440 --> 00:30:03.360
So if you looked at a
Windows list of files,

00:30:03.360 --> 00:30:04.930
it might be difficult
for you to see,

00:30:04.930 --> 00:30:08.040
but you notice there are
three files on the bottom that

00:30:08.040 --> 00:30:09.150
are a little different.

00:30:09.150 --> 00:30:11.410
They're sort of with the
blue title bar there.

00:30:11.410 --> 00:30:14.020
Those might be your legitimate
files, the files you actually

00:30:14.020 --> 00:30:15.110
have on your thumb drive.

00:30:15.110 --> 00:30:15.340
OK?

00:30:15.340 --> 00:30:16.390
Those might be the
files you actually

00:30:16.390 --> 00:30:17.520
have on your thumb drive.

00:30:17.520 --> 00:30:20.830
The files on top, there's
a bunch of link files,

00:30:20.830 --> 00:30:23.100
if I'm not mistaken,
those link files

00:30:23.100 --> 00:30:24.900
are files that
are Stuxnet files.

00:30:24.900 --> 00:30:26.130
These are actually
the files that Stuxnet

00:30:26.130 --> 00:30:27.760
will put on the thumb
drive when it spreads.

00:30:27.760 --> 00:30:29.710
So it actually puts a number
of different files on the thumb

00:30:29.710 --> 00:30:30.420
drive.

00:30:30.420 --> 00:30:32.125
Now, the moment you
stick that thumb

00:30:32.125 --> 00:30:33.750
drive into a computer,
what will happen

00:30:33.750 --> 00:30:37.890
is Stuxnet's going to copy the
top six files onto that thumb.

00:30:37.890 --> 00:30:40.170
But if you look at this
thumb drive in Explorer,

00:30:40.170 --> 00:30:42.060
you sort of say, what's
on this thumb drive,

00:30:42.060 --> 00:30:43.660
at least on a Windows
computer, you're

00:30:43.660 --> 00:30:45.482
going to see just
your three files.

00:30:45.482 --> 00:30:46.940
In other words, it
will immediately

00:30:46.940 --> 00:30:51.710
run through an exploit, as we'll
tell you about, its rootkit.

00:30:51.710 --> 00:30:54.100
The rootkit will say, oh,
a thumb drive's installed.

00:30:54.100 --> 00:30:55.759
Oh, my files are
on the thumb drive.

00:30:55.759 --> 00:30:57.050
Oh, I'm going to hide my files.

00:30:57.050 --> 00:30:59.341
So all you'll see are the
three files that are supposed

00:30:59.341 --> 00:31:00.510
to be on your thumb drive.

00:31:00.510 --> 00:31:03.580
Now you might ask,
how is it actually

00:31:03.580 --> 00:31:06.690
causing a rootkit to run
the moment you stick a thumb

00:31:06.690 --> 00:31:07.932
drive in?

00:31:07.932 --> 00:31:09.890
So [INAUDIBLE] you could
stick this thumb drive

00:31:09.890 --> 00:31:11.973
in a computer that is not
yet infected by Stuxnet,

00:31:11.973 --> 00:31:13.465
and it will still
hide these files.

00:31:13.465 --> 00:31:15.110
Pretty good.

00:31:15.110 --> 00:31:16.500
So how does it do it?

00:31:16.500 --> 00:31:19.115
Well, as it turns
out, these link

00:31:19.115 --> 00:31:20.990
files at the top, which
are difficult to see,

00:31:20.990 --> 00:31:24.950
but they're up there-- there's
one called the Copy of Copy

00:31:24.950 --> 00:31:27.019
of Copy of Shortcut to Link.

00:31:27.019 --> 00:31:29.060
So if you're not familiar
with what link file is,

00:31:29.060 --> 00:31:31.640
a link file is a
file that you might

00:31:31.640 --> 00:31:33.610
put on your desktop,
which basically contains

00:31:33.610 --> 00:31:35.000
a location of an application.

00:31:35.000 --> 00:31:37.847
So it might be, for instance,
a link to Word for Windows.

00:31:37.847 --> 00:31:40.430
So when you double click on the
link, it runs Word for Windows

00:31:40.430 --> 00:31:42.347
in its home directory,
so it can run normally.

00:31:42.347 --> 00:31:44.971
It's basically a way of having
a shortcut to your applications.

00:31:44.971 --> 00:31:46.130
That's what a link file is.

00:31:46.130 --> 00:31:49.870
Now, as it turns out,
there was a vulnerability

00:31:49.870 --> 00:31:52.650
in Windows, a bug,
so if you format

00:31:52.650 --> 00:31:56.540
a link file a certain
way, basically, you

00:31:56.540 --> 00:31:59.440
will buffer overflow
Windows, and crash Windows,

00:31:59.440 --> 00:32:02.020
and cause your own
malicious software to run.

00:32:02.020 --> 00:32:04.210
So what Stuxnet did
was it put a link

00:32:04.210 --> 00:32:06.654
to file on this
thumb drive, along

00:32:06.654 --> 00:32:07.820
with its own malicious file.

00:32:07.820 --> 00:32:10.480
So in the temp files here,
you see that first file,

00:32:10.480 --> 00:32:13.145
Tilde WTR4132.10?

00:32:13.145 --> 00:32:15.317
That is a Stuxnet file,
as is the other temp file.

00:32:15.317 --> 00:32:17.650
Those are the actual binaries
and machine code and so on

00:32:17.650 --> 00:32:18.870
in Stuxnet.

00:32:18.870 --> 00:32:20.500
But let's take the
first link file,

00:32:20.500 --> 00:32:23.630
let's say, Copy of
Shortcut 2.link.

00:32:23.630 --> 00:32:26.410
That file, when let's say
Windows XP at the time

00:32:26.410 --> 00:32:29.340
would have parsed that file,
it would have had a buffer

00:32:29.340 --> 00:32:33.086
overflow, that link file
would have taken control,

00:32:33.086 --> 00:32:35.210
injected shell code, which
would have then launched

00:32:35.210 --> 00:32:37.460
Stuxnet, which would have
then started hiding itself.

00:32:37.460 --> 00:32:39.835
And then you would see these
files disappear immediately.

00:32:39.835 --> 00:32:41.040
OK?

00:32:41.040 --> 00:32:44.280
Now the question is, why would
there be multiple link files?

00:32:47.320 --> 00:32:49.222
Anybody?

00:32:49.222 --> 00:32:50.430
Different versions of the OS.

00:32:50.430 --> 00:32:51.305
That's exactly right.

00:32:51.305 --> 00:32:52.930
We have smart people here.

00:32:52.930 --> 00:32:53.460
Wonder why?

00:32:53.460 --> 00:32:55.370
It's Google, I guess.

00:32:55.370 --> 00:32:56.140
That's right.

00:32:56.140 --> 00:32:57.802
So basically, the
creators of Stuxnet

00:32:57.802 --> 00:32:59.260
knew that this was
going be running

00:32:59.260 --> 00:33:01.650
on Windows Vista, and
Windows XP, and Windows 7,

00:33:01.650 --> 00:33:04.830
and so on, and Windows
2003 Server, and so on.

00:33:04.830 --> 00:33:07.480
What they did was they
created a special link file

00:33:07.480 --> 00:33:11.430
so that as Windows opened
these link files, one of them

00:33:11.430 --> 00:33:13.292
would cause that
version of Windows

00:33:13.292 --> 00:33:15.000
to crash, because each
version of Windows

00:33:15.000 --> 00:33:16.650
crashed in a
different way and had

00:33:16.650 --> 00:33:19.150
to be exploited with a different
type of link file formatted

00:33:19.150 --> 00:33:20.670
in a different way.

00:33:20.670 --> 00:33:22.919
So basically, they included
a different version

00:33:22.919 --> 00:33:25.210
of the link file for every
different version of Windows

00:33:25.210 --> 00:33:25.950
they wanted to target.

00:33:25.950 --> 00:33:28.241
So whether you inserted this
thumb drive in Windows XP,

00:33:28.241 --> 00:33:31.140
Windows 7, Windows 2003 Server,
whatever it happened to be,

00:33:31.140 --> 00:33:33.490
boom, they would
immediately take control,

00:33:33.490 --> 00:33:35.960
and compromise that computer
with a different export.

00:33:35.960 --> 00:33:37.670
So they were prepared
for everything.

00:33:37.670 --> 00:33:38.170
OK.

00:33:38.170 --> 00:33:40.560
So that was the way
they hid themselves.

00:33:40.560 --> 00:33:43.610
That was one of the
two rootkits they used.

00:33:43.610 --> 00:33:45.380
Number four.

00:33:45.380 --> 00:33:47.634
Stuxnet inhibits
different behaviors

00:33:47.634 --> 00:33:49.550
in the presence of
different security products

00:33:49.550 --> 00:33:50.637
to avoid detection.

00:33:50.637 --> 00:33:51.720
So what do I mean by this?

00:33:51.720 --> 00:33:53.950
Well, it might try to
spread in a certain way,

00:33:53.950 --> 00:33:55.950
opening a certain type
of network connection up,

00:33:55.950 --> 00:33:58.030
that might trigger a
particular security program.

00:33:58.030 --> 00:33:58.640
Right?

00:33:58.640 --> 00:33:59.140
OK.

00:33:59.140 --> 00:34:01.440
So for instance, let's imagine
we had Symantec Endpoint

00:34:01.440 --> 00:34:01.960
Protection.

00:34:01.960 --> 00:34:04.830
That's our product, Symantec
Endpoint Protection.

00:34:04.830 --> 00:34:06.360
Maybe Kaspersky
Internet Security,

00:34:06.360 --> 00:34:08.510
McAfee Total Protection.

00:34:08.510 --> 00:34:10.239
That's three different
security products.

00:34:10.239 --> 00:34:12.355
As it turns out, actually,
at least our product

00:34:12.355 --> 00:34:14.479
and McAfee's product are
export-controlled to Iran,

00:34:14.479 --> 00:34:15.895
so they couldn't
even run in Iran.

00:34:15.895 --> 00:34:17.739
But I'm using it as an example.

00:34:17.739 --> 00:34:18.610
OK.

00:34:18.610 --> 00:34:20.644
So what Stuxnet will
do, maybe Stuxnet

00:34:20.644 --> 00:34:22.310
has four different
attacks it can launch

00:34:22.310 --> 00:34:23.780
or something, or four
different ways of spreading,

00:34:23.780 --> 00:34:25.280
although we learned
it was seven.

00:34:25.280 --> 00:34:26.870
But I'm showing you four.

00:34:26.870 --> 00:34:29.550
What Stuxnet might do is, in the
presence of Symantec Endpoint

00:34:29.550 --> 00:34:31.802
Protection, it might
basically eliminate

00:34:31.802 --> 00:34:33.760
two of the different
mechanisms from spreading,

00:34:33.760 --> 00:34:35.880
because it would know those
would trigger the security

00:34:35.880 --> 00:34:36.380
software.

00:34:36.380 --> 00:34:38.340
So it just won't even do them.

00:34:38.340 --> 00:34:40.139
And in the presence
of Kaspersky,

00:34:40.139 --> 00:34:42.550
it would eliminate
different behaviors entirely

00:34:42.550 --> 00:34:44.297
to prevent Kaspersky
from triggering.

00:34:44.297 --> 00:34:45.880
Now in the case for
McAfee, of course,

00:34:45.880 --> 00:34:47.500
it wouldn't have to eliminate
any behaviors at all,

00:34:47.500 --> 00:34:49.900
because they probably
couldn't detect it anyway.

00:34:49.900 --> 00:34:50.615
That was a joke.

00:34:50.615 --> 00:34:51.489
They're a competitor.

00:34:51.489 --> 00:34:52.850
I apologize.

00:34:52.850 --> 00:34:54.050
That was very inappropriate.

00:34:54.050 --> 00:34:56.612
I take that back.

00:34:56.612 --> 00:34:58.070
It might eliminate
other behaviors.

00:34:58.070 --> 00:35:00.090
That was very inappropriate.

00:35:00.090 --> 00:35:01.650
It's now called Intel Security.

00:35:01.650 --> 00:35:02.390
It's different.

00:35:02.390 --> 00:35:06.030
I'm sure it's
perfectly effective.

00:35:06.030 --> 00:35:06.870
OK.

00:35:06.870 --> 00:35:08.370
[LAUGHING]

00:35:08.370 --> 00:35:09.480
OK.

00:35:09.480 --> 00:35:10.420
So number three.

00:35:10.420 --> 00:35:13.270
Stuxnet completely deletes
itself from USB keys

00:35:13.270 --> 00:35:15.870
after it's spread to
exactly three systems.

00:35:15.870 --> 00:35:19.830
So Stuxnet keeps track of how
many systems it's spread to.

00:35:19.830 --> 00:35:23.110
And once it's infected three
different systems, guess what?

00:35:23.110 --> 00:35:25.152
It basically removes itself
from the thumb drive.

00:35:25.152 --> 00:35:26.859
So if you were to look
at the thumb drive

00:35:26.859 --> 00:35:28.610
on another machine,
or a Mac, or whatever,

00:35:28.610 --> 00:35:29.810
it will look entirely clean.

00:35:29.810 --> 00:35:31.200
Why did they choose three?

00:35:31.200 --> 00:35:32.200
Somebody's lucky number.

00:35:32.200 --> 00:35:33.340
I don't know.

00:35:33.340 --> 00:35:34.950
That's sort of interesting.

00:35:34.950 --> 00:35:38.290
Number two, Stuxnet's
authors digitally

00:35:38.290 --> 00:35:40.380
signed it with stolen
digital certificates

00:35:40.380 --> 00:35:42.190
to make it look
like it was created

00:35:42.190 --> 00:35:43.430
by well-known companies.

00:35:43.430 --> 00:35:44.130
Now, this is interesting.

00:35:44.130 --> 00:35:45.100
I don't know how
many people know what

00:35:45.100 --> 00:35:46.466
digital certificates are here.

00:35:46.466 --> 00:35:48.340
Probably in this audience,
many do, but maybe

00:35:48.340 --> 00:35:50.170
on the internet, of the
hundreds of thousands

00:35:50.170 --> 00:35:52.295
of people that are going
to watch this and then buy

00:35:52.295 --> 00:35:54.190
my book, let me tell you.

00:35:54.190 --> 00:35:57.635
So sometimes, you'll see little
holograms, little holograms

00:35:57.635 --> 00:35:58.510
on your credit cards.

00:35:58.510 --> 00:36:00.260
Those are stamps
of authenticity,

00:36:00.260 --> 00:36:02.800
and they help you identify--
or even on currency, right,

00:36:02.800 --> 00:36:04.508
you'll see these little
strips and so on.

00:36:04.508 --> 00:36:07.410
They help you identify
that it's not a fake.

00:36:07.410 --> 00:36:11.860
Well, a digital certificate is
a digital equivalent of that.

00:36:11.860 --> 00:36:15.000
And what you can do is
obtain a digital certificate

00:36:15.000 --> 00:36:17.530
from a certificate authority.

00:36:17.530 --> 00:36:21.536
And basically, what it is a
special cryptographic number

00:36:21.536 --> 00:36:23.410
that helps you stamp
your software that says,

00:36:23.410 --> 00:36:25.410
hey, this software
came from Microsoft,

00:36:25.410 --> 00:36:26.920
or this software
came from Symantec,

00:36:26.920 --> 00:36:28.520
or this software
came from Google.

00:36:28.520 --> 00:36:29.060
OK.

00:36:29.060 --> 00:36:31.020
And this is used to prove
that software has not

00:36:31.020 --> 00:36:31.982
been tampered with.

00:36:31.982 --> 00:36:33.690
You can stamp it, and
basically make sure

00:36:33.690 --> 00:36:35.420
that it can't be
changed, or it can

00:36:35.420 --> 00:36:37.070
be detected if it was changed.

00:36:37.070 --> 00:36:39.810
And so, lots of software that
runs on Windows computers

00:36:39.810 --> 00:36:42.380
is actually digitally signed.

00:36:42.380 --> 00:36:44.107
And that, again,
helps Windows identify

00:36:44.107 --> 00:36:46.190
that, oh, this actually
hasn't been tampered with.

00:36:46.190 --> 00:36:48.356
It's from a particular
company, and you can find out

00:36:48.356 --> 00:36:50.020
who that company is, and so on.

00:36:50.020 --> 00:36:54.102
So what Stuxnet did is they
signed their driver files

00:36:54.102 --> 00:36:56.060
with certificates from
two different companies,

00:36:56.060 --> 00:36:58.420
one of which was RealTek.

00:36:58.420 --> 00:37:01.449
Now, the two stolen certificates
were from RealTek and Jmicron.

00:37:01.449 --> 00:37:03.490
These are two companies
that are based in Taiwan.

00:37:03.490 --> 00:37:06.220
And as it turns out, they're
based in the same business

00:37:06.220 --> 00:37:06.720
park.

00:37:06.720 --> 00:37:09.590
They're about a kilometer away.

00:37:09.590 --> 00:37:13.082
So you wonder, do the guys
who stole these certificate,

00:37:13.082 --> 00:37:15.040
these basically digital
stamps of authenticity,

00:37:15.040 --> 00:37:17.480
which are normally kept in
vaults-- in other words,

00:37:17.480 --> 00:37:20.230
these things are very, very
valuable pieces of data,

00:37:20.230 --> 00:37:22.480
because you can use them to
make software look like it

00:37:22.480 --> 00:37:23.420
came from you.

00:37:23.420 --> 00:37:25.974
I mean, imagine if somebody
sold Microsoft certificates,

00:37:25.974 --> 00:37:27.390
and then made
software that looked

00:37:27.390 --> 00:37:29.260
like it's coming from Microsoft,
but it was actually malicious.

00:37:29.260 --> 00:37:30.421
That would be really bad.

00:37:30.421 --> 00:37:30.920
OK?

00:37:30.920 --> 00:37:32.060
That would call into
question the safety

00:37:32.060 --> 00:37:34.080
of all software from
Microsoft, for instance,

00:37:34.080 --> 00:37:36.470
or other companies.

00:37:36.470 --> 00:37:37.610
Don't choke.

00:37:37.610 --> 00:37:38.570
OK.

00:37:38.570 --> 00:37:39.241
I'm sorry.

00:37:39.241 --> 00:37:39.740
OK.

00:37:39.740 --> 00:37:41.750
It's OK.

00:37:41.750 --> 00:37:44.680
So these digital
stamps, if you will,

00:37:44.680 --> 00:37:46.360
are actually stored
typically in vaults,

00:37:46.360 --> 00:37:48.581
they're in HSMs, basically
hardware security modules

00:37:48.581 --> 00:37:49.080
or machines.

00:37:49.080 --> 00:37:50.680
They're very well-protected.

00:37:50.680 --> 00:37:54.060
So you wonder how the
people who built Stuxnet

00:37:54.060 --> 00:37:55.390
got these certificates.

00:37:55.390 --> 00:37:57.210
Maybe they did
something like that.

00:37:57.210 --> 00:37:59.580
I don't.

00:37:59.580 --> 00:38:02.540
But anyway, this didn't trigger
Windows, because Stuxnet

00:38:02.540 --> 00:38:05.260
basically was signed with
legitimate certificate

00:38:05.260 --> 00:38:06.690
stamps of authenticity
as if they

00:38:06.690 --> 00:38:08.870
came from legitimate
Taiwanese vendors.

00:38:11.400 --> 00:38:16.500
Number one, Stuxnet
conceals its malicious code,

00:38:16.500 --> 00:38:17.750
it's changes to the PLC.

00:38:17.750 --> 00:38:19.800
So as I told you,
Stuxnet injects itself

00:38:19.800 --> 00:38:21.570
onto that programmable
logic controller,

00:38:21.570 --> 00:38:24.470
that device that controls
the centrifuges, right?

00:38:24.470 --> 00:38:28.600
And again, it's doing so-- it's
actually not replacing code,

00:38:28.600 --> 00:38:30.890
it's actually integrating
with the original code.

00:38:30.890 --> 00:38:33.140
They actually knew what the
original code looked like,

00:38:33.140 --> 00:38:35.150
and they patched the PLC
code that was running

00:38:35.150 --> 00:38:37.680
the centrifuges on that PLC.

00:38:37.680 --> 00:38:38.180
OK.

00:38:38.180 --> 00:38:41.679
So what if an operator--
not an operator--

00:38:41.679 --> 00:38:43.720
a programmer wanted to
look and say, well, what's

00:38:43.720 --> 00:38:45.030
going on with our code?

00:38:45.030 --> 00:38:47.239
We better take a look at
the code running on the PLC,

00:38:47.239 --> 00:38:48.780
and make sure that
it hasn't changed.

00:38:48.780 --> 00:38:50.040
It hasn't been tampered with.

00:38:50.040 --> 00:38:52.890
Maybe there's somebody trying
to tamper with this code.

00:38:52.890 --> 00:38:57.020
So what Stuxnet they did
was is it actually concealed

00:38:57.020 --> 00:38:57.650
those changes.

00:38:57.650 --> 00:39:00.040
So if you were to pull those
changes off the PLC and say,

00:39:00.040 --> 00:39:01.660
tell me the active
state of the PLC.

00:39:01.660 --> 00:39:04.520
What instructions are running?

00:39:04.520 --> 00:39:06.190
What you would see
on the Windows screen

00:39:06.190 --> 00:39:09.190
was, during normal operations,
spin at 1,000 Hertz.

00:39:09.190 --> 00:39:11.109
And in case of
emergency, spin down.

00:39:11.109 --> 00:39:12.650
Which is exactly
what you should see.

00:39:12.650 --> 00:39:15.130
You'd see real instructions, The
machine language instructions.

00:39:15.130 --> 00:39:16.360
That's what you should see.

00:39:16.360 --> 00:39:18.090
But on the PLC, what
you would actually

00:39:18.090 --> 00:39:21.790
have would be during normal
operations spin at 1,400 Hertz.

00:39:21.790 --> 00:39:24.390
In the case of emergency,
ignore operator commands.

00:39:24.390 --> 00:39:28.940
So it actually, what it would do
is as-- on the Windows machine,

00:39:28.940 --> 00:39:31.470
as you would view the
instructions on the PLC,

00:39:31.470 --> 00:39:33.243
it would watch them
coming over the wire,

00:39:33.243 --> 00:39:37.350
intercept them before they
would be rendered on the screen,

00:39:37.350 --> 00:39:39.710
remove itself from the
original instructions,

00:39:39.710 --> 00:39:41.650
showing only the
original instructions.

00:39:41.650 --> 00:39:44.800
And if you were to replace
the instructions on the PLC

00:39:44.800 --> 00:39:46.300
with a new version
of the software

00:39:46.300 --> 00:39:47.510
that it could integrate
with, it would

00:39:47.510 --> 00:39:49.870
actually on the fly, as it
was being written to the PLC,

00:39:49.870 --> 00:39:52.380
reintegrate in.

00:39:52.380 --> 00:39:54.030
Pretty good.

00:39:54.030 --> 00:39:54.600
All right.

00:39:54.600 --> 00:39:57.775
So the question now is,
did Stuxnet succeed?

00:39:57.775 --> 00:39:59.650
Now, you know what it
did, and how it spread,

00:39:59.650 --> 00:40:01.240
and how it detected whether
it was on the right machines,

00:40:01.240 --> 00:40:02.156
and how it hid itself.

00:40:02.156 --> 00:40:03.490
It's pretty exciting.

00:40:03.490 --> 00:40:07.660
So based on some clever
engineering, and some basically

00:40:07.660 --> 00:40:09.660
deals with certain
people around the world,

00:40:09.660 --> 00:40:11.670
we have some really
interesting data.

00:40:11.670 --> 00:40:14.870
What we did was we found
out that Stuxnet contacts

00:40:14.870 --> 00:40:16.370
two different
command and control

00:40:16.370 --> 00:40:19.102
servers in order to get
commands from its masters.

00:40:19.102 --> 00:40:20.810
Now, what's a command
and control server?

00:40:20.810 --> 00:40:23.520
It's a computer on the
internet that a piece

00:40:23.520 --> 00:40:24.984
of malicious
software can contact,

00:40:24.984 --> 00:40:26.400
and that computer
and the internet

00:40:26.400 --> 00:40:27.860
is controlled by the attacker.

00:40:27.860 --> 00:40:29.920
So basically, the attacker
can put a new command saying,

00:40:29.920 --> 00:40:32.190
hey, do this, or update
yourself to this, or whatever.

00:40:32.190 --> 00:40:33.690
It's on the computer.

00:40:33.690 --> 00:40:37.107
And every copy of Stuxnet
will connect to that server

00:40:37.107 --> 00:40:38.190
and say, what should I do?

00:40:38.190 --> 00:40:38.850
Is there anything new?

00:40:38.850 --> 00:40:40.040
Should I update myself?

00:40:40.040 --> 00:40:42.320
Is there a command
you have for me?

00:40:42.320 --> 00:40:48.170
So those two servers were
located in Asia and in Europe.

00:40:48.170 --> 00:40:51.210
And one was called
www.todaysfootball.com.

00:40:51.210 --> 00:40:54.190
The other one was called
www.mypremierefootball.com.

00:40:54.190 --> 00:40:55.690
So these command
and control servers

00:40:55.690 --> 00:40:58.780
are running in
foreign ISP hardware.

00:40:58.780 --> 00:41:01.630
They're just running on
servers somewhere else.

00:41:01.630 --> 00:41:03.370
And working with domain
registrars, which

00:41:03.370 --> 00:41:06.830
are the guys that control
the www.symantec.com

00:41:06.830 --> 00:41:09.140
mapping to an IP address,
if that makes sense

00:41:09.140 --> 00:41:12.680
to you, what we
did was we rerouted

00:41:12.680 --> 00:41:16.660
all traffic going to these
two websites to Symantec.

00:41:16.660 --> 00:41:18.564
So every copy of
Stuxnet that was

00:41:18.564 --> 00:41:20.730
trying to go to those two
servers in Asia and Europe

00:41:20.730 --> 00:41:23.785
instead was redirected to
Symantec Corporation, world

00:41:23.785 --> 00:41:25.600
leaders in computer security.

00:41:25.600 --> 00:41:26.600
OK.

00:41:26.600 --> 00:41:28.600
Little plug there.

00:41:28.600 --> 00:41:30.860
Now, I'm really supposed
to be plugging my book,

00:41:30.860 --> 00:41:32.235
but I'm sure people
from Symantec

00:41:32.235 --> 00:41:33.401
will be watching this video.

00:41:33.401 --> 00:41:36.729
And If you really want to go and
help people around the world,

00:41:36.729 --> 00:41:39.270
and you don't want to just sell
ads, please come and join us.

00:41:39.270 --> 00:41:39.745
[LAUGHING]

00:41:39.745 --> 00:41:40.245
I'm sorry.

00:41:40.245 --> 00:41:41.324
I'm sorry.

00:41:41.324 --> 00:41:43.160
I'm sorry.

00:41:43.160 --> 00:41:44.030
I use your products.

00:41:44.030 --> 00:41:45.071
I'm very happy with them.

00:41:45.071 --> 00:41:45.851
OK, let's go.

00:41:45.851 --> 00:41:46.350
OK.

00:41:46.350 --> 00:41:49.860
So as Stuxnet spreads between
computers, as it turns out.

00:41:49.860 --> 00:41:52.110
So first of all, it contacts
these command and control

00:41:52.110 --> 00:41:53.960
servers.

00:41:53.960 --> 00:41:56.960
And we took control of these
command and control servers,

00:41:56.960 --> 00:41:59.180
so we actually could monitor
where every [INAUDIBLE]

00:41:59.180 --> 00:42:00.044
at Stuxnet was.

00:42:00.044 --> 00:42:02.460
The other point is that Stuxnet
spreads between computers.

00:42:02.460 --> 00:42:04.615
As it spreads, it
actually keeps a log.

00:42:04.615 --> 00:42:06.600
It actually keeps
a notch on its belt

00:42:06.600 --> 00:42:09.319
every time it visits a computer,
because maybe it wants to brag.

00:42:09.319 --> 00:42:09.860
I don't know.

00:42:09.860 --> 00:42:12.240
But anyway, it tracks every
computer it's ever been to,

00:42:12.240 --> 00:42:14.160
and we can look at
these logs in order

00:42:14.160 --> 00:42:15.630
to see exactly where it's been.

00:42:15.630 --> 00:42:17.950
Which IP addresses, which
machines, and so on.

00:42:17.950 --> 00:42:19.572
So what do I mean by well?

00:42:19.572 --> 00:42:21.530
Well, imagine we have a
bunch of machines here.

00:42:21.530 --> 00:42:24.432
As Stuxnet reaches a machine,
it will infect the machine,

00:42:24.432 --> 00:42:26.890
but it will also keep the IP
address of the machine it just

00:42:26.890 --> 00:42:27.730
attacked.

00:42:27.730 --> 00:42:30.120
And it will actually add that
to a log inside the threat.

00:42:30.120 --> 00:42:31.770
So the second copy of
the threat as it spreads

00:42:31.770 --> 00:42:33.145
to another computer
will actually

00:42:33.145 --> 00:42:35.040
have two items in
its log, and so on.

00:42:35.040 --> 00:42:38.680
And so, every copy
actually had a history

00:42:38.680 --> 00:42:39.930
of every machine it's been to.

00:42:39.930 --> 00:42:42.305
So this allows you to figure
out exactly who is impacted,

00:42:42.305 --> 00:42:44.040
where they were, and so on.

00:42:44.040 --> 00:42:46.530
And that actually also
helped us get information.

00:42:46.530 --> 00:42:50.290
So it has a visited list,
or a little notch system.

00:42:50.290 --> 00:42:50.790
OK.

00:42:50.790 --> 00:42:52.660
So based on this
information, we found

00:42:52.660 --> 00:42:55.520
that there were three
initial attack waves.

00:42:55.520 --> 00:42:57.090
There were, to my
knowledge, if I

00:42:57.090 --> 00:43:00.190
recall correctly, five
different victims that

00:43:00.190 --> 00:43:01.990
were attacked initially.

00:43:01.990 --> 00:43:05.150
That were the seed infections,
the generation zero infections.

00:43:05.150 --> 00:43:07.280
Now these five different
victims were not

00:43:07.280 --> 00:43:09.622
people involved in the
Iranian Enrichment Program

00:43:09.622 --> 00:43:10.330
to our knowledge.

00:43:10.330 --> 00:43:12.190
They were actually
subcontractors

00:43:12.190 --> 00:43:15.006
to the Iranian
military that actually

00:43:15.006 --> 00:43:16.380
worked with them
in order to help

00:43:16.380 --> 00:43:17.630
them install these systems.

00:43:17.630 --> 00:43:19.970
So whoever infected
them actually

00:43:19.970 --> 00:43:22.720
infected the contractors,
and then the contractors,

00:43:22.720 --> 00:43:25.007
either inadvertently or
intentionally, brought it in.

00:43:25.007 --> 00:43:26.090
And you can see the waves.

00:43:26.090 --> 00:43:28.423
You can also see the compile
time versus infection time,

00:43:28.423 --> 00:43:30.605
and you can see
that in some cases,

00:43:30.605 --> 00:43:32.230
these things were
released within hours

00:43:32.230 --> 00:43:33.354
of actually being compiled.

00:43:33.354 --> 00:43:35.960
In other cases, they sat on
them and actually held them

00:43:35.960 --> 00:43:36.749
for a long time.

00:43:36.749 --> 00:43:38.290
So when we say
infection time, that's

00:43:38.290 --> 00:43:40.080
a first discovery
of an infection.

00:43:40.080 --> 00:43:43.239
And you can see the
days to infect there.

00:43:43.239 --> 00:43:44.280
And here are some graphs.

00:43:44.280 --> 00:43:45.780
This is, again,
from the information

00:43:45.780 --> 00:43:48.190
where Stuxnet keeps a log
of every machine it visits.

00:43:48.190 --> 00:43:50.066
You can see every dot
is a Stuxnet infection.

00:43:50.066 --> 00:43:52.440
And you can see if there's a
connection between two dots,

00:43:52.440 --> 00:43:54.490
it means that one
machine was infected,

00:43:54.490 --> 00:43:57.702
and then the infection
spread to a second machine.

00:43:57.702 --> 00:43:59.910
And here's the geographic
distribution of infections,

00:43:59.910 --> 00:44:00.743
to give you an idea.

00:44:00.743 --> 00:44:04.150
Iran was primarily hit, but
Indonesia, India, and so on

00:44:04.150 --> 00:44:04.755
were also hit.

00:44:04.755 --> 00:44:06.770
Now this, again, doesn't mean
that it was actually disrupting

00:44:06.770 --> 00:44:08.620
their centrifuge programs,
because they almost certainly

00:44:08.620 --> 00:44:10.770
had different setups
for their enrichment

00:44:10.770 --> 00:44:12.210
in these other countries.

00:44:12.210 --> 00:44:13.730
But it certainly
actually visited

00:44:13.730 --> 00:44:15.690
computers in those countries.

00:44:15.690 --> 00:44:17.860
And here, we see distribution
of infected systems

00:44:17.860 --> 00:44:18.630
with SIEMENS software.

00:44:18.630 --> 00:44:19.445
So you can see,
these are systems

00:44:19.445 --> 00:44:22.004
that actually got to where it
said, oh, I'm getting close.

00:44:22.004 --> 00:44:23.420
I'm reporting back
that I actually

00:44:23.420 --> 00:44:24.587
found something interesting.

00:44:24.587 --> 00:44:26.128
Because it's telling
that she was all

00:44:26.128 --> 00:44:28.639
set up so that the masters of
Stuxnet would know, oh, maybe

00:44:28.639 --> 00:44:30.430
there are other things
we don't know about.

00:44:30.430 --> 00:44:33.700
Maybe this is spreading to
systems we didn't expect.

00:44:33.700 --> 00:44:34.200
OK.

00:44:34.200 --> 00:44:35.380
So did Stuxnet succeed?

00:44:35.380 --> 00:44:37.859
Well, indications are that
it did, at least partially.

00:44:37.859 --> 00:44:40.150
Symantec telemetry indicates
that rather than directly,

00:44:40.150 --> 00:44:41.941
as I told you, trying
to infiltrate Natanz,

00:44:41.941 --> 00:44:44.060
they did go through
subcontractors,

00:44:44.060 --> 00:44:45.310
industrial companies.

00:44:45.310 --> 00:44:48.007
And then they unknowingly
ferried the infections in.

00:44:48.007 --> 00:44:50.340
And the Institute for Science
and International Security

00:44:50.340 --> 00:44:52.540
writes that it's
increasingly accepted

00:44:52.540 --> 00:44:56.050
that in a 2009, early in
2010, Stuxnet destroyed

00:44:56.050 --> 00:44:58.560
around 1,000 centrifuges.

00:44:58.560 --> 00:45:00.660
[INAUDIBLE] about 9,000.

00:45:00.660 --> 00:45:03.100
And it probably caused them
a great deal disruption.

00:45:03.100 --> 00:45:04.330
In other words, you
would expect that they

00:45:04.330 --> 00:45:05.550
were trying to figure
out what was going on.

00:45:05.550 --> 00:45:06.690
Did they have moles?

00:45:06.690 --> 00:45:08.272
Did they have insiders?

00:45:08.272 --> 00:45:08.980
Were there spies?

00:45:08.980 --> 00:45:09.760
What was going on?

00:45:09.760 --> 00:45:13.410
So it may have actually
done a great deal of good.

00:45:13.410 --> 00:45:15.082
Now finally, who did it.

00:45:15.082 --> 00:45:16.540
You should probably
have some idea.

00:45:16.540 --> 00:45:18.998
You might have heard, but just
in case you haven't, there's

00:45:18.998 --> 00:45:20.420
some very interesting clues.

00:45:20.420 --> 00:45:23.100
First of all, as it turns out,
when Stuxnet affects a machine,

00:45:23.100 --> 00:45:25.010
it actually creates a
setting on the machine.

00:45:25.010 --> 00:45:26.790
Because one thing that
malware does is it

00:45:26.790 --> 00:45:28.760
doesn't want to
reinfect computers.

00:45:28.760 --> 00:45:30.220
If a malware file
is automatically

00:45:30.220 --> 00:45:31.720
spreading from
computer to computer,

00:45:31.720 --> 00:45:33.890
it might go from this
computer to this computer.

00:45:33.890 --> 00:45:34.980
But then once it gets
to this computer,

00:45:34.980 --> 00:45:36.190
it's going to go
back to this computer

00:45:36.190 --> 00:45:36.960
and back to this computer.

00:45:36.960 --> 00:45:37.960
It'll go back and forth.

00:45:37.960 --> 00:45:41.210
And you might have 100 copies
of the malware process running

00:45:41.210 --> 00:45:43.030
on a computer if you
don't check for that.

00:45:43.030 --> 00:45:45.470
So what Stuxnet does is the
moment it gets on a computer,

00:45:45.470 --> 00:45:48.111
it sets a setting
with this number.

00:45:48.111 --> 00:45:48.610
OK?

00:45:48.610 --> 00:45:51.110
And if this - is present,
then a new copy of Stuxnet

00:45:51.110 --> 00:45:54.047
will not run, because it knows,
oh, Stuxnet's already here.

00:45:54.047 --> 00:45:54.880
I don't want to run.

00:45:57.420 --> 00:45:59.420
Now as it turns out, if
you look up this number,

00:45:59.420 --> 00:46:01.503
and you're a conspiracy
theorist, what you'll find

00:46:01.503 --> 00:46:03.240
is on Wikipedia,
which we know always

00:46:03.240 --> 00:46:05.320
holds the truth, that
according to Wikipedia,

00:46:05.320 --> 00:46:10.130
on May 9, 1979, which
might be 19790509,

00:46:10.130 --> 00:46:13.180
Habib Elghanian was
executed by a firing squad

00:46:13.180 --> 00:46:15.780
in Tehran, sending shockwaves
through the closingly-knit

00:46:15.780 --> 00:46:17.561
Iranian Jewish community.

00:46:17.561 --> 00:46:19.686
He was the first Jew and
one of the first civilians

00:46:19.686 --> 00:46:21.810
to be executed by the
newly Islamic government.

00:46:21.810 --> 00:46:25.730
This prompted the mass exodus of
the once 100,000-member strong

00:46:25.730 --> 00:46:28.130
Jewish community of Iran,
which continues to this day.

00:46:28.130 --> 00:46:29.600
We don't know if
this is related,

00:46:29.600 --> 00:46:30.766
but it's certainly exciting.

00:46:30.766 --> 00:46:33.110
I've also heard people tell
me that that was a new moon.

00:46:33.110 --> 00:46:34.485
There's all kinds
of crazy things

00:46:34.485 --> 00:46:37.750
that might be associated.

00:46:37.750 --> 00:46:39.860
But there's
something else that's

00:46:39.860 --> 00:46:42.310
really interesting that
also leads us to believe

00:46:42.310 --> 00:46:44.690
that Israel might be involved.

00:46:44.690 --> 00:46:47.660
Now, as many of you know, when
you compile an executable file

00:46:47.660 --> 00:46:49.768
with Visual Studio,
Visual Studio

00:46:49.768 --> 00:46:51.226
will put a date
stamp in the header

00:46:51.226 --> 00:46:53.120
of the file, a date and
time stamp which says

00:46:53.120 --> 00:46:54.245
when the file was compiled.

00:46:54.245 --> 00:46:59.024
It was compiled January 5, 3:00
AM, whatever it happens to be.

00:46:59.024 --> 00:47:00.440
And we knew about
this date stamp.

00:47:00.440 --> 00:47:02.510
I've known about
this date stamp.

00:47:02.510 --> 00:47:05.200
I've been analyzing
Windows malware for years.

00:47:05.200 --> 00:47:08.230
But as it turns out, Visual
Studio-- and by the way,

00:47:08.230 --> 00:47:09.790
this date stamp is in GMT.

00:47:09.790 --> 00:47:12.690
It's in GMT, or
Greenwich Mean Time.

00:47:12.690 --> 00:47:18.290
As it turns out, Visual Studio
also insert a second date stamp

00:47:18.290 --> 00:47:21.280
into the file in a
different place in the file.

00:47:21.280 --> 00:47:23.250
I never knew this, but it does.

00:47:23.250 --> 00:47:25.990
And it inserts a second
date stamp and time stamp

00:47:25.990 --> 00:47:27.780
in local time.

00:47:27.780 --> 00:47:30.870
And what we found was
that on the sample,

00:47:30.870 --> 00:47:34.190
the sample had a
GMT of 4:31, and it

00:47:34.190 --> 00:47:39.597
had a local time 6:31, which
means two hours east of GMT.

00:47:39.597 --> 00:47:41.555
Now, if you can guess
all of the countries that

00:47:41.555 --> 00:47:44.100
are two hours east of GMT, I'll
tell you what it is, Jamaica.

00:47:44.100 --> 00:47:44.600
OK?

00:47:44.600 --> 00:47:48.560
Jamaica really was
responsible for Stuxnet.

00:47:48.560 --> 00:47:51.580
If you do the math,
this is GMT plus two,

00:47:51.580 --> 00:47:55.060
which happens to be the region
where Israel is located.

00:47:55.060 --> 00:47:56.482
Now as we now know,
I think we now

00:47:56.482 --> 00:47:57.940
have an idea that
this was actually

00:47:57.940 --> 00:48:00.549
a joint program between the
United States and Israel.

00:48:00.549 --> 00:48:02.090
But this is an
interesting indicator.

00:48:02.090 --> 00:48:04.050
It just shows you
that forensic analysis

00:48:04.050 --> 00:48:06.730
can reveal all kinds
of interesting things.

00:48:06.730 --> 00:48:09.770
So to conclude, and
then I'll take questions

00:48:09.770 --> 00:48:13.800
as long as you like, Stuxnet has
signaled the fundamental shift

00:48:13.800 --> 00:48:15.230
in the malware space.

00:48:15.230 --> 00:48:16.220
And I don't say this
because, again, there

00:48:16.220 --> 00:48:18.094
was some rocket science
or some fundamentally

00:48:18.094 --> 00:48:19.420
new alien technology.

00:48:19.420 --> 00:48:23.890
They showed that physical
systems can be disrupted

00:48:23.890 --> 00:48:27.230
by virtual components.

00:48:27.230 --> 00:48:29.539
Cyber warfare is feasible.

00:48:29.539 --> 00:48:31.080
And unfortunately,
the same technique

00:48:31.080 --> 00:48:34.800
can be used to attack other
physical and virtual systems.

00:48:34.800 --> 00:48:38.080
So this is just the beginning.

00:48:38.080 --> 00:48:40.220
We will probably
see more of this.

00:48:40.220 --> 00:48:42.234
The good thing is,
is that-- I don't

00:48:42.234 --> 00:48:43.900
know if it's good or
bad-- but espionage

00:48:43.900 --> 00:48:46.309
is far more likely than
actual physical disruption.

00:48:46.309 --> 00:48:47.850
Because physical
disruption is an act

00:48:47.850 --> 00:48:49.058
of war in some sense-- right?

00:48:49.058 --> 00:48:50.970
You're disrupting a system.

00:48:50.970 --> 00:48:51.910
You might cause death.

00:48:51.910 --> 00:48:53.050
You might cause all
kinds of problems,

00:48:53.050 --> 00:48:55.690
whereas espionage, which is
most of what happens today,

00:48:55.690 --> 00:48:56.660
just goes on.

00:48:56.660 --> 00:48:57.880
You don't really know
what was affected.

00:48:57.880 --> 00:48:59.255
You don't know
who really did it.

00:48:59.255 --> 00:49:01.440
So there's a lot
more espionage now,

00:49:01.440 --> 00:49:03.320
but we will see more,
almost certainly more,

00:49:03.320 --> 00:49:05.000
physical disruption
in the future.

00:49:05.000 --> 00:49:07.980
And that brings me to
my final, final topic.

00:49:07.980 --> 00:49:12.690
So if you want to find out
how Iran gets even, and tries

00:49:12.690 --> 00:49:14.815
to harm the United
States, consider

00:49:14.815 --> 00:49:16.339
reading my new techno thriller.

00:49:16.339 --> 00:49:17.380
There's a couple reviews.

00:49:17.380 --> 00:49:19.110
I'll just leave
them on the screen.

00:49:19.110 --> 00:49:21.234
Kirkus Reviews, by the way,
if you're not familiar,

00:49:21.234 --> 00:49:23.860
is a reviewing company
like Publisher's Weekly.

00:49:23.860 --> 00:49:25.417
It was a very nice review.

00:49:25.417 --> 00:49:26.750
I did have to pay them for that.

00:49:29.312 --> 00:49:31.020
I did have to bribe
the reviewer as well.

00:49:31.020 --> 00:49:32.077
I'm kidding.

00:49:32.077 --> 00:49:32.660
That's a joke.

00:49:32.660 --> 00:49:33.990
I didn't give any bribes.

00:49:33.990 --> 00:49:38.070
But anyway, our book has been
receiving a reasonable reviews.

00:49:38.070 --> 00:49:40.600
And as I said, I'm donating
all proceeds to charities.

00:49:40.600 --> 00:49:42.380
And if you found my
talk entertaining,

00:49:42.380 --> 00:49:43.840
the book is sort of like that.

00:49:43.840 --> 00:49:48.950
Sort of goofy, sort of exciting,
computers do get destroyed,

00:49:48.950 --> 00:49:49.860
people get destroyed.

00:49:49.860 --> 00:49:51.100
It's very exciting.

00:49:51.100 --> 00:49:54.082
And you'll help underserved
children and veterans.

00:49:54.082 --> 00:49:56.040
So find out more in on
florentinedeception.com.

00:49:56.040 --> 00:49:59.706
And now, I'll take questions.

00:49:59.706 --> 00:50:01.140
Thank you.

00:50:01.140 --> 00:50:03.052
[APPLAUSE]

00:50:06.844 --> 00:50:09.260
AUDIENCE:So I had two quick
questions about those details.

00:50:09.260 --> 00:50:12.360
You said that after
infecting three machines,

00:50:12.360 --> 00:50:14.954
Stuxnet wiped all trace
off the thumb drive?

00:50:14.954 --> 00:50:15.870
CAREY NACHENBERG: Yes.

00:50:15.870 --> 00:50:17.710
AUDIENCE: How did it
prevent reinfection

00:50:17.710 --> 00:50:20.294
when it got plugged into one of
the other two computers again?

00:50:20.294 --> 00:50:21.626
CAREY NACHENBERG: Good question.

00:50:21.626 --> 00:50:23.994
I am actually not aware of
how to prevent a reinfection.

00:50:23.994 --> 00:50:25.410
There's a couple
ways it could do.

00:50:25.410 --> 00:50:27.690
It could actually leave, for
instance, a little artifact

00:50:27.690 --> 00:50:29.231
in the directory
structure that would

00:50:29.231 --> 00:50:30.915
be basically an identifiable.

00:50:30.915 --> 00:50:32.040
But I'm not sure if it did.

00:50:32.040 --> 00:50:35.370
It may have been reinfected
on a subsequent insertion

00:50:35.370 --> 00:50:37.270
into another computer
that was infected.

00:50:37.270 --> 00:50:39.900
AUDIENCE: And when you
redirected traffic for command

00:50:39.900 --> 00:50:41.690
and control, did you
man in the middle,

00:50:41.690 --> 00:50:45.120
or did you completely disrupt
Stuxnet's command and control?

00:50:45.120 --> 00:50:46.620
CAREY NACHENBERG:
So, good question.

00:50:46.620 --> 00:50:49.480
So the question was, when we
redirected all the traffic

00:50:49.480 --> 00:50:51.640
from the thousands
of Stuxnet infections

00:50:51.640 --> 00:50:53.410
to their command
and control servers,

00:50:53.410 --> 00:50:55.540
we took control of the
servers, and we basically,

00:50:55.540 --> 00:50:57.081
obviously, did not
send any commands,

00:50:57.081 --> 00:50:59.580
and we basically
completely cut it off

00:50:59.580 --> 00:51:01.680
from its original
masters, whoever that was.

00:51:04.910 --> 00:51:05.779
AUDIENCE: Hi.

00:51:05.779 --> 00:51:08.070
I was kind of surprised to
hear that they were actually

00:51:08.070 --> 00:51:10.028
talking back to the
command and control center.

00:51:12.610 --> 00:51:15.050
I mean, they went
through so many efforts

00:51:15.050 --> 00:51:18.130
to not be discovered,
and then they just

00:51:18.130 --> 00:51:21.469
ping some random
server on the internet?

00:51:21.469 --> 00:51:22.010
I don't know.

00:51:22.010 --> 00:51:25.220
I guess my question is,
is that something common

00:51:25.220 --> 00:51:27.090
for these kind of things to do?

00:51:27.090 --> 00:51:28.006
CAREY NACHENBERG: Yes.

00:51:28.006 --> 00:51:31.769
Most or many threats will ping
command and control servers.

00:51:31.769 --> 00:51:33.560
Actually, lots of
threats will ping Google.

00:51:33.560 --> 00:51:34.910
And they do so just to
see if they actually

00:51:34.910 --> 00:51:36.284
have internet
connectivity first,

00:51:36.284 --> 00:51:38.760
because that's sort of
a very easy thing to do.

00:51:38.760 --> 00:51:40.850
So this is a typical approach.

00:51:40.850 --> 00:51:44.400
And if you look at
the typical company,

00:51:44.400 --> 00:51:46.900
typical large enterprise,
or small company,

00:51:46.900 --> 00:51:49.460
they have no idea what's going
on with on their network,

00:51:49.460 --> 00:51:50.950
and what connections are being
made, and what's legitimate,

00:51:50.950 --> 00:51:51.640
and what's not.

00:51:51.640 --> 00:51:53.890
So that type of
connection, first of all,

00:51:53.890 --> 00:51:55.570
would have been blocked in
an air-gapped network anyway,

00:51:55.570 --> 00:51:56.800
and it would have
never been seen.

00:51:56.800 --> 00:51:57.420
OK?

00:51:57.420 --> 00:51:59.545
Because nobody has the time
to look at all firewall

00:51:59.545 --> 00:52:00.290
log, and so on.

00:52:00.290 --> 00:52:02.040
And second of all, it
just would blend in

00:52:02.040 --> 00:52:03.914
with all the rest of
the traffic, because you

00:52:03.914 --> 00:52:05.899
have literally millions
of connections per day

00:52:05.899 --> 00:52:06.440
and per hour.

00:52:06.440 --> 00:52:09.057
AUDIENCE: Was the payload
in the case encrypted?

00:52:09.057 --> 00:52:10.140
Or was it just plain text?

00:52:10.140 --> 00:52:12.239
CAREY NACHENBERG: Was
the payload encrypted?

00:52:12.239 --> 00:52:13.030
I'm certain it was.

00:52:13.030 --> 00:52:14.071
I don't know the details.

00:52:14.071 --> 00:52:15.490
I'd have to find out.

00:52:15.490 --> 00:52:17.573
If yoU send me an email
afterwards, I'll tell you.

00:52:20.191 --> 00:52:22.270
AUDIENCE: Hi, thank
you for coming today.

00:52:22.270 --> 00:52:25.350
You mentioned, explain why
the frequencies were chosen,

00:52:25.350 --> 00:52:28.740
versus [INAUDIBLE].

00:52:28.740 --> 00:52:30.860
Do you have a theory of
why 13 days was chosen

00:52:30.860 --> 00:52:33.070
as the initial monitored
period, or 27 days

00:52:33.070 --> 00:52:34.907
was chosen as the
downtime to be normal?

00:52:34.907 --> 00:52:35.990
CAREY NACHENBERG: I don't.

00:52:35.990 --> 00:52:37.460
I don't have any theories.

00:52:37.460 --> 00:52:39.034
I could talk to our
team and find out

00:52:39.034 --> 00:52:40.450
if they have any
thoughts on that.

00:52:40.450 --> 00:52:43.750
But I haven't heard anything
about that, frankly.

00:52:43.750 --> 00:52:46.125
It may have been to just to
dispel any sort of suspicion,

00:52:46.125 --> 00:52:48.291
because oh, it must have
been a glitch or something.

00:52:48.291 --> 00:52:50.520
But I don't really know,
to be honest with you.

00:52:50.520 --> 00:52:53.430
I know the significance
of those days.

00:52:53.430 --> 00:52:54.580
Please?

00:52:54.580 --> 00:52:55.830
AUDIENCE: Two quick questions.

00:52:55.830 --> 00:52:59.970
First one, did you guys ever get
a hold of the actual executable

00:52:59.970 --> 00:53:02.300
program, or did you just
determine all this information

00:53:02.300 --> 00:53:05.327
from the command and
control interception?

00:53:05.327 --> 00:53:06.660
CAREY NACHENBERG: Good question.

00:53:06.660 --> 00:53:07.160
OK.

00:53:07.160 --> 00:53:09.795
So we actually obtained many
copies of the executable.

00:53:09.795 --> 00:53:11.795
Because remember, every
copy of the executable's

00:53:11.795 --> 00:53:13.370
a little different, because
they're all customized

00:53:13.370 --> 00:53:14.600
with where they visited.

00:53:14.600 --> 00:53:18.420
Our team reverse
engineered from basically

00:53:18.420 --> 00:53:23.280
down to every instruction we
could find, including reverse

00:53:23.280 --> 00:53:25.870
engineering the payload for the
TLC, which required us to go

00:53:25.870 --> 00:53:27.880
and reverse engineer the
machine language for the PLC,

00:53:27.880 --> 00:53:29.250
because that wasn't documented.

00:53:29.250 --> 00:53:34.677
So [INAUDIBLE] every
last bit, and I

00:53:34.677 --> 00:53:36.560
was going to say something else.

00:53:36.560 --> 00:53:39.340
One interesting thing
is once my colleagues,

00:53:39.340 --> 00:53:42.520
who work in our
anti-malware analysis lab

00:53:42.520 --> 00:53:44.570
realized what was
happening-- and it required,

00:53:44.570 --> 00:53:47.550
by the way-- we didn't discover
this the 1,400 Hertz thing

00:53:47.550 --> 00:53:48.429
right away.

00:53:48.429 --> 00:53:50.470
We actually had to post
a blog entry saying, hey,

00:53:50.470 --> 00:53:53.320
we found this malware.

00:53:53.320 --> 00:53:56.070
It's obviously doing
some modification

00:53:56.070 --> 00:53:57.710
of industrial control hardware.

00:53:57.710 --> 00:53:59.210
But we don't know
what it is, and we

00:53:59.210 --> 00:54:00.800
don't know what type of
system it's controlling,

00:54:00.800 --> 00:54:01.970
so we posted a blog.

00:54:01.970 --> 00:54:04.300
And somebody contacted
us and said, hey,

00:54:04.300 --> 00:54:06.350
by the way, that
number that you posted

00:54:06.350 --> 00:54:09.730
is actually the identification
of a frequency converter

00:54:09.730 --> 00:54:10.730
of this particular type.

00:54:10.730 --> 00:54:13.967
We looked it up, realized
that it was actually

00:54:13.967 --> 00:54:17.630
a centrifuge control
frequency converter.

00:54:17.630 --> 00:54:19.260
And then the next
day, my coworker

00:54:19.260 --> 00:54:21.203
started looking under
his car for bombs.

00:54:21.203 --> 00:54:21.990
[LAUGHING]

00:54:21.990 --> 00:54:22.580
I'm serious.

00:54:22.580 --> 00:54:24.760
I'm very serious.

00:54:24.760 --> 00:54:26.450
Yeah.

00:54:26.450 --> 00:54:28.150
AUDIENCE: Second question.

00:54:28.150 --> 00:54:31.200
What could have Iran done
to help prevent this attack?

00:54:31.200 --> 00:54:34.410
Or what are things--
I guess if Stuxnet

00:54:34.410 --> 00:54:36.180
went to all this
trouble to do this, what

00:54:36.180 --> 00:54:37.930
are some of the steps
that they could have

00:54:37.930 --> 00:54:41.890
done to further prevent it?

00:54:41.890 --> 00:54:44.420
CAREY NACHENBERG: So that's
a really good question.

00:54:44.420 --> 00:54:46.800
What I would say
is that it would

00:54:46.800 --> 00:54:48.740
be very difficult on
a Windows computer

00:54:48.740 --> 00:54:50.720
to prevent something
like this type of attack.

00:54:50.720 --> 00:54:53.691
You could run effectively what's
called white listing software.

00:54:53.691 --> 00:54:55.190
And what white
listing software does

00:54:55.190 --> 00:54:57.899
is it specifies that only the
following software can be run,

00:54:57.899 --> 00:54:59.940
and nothing else outside
of this list of software

00:54:59.940 --> 00:55:01.170
can be executed.

00:55:01.170 --> 00:55:01.800
OK.

00:55:01.800 --> 00:55:03.240
Not that I'm telling Iran
how to solve their problems,

00:55:03.240 --> 00:55:05.060
but that's what
corporations would do.

00:55:05.060 --> 00:55:09.067
That's a very difficult thing
to do, because on typical PCs,

00:55:09.067 --> 00:55:10.650
software's updating
itself constantly,

00:55:10.650 --> 00:55:12.160
you get new versions
of software.

00:55:12.160 --> 00:55:13.540
If that software's
not on the white list,

00:55:13.540 --> 00:55:14.980
then you end up having
a denial of service,

00:55:14.980 --> 00:55:17.050
and the software stops running,
because the white list says,

00:55:17.050 --> 00:55:19.520
oh, you're not on the white
list, and you'll be blocked.

00:55:19.520 --> 00:55:21.590
So it's very
difficult to do that.

00:55:21.590 --> 00:55:25.500
Ultimately, what you need
is a change in the platform.

00:55:25.500 --> 00:55:28.370
In other words, you need to
go to an Android or iOS model,

00:55:28.370 --> 00:55:30.530
where you have
containerization, software

00:55:30.530 --> 00:55:32.560
can't get out of its
little bubble, and so on.

00:55:32.560 --> 00:55:35.255
That's a much safer model than
the traditional Windows model.

00:55:35.255 --> 00:55:37.880
The problem is there's hundreds
of millions of Windows programs

00:55:37.880 --> 00:55:41.280
that assume no
containerization, and that

00:55:41.280 --> 00:55:42.420
are not vetted, and so on.

00:55:42.420 --> 00:55:44.507
So it's very, very
difficult to prevent this.

00:55:44.507 --> 00:55:45.340
AUDIENCE: Thank you.

00:55:45.340 --> 00:55:47.327
CAREY NACHENBERG:
You're welcome.

00:55:47.327 --> 00:55:48.910
AUDIENCE: Yeah, I
was wondering if you

00:55:48.910 --> 00:55:52.500
could speak to any
what you saw as maybe

00:55:52.500 --> 00:55:56.410
updates in the various
versions of Stuxnet.

00:55:56.410 --> 00:55:58.876
You said it was
self-updating, and maybe they

00:55:58.876 --> 00:56:00.750
changed-- I don't know
if you saw them change

00:56:00.750 --> 00:56:02.900
the configurations
they were targeting,

00:56:02.900 --> 00:56:04.082
or narrow down somehow?

00:56:04.082 --> 00:56:06.040
CAREY NACHENBERG: I'll
have to plead ignorance.

00:56:06.040 --> 00:56:08.844
Unfortunately, yes.

00:56:08.844 --> 00:56:10.260
AUDIENCE: Thanks
for a great talk.

00:56:10.260 --> 00:56:11.426
CAREY NACHENBERG: Thank you.

00:56:11.426 --> 00:56:14.100
AUDIENCE: Did the command and
control, were those owned,

00:56:14.100 --> 00:56:18.404
or the domain names were bought
by some like, [INAUDIBLE]?

00:56:18.404 --> 00:56:19.820
CAREY NACHENBERG:
My understanding

00:56:19.820 --> 00:56:23.687
is that they were
basically provisioned just

00:56:23.687 --> 00:56:25.270
for this purpose,
is my understanding.

00:56:25.270 --> 00:56:25.960
They were not owned.

00:56:25.960 --> 00:56:28.001
In other words, they were
not legitimate websites

00:56:28.001 --> 00:56:29.987
that were compromised
in order to do this.

00:56:29.987 --> 00:56:32.570
AUDIENCE: But we couldn't figure
out who purchased the domains

00:56:32.570 --> 00:56:33.361
and work that back?

00:56:34.799 --> 00:56:36.340
CAREY NACHENBERG:
I remember hearing,

00:56:36.340 --> 00:56:37.930
but I don't remember
the details.

00:56:37.930 --> 00:56:39.170
I don't remember exactly
how they were registered.

00:56:39.170 --> 00:56:41.370
Obviously, they were
not registered to Joe

00:56:41.370 --> 00:56:42.850
in Israel or something.

00:56:42.850 --> 00:56:44.810
[LAUGHING]

00:56:46.770 --> 00:56:48.520
AUDIENCE: If the
target machines were

00:56:48.520 --> 00:56:50.690
it not connected directly
to the internet, how

00:56:50.690 --> 00:56:52.060
did they phone home?

00:56:52.060 --> 00:56:52.740
CAREY NACHENBERG:
So in those cases,

00:56:52.740 --> 00:56:53.960
they would not phone home.

00:56:53.960 --> 00:56:55.418
And what would have
to happen would

00:56:55.418 --> 00:56:58.500
be that, for instance,
the research network,

00:56:58.500 --> 00:57:00.580
you might get a new version
that did phone home,

00:57:00.580 --> 00:57:03.522
get a new infection, and
then, for instance, even

00:57:03.522 --> 00:57:04.480
affect the thumb drive.

00:57:04.480 --> 00:57:05.960
You bring that thumb drive in.

00:57:05.960 --> 00:57:08.130
2.0, version 2.0 of the
threat would override

00:57:08.130 --> 00:57:09.140
version 1.0, and so on.

00:57:09.140 --> 00:57:10.640
But yeah, in the
air-gapped network,

00:57:10.640 --> 00:57:11.848
there would be no phone home.

00:57:11.848 --> 00:57:14.098
AUDIENCE: So the phone home
was to upgrade the version

00:57:14.098 --> 00:57:15.014
CAREY NACHENBERG: Yes.

00:57:15.014 --> 00:57:15.932
To upgrade versions.

00:57:15.932 --> 00:57:17.140
Also, to send telemetry back.

00:57:17.140 --> 00:57:18.070
In other words, are you running?

00:57:18.070 --> 00:57:19.050
Where are you running?

00:57:19.050 --> 00:57:21.610
Are you running on a machine
that's running STEP7 software?

00:57:21.610 --> 00:57:23.940
So it's giving visibility
as much as it's taking--

00:57:23.940 --> 00:57:25.190
AUDIENCE: But if it
was running a machine--

00:57:25.190 --> 00:57:26.481
CAREY NACHENBERG: Say it again.

00:57:26.481 --> 00:57:28.960
AUDIENCE: If it was running on
its target machine, that's--

00:57:28.960 --> 00:57:29.810
CAREY NACHENBERG: Then
it could not talk back.

00:57:29.810 --> 00:57:30.580
That's right.

00:57:30.580 --> 00:57:31.200
AUDIENCE: But that's the only--

00:57:31.200 --> 00:57:32.880
CAREY NACHENBERG:
No, because remember,

00:57:32.880 --> 00:57:35.910
when you're building centrifuge
software that runs centrifuges,

00:57:35.910 --> 00:57:37.910
you're not doing it right
next to the centrifuge

00:57:37.910 --> 00:57:38.750
here necessarily.

00:57:38.750 --> 00:57:39.930
You're building it in a lab.

00:57:39.930 --> 00:57:41.162
You're writing your code.

00:57:41.162 --> 00:57:42.870
You might have a test
system or whatever,

00:57:42.870 --> 00:57:45.840
and then you're bringing
that into the enrichment.

00:57:45.840 --> 00:57:48.106
So these systems on
the research network,

00:57:48.106 --> 00:57:49.480
where they were
doing the coding,

00:57:49.480 --> 00:57:51.470
we believe were
connected to internet.

00:57:56.960 --> 00:57:59.050
AUDIENCE: So how did
Symantec get involved

00:57:59.050 --> 00:58:01.086
in researching Stuxnet?

00:58:01.086 --> 00:58:02.460
Did it just come
through one day.

00:58:02.460 --> 00:58:04.136
Hello, you've got another virus.

00:58:04.136 --> 00:58:05.510
CAREY NACHENBERG:
Great question.

00:58:05.510 --> 00:58:07.676
So how did we get involved
with researching Stuxnet?

00:58:07.676 --> 00:58:09.600
So it's actually
a two-part answer.

00:58:09.600 --> 00:58:12.650
The first part is
that we received

00:58:12.650 --> 00:58:14.890
a copy of Stuxnet
months, if not maybe

00:58:14.890 --> 00:58:19.510
a year, earlier than when we
started actually analyzing it.

00:58:19.510 --> 00:58:23.860
We have 99.9% of
malware analysis

00:58:23.860 --> 00:58:26.370
is done via automated systems.

00:58:26.370 --> 00:58:29.321
So Stuxnet came in
from some customer.

00:58:29.321 --> 00:58:30.320
I don't know who it was.

00:58:30.320 --> 00:58:31.028
I don't remember.

00:58:31.028 --> 00:58:33.410
We could find out, but
I can't tell you anyway.

00:58:33.410 --> 00:58:36.782
Came in him from customer, and
our automated analysis system

00:58:36.782 --> 00:58:38.865
said, oh, this is definitely
some type of malware,

00:58:38.865 --> 00:58:41.270
and we fingerprinted that
version that we found.

00:58:41.270 --> 00:58:41.849
OK?

00:58:41.849 --> 00:58:44.140
We had protection for at
least some variant of Stuxnet,

00:58:44.140 --> 00:58:46.020
I don't know, six
months, a year, earlier.

00:58:46.020 --> 00:58:46.519
OK?

00:58:46.519 --> 00:58:48.379
But we didn't know what it was.

00:58:48.379 --> 00:58:50.670
And by the way, there are
multiple variants, and so on,

00:58:50.670 --> 00:58:52.940
so that was just
one of the variants.

00:58:52.940 --> 00:58:55.220
Fast forward to six
months a year later,

00:58:55.220 --> 00:58:56.842
somebody contacted
us, because they

00:58:56.842 --> 00:58:58.550
had noticed-- they
had done some analysis

00:58:58.550 --> 00:59:01.100
and noticed that this used
a day zero vulnerability.

00:59:01.100 --> 00:59:02.780
It exploited a day
zero vulnerability.

00:59:02.780 --> 00:59:04.280
And they said, hey,
this is unusual.

00:59:04.280 --> 00:59:05.810
Because when we
see that, we know

00:59:05.810 --> 00:59:08.300
there's nation state or
organized crime involved.

00:59:08.300 --> 00:59:10.380
It's not something regular.

00:59:10.380 --> 00:59:11.782
And then we started
analyzing it.

00:59:11.782 --> 00:59:13.365
We pulled up the
sample, which we had,

00:59:13.365 --> 00:59:14.730
and we said, oh, we
fingerprint for that.

00:59:14.730 --> 00:59:15.320
Let's look at it.

00:59:15.320 --> 00:59:17.653
We looked at the samples, and
we realized that, in fact,

00:59:17.653 --> 00:59:20.940
this was far more, and it was
months of time of analysis

00:59:20.940 --> 00:59:24.220
to then realize what it was.

00:59:24.220 --> 00:59:25.327
So really, two ways.

00:59:25.327 --> 00:59:26.160
AUDIENCE: Thank you.

00:59:30.100 --> 00:59:34.070
AUDIENCE: So given that this
was capable of being infected

00:59:34.070 --> 00:59:36.210
on something so
sensitive, and that we

00:59:36.210 --> 00:59:39.460
have lots of similar technology,
like controlling probably

00:59:39.460 --> 00:59:42.120
very important things
in our own country,

00:59:42.120 --> 00:59:44.210
in the grand scheme of
things, how screwed are

00:59:44.210 --> 00:59:48.370
with the current
state of ability

00:59:48.370 --> 00:59:51.220
to manipulate physical
devices, or maybe

00:59:51.220 --> 00:59:56.580
even like military devices
using this type of attack?

00:59:56.580 --> 00:59:58.300
CAREY NACHENBERG:
Tesla's [INAUDIBLE].

00:59:58.300 --> 00:59:59.270
OK.

00:59:59.270 --> 01:00:02.320
That's a good question.

01:00:02.320 --> 01:00:07.880
So what I would say is
that, again, it's fortunate

01:00:07.880 --> 01:00:10.760
that cyber warfare-- actually,
sort of kinetic modifications

01:00:10.760 --> 01:00:12.630
through software--
are rare, because they

01:00:12.630 --> 01:00:16.080
are perceived as acts of war.

01:00:16.080 --> 01:00:18.322
Because if you talk
any security expert,

01:00:18.322 --> 01:00:20.780
they can tell you five different
ways that you could really

01:00:20.780 --> 01:00:21.530
cause destruction.

01:00:21.530 --> 01:00:23.400
If you read my novel,
what you'll find out

01:00:23.400 --> 01:00:28.900
is-- "The Florentine Deception,"
available in all major formats.

01:00:28.900 --> 01:00:32.120
In my novel, I actually
propose a mechanism, which

01:00:32.120 --> 01:00:36.460
is entirely feasible, that
would potentially take out

01:00:36.460 --> 01:00:40.180
the entire hardware
infrastructure of the United

01:00:40.180 --> 01:00:42.929
States, or any country that
would want to be targeted.

01:00:42.929 --> 01:00:43.970
Permanent damage to that.

01:00:43.970 --> 01:00:45.566
You literally would have to
replace the motherboards and so

01:00:45.566 --> 01:00:46.066
on.

01:00:46.066 --> 01:00:46.600
OK.

01:00:46.600 --> 01:00:48.837
So it's totally feasible.

01:00:48.837 --> 01:00:51.170
And I don't think we're seeing
it, because we would then

01:00:51.170 --> 01:00:53.820
go and have a major military
intervention, and the people

01:00:53.820 --> 01:00:56.420
who did that would
be in real trouble.

01:00:56.420 --> 01:00:58.830
So there's no
technological reason

01:00:58.830 --> 01:01:01.508
why we haven't seen
this, I would say.

01:01:01.508 --> 01:01:02.420
AUDIENCE: Thank you.

01:01:02.420 --> 01:01:04.079
CAREY NACHENBERG: Yeah.

01:01:04.079 --> 01:01:04.620
AUDIENCE: Hi.

01:01:04.620 --> 01:01:05.930
It's me again.

01:01:05.930 --> 01:01:07.910
So you said you
redirected the traffic

01:01:07.910 --> 01:01:09.830
from the command and control.

01:01:09.830 --> 01:01:12.400
You kind of glossed over--
was that a DNS hijack,

01:01:12.400 --> 01:01:13.400
or was that a--

01:01:13.400 --> 01:01:15.358
CAREY NACHENBERG: So we
went to the Registrars.

01:01:15.358 --> 01:01:17.750
The Registrar is a company
that actually basically takes

01:01:17.750 --> 01:01:19.710
a website name like
myfootball.com,

01:01:19.710 --> 01:01:22.630
mypremierefootball.com,
and associates with an IP

01:01:22.630 --> 01:01:23.755
address on the internet OK.

01:01:23.755 --> 01:01:25.546
And this is just for
the people in audience

01:01:25.546 --> 01:01:26.490
who don't know this.

01:01:26.490 --> 01:01:28.010
And so, what we did was
he said, hey, Registrar,

01:01:28.010 --> 01:01:30.415
we know that this server,
myfootball.com, this IP address

01:01:30.415 --> 01:01:31.450
is bad.

01:01:31.450 --> 01:01:33.840
So we said, take that
domain, myfootball.com,

01:01:33.840 --> 01:01:36.710
or mypremierefootball.com,
and to instead of this IP

01:01:36.710 --> 01:01:39.499
address on the server, send
it to Symantec over here.

01:01:39.499 --> 01:01:40.040
AUDIENCE: OK.

01:01:40.040 --> 01:01:44.770
So the next question is,
who authorized Symantec

01:01:44.770 --> 01:01:48.090
specifically to be able
to [INAUDIBLE] DNS?

01:01:48.090 --> 01:01:50.467
CAREY NACHENBERG: We
talked to the Registrar,

01:01:50.467 --> 01:01:52.800
so the Registrar made the
decision based on the evidence

01:01:52.800 --> 01:01:53.716
that we provided them.

01:01:53.716 --> 01:01:56.611
That was their decision to give
us that command and control

01:01:56.611 --> 01:01:57.110
traffic.

01:02:04.012 --> 01:02:05.195
Please?

01:02:05.195 --> 01:02:06.570
AUDIENCE: You
mentioned that when

01:02:06.570 --> 01:02:10.300
you see a day zero, like
a sophisticated day zero

01:02:10.300 --> 01:02:14.080
vulnerability as part
of a malware packet,

01:02:14.080 --> 01:02:18.060
that you assume it's
nation state or military.

01:02:18.060 --> 01:02:21.260
When you saw Stuxnet and
realized it was there,

01:02:21.260 --> 01:02:25.170
are there like, folks in the US
security structure that you go

01:02:25.170 --> 01:02:29.570
talk to think about
maybe, you shouldn't

01:02:29.570 --> 01:02:32.027
be looking at it further,
or spreading it differently?

01:02:32.027 --> 01:02:34.110
CAREY NACHENBERG: So it's
an interesting question.

01:02:34.110 --> 01:02:36.443
In other words, the question
is more generally, I think,

01:02:36.443 --> 01:02:38.070
what is our role?

01:02:38.070 --> 01:02:40.530
Is our role to defend any
particular nation state,

01:02:40.530 --> 01:02:43.150
or make sure that we sort
of turn the other way?

01:02:43.150 --> 01:02:44.790
First of all,
attribution is extremely

01:02:44.790 --> 01:02:45.956
difficult with these things.

01:02:45.956 --> 01:02:49.830
It's impossible to know
who built what and how.

01:02:49.830 --> 01:02:53.220
In fact, today, we still don't
really know that for sure.

01:02:53.220 --> 01:02:56.210
The way we look at it is, we
will protect our customers

01:02:56.210 --> 01:02:58.290
no matter what country
they're in a matter,

01:02:58.290 --> 01:02:59.810
no matter what
nationality they are.

01:02:59.810 --> 01:03:01.226
We will protect
them from threats.

01:03:01.226 --> 01:03:03.364
And so, we don't
go and say, hey,

01:03:03.364 --> 01:03:05.030
do you think we detect
this, government?

01:03:05.030 --> 01:03:06.640
We just say, look,
this is a threat.

01:03:06.640 --> 01:03:08.890
We're gong to build protection
for it and do our best.

01:03:08.890 --> 01:03:10.670
That's just the way we operate.

01:03:10.670 --> 01:03:13.900
And frankly, if that happens
to damage a particular nation

01:03:13.900 --> 01:03:15.954
state or not that's par
for the course for them.

01:03:15.954 --> 01:03:17.370
They got to deal
with that anyway.

01:03:17.370 --> 01:03:18.870
And as you saw,
they took mechanisms

01:03:18.870 --> 01:03:20.850
to try to evade
security software.

01:03:20.850 --> 01:03:23.900
And by the way, there are
many security products.

01:03:23.900 --> 01:03:25.400
If we were to say,
hey, we're going

01:03:25.400 --> 01:03:27.316
to go and sort of turn
our head the other way,

01:03:27.316 --> 01:03:29.690
people would choose
other products.

01:03:29.690 --> 01:03:32.120
So we basically protect our
customers wherever they are.

01:03:32.120 --> 01:03:33.950
And of course, we're
export-controlled to Iran,

01:03:33.950 --> 01:03:36.130
as I said, so we wouldn't have
worried about Iran anyway,

01:03:36.130 --> 01:03:36.796
as it turns out.

01:03:41.241 --> 01:03:41.740
OK.

01:03:41.740 --> 01:03:42.980
We'll, I'll be staying
for lunch, so if you

01:03:42.980 --> 01:03:44.188
want to ask another question.

01:03:44.188 --> 01:03:46.930
[APPLAUSE]

