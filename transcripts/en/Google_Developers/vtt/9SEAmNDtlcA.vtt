WEBVTT
Kind: captions
Language: en

00:00:08.050 --> 00:00:08.930
IKAI LAN: Hi, everybody.

00:00:08.930 --> 00:00:10.620
Welcome to a very special
edition of

00:00:10.620 --> 00:00:13.100
Google Developers Live.

00:00:13.100 --> 00:00:14.470
My name is Ikai Lan.

00:00:14.470 --> 00:00:15.620
ARUN NAGARAJAN: Arun
Nagarajan here.

00:00:15.620 --> 00:00:17.240
IKAI LAN: And today we're going
to be talking about how

00:00:17.240 --> 00:00:19.810
to integrate Google Apps
with Salesforce

00:00:19.810 --> 00:00:21.230
using Google Apps Script.

00:00:21.230 --> 00:00:23.910
And when I say we, I mean Arun's
going to be doing this

00:00:23.910 --> 00:00:26.570
and I'm going to be following
along just explaining things

00:00:26.570 --> 00:00:27.360
about Apps Script.

00:00:27.360 --> 00:00:30.220
Because I don't know very much
about the Salesforce API at

00:00:30.220 --> 00:00:32.450
all, whereas Arun knows a lot.

00:00:32.450 --> 00:00:33.120
ARUN NAGARAJAN: All
right, yeah.

00:00:33.120 --> 00:00:35.410
So actually, one of the things
that I realized this morning

00:00:35.410 --> 00:00:37.680
was that the very first time
that I worked with

00:00:37.680 --> 00:00:40.950
salesforce.com was in 2006.

00:00:40.950 --> 00:00:43.830
Yeah, which is decades
ago in tech.

00:00:43.830 --> 00:00:46.610
And it was back when we were
building some mobile

00:00:46.610 --> 00:00:48.700
applications, and we had
to tap into the API.

00:00:48.700 --> 00:00:51.990
And all they had was a fairly
early-on version

00:00:51.990 --> 00:00:53.860
of their SOAP API.

00:00:53.860 --> 00:00:55.690
So I was very happy to
know that things

00:00:55.690 --> 00:00:57.090
have come a long way.

00:00:57.090 --> 00:01:00.280
It's much more robust, much
more secure, very easy to

00:01:00.280 --> 00:01:01.390
connect to.

00:01:01.390 --> 00:01:03.440
And it's always been
cloud-based.

00:01:03.440 --> 00:01:07.510
So it's a great fit for Google
Apps in general to exchange

00:01:07.510 --> 00:01:09.850
data, documents,
spreadsheet-type

00:01:09.850 --> 00:01:11.810
data, things like that.

00:01:11.810 --> 00:01:14.840
And before we kind of dive into
the API aspect of things,

00:01:14.840 --> 00:01:17.300
maybe for yourself and the other
viewers that are out

00:01:17.300 --> 00:01:20.570
there, maybe I'll just give a
very quick overview of what

00:01:20.570 --> 00:01:22.750
Salesforce is.

00:01:22.750 --> 00:01:24.120
IKAI LAN: What is Salesforce,
Arun?

00:01:24.120 --> 00:01:26.190
ARUN NAGARAJAN: Exactly, ask
me the question, right?

00:01:26.190 --> 00:01:28.690
IKAI LAN: What is it?

00:01:28.690 --> 00:01:30.430
ARUN NAGARAJAN: Salesforce.com
is a CRM system.

00:01:30.430 --> 00:01:32.020
So there are many like it.

00:01:32.020 --> 00:01:35.050
Oracle, Microsoft-- a lot of
these vendors have their own

00:01:35.050 --> 00:01:37.760
CRM systems that are
on the cloud.

00:01:37.760 --> 00:01:38.100
IKAI LAN: And a CRM
system is--

00:01:38.100 --> 00:01:39.920
ARUN NAGARAJAN: A CRM system
stands for Customer

00:01:39.920 --> 00:01:41.500
Relationship Management.

00:01:41.500 --> 00:01:45.120
It allows you to track contacts
with your customers--

00:01:45.120 --> 00:01:46.790
for sales, for service--

00:01:46.790 --> 00:01:49.650
and it allows you to track
accounts and contacts and

00:01:49.650 --> 00:01:51.060
opportunities against them.

00:01:51.060 --> 00:01:53.150
Opportunities are things
like deals.

00:01:53.150 --> 00:01:54.230
So you may want to know--

00:01:54.230 --> 00:01:56.600
I started to market
to this customer.

00:01:56.600 --> 00:01:58.630
It took them a couple weeks
to get to know what it is.

00:01:58.630 --> 00:02:01.240
Now they're evaluating us
against another vendor.

00:02:01.240 --> 00:02:02.990
And then finally, they
procure our software

00:02:02.990 --> 00:02:04.390
and paid us our bills.

00:02:04.390 --> 00:02:06.550
So if you're a small company,
a big company, this is a

00:02:06.550 --> 00:02:08.610
typical flow for a salesperson
to have.

00:02:08.610 --> 00:02:11.630
It's a pretty common business
purpose software.

00:02:11.630 --> 00:02:15.610
So what I'll do is just give you
a little overview of the

00:02:15.610 --> 00:02:18.790
components and the contents that
a CRM system may have.

00:02:18.790 --> 00:02:21.950
By the way, everything that
I'll be doing today is

00:02:21.950 --> 00:02:24.260
something that you guys
can follow along.

00:02:24.260 --> 00:02:26.720
Salesforce.com actually has
a free developer version.

00:02:26.720 --> 00:02:28.240
And it's actually--

00:02:28.240 --> 00:02:32.690
I think it's free unlimited
and allows you to have

00:02:32.690 --> 00:02:35.710
hundreds of records for testing
purposes and a lot of

00:02:35.710 --> 00:02:37.150
good things there.

00:02:37.150 --> 00:02:39.500
And obviously, it's great
for testing as well.

00:02:39.500 --> 00:02:42.540
You can actually add your
content and get a good sense

00:02:42.540 --> 00:02:43.510
for what it's like.

00:02:43.510 --> 00:02:48.220
So a typical CRM system, when
you come in, you have--

00:02:48.220 --> 00:02:50.090
the key moving pieces
are Accounts.

00:02:50.090 --> 00:02:51.860
So accounts are like
companies, right?

00:02:51.860 --> 00:02:54.900
So these are-- if I just go
in, I can see all the

00:02:54.900 --> 00:02:56.000
different companies here.

00:02:56.000 --> 00:02:59.660
You have United Oil &amp; Gas,
Express Logistics, GenePoint,

00:02:59.660 --> 00:03:01.630
Grand Hotels.

00:03:01.630 --> 00:03:03.880
Contacts are people that
work at accounts.

00:03:03.880 --> 00:03:06.260
If I just go into Contacts,
these are people.

00:03:06.260 --> 00:03:08.730
They have title, they have phone
numbers, they have email

00:03:08.730 --> 00:03:10.240
addresses, and so on.

00:03:10.240 --> 00:03:13.030
And Opportunities are what
I mentioned before.

00:03:13.030 --> 00:03:14.880
These are sort of the deals.

00:03:14.880 --> 00:03:17.690
So a single account can have
multiple opportunities

00:03:17.690 --> 00:03:18.900
associated with it.

00:03:18.900 --> 00:03:21.050
They could be for different
amounts, and they could be in

00:03:21.050 --> 00:03:23.140
different stages with different

00:03:23.140 --> 00:03:24.780
probabilities as well.

00:03:24.780 --> 00:03:26.950
So those are the three
main pieces that most

00:03:26.950 --> 00:03:28.260
folks will deal with.

00:03:28.260 --> 00:03:30.320
So that's salesforce.com.

00:03:30.320 --> 00:03:32.440
So what we'll do is actually,
we'll start off real easy.

00:03:32.440 --> 00:03:35.760
And we'll actually kind of
create a spreadsheet to dump

00:03:35.760 --> 00:03:38.020
some data from salesforce.com.

00:03:38.020 --> 00:03:41.080
So we'll try to do three
things today--

00:03:41.080 --> 00:03:43.290
get data out of salesforce.com.

00:03:43.290 --> 00:03:46.880
We will then try to push data
into salesforce.com.

00:03:46.880 --> 00:03:49.250
And then we'll try to do some
interesting workflow-type

00:03:49.250 --> 00:03:52.990
things where we tap into an
email and then upload data

00:03:52.990 --> 00:03:55.050
into salesforce.com
contextually.

00:03:55.050 --> 00:03:57.800
IKAI LAN: So to clarify a little
bit, what are some of

00:03:57.800 --> 00:03:59.790
the things that you can
do in salesforce.com?

00:03:59.790 --> 00:04:02.160
And what would be some examples
of reasons that you'd

00:04:02.160 --> 00:04:03.940
want to get this into
Google Apps?

00:04:03.940 --> 00:04:06.490
ARUN NAGARAJAN: So there are a
couple of important things

00:04:06.490 --> 00:04:08.830
that I think people will end
up doing in salesforce.com.

00:04:08.830 --> 00:04:09.850
One is--

00:04:09.850 --> 00:04:12.750
so if you're a salesperson that
you're on the road, you

00:04:12.750 --> 00:04:14.760
want to be able to quickly
look up these contacts.

00:04:14.760 --> 00:04:17.240
You want to be able
to log a meeting.

00:04:17.240 --> 00:04:21.459
You want to be able to say, I
met with this person on so and

00:04:21.459 --> 00:04:24.920
so date, the call went well,
things like that.

00:04:24.920 --> 00:04:28.590
Also, if you're an internal
sales or marketing person,

00:04:28.590 --> 00:04:30.610
you're oftentimes bulk-editing
data.

00:04:30.610 --> 00:04:32.740
So you want to load
data en masse.

00:04:32.740 --> 00:04:35.960
So you want to import it from
a lead spreadsheet and then

00:04:35.960 --> 00:04:37.890
put it into salesforce.com,
for instance.

00:04:37.890 --> 00:04:40.560
Or if you're a sales manager, a
lot of times you want to run

00:04:40.560 --> 00:04:41.620
analytics on it.

00:04:41.620 --> 00:04:44.270
You want to be able
to look at--

00:04:44.270 --> 00:04:47.630
what are the different stages of
the opportunities that I'm

00:04:47.630 --> 00:04:49.310
tracking right now
and all sorts of

00:04:49.310 --> 00:04:50.260
interesting things like that.

00:04:50.260 --> 00:04:53.230
So those are the key use
cases that I see.

00:04:53.230 --> 00:04:55.430
And I'll actually start with
the one that I mentioned,

00:04:55.430 --> 00:04:58.630
which is downloading
data en masse.

00:04:58.630 --> 00:05:00.040
So what I'll do is I'll
go ahead and--

00:05:00.040 --> 00:05:02.860
I'm in Drive, so
drive.google.com.

00:05:02.860 --> 00:05:05.300
And like I said, everything that
I'm doing here you should

00:05:05.300 --> 00:05:06.650
be able to follow along.

00:05:06.650 --> 00:05:08.680
Some of it might be
a little tricky.

00:05:08.680 --> 00:05:10.200
But what I'll do is--

00:05:10.200 --> 00:05:12.080
in this, for the very first one,
we're actually going to

00:05:12.080 --> 00:05:13.990
use a canned script.

00:05:13.990 --> 00:05:17.620
So someone has written a really
nice script that works

00:05:17.620 --> 00:05:20.960
really well with the Google
Apps Script platform.

00:05:20.960 --> 00:05:24.360
So I'll go to the
Script gallery.

00:05:24.360 --> 00:05:26.330
IKAI LAN: And the script gallery
is-- you can always

00:05:26.330 --> 00:05:27.730
submit something to the
script gallery.

00:05:27.730 --> 00:05:30.240
You can do this when you're
in the script editor at

00:05:30.240 --> 00:05:31.380
script.google.com.

00:05:31.380 --> 00:05:32.760
Others Submit to Gallery.

00:05:32.760 --> 00:05:35.280
I think there's a little bit of
confusion between Submit to

00:05:35.280 --> 00:05:36.720
Gallery and Publish.

00:05:36.720 --> 00:05:39.380
So Publish is what you do when
you want to expose your

00:05:39.380 --> 00:05:41.820
application as a web
service or web app.

00:05:41.820 --> 00:05:44.460
Whereas Publish to Gallery is to
publish it into the script

00:05:44.460 --> 00:05:48.190
gallery here, which you can
access right now through a

00:05:48.190 --> 00:05:49.240
spreadsheet.

00:05:49.240 --> 00:05:50.080
You go to Spreadsheet.

00:05:50.080 --> 00:05:51.350
You go to Tools and
Script Gallery.

00:05:51.350 --> 00:05:54.350
You can look for things that
people have published.

00:05:54.350 --> 00:05:55.400
ARUN NAGARAJAN: And I'll
go ahead and--

00:05:55.400 --> 00:05:57.350
I just searched for
Salesforce--

00:05:57.350 --> 00:06:01.040
and try clicking on Install.

00:06:01.040 --> 00:06:03.130
And this is actually one of the
members that a contributor

00:06:03.130 --> 00:06:04.970
did, Sanjay Gidwani.

00:06:04.970 --> 00:06:07.380
I'm going to authorize
this script.

00:06:07.380 --> 00:06:08.630
Going to close--

00:06:10.990 --> 00:06:12.520
close it here.

00:06:12.520 --> 00:06:14.560
And you will notice that there's
a new menu available

00:06:14.560 --> 00:06:16.830
now called Cloud Connector--

00:06:16.830 --> 00:06:17.790
great name for it.

00:06:17.790 --> 00:06:20.580
In this one, the way it's going
to work is it's going to

00:06:20.580 --> 00:06:22.370
actually ask me for
a password.

00:06:22.370 --> 00:06:25.440
So it's using the old mechanism
to authenticate.

00:06:25.440 --> 00:06:29.690
It's going to actually make me
type in my password, which

00:06:29.690 --> 00:06:34.170
obviously may not be the
most secure approach.

00:06:34.170 --> 00:06:36.090
Let me log in here.

00:06:36.090 --> 00:06:38.530
And then one of the things that
Salesforce instituted a

00:06:38.530 --> 00:06:42.260
few years ago was that, for a
third-party app to access--

00:06:42.260 --> 00:06:44.670
it's sort of like an
application-specific password,

00:06:44.670 --> 00:06:46.760
except it's for all
third-party apps.

00:06:46.760 --> 00:06:49.970
And I actually have to save
it-- they email you it.

00:06:49.970 --> 00:06:51.360
And I'm going to save that.

00:06:51.360 --> 00:06:54.070
So that's another reason this
approach is not the best--

00:06:54.070 --> 00:06:55.660
IKAI LAN: This is kind of a
really funny approach if you

00:06:55.660 --> 00:06:56.430
think about it.

00:06:56.430 --> 00:07:00.210
Because the whole thing about
using OAuth and third-party

00:07:00.210 --> 00:07:03.490
authentication is that you want
to give people a password

00:07:03.490 --> 00:07:05.190
that's not the same password
they're likely

00:07:05.190 --> 00:07:06.530
using somewhere else.

00:07:06.530 --> 00:07:09.200
So in this case, they're asking
for your password, and

00:07:09.200 --> 00:07:10.420
they're asking for
initial security.

00:07:10.420 --> 00:07:12.350
So they're protecting their
system, but they're not

00:07:12.350 --> 00:07:13.600
protecting you.

00:07:16.590 --> 00:07:18.310
ARUN NAGARAJAN: That's
about it.

00:07:18.310 --> 00:07:19.020
That's fair.

00:07:19.020 --> 00:07:20.420
So I'm going to log in.

00:07:20.420 --> 00:07:22.790
So it's sort of stages
of things.

00:07:22.790 --> 00:07:24.250
I type in my credentials.

00:07:24.250 --> 00:07:25.460
I have to hit Login.

00:07:25.460 --> 00:07:28.180
And then I can query.

00:07:28.180 --> 00:07:29.340
So this is actually
interesting.

00:07:29.340 --> 00:07:33.060
So the Salesforce interface
is based on the

00:07:33.060 --> 00:07:35.270
syntax called SQQL--

00:07:35.270 --> 00:07:36.580
SQOL--

00:07:36.580 --> 00:07:38.270
IKAI LAN: So it's like SOQL.

00:07:38.270 --> 00:07:39.030
ARUN NAGARAJAN: Exactly.

00:07:39.030 --> 00:07:41.360
It stands for Salesforce
Query Language--

00:07:41.360 --> 00:07:42.910
that's a typo there.

00:07:42.910 --> 00:07:46.930
This is the right version, SOQL
And it looks like SQL.

00:07:46.930 --> 00:07:48.940
It's got most of the
properties of SQL.

00:07:48.940 --> 00:07:54.110
But sort of like some of the
systems we have, it's got some

00:07:54.110 --> 00:07:57.346
things that SQL cannot do--
things like Group By, some of

00:07:57.346 --> 00:07:58.860
the advanced structures.

00:07:58.860 --> 00:08:01.210
So what I'll start off with is
some of the simple ones.

00:08:01.210 --> 00:08:05.360
So I can say Select ID,
FirstName, LastName.

00:08:05.360 --> 00:08:07.500
So this requires some
familiarity with the system,

00:08:07.500 --> 00:08:09.960
but then it's actually
quite nice to use it.

00:08:09.960 --> 00:08:12.280
So I can say From Contact.

00:08:12.280 --> 00:08:16.720
I hit Query, and it's going to
dump the data into a nice

00:08:16.720 --> 00:08:17.230
spreadsheet.

00:08:17.230 --> 00:08:21.090
So now I have it into a Google
spreadsheet, and I can go

00:08:21.090 --> 00:08:22.600
ahead and export it.

00:08:22.600 --> 00:08:25.880
I can save it, and share
it as a PDF.

00:08:25.880 --> 00:08:27.630
It's in a spreadsheet, so I can
do a lot of cool things.

00:08:27.630 --> 00:08:30.780
And I can create another
tab of the sheet here.

00:08:30.780 --> 00:08:33.400
And what I'll do here
is query for--

00:08:33.400 --> 00:08:34.929
let's get account information.

00:08:34.929 --> 00:08:36.880
I'll show a couple examples
here as to why

00:08:36.880 --> 00:08:37.760
this might be useful.

00:08:37.760 --> 00:08:42.850
So I'll say Select ID,
Name from Account.

00:08:42.850 --> 00:08:44.360
IKAI LAN: I notice that
this script caches

00:08:44.360 --> 00:08:45.490
the credentials somewhere.

00:08:45.490 --> 00:08:45.950
ARUN NAGARAJAN: That's right.

00:08:45.950 --> 00:08:47.380
IKAI LAN: So do you know
where it does that?

00:08:47.380 --> 00:08:49.020
ARUN NAGARAJAN: Yeah, it does
it under User Properties.

00:08:49.020 --> 00:08:49.970
I don't want to show
it because my

00:08:49.970 --> 00:08:53.280
password will be there.

00:08:53.280 --> 00:08:53.960
And I'll do--

00:08:53.960 --> 00:08:56.860
IKAI LAN: You almost fell
for my trick there.

00:08:56.860 --> 00:08:57.670
ARUN NAGARAJAN: So I'm
actually going to

00:08:57.670 --> 00:08:59.650
create a new tab first.

00:08:59.650 --> 00:09:02.480
And there's a lot of benefits
to this approach.

00:09:02.480 --> 00:09:05.030
And I'll show you the real
reason why this might be

00:09:05.030 --> 00:09:07.520
really beneficial for
a sales manager.

00:09:07.520 --> 00:09:10.220
I'll say Select Name--

00:09:10.220 --> 00:09:11.240
let's see--

00:09:11.240 --> 00:09:17.690
Amount, remembering my
Probability from Opportunity--

00:09:17.690 --> 00:09:18.442
"opp-or-tunity"--

00:09:18.442 --> 00:09:19.950
if I can spell.

00:09:19.950 --> 00:09:22.590
All right, so this is going to
download the sales deals.

00:09:22.590 --> 00:09:24.370
100% means it's sold.

00:09:24.370 --> 00:09:28.330
60% means the salesperson thinks
it's getting close.

00:09:28.330 --> 00:09:32.830
And then if it's 20%, they just
started this opportunity.

00:09:32.830 --> 00:09:34.400
IKAI LAN: Is that probability
or progress?

00:09:34.400 --> 00:09:36.600
Well, I guess it depends on
how people want to use it.

00:09:36.600 --> 00:09:38.520
ARUN NAGARAJAN: Yeah, so the
field is called Probability,

00:09:38.520 --> 00:09:39.860
so let's kind of go with that.

00:09:39.860 --> 00:09:41.580
So what I can do as
a sales manager--

00:09:41.580 --> 00:09:45.501
and this is just the
fact that it's in--

00:09:45.501 --> 00:09:48.520
oop, [? can't see. ?]

00:09:48.520 --> 00:09:51.580
All right, so let me actually
go back in, say Data, and

00:09:51.580 --> 00:09:53.140
create a pivot table.

00:09:53.140 --> 00:09:57.340
So what I can do very quickly
is add something as a pivot

00:09:57.340 --> 00:10:01.580
table and add values
for amount.

00:10:01.580 --> 00:10:03.990
And you can see that very
quickly, I have a

00:10:03.990 --> 00:10:05.760
little stage here.

00:10:05.760 --> 00:10:10.680
And I can add another field for
Amount, and this one I'll

00:10:10.680 --> 00:10:12.050
do just Count.

00:10:12.050 --> 00:10:15.530
And you can see that, as a sales
manager, I can see that

00:10:15.530 --> 00:10:19.090
my sales pipeline
is left-heavy.

00:10:19.090 --> 00:10:22.160
So a lot of deals are stuck
in the early stages.

00:10:22.160 --> 00:10:25.560
And I can just go ahead very
quickly and then select these

00:10:25.560 --> 00:10:29.100
guys and insert a chart.

00:10:29.100 --> 00:10:33.270
And we'll call this a typical
pipeline chart.

00:10:33.270 --> 00:10:33.730
And there it is.

00:10:33.730 --> 00:10:37.080
So as a sales manager, ignore
the ones that are 100%.

00:10:37.080 --> 00:10:38.500
That's kind of skewing
the data.

00:10:38.500 --> 00:10:39.590
Just look at this part.

00:10:39.590 --> 00:10:43.660
I can see that a lot of these
deals are just starting up.

00:10:43.660 --> 00:10:48.070
So I cannot expect a great next
two weeks, because it

00:10:48.070 --> 00:10:49.810
takes a couple of weeks
for deals to move.

00:10:49.810 --> 00:10:52.430
So these are the types of data
and these are the types of

00:10:52.430 --> 00:10:54.770
reports that a sales manager
likes to see.

00:10:54.770 --> 00:10:58.690
So that hopefully was a little
example of why you want to

00:10:58.690 --> 00:11:00.210
bring it into a spreadsheet
and analyze--

00:11:00.210 --> 00:11:00.980
IKAI LAN: That's a very
good example.

00:11:00.980 --> 00:11:02.740
And there's one more thing you
could do here, which I think

00:11:02.740 --> 00:11:05.980
is kind of cool, is that, with
this chart-- you can publish

00:11:05.980 --> 00:11:06.230
this chart.

00:11:06.230 --> 00:11:07.360
ARUN NAGARAJAN: That's
right, that's right.

00:11:07.360 --> 00:11:10.600
So you can actually publish it
to a site or a dashboard, And

00:11:10.600 --> 00:11:13.470
then that person doesn't have
to have access to the

00:11:13.470 --> 00:11:14.310
salesforce.com interface.

00:11:14.310 --> 00:11:17.190
So this data is now published
and very similar to the

00:11:17.190 --> 00:11:19.880
analytics example a
couple weeks ago.

00:11:19.880 --> 00:11:22.390
IKAI LAN: And that's interesting
because Salesforce

00:11:22.390 --> 00:11:24.930
also provides functionality
that allows you to create

00:11:24.930 --> 00:11:25.850
dashboards.

00:11:25.850 --> 00:11:27.900
And some people might
prefer that method.

00:11:27.900 --> 00:11:29.250
Some people prefer
this method.

00:11:29.250 --> 00:11:31.490
There are advantages and
disadvantages to both.

00:11:31.490 --> 00:11:34.340
If you use Salesforce natively,
it has native access

00:11:34.340 --> 00:11:35.040
to the data.

00:11:35.040 --> 00:11:37.080
Whereas when you're using Google
Apps and Apps Script,

00:11:37.080 --> 00:11:39.262
you have to remember to import
the data and always get the

00:11:39.262 --> 00:11:39.800
newest data.

00:11:39.800 --> 00:11:42.360
But you also get access to other
Google properties such

00:11:42.360 --> 00:11:47.080
as-- you could access Calendar,
Gmail, and, I don't

00:11:47.080 --> 00:11:47.635
know, Finance.

00:11:47.635 --> 00:11:49.740
ARUN NAGARAJAN: Yeah, Sharing,
all the versioning, all that

00:11:49.740 --> 00:11:51.200
good stuff.

00:11:51.200 --> 00:11:53.300
And let's actually go ahead and
take a quick look at the

00:11:53.300 --> 00:11:54.510
code as well.

00:11:54.510 --> 00:11:58.300
This gentleman did a real good
job here of calling the SOAP

00:11:58.300 --> 00:12:01.730
service for the login part, but
then followed it up with

00:12:01.730 --> 00:12:05.780
the ability to call the
Salesforce REST API.

00:12:05.780 --> 00:12:08.130
Sorry, my font's a little
funky here.

00:12:08.130 --> 00:12:10.690
So you can see all the
menus that get added.

00:12:10.690 --> 00:12:12.820
And then let's just take a quick
look-- so here's the

00:12:12.820 --> 00:12:14.340
login process.

00:12:14.340 --> 00:12:17.170
So that's the SOAP message
that gets sent up.

00:12:17.170 --> 00:12:21.210
And then they follow it up with
the ability to call the

00:12:21.210 --> 00:12:24.070
REST data, which is through
a very simple

00:12:24.070 --> 00:12:25.460
function called Query.

00:12:25.460 --> 00:12:28.270
And you can see that that is a
really straightforward call.

00:12:28.270 --> 00:12:30.630
So this is the beauty
of Salesforce API or

00:12:30.630 --> 00:12:32.050
really any REST API.

00:12:32.050 --> 00:12:34.270
And one of the nice things that
you'll see hopefully is

00:12:34.270 --> 00:12:37.550
that, anything that we're
showing, hopefully you'll be

00:12:37.550 --> 00:12:41.440
able to adapt conceptually and
also code-wise into any other

00:12:41.440 --> 00:12:42.450
system that you may have.

00:12:42.450 --> 00:12:44.180
IKAI LAN: Do me a favor and
scroll back up real

00:12:44.180 --> 00:12:46.010
quick to the XML.

00:12:46.010 --> 00:12:48.970
So a couple of things to point
out here are that, when we're

00:12:48.970 --> 00:12:51.940
constructing the XML, it looks
like this developer has done

00:12:51.940 --> 00:12:53.840
so by building the
string directly.

00:12:53.840 --> 00:12:56.990
Another method you could do this
is using the XML Service.

00:12:56.990 --> 00:13:00.800
Now, I personally think that
for smaller XML documents,

00:13:00.800 --> 00:13:03.230
sometimes it's just much easier
to do it this way with

00:13:03.230 --> 00:13:03.880
direct string.

00:13:03.880 --> 00:13:05.870
Because you don't have
to remember, where in

00:13:05.870 --> 00:13:06.980
the DOM tree am I?

00:13:06.980 --> 00:13:09.160
You just go ahead, you construct
your XML, and you're

00:13:09.160 --> 00:13:09.740
ready to go.

00:13:09.740 --> 00:13:10.760
ARUN NAGARAJAN: Right,
absolutely.

00:13:10.760 --> 00:13:12.020
That's correct.

00:13:12.020 --> 00:13:14.900
IKAI LAN: The only thing to be
aware of is, when you do use

00:13:14.900 --> 00:13:17.920
tools like XML Service,
it takes care of

00:13:17.920 --> 00:13:18.890
escaping for you.

00:13:18.890 --> 00:13:21.500
So you have to remember--
which quotes am I using?

00:13:21.500 --> 00:13:24.080
Am I escaping or not escaping,
greater than, less than?

00:13:24.080 --> 00:13:26.590
Just be aware of these things
when you're writing XML you

00:13:26.590 --> 00:13:28.070
want to send as part
of an API.

00:13:28.070 --> 00:13:29.240
ARUN NAGARAJAN: Right, so
if my login name had an

00:13:29.240 --> 00:13:32.220
apostrophe in it, that
system would break--

00:13:32.220 --> 00:13:32.935
which is valid.

00:13:32.935 --> 00:13:35.330
IKAI LAN: Oh yeah,
makes sense.

00:13:35.330 --> 00:13:37.520
ARUN NAGARAJAN: So hopefully,
that was interesting.

00:13:37.520 --> 00:13:40.220
And that's a script that we
didn't have to write.

00:13:40.220 --> 00:13:42.520
A great member of our community
wrote it, and it's

00:13:42.520 --> 00:13:44.390
available today for
you to try out.

00:13:44.390 --> 00:13:48.470
What we'll do next is actually
use the REST API and actually

00:13:48.470 --> 00:13:50.370
upload some data in bulk.

00:13:50.370 --> 00:13:52.620
And for this, we'll actually
use OAuth.

00:13:52.620 --> 00:13:55.250
IKAI LAN: OK, OAuth, yeah.

00:13:55.250 --> 00:13:56.815
ARUN NAGARAJAN: Yes, this is
going to involve a little bit

00:13:56.815 --> 00:13:59.000
of copy-pasting of the code
I wrote ahead of time.

00:13:59.000 --> 00:14:01.100
IKAI LAN: So again, while he's
doing this I'll talk a little

00:14:01.100 --> 00:14:02.240
bit about OAuth.

00:14:02.240 --> 00:14:05.770
OAuth, if you don't know what
it is-- it's a mechanism for

00:14:05.770 --> 00:14:08.690
authorizing third parties
to use your service.

00:14:08.690 --> 00:14:11.530
So a good description I've seen
on the OAuth website is

00:14:11.530 --> 00:14:13.350
that it's like a valet
key for the internet.

00:14:13.350 --> 00:14:18.070
So for instance, if Arun has a
service and he calls it Arun's

00:14:18.070 --> 00:14:19.250
Social Network.

00:14:19.250 --> 00:14:21.160
He's got a total of maybe three
or four people that are

00:14:21.160 --> 00:14:25.050
using it, but I want to write
applications against this API.

00:14:25.050 --> 00:14:27.010
So me as a user--

00:14:27.010 --> 00:14:28.620
you don't want to train your
users to give out their

00:14:28.620 --> 00:14:30.440
password to third-party APIs.

00:14:30.440 --> 00:14:33.230
Now, this is something that was
very common in Web 1.0.

00:14:33.230 --> 00:14:35.460
It started to become less
common in Web 2.0.

00:14:35.460 --> 00:14:38.090
And nowadays, everything,
whether it's Facebook or

00:14:38.090 --> 00:14:40.140
Twitter, you get an
authentication panel.

00:14:40.140 --> 00:14:43.020
In your browser, users
get to see HTTPS

00:14:43.020 --> 00:14:44.430
Twitter, HTTPS Facebook.

00:14:44.430 --> 00:14:46.520
So you know they're giving their
password to the right

00:14:46.520 --> 00:14:50.340
authority and not to
ikaismaliciousscript.com.

00:14:50.340 --> 00:14:51.200
ARUN NAGARAJAN: That's right.

00:14:51.200 --> 00:14:54.460
And Salesforce actually does a
really good job of explaining

00:14:54.460 --> 00:14:55.090
this as well.

00:14:55.090 --> 00:14:57.500
They have a really good
resource here on their

00:14:57.500 --> 00:14:59.480
Developerforce wiki.

00:14:59.480 --> 00:15:01.890
And you should be able to just
search for it, and we'll make

00:15:01.890 --> 00:15:03.710
sure to include a link
for this as well.

00:15:03.710 --> 00:15:07.590
It's a really good overview of
all the cool things that the

00:15:07.590 --> 00:15:09.940
API can do, different
approaches.

00:15:09.940 --> 00:15:12.700
And you want to use the web
server flow when you're

00:15:12.700 --> 00:15:14.270
dealing with Apps Script.

00:15:14.270 --> 00:15:16.680
And we will get into this
probably deeper into a blog

00:15:16.680 --> 00:15:18.680
post or a separate session
on this by itself.

00:15:18.680 --> 00:15:21.220
It's a fairly complicated
topic.

00:15:21.220 --> 00:15:24.070
And it's a pretty sophisticated
piece of

00:15:24.070 --> 00:15:27.450
documentation that they have
on how this all works.

00:15:27.450 --> 00:15:29.900
And we are the client
application in this case.

00:15:29.900 --> 00:15:33.250
OK, so what we'll do is I'll
have to-- for this, I just

00:15:33.250 --> 00:15:35.940
created a script against
the spreadsheet.

00:15:35.940 --> 00:15:38.590
So I went to Tools, Create
Script Editor.

00:15:38.590 --> 00:15:40.390
I'm just going to create
a blank project.

00:15:40.390 --> 00:15:43.040
IKAI LAN: So he's not going
straight to script.google.com.

00:15:43.040 --> 00:15:45.300
He's creating a spreadsheet,
and he's going to Tools,

00:15:45.300 --> 00:15:46.130
Script Editor.

00:15:46.130 --> 00:15:46.590
ARUN NAGARAJAN: That's right.

00:15:46.590 --> 00:15:48.550
And a lot of the ideas
will apply even if

00:15:48.550 --> 00:15:49.620
I start from scratch.

00:15:49.620 --> 00:15:51.970
In this case, it's a lot easier
for me to kind of

00:15:51.970 --> 00:15:53.960
showcase this in a spreadsheet
container.

00:15:53.960 --> 00:15:56.080
OK, so what I'll do is--
actually, I wrote up all the

00:15:56.080 --> 00:16:00.470
code ahead of time, both
for sharing it and for

00:16:00.470 --> 00:16:01.550
me to copy and paste.

00:16:01.550 --> 00:16:03.450
So if you go to my GitHub
page, it's all there.

00:16:03.450 --> 00:16:04.880
So you can follow
along as well.

00:16:04.880 --> 00:16:06.630
IKAI LAN: And what's your
GitHub username?

00:16:06.630 --> 00:16:06.840
ARUN NAGARAJAN: Entaq--

00:16:06.840 --> 00:16:07.440
E-N-T-A-Q.

00:16:07.440 --> 00:16:08.804
IKAI LAN: Does that stand
for something?

00:16:08.804 --> 00:16:11.310
ARUN NAGARAJAN: No, it's--

00:16:11.310 --> 00:16:13.120
don't put me on the spot.

00:16:13.120 --> 00:16:15.852
IKAI LAN: Do you know what
my GitHub name is?

00:16:15.852 --> 00:16:17.400
It's Ikai, I think.

00:16:17.400 --> 00:16:19.970
ARUN NAGARAJAN: You have
a very unique name.

00:16:19.970 --> 00:16:23.450
OK, so what we're going to do
is I'm going to go ahead and

00:16:23.450 --> 00:16:24.370
copy some of this code.

00:16:24.370 --> 00:16:27.060
So the one called
RowUtilities--

00:16:27.060 --> 00:16:29.020
this one should look
really familiar.

00:16:29.020 --> 00:16:31.520
This one is just code right
from our documentation.

00:16:31.520 --> 00:16:38.840
This has all the utilities
around converting a sheet into

00:16:38.840 --> 00:16:40.530
a JavaScript object.

00:16:40.530 --> 00:16:43.880
It allows you to query for them
by range, and then all

00:16:43.880 --> 00:16:44.840
sorts of good stuff.

00:16:44.840 --> 00:16:47.680
So let's go to the Raw
here, copy this, and

00:16:47.680 --> 00:16:49.090
then come in here.

00:16:49.090 --> 00:16:50.280
IKAI LAN: I'm sorry,
let's go back.

00:16:50.280 --> 00:16:52.140
That was kind of on
the quick side.

00:16:52.140 --> 00:16:54.710
So when you're using GitHub, if
you're new at GitHub, one

00:16:54.710 --> 00:16:56.770
thing you're doing when you look
at code is that you can

00:16:56.770 --> 00:16:58.030
copy-paste the code.

00:16:58.030 --> 00:17:00.170
But look for the Raw link.

00:17:00.170 --> 00:17:02.800
Because it's sometimes easier to
click the Raw link and open

00:17:02.800 --> 00:17:04.839
up just the text of the code.

00:17:04.839 --> 00:17:06.480
So that's what Arun is
doing right here.

00:17:06.480 --> 00:17:06.760
ARUN NAGARAJAN: That's right.

00:17:06.760 --> 00:17:09.390
And when they show you the
preview, it's really nice to

00:17:09.390 --> 00:17:12.210
get all the syntax highlighting
and comments and

00:17:12.210 --> 00:17:12.730
things like that.

00:17:12.730 --> 00:17:14.310
But when you want to copy
it, you don't want that

00:17:14.310 --> 00:17:15.070
formatting.

00:17:15.070 --> 00:17:16.569
All right, so we
paste that in.

00:17:16.569 --> 00:17:21.270
And I'm going to save this
project as Salesforce Scripts.

00:17:21.270 --> 00:17:24.210
And I'm going to rename this
just to make sure I

00:17:24.210 --> 00:17:25.319
understand.

00:17:25.319 --> 00:17:26.569
So I'll call this
RowUtilities.

00:17:30.550 --> 00:17:34.080
And then I'm going to
create a new script.

00:17:34.080 --> 00:17:36.800
OK, and we'll call
this Salesforce.

00:17:36.800 --> 00:17:37.640
IKAI LAN: You're creating
a new file.

00:17:37.640 --> 00:17:39.640
ARUN NAGARAJAN: I'm sorry,
yeah, that's right.

00:17:39.640 --> 00:17:40.530
Thank you.

00:17:40.530 --> 00:17:45.480
And I'll go back and then pick
this guy, the OAuth code.

00:17:45.480 --> 00:17:48.560
And I'll call this guy-- again,
doing it quickly.

00:17:48.560 --> 00:17:51.170
But all I'm doing is bringing
the code over so that I'm not

00:17:51.170 --> 00:17:53.490
typing this in front of you.

00:17:53.490 --> 00:17:55.210
And you can use this today.

00:17:55.210 --> 00:17:57.930
I should say that it's not
production caliber.

00:17:57.930 --> 00:18:00.570
We're working on cleaning that
up and publishing it as a

00:18:00.570 --> 00:18:02.170
sample at some point soon.

00:18:02.170 --> 00:18:05.120
But it's great to get started
and get a sense for what the

00:18:05.120 --> 00:18:06.670
script does.

00:18:06.670 --> 00:18:08.500
IKAI LAN: I'm kind of already
seeing where you're going with

00:18:08.500 --> 00:18:12.000
this when it has the
authorization page.

00:18:12.000 --> 00:18:14.120
I can't wait because I can
already tell it's going to be

00:18:14.120 --> 00:18:15.370
really ugly.

00:18:17.300 --> 00:18:19.680
ARUN NAGARAJAN: I said
not production ready.

00:18:19.680 --> 00:18:20.430
All right, cool.

00:18:20.430 --> 00:18:22.190
So we've got the stuff.

00:18:22.190 --> 00:18:24.670
So what we want to do now is
actually a couple of things.

00:18:24.670 --> 00:18:26.990
So I want to--

00:18:26.990 --> 00:18:30.610
in order for OAuth to work, your
script is both bound to a

00:18:30.610 --> 00:18:33.720
container and also published
as a web app.

00:18:33.720 --> 00:18:37.520
So that's kind of a tricky
concept to get to make sure it

00:18:37.520 --> 00:18:38.890
makes sense to you.

00:18:38.890 --> 00:18:41.830
So it's got two entry points,
one from the spreadsheet,

00:18:41.830 --> 00:18:44.660
another one when it gets called
in from the browser.

00:18:44.660 --> 00:18:47.110
So if you can think about that,
that's necessary for the

00:18:47.110 --> 00:18:49.350
callback that the OAuth service

00:18:49.350 --> 00:18:50.650
returns with the token.

00:18:50.650 --> 00:18:52.700
IKAI LAN: Let's try to
rephrase that again.

00:18:52.700 --> 00:18:56.470
So you're saying that we
need two entry points.

00:18:56.470 --> 00:18:59.930
Because when you're doing OAuth,
in a typical OAuth

00:18:59.930 --> 00:19:02.610
flow, after you go to,
say, your service,

00:19:02.610 --> 00:19:05.270
arunssocialnetwork.com, and
you say, yes, grant

00:19:05.270 --> 00:19:09.340
ikaismaliciousscripts.com access
to my personal info,

00:19:09.340 --> 00:19:11.930
it's going to redirect
you back to my site.

00:19:11.930 --> 00:19:14.220
So that's what he's talking
about when he says he needs to

00:19:14.220 --> 00:19:16.600
expose a web app, which
he's doing right now.

00:19:16.600 --> 00:19:21.430
Because inside this app,
arunssocialnetwork.com is

00:19:21.430 --> 00:19:23.740
going to pass a bunch of
authorization codes that you

00:19:23.740 --> 00:19:28.050
can then use to do some key
exchanges and make API calls

00:19:28.050 --> 00:19:28.280
on my behalf.

00:19:28.280 --> 00:19:32.810
Now again, the scope of OAuth
is big and can be very

00:19:32.810 --> 00:19:33.480
complicated.

00:19:33.480 --> 00:19:34.920
So we're not going to
go too much into it.

00:19:34.920 --> 00:19:37.500
But that's why he needs a web
interface for this even though

00:19:37.500 --> 00:19:39.970
he's not going to be serving
a web application.

00:19:39.970 --> 00:19:41.850
ARUN NAGARAJAN: That's right,
and hopefully you'll be able

00:19:41.850 --> 00:19:44.740
to watch it again and get the
flow if we're going too fast.

00:19:44.740 --> 00:19:47.380
But this should all make
sense in a little bit.

00:19:47.380 --> 00:19:50.460
OK, so now what I did was I
copied the URL that this

00:19:50.460 --> 00:19:52.150
service was published as.

00:19:52.150 --> 00:19:55.150
And what I'm going to do now
is go into Salesforce and

00:19:55.150 --> 00:19:56.900
register a new application.

00:19:56.900 --> 00:20:00.500
So this is me telling
salesforce.com that it's OK

00:20:00.500 --> 00:20:04.590
for this custom third-party
application to access my data.

00:20:04.590 --> 00:20:07.210
And the administrator
does this.

00:20:07.210 --> 00:20:09.110
So we go to Setup.

00:20:09.110 --> 00:20:13.200
We'll go down to Develop.

00:20:13.200 --> 00:20:15.980
We'll go down to
Remote Access.

00:20:15.980 --> 00:20:18.490
And I have a couple of samples,
but this is all-- you

00:20:18.490 --> 00:20:20.270
want to do this from scratch.

00:20:20.270 --> 00:20:23.220
So you want to go
down to hit New.

00:20:23.220 --> 00:20:25.780
So this is the application
registration.

00:20:25.780 --> 00:20:29.280
Again, this is something that
a single administrator does

00:20:29.280 --> 00:20:31.620
for all their Salesforce
users.

00:20:31.620 --> 00:20:34.015
So we'll call this Ikai Demo.

00:20:37.990 --> 00:20:43.420
This is a great live
demo, hopefully.

00:20:43.420 --> 00:20:46.745
And I've saved myself
a little logo.

00:20:46.745 --> 00:20:48.850
I'm going to put that in.

00:20:48.850 --> 00:20:51.910
And I'm going to just point
to our developer site if

00:20:51.910 --> 00:20:54.520
something goes wrong,
and then just use my

00:20:54.520 --> 00:20:55.780
email address there.

00:20:55.780 --> 00:20:57.970
And now here's the
important bit.

00:20:57.970 --> 00:20:59.690
It wants a callback URL.

00:20:59.690 --> 00:21:05.440
So this is the callback URL that
the web app calls into,

00:21:05.440 --> 00:21:07.156
the redirect calls into.

00:21:07.156 --> 00:21:09.310
Oh, I lost it.

00:21:09.310 --> 00:21:11.150
IKAI LAN: Right, so again, this
is the page that he's

00:21:11.150 --> 00:21:12.910
publishing.

00:21:12.910 --> 00:21:15.620
This is the page where
Salesforce is going to give

00:21:15.620 --> 00:21:18.050
back a token.

00:21:18.050 --> 00:21:19.330
This is how Salesforce
is going to give

00:21:19.330 --> 00:21:20.640
Apps Script a token.

00:21:20.640 --> 00:21:22.070
ARUN NAGARAJAN: So I'm going
to paste that in.

00:21:22.070 --> 00:21:23.940
Now, there's one thing that
you have to tweak.

00:21:23.940 --> 00:21:28.150
So when a script is bound
to a container, it's not

00:21:28.150 --> 00:21:29.150
scripts.google.com.

00:21:29.150 --> 00:21:30.300
It's docs.google.com.

00:21:30.300 --> 00:21:32.660
So this is a manual edit,
and hopefully we'll

00:21:32.660 --> 00:21:34.540
correct this very soon.

00:21:34.540 --> 00:21:38.020
And then another thing that's
really great about it is, as

00:21:38.020 --> 00:21:42.520
an administrator, you can give
domain-wide privileges.

00:21:42.520 --> 00:21:46.170
So you can make this application
available for all

00:21:46.170 --> 00:21:48.620
users without them having
to authorize it.

00:21:48.620 --> 00:21:51.320
All they need to do is log in
so that they don't get that

00:21:51.320 --> 00:21:53.270
warning message saying, hey,
there's a third-party

00:21:53.270 --> 00:21:53.880
application.

00:21:53.880 --> 00:21:54.720
Do you trust it?

00:21:54.720 --> 00:21:56.900
Which may alarm some people.

00:21:56.900 --> 00:21:58.230
So I won't check it for
this case because

00:21:58.230 --> 00:21:59.610
it's just me for now.

00:21:59.610 --> 00:22:02.010
So I'm going to hit Save.

00:22:02.010 --> 00:22:04.500
And what this is going to do
is you can see that it just

00:22:04.500 --> 00:22:05.530
registered this application.

00:22:05.530 --> 00:22:07.840
The application's called
Ikai Demo.

00:22:07.840 --> 00:22:10.220
You have the callback URL
that I pasted in.

00:22:10.220 --> 00:22:12.880
And there are two bits of
information that are very

00:22:12.880 --> 00:22:15.390
critical here, the key
and the secret.

00:22:15.390 --> 00:22:16.920
So I'm going to reveal it.

00:22:16.920 --> 00:22:18.160
You can use it.

00:22:18.160 --> 00:22:20.680
I'll delete this after.

00:22:20.680 --> 00:22:24.400
And this needs to get pasted
into the application.

00:22:24.400 --> 00:22:26.810
So copy this and--

00:22:26.810 --> 00:22:28.430
IKAI LAN: I know that some joker
out there is going to

00:22:28.430 --> 00:22:29.620
try to hack this account.

00:22:29.620 --> 00:22:32.510
But just so you guys know,
this is a test account.

00:22:32.510 --> 00:22:33.840
You're going to get absolutely
nothing of any

00:22:33.840 --> 00:22:35.790
value out of this.

00:22:35.790 --> 00:22:39.400
ARUN NAGARAJAN: So what I'm
going to do is copy over the

00:22:39.400 --> 00:22:42.910
dummy one that I had saved in
there, delete it, paste it,

00:22:42.910 --> 00:22:45.625
and then also copy
over the secret.

00:22:45.625 --> 00:22:47.870
So this is a little
bit of a set up.

00:22:47.870 --> 00:22:49.850
There's an overhead involved
with OAuth.

00:22:49.850 --> 00:22:52.310
But in the end, your
users are more--

00:22:52.310 --> 00:22:53.920
their data is more secure.

00:22:53.920 --> 00:22:55.250
They trust the applications
more.

00:22:55.250 --> 00:22:57.450
So it's a really worthwhile
thing to do.

00:22:57.450 --> 00:23:00.020
So that's what I've done so far,
the ID and the secret.

00:23:00.020 --> 00:23:03.500
So that's the pairing that
explains that this code is

00:23:03.500 --> 00:23:06.240
Ikai's demo application
that we registered.

00:23:06.240 --> 00:23:08.920
All right so, so far so good.

00:23:08.920 --> 00:23:11.400
And I'm going to quickly
test this as well.

00:23:11.400 --> 00:23:15.190
So for now, since I'm the
editor, I'll just pop open

00:23:15.190 --> 00:23:16.580
this script directly.

00:23:16.580 --> 00:23:19.620
So I'll just hit Run.

00:23:19.620 --> 00:23:21.430
That'll make me authorize it.

00:23:21.430 --> 00:23:22.580
IKAI LAN: So this is a demo.

00:23:22.580 --> 00:23:24.480
But if this were a real script,
there are a lot of

00:23:24.480 --> 00:23:27.250
things that we could do to
enhance the user interface.

00:23:27.250 --> 00:23:31.070
Like, for instance, there's the
bit about replacing the

00:23:31.070 --> 00:23:32.750
URL script in Docs.

00:23:32.750 --> 00:23:35.690
We could have made that a UI
that came up where we replace

00:23:35.690 --> 00:23:37.730
it-- where we just go ahead
and do a string substring.

00:23:37.730 --> 00:23:38.790
But we're not trying to
do that right now.

00:23:38.790 --> 00:23:40.870
We're trying to show you
guys how to access

00:23:40.870 --> 00:23:43.050
Salesforce using apps.

00:23:43.050 --> 00:23:45.140
ARUN NAGARAJAN: Yeah, the goal
is to give you guys the sample

00:23:45.140 --> 00:23:47.670
code, a bunch of recipes, and
the building blocks with which

00:23:47.670 --> 00:23:49.550
you can go ahead and build
the greatest Salesforce

00:23:49.550 --> 00:23:50.950
integration we've ever seen.

00:23:50.950 --> 00:23:54.210
So I'm going to click on just
one option here called Upload

00:23:54.210 --> 00:23:55.270
to SalesForce.

00:23:55.270 --> 00:24:00.450
And actually, one thing that
I'll want to do is clean some

00:24:00.450 --> 00:24:01.340
things up here.

00:24:01.340 --> 00:24:04.790
So ignore this for a second.

00:24:04.790 --> 00:24:06.700
Ignore that.

00:24:06.700 --> 00:24:07.770
IKAI LAN: Was that your
password out there?

00:24:07.770 --> 00:24:08.190
ARUN NAGARAJAN: No.

00:24:08.190 --> 00:24:09.040
Oh, was it in there?

00:24:09.040 --> 00:24:10.550
IKAI LAN: I don't know.

00:24:10.550 --> 00:24:12.430
We're changing it
after the show.

00:24:12.430 --> 00:24:16.710
ARUN NAGARAJAN: I'm going to hit
Run salesforceEntryPoint,

00:24:16.710 --> 00:24:17.630
hit the button.

00:24:17.630 --> 00:24:20.700
And what that's going to do is
say, hey, this is the first

00:24:20.700 --> 00:24:21.900
time you're calling this.

00:24:21.900 --> 00:24:23.990
I don't know who you are.

00:24:23.990 --> 00:24:25.800
I tried to log into
Salesforce.

00:24:25.800 --> 00:24:28.050
It wanted me to go in
and then hit Login.

00:24:28.050 --> 00:24:31.465
So I'm going to hit Click
Here to Start.

00:24:31.465 --> 00:24:33.630
IKAI LAN: It's opening
a new tab.

00:24:33.630 --> 00:24:37.190
ARUN NAGARAJAN: So now you can
see that it says, Ikai Demo is

00:24:37.190 --> 00:24:39.900
requesting permission to access
your information.

00:24:39.900 --> 00:24:43.250
You can see the logo that we
supplied, the description, and

00:24:43.250 --> 00:24:46.500
all sorts of useful things that
I think is important.

00:24:46.500 --> 00:24:47.710
And I'm already logged in.

00:24:47.710 --> 00:24:49.260
That's why it didn't
ask me to log in.

00:24:49.260 --> 00:24:52.290
If I weren't logged in, it'll
actually make me log in again.

00:24:52.290 --> 00:24:55.790
So now I'm going to go
ahead and say Allow.

00:24:55.790 --> 00:24:59.270
And now you can see that
the URL callback--

00:24:59.270 --> 00:25:01.820
client identifier invalid.

00:25:01.820 --> 00:25:03.210
I screwed something up.

00:25:03.210 --> 00:25:04.460
Let's take a look.

00:25:08.038 --> 00:25:10.040
Let's try one more time.

00:25:10.040 --> 00:25:11.250
IKAI LAN: Ah, your client ID.

00:25:11.250 --> 00:25:14.010
Now, you pasted over the client
secret as well as the

00:25:14.010 --> 00:25:16.620
key, but I don't think you
set the client ID.

00:25:16.620 --> 00:25:19.030
ARUN NAGARAJAN: No, what I
didn't do is, once I pasted in

00:25:19.030 --> 00:25:21.452
the code, I didn't
republish it.

00:25:21.452 --> 00:25:22.930
IKAI LAN: Ah, of course.

00:25:22.930 --> 00:25:25.740
ARUN NAGARAJAN: So this is one
of the things that-- you kind

00:25:25.740 --> 00:25:28.880
of have to publish it first,
and then you'll get the new

00:25:28.880 --> 00:25:29.600
credentials.

00:25:29.600 --> 00:25:32.560
And you have to paste it in
and then republish it--

00:25:32.560 --> 00:25:35.120
a little bit of an annoyance.

00:25:35.120 --> 00:25:37.010
All right, go ahead.

00:25:37.010 --> 00:25:38.820
IKAI LAN: So this
is OAuth 2.0.

00:25:38.820 --> 00:25:41.330
In OAuth 1.0, they had all these
different parameters you

00:25:41.330 --> 00:25:41.980
had to pass in.

00:25:41.980 --> 00:25:44.950
And one of them, I believe,
was a client ID.

00:25:44.950 --> 00:25:46.400
So I don't think you have
to do that anymore

00:25:46.400 --> 00:25:48.450
in OAuth 2.0, but--

00:25:48.450 --> 00:25:49.190
there you go.

00:25:49.190 --> 00:25:50.720
ARUN NAGARAJAN: Cool, so
I just refreshed it.

00:25:50.720 --> 00:25:53.020
Hopefully the error message will
not happen when you're

00:25:53.020 --> 00:25:54.380
doing this for the first time.

00:25:54.380 --> 00:25:56.460
But you can see that, at
this point, the URL is

00:25:56.460 --> 00:25:57.890
[? rpublishservice ?].

00:25:57.890 --> 00:26:00.520
So this is the callback that
I was talking about.

00:26:00.520 --> 00:26:04.140
OK, so I can close this window,
go back in here into

00:26:04.140 --> 00:26:06.540
the spreadsheet-- again, so
this is not very nice.

00:26:06.540 --> 00:26:08.520
You could have a little
timer in here.

00:26:08.520 --> 00:26:10.170
You could automatically
close it.

00:26:10.170 --> 00:26:11.950
I was being a little lazy.

00:26:11.950 --> 00:26:15.250
So actually, before I use it,
let's set up the context as to

00:26:15.250 --> 00:26:16.730
why we want to do this.

00:26:16.730 --> 00:26:20.210
So if I go into my Account
section here-- or Contacts, I

00:26:20.210 --> 00:26:21.070
should say--

00:26:21.070 --> 00:26:22.760
I have a lot of contacts here.

00:26:22.760 --> 00:26:26.000
But maybe I want to bulk-enter
a bunch of contacts.

00:26:26.000 --> 00:26:29.600
I'm an admin, I'm familiar with
spreadsheets, I don't

00:26:29.600 --> 00:26:32.350
want to deal with salesforce.com
directly.

00:26:32.350 --> 00:26:39.585
So what I'll do is just type in
a bunch of contacts, type

00:26:39.585 --> 00:26:42.200
in some numbers--

00:26:42.200 --> 00:26:45.834
do you want to give your
real email out, Ikai?

00:26:45.834 --> 00:26:47.806
IKAI LAN: Yeah, that's fine.

00:26:47.806 --> 00:26:49.525
How did you know?

00:26:49.525 --> 00:26:50.500
ARUN NAGARAJAN: Let
me fix this.

00:26:50.500 --> 00:26:52.470
I think there's some
format checkers.

00:26:52.470 --> 00:26:54.170
I think it makes sure that
it's at least numbers.

00:26:54.170 --> 00:26:58.820
And we'll use our producer,
Eric, as well.

00:26:58.820 --> 00:27:01.250
eric@test.com.

00:27:01.250 --> 00:27:05.610
All right, so we've just punched
in three contacts

00:27:05.610 --> 00:27:08.620
really quickly-- their names,
their contact info.

00:27:08.620 --> 00:27:10.590
What I'm going to do is go
ahead and say Upload to

00:27:10.590 --> 00:27:11.840
SalesForce.

00:27:11.840 --> 00:27:13.980
And I'll show you the code as
well, so that this doesn't

00:27:13.980 --> 00:27:15.660
seem like magic.

00:27:15.660 --> 00:27:19.170
And this time, it again says,
hey, you know what?

00:27:19.170 --> 00:27:20.700
You don't have to log
in this time.

00:27:20.700 --> 00:27:22.020
I already have the token.

00:27:22.020 --> 00:27:24.270
And I've gone ahead and
uploaded these people.

00:27:24.270 --> 00:27:25.020
Beautiful, isn't it?

00:27:25.020 --> 00:27:27.160
IKAI LAN: I'm, like, laughing
at this right now.

00:27:27.160 --> 00:27:31.420
You made the message the
giant title box.

00:27:31.420 --> 00:27:32.730
ARUN NAGARAJAN: Of
course, man.

00:27:32.730 --> 00:27:36.000
So what I'll do is actually
go into New This Week,

00:27:36.000 --> 00:27:37.305
and there they are.

00:27:37.305 --> 00:27:39.320
So the contacts that
we just added--

00:27:39.320 --> 00:27:42.280
hopefully you guys can see
on the line there.

00:27:42.280 --> 00:27:45.500
But that's the power
of Apps Script.

00:27:45.500 --> 00:27:47.650
So you can work with the simple
tools that you're

00:27:47.650 --> 00:27:48.780
familiar with, things like

00:27:48.780 --> 00:27:50.410
Spreadsheets, things like Docs.

00:27:50.410 --> 00:27:52.690
And then through a
couple clicks--

00:27:52.690 --> 00:27:54.240
boom, publish out to
another service.

00:27:54.240 --> 00:27:56.010
IKAI LAN: And there are lots of
reasons why you might want

00:27:56.010 --> 00:27:57.720
to use the Spreadsheets
UI to do this.

00:27:57.720 --> 00:28:00.350
Now, could we go ahead and show
us how you would create a

00:28:00.350 --> 00:28:02.390
new contact using the
Salesforce UI?

00:28:02.390 --> 00:28:03.930
ARUN NAGARAJAN: Yes,
New Contact.

00:28:03.930 --> 00:28:05.820
IKAI LAN: So we're going
to click New Contact.

00:28:05.820 --> 00:28:08.420
And now you'll see that, OK,
you've got to jump around from

00:28:08.420 --> 00:28:09.240
field to field.

00:28:09.240 --> 00:28:13.180
So you get a lot more features
here for instance, but you

00:28:13.180 --> 00:28:15.930
could always modify the script
to include additional fields.

00:28:15.930 --> 00:28:18.780
It's just that suppose that--
he very quickly entered in

00:28:18.780 --> 00:28:20.220
three contacts.

00:28:20.220 --> 00:28:22.200
And now it would probably--

00:28:22.200 --> 00:28:22.560
here you go.

00:28:22.560 --> 00:28:23.930
It's taking a little bit
longer to do it.

00:28:23.930 --> 00:28:24.850
ARUN NAGARAJAN: And then
I would have to

00:28:24.850 --> 00:28:25.700
do it again, yeah.

00:28:25.700 --> 00:28:26.480
IKAI LAN: And he'd have to
do it again and again.

00:28:26.480 --> 00:28:29.110
So there are definitely
lots of reasons.

00:28:29.110 --> 00:28:32.290
Other reasons are, for instance,
maybe you have a

00:28:32.290 --> 00:28:34.590
Google Form attached to your
spreadsheet where people

00:28:34.590 --> 00:28:36.900
submit their contact
information.

00:28:36.900 --> 00:28:38.150
ARUN NAGARAJAN: We're not going
to show that right now.

00:28:38.150 --> 00:28:40.700
But for instance, you could
just go and say

00:28:40.700 --> 00:28:42.750
Tools, Create a Form.

00:28:42.750 --> 00:28:45.960
And it's smart enough to know
that the fields are FirstName,

00:28:45.960 --> 00:28:47.400
LastName, Email, and Phone.

00:28:47.400 --> 00:28:49.990
And this is a very simple thing
you can publish out.

00:28:49.990 --> 00:28:52.270
And yeah, that's great.

00:28:52.270 --> 00:28:53.740
So I'll show you the
code real quick.

00:28:53.740 --> 00:28:56.350
We won't dwell on it too much
because there are a lot of

00:28:56.350 --> 00:28:57.560
moving pieces.

00:28:57.560 --> 00:29:01.930
But what it really does is calls
the Utilities function

00:29:01.930 --> 00:29:03.110
getRowsData--

00:29:03.110 --> 00:29:04.560
hopefully you guys
can see that--

00:29:04.560 --> 00:29:08.090
and then just iterates through
all the objects, creates a

00:29:08.090 --> 00:29:11.460
little post payload, and
then just sends it

00:29:11.460 --> 00:29:13.130
up using URL Fetch.

00:29:13.130 --> 00:29:16.060
So URL Fetch is your friend
in these cases.

00:29:16.060 --> 00:29:19.300
And then further down-- and you
can see this in the script

00:29:19.300 --> 00:29:23.590
as well-- there's lot of set
up that needs to happen to

00:29:23.590 --> 00:29:26.470
preserve the user's properties
for the token, for the

00:29:26.470 --> 00:29:28.310
callback server for
themselves.

00:29:28.310 --> 00:29:30.870
You need to make sure that the
authorization header is passed

00:29:30.870 --> 00:29:34.130
where the OAuth token that was
downloaded is passed up.

00:29:34.130 --> 00:29:36.060
So these are the things that you
need to keep in mind, but

00:29:36.060 --> 00:29:39.920
hopefully all the samples
will make it

00:29:39.920 --> 00:29:42.286
easier for you get started.

00:29:42.286 --> 00:29:43.590
Does that make sense to you?

00:29:43.590 --> 00:29:44.150
IKAI LAN: Makes sense.

00:29:44.150 --> 00:29:44.920
ARUN NAGARAJAN: All
right, cool.

00:29:44.920 --> 00:29:47.340
So let's do the last bit, and
then hopefully there are some

00:29:47.340 --> 00:29:49.486
questions as well that
we can take.

00:29:49.486 --> 00:29:52.360
Great, so the last thing
that I wanted to do

00:29:52.360 --> 00:29:53.990
was let's go into--

00:29:53.990 --> 00:29:58.440
so I set up this sample account
called Arun DevRel.

00:29:58.440 --> 00:30:00.470
All right, so this account--

00:30:00.470 --> 00:30:02.640
he's a COO.

00:30:02.640 --> 00:30:05.530
And he's got a bunch of details
about him-- the last

00:30:05.530 --> 00:30:09.420
time I talked to him, the last
time I tried to sell to him,

00:30:09.420 --> 00:30:10.490
and whatnot.

00:30:10.490 --> 00:30:14.140
So this is a contact that I have
a relationship with for

00:30:14.140 --> 00:30:15.080
business purposes.

00:30:15.080 --> 00:30:16.236
IKAI LAN: So I'm thinking
about this demo.

00:30:16.236 --> 00:30:17.710
And we should have named it
[? Colleague ?] because now

00:30:17.710 --> 00:30:18.890
it's just going to
be confusing.

00:30:18.890 --> 00:30:19.440
Do you know what I mean?

00:30:19.440 --> 00:30:20.440
ARUN NAGARAJAN: Yeah,
probably.

00:30:20.440 --> 00:30:21.800
There are a lot of--

00:30:21.800 --> 00:30:23.940
yeah, I should probably have
thought about that.

00:30:23.940 --> 00:30:24.920
You're right.

00:30:24.920 --> 00:30:27.530
So what we're going to do for
this demo is we're actually

00:30:27.530 --> 00:30:29.970
going to paste in a new
function, which is going to

00:30:29.970 --> 00:30:33.730
allow the Apps Script
environment to go ahead and

00:30:33.730 --> 00:30:36.320
seek into my inbox and
find matches for

00:30:36.320 --> 00:30:37.760
emails from this person.

00:30:37.760 --> 00:30:40.410
And then actually if there's an
attachment associated with

00:30:40.410 --> 00:30:43.510
it, take that attachment and
push it up to Salesforce as an

00:30:43.510 --> 00:30:46.140
attachment that's available
within the system.

00:30:46.140 --> 00:30:48.320
So that when I'm collaborating
with someone through

00:30:48.320 --> 00:30:50.810
salesforce.com, they can
reach into this.

00:30:50.810 --> 00:30:51.590
They can edit it.

00:30:51.590 --> 00:30:53.490
They can add notes
to it, and so on.

00:30:53.490 --> 00:30:55.455
IKAI LAN: So again, to
disambiguate the accounts,

00:30:55.455 --> 00:30:58.290
he's receiving emails
from Arun DevRel,

00:30:58.290 --> 00:30:59.940
and he is Arun Nagarajan.

00:30:59.940 --> 00:31:01.200
ARUN NAGARAJAN: That's right,
and I'll actually showcase

00:31:01.200 --> 00:31:03.410
that one more time.

00:31:03.410 --> 00:31:08.540
So the email associated here
is appsscript@gmail.com.

00:31:08.540 --> 00:31:10.430
So that's my DevRel account--

00:31:10.430 --> 00:31:13.470
Developer Relations, code for.

00:31:13.470 --> 00:31:16.340
And I'm actually logged in to
this account, so this is-- you

00:31:16.340 --> 00:31:18.230
can see that, it's
Arun DevRel.

00:31:18.230 --> 00:31:21.590
And this is my inbox associated
with Salesforce.

00:31:21.590 --> 00:31:23.440
So this is just my test inbox.

00:31:23.440 --> 00:31:25.230
You see there's a few
messages in there.

00:31:25.230 --> 00:31:29.270
OK, so what I'm going to do is
pretend to be this customer of

00:31:29.270 --> 00:31:31.910
Arun and hit Compose.

00:31:31.910 --> 00:31:38.650
And I'm going to say,
my details for you.

00:31:38.650 --> 00:31:42.760
Sending this doc for review.

00:31:42.760 --> 00:31:44.990
And I'm going to actually--

00:31:44.990 --> 00:31:48.980
I think it's called Sales Detail
or something like that.

00:31:48.980 --> 00:31:51.710
And it's actually a Microsoft
Word documents as well.

00:31:51.710 --> 00:31:54.340
IKAI LAN: So a lot of reasons
why Salesforce allows

00:31:54.340 --> 00:31:56.550
attachments is that a lot of
times, you have these things

00:31:56.550 --> 00:31:59.410
called RFPs, which stands for
Request For Proposal.

00:31:59.410 --> 00:32:03.700
So typically, people tend
to use Word or PDFs.

00:32:03.700 --> 00:32:06.130
Now as much as I would love to
see people doing this in

00:32:06.130 --> 00:32:09.070
Google Docs, the reality is that
there are lots of times

00:32:09.070 --> 00:32:10.520
when you want to
send out a PDF.

00:32:10.520 --> 00:32:13.960
Or perhaps you want to send
out a Visio doc that says,

00:32:13.960 --> 00:32:15.440
here's how you would wire
up your network.

00:32:15.440 --> 00:32:17.800
ARUN NAGARAJAN: Right, there
are a lot of people that

00:32:17.800 --> 00:32:20.520
haven't seen the light, I
guess, with Google Docs.

00:32:20.520 --> 00:32:23.270
So what I'll do is I'll paste
in this other function.

00:32:23.270 --> 00:32:25.310
And this is called scanEmail.

00:32:25.310 --> 00:32:27.970
And for now, we're just going
to run it manually.

00:32:27.970 --> 00:32:31.310
But this, as you can see after
this runs, can be triggered

00:32:31.310 --> 00:32:34.210
every hour or every minute,
whatever makes sense for your

00:32:34.210 --> 00:32:35.610
personal purposes.

00:32:35.610 --> 00:32:37.150
I'm going to save this.

00:32:37.150 --> 00:32:42.050
And I'm going to go ahead and
pick that function to run.

00:32:42.050 --> 00:32:43.680
And I'm going to say--

00:32:43.680 --> 00:32:46.550
so it's going to realize that
I'm now trying to trick it and

00:32:46.550 --> 00:32:47.400
read my email.

00:32:47.400 --> 00:32:50.500
So it's going to make sure
that I reauthorize it--

00:32:50.500 --> 00:32:58.110
Grant Access, Close, this
time run it for real.

00:32:58.110 --> 00:32:59.580
All right, so what
is it doing?

00:32:59.580 --> 00:33:03.640
So it's going into this inbox,
looks through my email, sees

00:33:03.640 --> 00:33:07.040
that there's an email from this
particular email address,

00:33:07.040 --> 00:33:10.840
which matches a Contacts email
address in Salesforce.

00:33:10.840 --> 00:33:15.130
And then, if the demo gods are
with me, there should be a new

00:33:15.130 --> 00:33:18.490
attachment that wasn't there
before now visible.

00:33:18.490 --> 00:33:21.610
And it's in fact also converted
into a PDF.

00:33:21.610 --> 00:33:24.850
So I can click on
it and view it.

00:33:24.850 --> 00:33:25.520
IKAI LAN: Wow, very nice.

00:33:25.520 --> 00:33:26.240
ARUN NAGARAJAN: Make sense?

00:33:26.240 --> 00:33:28.520
Yeah, so let me just show
you the code real quick.

00:33:28.520 --> 00:33:32.570
So for the purposes of this
demo, I made it just so that

00:33:32.570 --> 00:33:34.540
it scans the last
five threads.

00:33:34.540 --> 00:33:37.520
You could go and be a bit more
intelligent, remember where it

00:33:37.520 --> 00:33:40.090
left off and do some pretty
interesting backoff there.

00:33:40.090 --> 00:33:42.330
IKAI LAN: So when I've been
programming with Gmail App,

00:33:42.330 --> 00:33:45.290
one thing that I like to do is
look for a document that looks

00:33:45.290 --> 00:33:46.910
for saved searches.

00:33:46.910 --> 00:33:48.700
Because there are a lot of very
powerful things you can

00:33:48.700 --> 00:33:49.990
do with Gmail searches.

00:33:49.990 --> 00:33:52.040
You can say, label dash label.

00:33:52.040 --> 00:33:54.600
You could say, has
colon attachment.

00:33:54.600 --> 00:33:56.910
There are lots of things you
could do to filter down before

00:33:56.910 --> 00:33:58.050
you start iterating
over things.

00:33:58.050 --> 00:33:58.660
ARUN NAGARAJAN: That's
a good one, yeah.

00:33:58.660 --> 00:34:00.140
IKAI LAN: Since this is a demo,
we're just going to go

00:34:00.140 --> 00:34:01.570
over the last five emails.

00:34:01.570 --> 00:34:03.440
ARUN NAGARAJAN: Exactly,
I'm cheating.

00:34:03.440 --> 00:34:06.005
So what I'm going to do is then
also look for emails with

00:34:06.005 --> 00:34:06.600
an attachment.

00:34:06.600 --> 00:34:07.904
I probably should have
used your trick.

00:34:07.904 --> 00:34:09.110
That's a really good one.

00:34:09.110 --> 00:34:11.080
Then I'm going to find
the first attachment.

00:34:11.080 --> 00:34:13.670
And then I'm going to read
the attachment as a PDF.

00:34:13.670 --> 00:34:16.810
So this is that sort of online
conversion that Apps Script

00:34:16.810 --> 00:34:19.050
provides that I think
is ultra-powerful.

00:34:19.050 --> 00:34:21.310
And then I'm going to take
the bytes and then

00:34:21.310 --> 00:34:22.670
Base64 encode it.

00:34:22.670 --> 00:34:25.850
So this is something that the
Salesforce API stipulates.

00:34:25.850 --> 00:34:29.920
It only likes documents as
Base64 encoded blobs.

00:34:29.920 --> 00:34:32.870
And then it gets the email
address of the person.

00:34:32.870 --> 00:34:34.909
The address comes in this
format, so there's a little

00:34:34.909 --> 00:34:37.050
regular expression magic
that happens.

00:34:37.050 --> 00:34:40.219
Then it sees, is that email
address associated with the

00:34:40.219 --> 00:34:41.900
contact in Salesforce?

00:34:41.900 --> 00:34:42.570
Runs that--

00:34:42.570 --> 00:34:43.170
IKAI LAN: And you're using--

00:34:43.170 --> 00:34:45.409
that's not SQL, that's SOQL.

00:34:48.380 --> 00:34:50.219
ARUN NAGARAJAN: Then it's going
to use the original name

00:34:50.219 --> 00:34:55.250
and attach a PDF extension to
it along with some details,

00:34:55.250 --> 00:34:59.020
give it a parent ID of that
person that matches that email

00:34:59.020 --> 00:35:01.510
address, and then just run it.

00:35:01.510 --> 00:35:02.940
IKAI LAN: And the parent ID,
what does that represent?

00:35:02.940 --> 00:35:04.860
ARUN NAGARAJAN: In this
case, the contact ID.

00:35:04.860 --> 00:35:09.420
So it runs the Select against
that entity, gets the contact

00:35:09.420 --> 00:35:13.030
ID like so, and then it
associates it with the parent.

00:35:13.030 --> 00:35:16.170
So most objects in Salesforce
can have attachments.

00:35:16.170 --> 00:35:19.100
So I can have a parent ID of an
account ID, and that'll be

00:35:19.100 --> 00:35:20.820
an attachment against
the account.

00:35:20.820 --> 00:35:23.230
So hopefully that made sense.

00:35:23.230 --> 00:35:27.290
So what we've been able to do is
automatically find an email

00:35:27.290 --> 00:35:31.850
with an attachment in it for
people that have a record in

00:35:31.850 --> 00:35:35.100
my salesforce.com instance, and
then be able to send an

00:35:35.100 --> 00:35:36.480
attachment to that record.

00:35:36.480 --> 00:35:37.890
So this code--

00:35:37.890 --> 00:35:40.050
again, all of this
is on GitHub.

00:35:40.050 --> 00:35:42.190
Go check it out-- pretty
easy to find.

00:35:42.190 --> 00:35:46.170
If you just go to
github.com/entaq, it's the

00:35:46.170 --> 00:35:48.910
second project there,
hopefully.

00:35:48.910 --> 00:35:49.720
There it is.

00:35:49.720 --> 00:35:52.150
And then if you just look
through it, all the code we

00:35:52.150 --> 00:35:53.830
talked about is there.

00:35:53.830 --> 00:35:56.450
And then you'll be able to
create a sample account in

00:35:56.450 --> 00:35:59.690
salesforce.com yourselves and
try this all yourself.

00:35:59.690 --> 00:36:01.020
IKAI LAN: Very, very cool.

00:36:01.020 --> 00:36:04.810
In fact, I think that-- we
keep talking about SOQL,

00:36:04.810 --> 00:36:08.634
"so-quill," and I think that
you're so cool for being able

00:36:08.634 --> 00:36:09.280
to pull this demo off.

00:36:09.280 --> 00:36:10.860
I've been waiting for
that one all show.

00:36:10.860 --> 00:36:11.480
You've gotta give this to me.

00:36:11.480 --> 00:36:12.900
ARUN NAGARAJAN: No,
that's good.

00:36:12.900 --> 00:36:15.460
IKAI LAN: Let's take a look to
see if there any questions in

00:36:15.460 --> 00:36:17.180
Google Moderator.

00:36:17.180 --> 00:36:18.950
There weren't any when we
started up the show.

00:36:18.950 --> 00:36:21.260
But it's possible that we have
live viewers that, as

00:36:21.260 --> 00:36:22.590
watching, came up
with questions.

00:36:22.590 --> 00:36:23.840
So we'll see if there's
anything there.

00:36:23.840 --> 00:36:25.880
ARUN NAGARAJAN: I actually
don't have a link to that

00:36:25.880 --> 00:36:27.580
directly, so let me see
if I can find it.

00:36:27.580 --> 00:36:29.380
IKAI LAN: So--
developers.google.com/live--

00:36:29.380 --> 00:36:32.240
so if you're finding this show
from our YouTube channel at

00:36:32.240 --> 00:36:35.200
youtube.com/googledevelopers,
you can always find out about

00:36:35.200 --> 00:36:40.700
future live shows at
developers.google.com/live.

00:36:40.700 --> 00:36:41.640
It's going to take
a little bit.

00:36:41.640 --> 00:36:44.010
There we go.

00:36:44.010 --> 00:36:45.190
ARUN NAGARAJAN: All
right, let's see.

00:36:45.190 --> 00:36:47.900
So "could you write an Apps
Script to integrate with

00:36:47.900 --> 00:36:50.530
Salesforce Chatter, Salesforce's
social media

00:36:50.530 --> 00:36:51.510
channel for the enterprise?

00:36:51.510 --> 00:36:54.330
That would be neat." This
is Marc R from Waltham.

00:36:54.330 --> 00:36:55.790
So the answer is, yes.

00:36:55.790 --> 00:36:59.200
So the Chatter API is also
exposed to the REST interface.

00:36:59.200 --> 00:37:02.420
And you're able to query against
it and run clouds

00:37:02.420 --> 00:37:04.950
about which people are chatting
the most, which

00:37:04.950 --> 00:37:07.870
people are liking my posts,
and things like that.

00:37:07.870 --> 00:37:10.460
So the social enterprise can
be brought into the Google

00:37:10.460 --> 00:37:11.520
Docs platform as well--

00:37:11.520 --> 00:37:14.460
Google Apps platform,
I should say.

00:37:14.460 --> 00:37:15.280
IKAI LAN: Good question.

00:37:15.280 --> 00:37:16.610
ARUN NAGARAJAN: Really
good question.

00:37:16.610 --> 00:37:18.170
All right, let's see. "You're
probably already

00:37:18.170 --> 00:37:18.790
planning to do this.

00:37:18.790 --> 00:37:21.950
Please include a few minutes
of Goo Salesforce for those

00:37:21.950 --> 00:37:23.620
who are not using it."

00:37:23.620 --> 00:37:25.680
IKAI LAN: For Goo Salesforce.

00:37:25.680 --> 00:37:28.950
ARUN NAGARAJAN: I'm not sure
what that is, but I'll have to

00:37:28.950 --> 00:37:31.030
look into that.

00:37:31.030 --> 00:37:32.840
Hopefully, that's a typo.

00:37:32.840 --> 00:37:34.580
But maybe they were just
talking about just an

00:37:34.580 --> 00:37:35.710
introduction to Salesforce.

00:37:35.710 --> 00:37:37.960
So another resource that
I didn't point out

00:37:37.960 --> 00:37:39.620
is this REST API.

00:37:39.620 --> 00:37:40.860
So take a look at this
one as well.

00:37:40.860 --> 00:37:45.360
So salesforce.com/us/developer
has all these docs.

00:37:45.360 --> 00:37:49.640
And this kind of outlines all
the real API endpoints that

00:37:49.640 --> 00:37:51.020
they expose--

00:37:51.020 --> 00:37:52.485
by objects, by version.

00:37:52.485 --> 00:37:54.830
So you can actually go ahead
and take a look at how we

00:37:54.830 --> 00:37:56.680
figured out the attachment
example.

00:37:56.680 --> 00:37:59.930
So I can just go in here, go
into Working with Records,

00:37:59.930 --> 00:38:00.680
Creating a Record.

00:38:00.680 --> 00:38:03.260
So this is the example that I
used to figure out how to

00:38:03.260 --> 00:38:05.550
upload a contact,
for instance--

00:38:05.550 --> 00:38:07.990
very straightforward.

00:38:07.990 --> 00:38:08.610
Cool.

00:38:08.610 --> 00:38:09.360
Does that make sense to you?

00:38:09.360 --> 00:38:10.670
IKAI LAN: It makes
sense to me.

00:38:10.670 --> 00:38:13.510
Let's see if he's come in
with any more questions.

00:38:13.510 --> 00:38:15.640
Because sometimes what happens
is, when we're doing these

00:38:15.640 --> 00:38:18.260
live shows, more and more
questions come in.

00:38:18.260 --> 00:38:21.030
And if not, you guys know where
to find us and you can

00:38:21.030 --> 00:38:23.770
feel free to post comments on
the YouTube video as well.

00:38:23.770 --> 00:38:25.850
We're going to take a look at
this every once in a while and

00:38:25.850 --> 00:38:28.290
see if anyone has any new
questions or comments.

00:38:28.290 --> 00:38:31.560
Again, you can always find us at
the standard channels, too.

00:38:31.560 --> 00:38:32.880
So all right.

00:38:32.880 --> 00:38:34.220
Is there anything else
you want to show us?

00:38:34.220 --> 00:38:35.060
ARUN NAGARAJAN: Let's see.

00:38:35.060 --> 00:38:37.090
I think that that about covers
everything that I

00:38:37.090 --> 00:38:38.390
want to talk about.

00:38:38.390 --> 00:38:41.560
Hopefully this gives you some
ideas, some sort of building

00:38:41.560 --> 00:38:44.030
blocks with which you can take
and build your own cool

00:38:44.030 --> 00:38:46.100
applications and workflows.

00:38:46.100 --> 00:38:48.190
Think about integrating with
the Google Calendar.

00:38:48.190 --> 00:38:50.490
Think about doing some
interesting things with Gmail

00:38:50.490 --> 00:38:51.530
Labels and [? Start ?]

00:38:51.530 --> 00:38:53.190
Emails and things like that.

00:38:53.190 --> 00:38:55.560
Do you have any other ideas that
would make sense in this?

00:38:55.560 --> 00:38:57.980
IKAI LAN: Yeah, a very common
thing that we used to do is,

00:38:57.980 --> 00:39:02.150
sometimes you talk to people,
you talk to prospects, and

00:39:02.150 --> 00:39:03.240
they're not ready to buy yet.

00:39:03.240 --> 00:39:03.760
They don't have budget yet.

00:39:03.760 --> 00:39:06.440
But they tell you, I'm going
to have budge in Q3 or Q4.

00:39:06.440 --> 00:39:09.560
Now, Salesforce does have an
interface that says, find me

00:39:09.560 --> 00:39:11.090
these people when I should
contact them.

00:39:11.090 --> 00:39:13.470
But if you're already using
Google Calendar, that's

00:39:13.470 --> 00:39:15.240
another very interesting
use case.

00:39:15.240 --> 00:39:17.330
ARUN NAGARAJAN: Yep, setting up
reminders and things like

00:39:17.330 --> 00:39:17.580
that, that's really cool.

00:39:17.580 --> 00:39:19.280
IKAI LAN: Right, and there's so
many things that you could

00:39:19.280 --> 00:39:20.610
do once you integrate
with Google Apps.

00:39:20.610 --> 00:39:22.800
You're taking all the power of
Salesforce, which you're

00:39:22.800 --> 00:39:25.480
likely already using if you're
a Salesforce shop, and you're

00:39:25.480 --> 00:39:26.480
just extending it.

00:39:26.480 --> 00:39:28.310
Because a lot of times I see
people that are doing these

00:39:28.310 --> 00:39:29.340
very manual things.

00:39:29.340 --> 00:39:30.750
ARUN NAGARAJAN: Right, yes.

00:39:30.750 --> 00:39:33.650
Any time you find yourself doing
something that's mundane

00:39:33.650 --> 00:39:37.240
or repeatable, find a way to
write a script for that.

00:39:37.240 --> 00:39:37.930
IKAI LAN: Right.

00:39:37.930 --> 00:39:40.620
OK, so I think that's all we
have for today then, isn't it?

00:39:40.620 --> 00:39:41.960
ARUN NAGARAJAN: Yeah, that
covered all the three things

00:39:41.960 --> 00:39:43.170
that I wanted to talk about.

00:39:43.170 --> 00:39:44.230
Thank you for watching.

00:39:44.230 --> 00:39:45.790
IKAI LAN: Thank you
guys for watching.

00:39:45.790 --> 00:39:48.320
Again, we'll be having these
shows of various topics.

00:39:48.320 --> 00:39:50.160
And this is for people that
are on the live show.

00:39:50.160 --> 00:39:52.580
We'll be doing a show
about triggers.

00:39:52.580 --> 00:39:54.240
This will be happening
next Tuesday.

00:39:54.240 --> 00:39:57.280
So check
developers.google.com/live,

00:39:57.280 --> 00:39:59.010
and you'll be able to see when
that show's going to be.

00:39:59.010 --> 00:40:01.150
So if you were watching this
show and you're thinking,

00:40:01.150 --> 00:40:04.240
well, this is all very cool,
but I want to periodically

00:40:04.240 --> 00:40:06.070
update a spreadsheet, or
I want to periodically

00:40:06.070 --> 00:40:07.250
send an email out.

00:40:07.250 --> 00:40:09.450
Now, I'm pretty sure you can
do that in Salesforce.

00:40:09.450 --> 00:40:13.830
But suppose you prefer
programmatically editing it

00:40:13.830 --> 00:40:14.920
and sending it out in Gmail.

00:40:14.920 --> 00:40:16.480
Well, you can do that
using triggers.

00:40:16.480 --> 00:40:18.720
And we'll be talking about
how to use triggers.

00:40:18.720 --> 00:40:20.070
And that'll be happening
next Tuesday.

00:40:20.070 --> 00:40:23.110
So again, go to
developers.google.com/live.

00:40:23.110 --> 00:40:27.260
And you'll be able to find
details about future shows.

00:40:27.260 --> 00:40:28.800
OK, so yeah, that's our show.

00:40:28.800 --> 00:40:29.750
ARUN NAGARAJAN: Thank
you very much.

00:40:29.750 --> 00:40:31.080
IKAI LAN: Thank you
guys very much.

00:40:31.080 --> 00:40:32.120
You guys have a great weekend.

00:40:32.120 --> 00:40:33.370
And we'll see you next time.

