WEBVTT
Kind: captions
Language: en

00:00:00.500 --> 00:00:03.400
LAURENCE MORONEY: Our last
session of the day on Firebase.

00:00:03.400 --> 00:00:06.540
I'm Laurence Moroney
[SPEAKING CHINESE].

00:00:09.850 --> 00:00:12.580
And so I'm going to be
talking about Firebase Cloud

00:00:12.580 --> 00:00:14.940
Messaging and Firebase
Notifications,

00:00:14.940 --> 00:00:16.440
and some of the
technologies that we

00:00:16.440 --> 00:00:19.050
have in Firebase for you
to deliver notifications

00:00:19.050 --> 00:00:19.890
to your end users.

00:00:19.890 --> 00:00:21.420
It's quite a short
talk, and there's

00:00:21.420 --> 00:00:23.440
going to be a few
demos in there as well.

00:00:23.440 --> 00:00:25.606
And I'm going to try and
make the demos interactive,

00:00:25.606 --> 00:00:28.040
so I'm going to need
your help with them.

00:00:28.040 --> 00:00:32.880
To get started, talking a little
bit about what notifications

00:00:32.880 --> 00:00:36.420
are and some of the technologies
that we have at Google.

00:00:36.420 --> 00:00:39.916
So how many of you have heard
of Firebase Notifications?

00:00:39.916 --> 00:00:41.360
Not many.

00:00:41.360 --> 00:00:43.620
And how about Firebase Cloud
Messaging or Google Cloud

00:00:43.620 --> 00:00:45.355
Messaging?

00:00:45.355 --> 00:00:46.310
Not many more.

00:00:46.310 --> 00:00:47.640
OK, interesting.

00:00:47.640 --> 00:00:50.700
So I'm going to start with
Firebase Notifications.

00:00:50.700 --> 00:00:53.390
And the idea behind
Firebase Notifications

00:00:53.390 --> 00:00:57.750
is that we wanted to give you
a technology that you could use

00:00:57.750 --> 00:01:01.920
to deliver real time
notifications to your end users

00:01:01.920 --> 00:01:05.340
without you requiring to
build any kind of server

00:01:05.340 --> 00:01:07.470
infrastructure to do so.

00:01:07.470 --> 00:01:09.745
So if you use Firebase,
we have a thing

00:01:09.745 --> 00:01:11.880
at Firebase called the
Firebase Console that you

00:01:11.880 --> 00:01:12.930
might be familiar with.

00:01:12.930 --> 00:01:15.420
And the Firebase Console
is used for things

00:01:15.420 --> 00:01:18.270
like analytics and crash
reporting, and all that.

00:01:18.270 --> 00:01:20.520
And within the Firebase
Console, you're

00:01:20.520 --> 00:01:22.710
given a user
interface that allows

00:01:22.710 --> 00:01:26.370
you to define the notification
that you send to your users,

00:01:26.370 --> 00:01:28.590
and importantly, and
perhaps more importantly,

00:01:28.590 --> 00:01:31.080
pick the population of
users that you're going

00:01:31.080 --> 00:01:33.240
to send that notification to.

00:01:33.240 --> 00:01:35.220
So this is a really
useful technology,

00:01:35.220 --> 00:01:38.730
I think, for the business
side of your house.

00:01:38.730 --> 00:01:41.040
So people who are not
developers, people

00:01:41.040 --> 00:01:43.524
who are marketers, people
who a business group,

00:01:43.524 --> 00:01:44.940
that kind of thing,
who don't want

00:01:44.940 --> 00:01:47.830
to deal with actually writing
a server or managing a server.

00:01:47.830 --> 00:01:48.455
[MUSIC PLAYING]

00:01:48.455 --> 00:01:50.205
LAURENCE MORONEY: The
music's still going.

00:01:50.205 --> 00:01:52.922
[CHUCKLING] I want
to start dancing.

00:01:52.922 --> 00:01:55.380
You don't want to build a server
and all that kind of thing

00:01:55.380 --> 00:01:57.380
for managing these
notifications,

00:01:57.380 --> 00:02:00.300
but just have a very simple
interface that they could go in

00:02:00.300 --> 00:02:03.780
and they can select an audience
based on analytics to whom they

00:02:03.780 --> 00:02:05.840
would deliver notifications.

00:02:05.840 --> 00:02:08.030
And then on the client
side, within your app,

00:02:08.030 --> 00:02:11.280
be it an Android app or
an iOS app or a web app,

00:02:11.280 --> 00:02:13.590
we want to make it
as simple as possible

00:02:13.590 --> 00:02:16.920
for you to be able to receive
these notifications that they

00:02:16.920 --> 00:02:19.310
can be then used to
re-engage with your app.

00:02:19.310 --> 00:02:22.530
Most users, I'm trying to
remember the statistics,

00:02:22.530 --> 00:02:26.250
but the average user has
about 35 apps on their device.

00:02:26.250 --> 00:02:28.590
And the vast majority
of these apps

00:02:28.590 --> 00:02:31.090
are not used more than one time.

00:02:31.090 --> 00:02:34.080
So as a result, you have a lot
of these apps on your device.

00:02:34.080 --> 00:02:35.730
They're sitting
there on your device.

00:02:35.730 --> 00:02:38.130
They've been installed, and
they've been forgotten about.

00:02:38.130 --> 00:02:39.588
And you as an app
developer, that's

00:02:39.588 --> 00:02:42.300
terrible, because you spent
so much time and effort

00:02:42.300 --> 00:02:44.490
building your app,
marketing your app,

00:02:44.490 --> 00:02:46.140
getting people to install it.

00:02:46.140 --> 00:02:48.390
They use it once and then
they forget about it.

00:02:48.390 --> 00:02:51.360
So what we wanted to do
is provide notifications,

00:02:51.360 --> 00:02:53.820
so that when a user
receives a notification,

00:02:53.820 --> 00:02:55.997
it will allow them to
re-engage with your app,

00:02:55.997 --> 00:02:58.080
and relaunch your app, and
remember and rediscover

00:02:58.080 --> 00:02:59.580
your app.

00:02:59.580 --> 00:03:03.030
Now, this obviously
is very easily open

00:03:03.030 --> 00:03:07.360
to misuse, where somebody
could spam users and send

00:03:07.360 --> 00:03:11.100
too many notifications to
users and turn users off.

00:03:11.100 --> 00:03:12.870
So what we wanted
to do was give you

00:03:12.870 --> 00:03:15.780
very powerful tools that will
allow you to select your user

00:03:15.780 --> 00:03:18.800
population that you're going
to send notifications to

00:03:18.800 --> 00:03:21.450
so that you don't oversend.

00:03:21.450 --> 00:03:23.520
These notifications are
driven off of analytics,

00:03:23.520 --> 00:03:25.010
as I mentioned.

00:03:25.010 --> 00:03:27.030
And the analytics
tools in Firebase

00:03:27.030 --> 00:03:29.920
are very powerful to
the extent of say,

00:03:29.920 --> 00:03:33.000
for example, you have an
e-commerce application

00:03:33.000 --> 00:03:35.910
that you could find
a population of users

00:03:35.910 --> 00:03:38.910
of your e-commerce
application as people

00:03:38.910 --> 00:03:42.870
who have made a purchase
in the last 30 days

00:03:42.870 --> 00:03:45.300
but have not made a
purchase in the 60 days

00:03:45.300 --> 00:03:48.150
prior to that, as in
these are customers

00:03:48.150 --> 00:03:50.935
that you've had for a while
and are now using your app,

00:03:50.935 --> 00:03:52.560
and you want to get
them using your app

00:03:52.560 --> 00:03:54.170
or continuing to use your app.

00:03:54.170 --> 00:03:57.450
And those kind of people you can
use then to find a population.

00:03:57.450 --> 00:04:00.000
You can send a
notification to them

00:04:00.000 --> 00:04:02.550
to say, hey, thanks
for using our app,

00:04:02.550 --> 00:04:05.850
here's a 20% discount code,
something along those lines.

00:04:05.850 --> 00:04:09.120
And as a result, you have this
very powerful re-engagement

00:04:09.120 --> 00:04:10.640
of your users.

00:04:10.640 --> 00:04:13.560
And notifications,
to me, is primarily

00:04:13.560 --> 00:04:15.560
about re-engaging
your users, keeping

00:04:15.560 --> 00:04:17.490
them interested in
your app, keeping

00:04:17.490 --> 00:04:20.456
them exciting to use your
app, and growing your app

00:04:20.456 --> 00:04:21.660
as a result.

00:04:21.660 --> 00:04:24.240
My bottom bullet here,
which is my favorite part,

00:04:24.240 --> 00:04:26.730
I think, of using
Firebase Notifications is

00:04:26.730 --> 00:04:31.090
that there's actually no code
necessary on the client side.

00:04:31.090 --> 00:04:32.690
So if you're building
an Android app,

00:04:32.690 --> 00:04:34.920
you have a built
out Gradle file,

00:04:34.920 --> 00:04:37.470
and this is what you put in
your built out Gradle file.

00:04:37.470 --> 00:04:38.220
That's it.

00:04:38.220 --> 00:04:41.010
You don't find any code
whatsoever within your app

00:04:41.010 --> 00:04:41.690
itself.

00:04:41.690 --> 00:04:45.030
You just tell your app
to use com/google/fireb

00:04:45.030 --> 00:04:47.415
ase/firebasemessaging and
whatever the current version

00:04:47.415 --> 00:04:50.700
number is or whatever the latest
version is, and that's it.

00:04:50.700 --> 00:04:52.620
You will get notifications
within your app.

00:04:52.620 --> 00:04:56.190
I'm a very lazy developer,
and as a result,

00:04:56.190 --> 00:04:58.410
I really like this.

00:04:58.410 --> 00:05:00.300
Again, if you're
building an app,

00:05:00.300 --> 00:05:02.710
if you're building an app
for the international market,

00:05:02.710 --> 00:05:05.260
and you want to give
your users, and you

00:05:05.260 --> 00:05:07.460
want to give your
business the facility

00:05:07.460 --> 00:05:10.180
to allow re-engagement
with your users,

00:05:10.180 --> 00:05:11.830
this is all you have to do.

00:05:11.830 --> 00:05:14.290
Pretty simple, right?

00:05:14.290 --> 00:05:15.700
And this is what
the console will

00:05:15.700 --> 00:05:18.220
look like, the Firebase
Console, when you're doing that.

00:05:18.220 --> 00:05:21.430
So here, I have it
linked with Analytics.

00:05:21.430 --> 00:05:25.700
So I've set up Analytics, and
there's a notifications funnel.

00:05:25.700 --> 00:05:29.000
So in this case, there's
an app called Bingo Blast.

00:05:29.000 --> 00:05:31.440
And there was a notification
so that, you know, level

00:05:31.440 --> 00:05:34.810
up at Bingo Blast
to unlock new codes

00:05:34.810 --> 00:05:36.880
that was sent out to people.

00:05:36.880 --> 00:05:40.500
So they said, hey, if I continue
playing this game Bingo Blast,

00:05:40.500 --> 00:05:42.820
and if I level up, I'm
going to get some goodies

00:05:42.820 --> 00:05:44.240
beyond leveling up.

00:05:44.240 --> 00:05:46.270
This notification was
sent out, as you can see,

00:05:46.270 --> 00:05:48.500
on the 9th of August 2016.

00:05:48.500 --> 00:05:50.490
It was sent to
the Android users,

00:05:50.490 --> 00:05:53.840
and it was targeting
between 1 and 10,000 users.

00:05:53.840 --> 00:05:56.360
And then you can see the
effectiveness of that here.

00:05:56.360 --> 00:05:57.820
Well, what we can
see in this case,

00:05:57.820 --> 00:06:00.300
we sent this many notifications.

00:06:00.300 --> 00:06:03.610
This many were opened, and this
many were actually acted on.

00:06:03.610 --> 00:06:07.030
So it's a pretty sharp
drop-off in this case,

00:06:07.030 --> 00:06:09.910
because not everybody
will interact

00:06:09.910 --> 00:06:11.110
with every notification.

00:06:11.110 --> 00:06:12.610
And I think it's
really good for you

00:06:12.610 --> 00:06:15.970
to get that kind of intelligence
behind your notifications.

00:06:15.970 --> 00:06:19.270
Because here this tells
me that the notification

00:06:19.270 --> 00:06:21.940
that we used here was a
very bad one, because we

00:06:21.940 --> 00:06:25.360
sent that many and we got that
many converted, very, very few.

00:06:25.360 --> 00:06:28.388
Why do you think this
notification would be bad?

00:06:28.388 --> 00:06:29.533
AUDIENCE: [INAUDIBLE].

00:06:29.533 --> 00:06:30.783
LAURENCE MORONEY: What's that?

00:06:30.783 --> 00:06:31.283
Sorry.

00:06:31.283 --> 00:06:33.182
AUDIENCE: The
message was useless.

00:06:33.182 --> 00:06:34.140
LAURENCE MORONEY: Yeah.

00:06:34.140 --> 00:06:34.930
The message wasn't good.

00:06:34.930 --> 00:06:36.260
It's kind of a useless
message, right?

00:06:36.260 --> 00:06:37.890
Instead of saying,
hey, if you level up,

00:06:37.890 --> 00:06:39.431
you're going to get
more of the game.

00:06:39.431 --> 00:06:40.900
Because people who
are leveling up

00:06:40.900 --> 00:06:43.140
are people who are
playing the game anyway,

00:06:43.140 --> 00:06:45.670
so why would they
want to do this?

00:06:45.670 --> 00:06:48.180
What if it was a case of,
hey, remember Bingo Blast?

00:06:48.180 --> 00:06:51.195
If you play it now, we're going
to give you 500 free coins.

00:06:51.195 --> 00:06:54.000
Now that kind of notification
would be very powerful,

00:06:54.000 --> 00:06:55.600
and that's the idea
behind analytics.

00:06:55.600 --> 00:06:58.495
So you can use analytics
to define your audience,

00:06:58.495 --> 00:07:00.620
and then you can use
analytics within notifications

00:07:00.620 --> 00:07:02.610
to understand how things work.

00:07:02.610 --> 00:07:05.680
So beyond the programming and
beyond the ease of programming,

00:07:05.680 --> 00:07:08.510
I just love the fact that we've
got analytics on both sides--

00:07:08.510 --> 00:07:10.540
prior to sending
the notification,

00:07:10.540 --> 00:07:12.870
so you could pick your
audience, and then after sending

00:07:12.870 --> 00:07:15.130
the notification, so
that you can know what

00:07:15.130 --> 00:07:16.230
your audience has done.

00:07:16.230 --> 00:07:19.425
My clicker isn't working.

00:07:19.425 --> 00:07:20.550
Can I go to the next slide?

00:07:20.550 --> 00:07:23.020
The clicker has failed.

00:07:23.020 --> 00:07:24.590
There we go.

00:07:24.590 --> 00:07:27.980
So earlier, I showed a
piece of code that says,

00:07:27.980 --> 00:07:31.560
OK, in my application, if I just
want to receive a notification,

00:07:31.560 --> 00:07:33.310
and then I will touch
on that notification

00:07:33.310 --> 00:07:37.190
and it relaunches my app, then
if the application was running

00:07:37.190 --> 00:07:40.192
in the background, I'm going to
get my application relaunched.

00:07:40.192 --> 00:07:42.390
But sometimes, we might
want to go like a little bit

00:07:42.390 --> 00:07:44.699
more complex, and we want
to write some code that

00:07:44.699 --> 00:07:46.490
allows me to do something
a little bit more

00:07:46.490 --> 00:07:48.280
interesting with
that notification,

00:07:48.280 --> 00:07:51.680
maybe take me to a specific
screen within my application

00:07:51.680 --> 00:07:53.710
once the user has
touched the notification.

00:07:53.710 --> 00:07:55.730
And for that, you need
a little bit of code.

00:07:55.730 --> 00:07:57.710
And this is what it
looks like in Android.

00:07:57.710 --> 00:08:02.040
So in Android, I've created
a service class called--

00:08:02.040 --> 00:08:04.740
in this case, it's
MyFirebaseMessagingService.

00:08:04.740 --> 00:08:09.070
And I've told it, on an action
of a Firebase Messaging event,

00:08:09.070 --> 00:08:10.460
use this service.

00:08:10.460 --> 00:08:13.750
So this is something that
goes into my Android manifest.

00:08:13.750 --> 00:08:15.990
Can I go to the
next slide, please?

00:08:15.990 --> 00:08:18.320
And then within my code
within my Android manifest,

00:08:18.320 --> 00:08:19.740
it's going to look
something like thi-- sorry,

00:08:19.740 --> 00:08:21.380
within my messaging
service, it's

00:08:21.380 --> 00:08:22.970
going to look
something like this.

00:08:22.970 --> 00:08:24.426
I've created a class.

00:08:24.426 --> 00:08:26.300
You saw it named in the
previous slide called

00:08:26.300 --> 00:08:28.190
MyFirebaseMessagingService.

00:08:28.190 --> 00:08:29.810
And in this case,
Firebase offers you

00:08:29.810 --> 00:08:32.360
this class called
FirebaseMessagingService

00:08:32.360 --> 00:08:34.039
that you can extend.

00:08:34.039 --> 00:08:36.520
What this does is this
messaging service then

00:08:36.520 --> 00:08:40.320
provides an onMessageReceived,
so that when

00:08:40.320 --> 00:08:43.700
Firebase Notifications sends
that message and the device

00:08:43.700 --> 00:08:46.580
receives that message,
this event will get logged.

00:08:46.580 --> 00:08:48.440
This event will get
fired, and then I

00:08:48.440 --> 00:08:51.050
can do whatever I want
to within this event.

00:08:51.050 --> 00:08:54.020
So, for example, upon receiving
a notification and the user

00:08:54.020 --> 00:08:56.940
touches the location,
and I want to go--

00:08:56.940 --> 00:08:58.670
for example, if
it's a game, if I

00:08:58.670 --> 00:09:01.280
want to go to a special
screen where the user gets 500

00:09:01.280 --> 00:09:02.980
free coins or
something like that,

00:09:02.980 --> 00:09:05.150
I can do so instead of
just launching them back

00:09:05.150 --> 00:09:09.520
into where the were
in the application.

00:09:09.520 --> 00:09:12.090
Can I go forward again, please?

00:09:12.090 --> 00:09:13.780
I don't know why my
clicker has failed.

00:09:13.780 --> 00:09:14.630
It's probably the batteries out.

00:09:14.630 --> 00:09:15.720
And forward again.

00:09:22.500 --> 00:09:25.450
Can we switch to
the demo machine?

00:09:25.450 --> 00:09:26.930
So let me show a demo of this.

00:09:26.930 --> 00:09:28.721
I'm going to put the
mic down for a second.

00:09:34.620 --> 00:09:38.490
So to show a demo of this, I
have a tablet running here.

00:09:38.490 --> 00:09:40.203
And you've just seen
my unlock code--

00:09:40.203 --> 00:09:43.270
[LAUGHS] those of you
who are paying attention.

00:09:43.270 --> 00:09:46.630
So on the tablet, I've
written this application

00:09:46.630 --> 00:09:49.180
that I call Firebase
Notification 1.

00:09:49.180 --> 00:09:51.340
And if you're familiar
with Android Studio,

00:09:51.340 --> 00:09:53.350
in Android Studio,
you have the ability

00:09:53.350 --> 00:09:56.950
to just say File, New,
Single Activity Application.

00:09:56.950 --> 00:09:58.477
And that's all this is.

00:09:58.477 --> 00:10:01.060
So when you create that single
activity application in Android

00:10:01.060 --> 00:10:02.070
Studio, you get this.

00:10:02.070 --> 00:10:03.940
And it says
"HelloWorld" at the top.

00:10:03.940 --> 00:10:06.220
So I haven't done
anything to that,

00:10:06.220 --> 00:10:08.930
except adding that single
line to the built out Gradle

00:10:08.930 --> 00:10:10.150
that I spoke about.

00:10:10.150 --> 00:10:12.940
So I'm going to put that app
in the background for a moment.

00:10:12.940 --> 00:10:15.850
And now, over here, I'm
in the Firebase Console.

00:10:15.850 --> 00:10:18.280
And in the Firebase Console,
I can compose a message

00:10:18.280 --> 00:10:20.120
that I'm going to
send to that app.

00:10:20.120 --> 00:10:22.570
So a lot of times when I demo
something like this people

00:10:22.570 --> 00:10:24.280
think, oh, he's
prerecorded something

00:10:24.280 --> 00:10:25.780
and he's precanned something.

00:10:25.780 --> 00:10:27.850
So I want you to
help me craft what

00:10:27.850 --> 00:10:31.300
this message is going to be so
that you know that it's real.

00:10:31.300 --> 00:10:35.550
Anybody want to-- any
sports friends here?

00:10:35.550 --> 00:10:36.050
Wow.

00:10:36.050 --> 00:10:36.550
No.

00:10:36.550 --> 00:10:37.480
OK.

00:10:37.480 --> 00:10:41.470
Anybody want to give me a
message that I'm going to send?

00:10:41.470 --> 00:10:49.398
Merry Christmas or Happy
New Year or Welcome Beijing?

00:10:49.398 --> 00:10:51.600
So if I-- whoops,
I typed it wrong.

00:10:51.600 --> 00:10:53.560
My Chinese typing's
not very good.

00:10:53.560 --> 00:10:57.000
So if I type something like
"Welcome Beijing," so this now,

00:10:57.000 --> 00:10:58.150
I'm not a programmer.

00:10:58.150 --> 00:10:59.187
I'm not a developer.

00:10:59.187 --> 00:11:01.020
Maybe I'm a marketer
or something like this.

00:11:01.020 --> 00:11:04.020
I have this tool, and this tool,
I can specify the message text.

00:11:04.020 --> 00:11:05.730
Now, maybe this
message text isn't

00:11:05.730 --> 00:11:09.210
the best for notifying someone,
but I'm going to use it anyway.

00:11:09.210 --> 00:11:11.282
And then when I target
it, I can target

00:11:11.282 --> 00:11:12.490
a number of different things.

00:11:12.490 --> 00:11:15.480
So I can target an entire
user segment, which

00:11:15.480 --> 00:11:17.700
has been defined by analytics.

00:11:17.700 --> 00:11:19.204
I can target a topic.

00:11:19.204 --> 00:11:21.370
I'm going to talk about
Cloud Messaging in a moment,

00:11:21.370 --> 00:11:25.810
but in Cloud Messaging, you
can define areas called Topics.

00:11:25.810 --> 00:11:28.620
So, for example, if you're-- the
example I used this morning is

00:11:28.620 --> 00:11:31.590
like say you're building
an application for airport

00:11:31.590 --> 00:11:33.130
information.

00:11:33.130 --> 00:11:36.120
You live here in
Beijing, and say, you

00:11:36.120 --> 00:11:38.150
could create a topic
for Beijing airport.

00:11:38.150 --> 00:11:40.950
So all notifications
that go to the topic

00:11:40.950 --> 00:11:44.100
Beijing airports, then anybody
who's interested in that topic

00:11:44.100 --> 00:11:45.520
would subscribe to it.

00:11:45.520 --> 00:11:47.070
So in this case,
I could just say,

00:11:47.070 --> 00:11:50.490
go to that topic, name the
topic the Beijing Airport topic,

00:11:50.490 --> 00:11:53.360
and then every user who's
receiving the notification

00:11:53.360 --> 00:11:56.700
are the users who actively
subscribed to that topic.

00:11:56.700 --> 00:11:59.720
I can also target it to a single
device, as you can see there.

00:11:59.720 --> 00:12:02.970
Or I could pick
a particular app.

00:12:02.970 --> 00:12:06.530
So here within my Firebase
project, I've build three apps.

00:12:06.530 --> 00:12:09.090
There's an Android one
called Firebase Notification

00:12:09.090 --> 00:12:11.097
1, which is what was
running over there.

00:12:11.097 --> 00:12:12.930
There's another called
Firebase Notification

00:12:12.930 --> 00:12:14.410
2, which I'll show in a moment.

00:12:14.410 --> 00:12:17.341
And there's an iOS one called
iOS Firebase Notification 1.

00:12:17.341 --> 00:12:19.340
But I'm just going to
select-- whoops, I missed.

00:12:19.340 --> 00:12:22.710
I'm going to select
Firebase Notification 1.

00:12:22.710 --> 00:12:26.121
And then I'm going to come down
here and say, send a message.

00:12:26.121 --> 00:12:27.620
So then the message,
hey, look, it's

00:12:27.620 --> 00:12:29.400
just asking me to review it.

00:12:29.400 --> 00:12:31.680
When I press this Send
button in a moment,

00:12:31.680 --> 00:12:34.500
keep your eye on the
top notification bar

00:12:34.500 --> 00:12:37.680
just under where it says
Nexus 7 on my tablet,

00:12:37.680 --> 00:12:41.440
and you'll see that
notification. arrive.

00:12:41.440 --> 00:12:43.249
So I press Send.

00:12:43.249 --> 00:12:44.290
There's the notification.

00:12:44.290 --> 00:12:46.030
It has arrived already.

00:12:46.030 --> 00:12:48.130
So if I swipe
down, it's probably

00:12:48.130 --> 00:12:49.970
kind of hard to
see on the monitor,

00:12:49.970 --> 00:12:51.670
but you can see that
top notification,

00:12:51.670 --> 00:12:54.125
Firebase Notification
1, Welcome Beijing,

00:12:54.125 --> 00:12:55.750
that I typed in a moment ago.

00:12:55.750 --> 00:12:57.300
You saw how quickly
that arrived.

00:12:57.300 --> 00:12:59.050
And then when I touch
on the notification,

00:12:59.050 --> 00:13:01.150
the application relaunches.

00:13:01.150 --> 00:13:03.820
So here's a great way
to re-engage your users

00:13:03.820 --> 00:13:05.470
through simple notification.

00:13:05.470 --> 00:13:07.990
In this case, I sent it out
to every instance of this app,

00:13:07.990 --> 00:13:10.031
because there's really
only one or two instances.

00:13:10.031 --> 00:13:11.480
It's just running on my devices.

00:13:11.480 --> 00:13:14.174
But if you've got an install
base of thousands of users,

00:13:14.174 --> 00:13:16.590
then you could use the filtering
that I showed earlier on.

00:13:16.590 --> 00:13:19.162
You could use the analytics
filtering to do so.

00:13:19.162 --> 00:13:20.620
Now, one question
that I always get

00:13:20.620 --> 00:13:23.470
when I do that demo is that
people will then ask, OK,

00:13:23.470 --> 00:13:26.752
that's all very nice, but when
you relaunched the application,

00:13:26.752 --> 00:13:28.210
you relaunched it
into the activity

00:13:28.210 --> 00:13:29.710
that you were looking
at earlier on.

00:13:29.710 --> 00:13:32.110
What if I want to drive
the content of the activity

00:13:32.110 --> 00:13:34.369
based on the content
of the notification?

00:13:34.369 --> 00:13:36.160
Well, that code that
I showed a moment ago,

00:13:36.160 --> 00:13:39.320
where I wrote that simple
service, so I built that

00:13:39.320 --> 00:13:40.660
into this application.

00:13:40.660 --> 00:13:43.120
So this one, Firebase
Notification 2,

00:13:43.120 --> 00:13:44.470
is exactly the same.

00:13:44.470 --> 00:13:46.970
It's just the File,
New, Single View

00:13:46.970 --> 00:13:49.300
Activity within Android Studio.

00:13:49.300 --> 00:13:51.500
I added the Firebase
Notifications to it.

00:13:51.500 --> 00:13:54.470
And in this case, I also added
that service that I mentioned.

00:13:54.470 --> 00:13:57.209
So I'm going to
create a new message.

00:13:57.209 --> 00:13:58.750
And I'm going to
send it to that one.

00:13:58.750 --> 00:14:00.374
So can someone help
me craft a message?

00:14:00.374 --> 00:14:01.850
What should I put in here?

00:14:01.850 --> 00:14:04.868
Shout something out.

00:14:04.868 --> 00:14:06.334
AUDIENCE: Have a nice day.

00:14:06.334 --> 00:14:07.750
LAURENCE MORONEY:
Have a nice day.

00:14:07.750 --> 00:14:09.340
I'm going to put the
mic down to type.

00:14:16.820 --> 00:14:19.367
So I've just typed out "have
a nice day," as you asked.

00:14:19.367 --> 00:14:21.200
And now I'll go down
here, and in this case,

00:14:21.200 --> 00:14:23.470
I'm going to say send it
to Firebase Notification 2.

00:14:23.470 --> 00:14:24.720
As you saw, I picked it there.

00:14:24.720 --> 00:14:25.940
It's cropped off, sorry.

00:14:25.940 --> 00:14:28.010
But if you see it
here on the menu,

00:14:28.010 --> 00:14:30.800
I'm just saying pick to send
to firebasenotification2,

00:14:30.800 --> 00:14:34.260
because this app is
Firebase Notification 2.

00:14:34.260 --> 00:14:38.340
So I'll pick that, and
I'll say Send message.

00:14:38.340 --> 00:14:40.460
And, again, it's
asking me to review it.

00:14:40.460 --> 00:14:42.740
Keep your eye on the tablet,
on the left-hand side.

00:14:42.740 --> 00:14:47.560
That when I hit Send,
the message will come in.

00:14:47.560 --> 00:14:49.884
And now, what happened is
once the message arrived,

00:14:49.884 --> 00:14:51.300
you see I didn't
interact with it.

00:14:51.300 --> 00:14:52.730
I didn't touch it or anything.

00:14:52.730 --> 00:14:55.190
Because the app was
actually active,

00:14:55.190 --> 00:14:57.410
when the message arrived,
the messaging service

00:14:57.410 --> 00:14:58.400
picked up that message.

00:14:58.400 --> 00:15:00.011
You asked me to say
"have a nice day."

00:15:00.011 --> 00:15:02.510
And all this activity does in
this simple one is just render

00:15:02.510 --> 00:15:05.010
that text that was
in the notification.

00:15:05.010 --> 00:15:06.470
So it was really
as easy as that.

00:15:06.470 --> 00:15:08.570
All I had to do
to build this one

00:15:08.570 --> 00:15:10.620
to actually receive
the notification,

00:15:10.620 --> 00:15:12.230
launch the new
activity in response

00:15:12.230 --> 00:15:14.852
to it, was link in
Firebase Notifications,

00:15:14.852 --> 00:15:16.310
and then as well
as far as Firebase

00:15:16.310 --> 00:15:18.870
Notifications to create that
messaging service that I showed

00:15:18.870 --> 00:15:21.740
the source code for and have
that messaging service launch

00:15:21.740 --> 00:15:25.040
this activity and just render
this text in the activity.

00:15:25.040 --> 00:15:27.710
So can we switch back
to slides, please?

00:15:27.710 --> 00:15:29.420
So that's the kind
of thing that you can

00:15:29.420 --> 00:15:31.580
do with Firebase Notifications.

00:15:31.580 --> 00:15:33.170
It makes it very,
very simple for you

00:15:33.170 --> 00:15:34.920
to create these
notifications that you can

00:15:34.920 --> 00:15:36.567
use to re-engage your users.

00:15:36.567 --> 00:15:38.150
And again, thinking
in terms of you've

00:15:38.150 --> 00:15:40.720
spent all this time and
effort building an app,

00:15:40.720 --> 00:15:42.980
you've spent all this time
and effort marketing it,

00:15:42.980 --> 00:15:45.350
you don't want that app to
be forgotten when people have

00:15:45.350 --> 00:15:46.808
installed it and
it's sitting there

00:15:46.808 --> 00:15:48.870
as one of those dozens
of apps that they've only

00:15:48.870 --> 00:15:49.969
ever used once.

00:15:49.969 --> 00:15:51.510
And notifications,
when you're smart,

00:15:51.510 --> 00:15:53.330
they can help you avoid that.

00:15:53.330 --> 00:15:55.670
So Cloud Messaging,
it lets you then

00:15:55.670 --> 00:15:57.540
take this to the next level.

00:15:57.540 --> 00:16:00.680
So with Cloud
Messaging, you can send

00:16:00.680 --> 00:16:03.380
messages, like I mentioned,
to topics, to users,

00:16:03.380 --> 00:16:04.820
and all that kind of stuff.

00:16:04.820 --> 00:16:07.840
We actually-- as of now, we're
sending in the infrastructure

00:16:07.840 --> 00:16:10.940
of Cloud Messaging, Google,
we're seeing trillions

00:16:10.940 --> 00:16:13.880
of messages per week
actually being sold--

00:16:13.880 --> 00:16:15.662
being sent.

00:16:15.662 --> 00:16:18.860
And these messages, generally
for connected devices,

00:16:18.860 --> 00:16:21.290
will arrive in less
than half a second, so

00:16:21.290 --> 00:16:22.970
500 milliseconds or
less, many of them

00:16:22.970 --> 00:16:24.986
even less than 250 milliseconds.

00:16:24.986 --> 00:16:26.360
So they're arriving
very quickly.

00:16:26.360 --> 00:16:28.320
As you saw when I
demoed there, and that's

00:16:28.320 --> 00:16:29.695
using the Wi-FI
in the room here,

00:16:29.695 --> 00:16:32.090
they were arriving very quickly.

00:16:32.090 --> 00:16:35.356
With Cloud Messaging, you start
getting some more functionality

00:16:35.356 --> 00:16:37.105
that wouldn't be
possible with the console

00:16:37.105 --> 00:16:40.400
here in notifications,
such as upstream messages.

00:16:40.400 --> 00:16:44.250
So you saw me receiving a
message from the Firebase

00:16:44.250 --> 00:16:46.370
Notifications, but
I could build my app

00:16:46.370 --> 00:16:49.400
when I'm using Cloud Messaging
to send upstream messages too.

00:16:49.400 --> 00:16:52.040
So, for example, maybe
in response to a message

00:16:52.040 --> 00:16:54.230
that I received, I could
send something back.

00:16:54.230 --> 00:16:55.700
This could be used
for chat rooms.

00:16:55.700 --> 00:16:57.834
This could be used for
peer-to-peer chat, all

00:16:57.834 --> 00:16:58.875
of those kinds of things.

00:16:58.875 --> 00:17:01.040
And Topics, as I
mentioned earlier on,

00:17:01.040 --> 00:17:03.440
are also supported in
Firebase Cloud Messaging.

00:17:03.440 --> 00:17:06.159
So when you build your
messaging, your app, or when

00:17:06.159 --> 00:17:08.450
you build something that uses
Firebase Cloud Messaging,

00:17:08.450 --> 00:17:10.400
you get all of these benefits.

00:17:10.400 --> 00:17:13.819
Now, to build this is
a little more complex.

00:17:13.819 --> 00:17:17.240
So as you saw already when
I was using notifications,

00:17:17.240 --> 00:17:19.579
all of my notifications I was
generating on the Firebase

00:17:19.579 --> 00:17:22.760
Console, and Google was nice
enough to build that for me.

00:17:22.760 --> 00:17:24.574
But with Firebase
Cloud Messaging,

00:17:24.574 --> 00:17:26.490
there's a little bit
more that you have to do.

00:17:26.490 --> 00:17:28.781
And with Firebase Cloud
Messaging, that generally means

00:17:28.781 --> 00:17:31.126
you have to build an
app server yourself.

00:17:31.126 --> 00:17:32.750
And this app server
can be very simple.

00:17:32.750 --> 00:17:34.760
And the reason why
you need this is

00:17:34.760 --> 00:17:38.810
that when a user registers
with Firebase Cloud Messaging,

00:17:38.810 --> 00:17:43.310
your app will receive a server
ID, all for Firebase Messaging,

00:17:43.310 --> 00:17:44.790
that identifies that device.

00:17:44.790 --> 00:17:47.890
It doesn't identify personal
information about the user,

00:17:47.890 --> 00:17:51.150
but it's used to address
that specific device.

00:17:51.150 --> 00:17:54.320
So when you have
those registration IDs

00:17:54.320 --> 00:17:58.190
for each of the devices that
your users are actually using,

00:17:58.190 --> 00:17:59.840
you need to know
how you're going

00:17:59.840 --> 00:18:01.796
to send messages to these IDs.

00:18:01.796 --> 00:18:03.170
So the next thing
that you'll do,

00:18:03.170 --> 00:18:05.461
and this is where I'm saying
you'll need an app server,

00:18:05.461 --> 00:18:08.450
is their app will generally
tell your app server,

00:18:08.450 --> 00:18:12.320
here's my registration ID that
Google Firebase has given me,

00:18:12.320 --> 00:18:13.820
please keep track of it.

00:18:13.820 --> 00:18:16.730
So then your app server will
have a simple database perhaps

00:18:16.730 --> 00:18:20.420
that will store your
registration ID, your Firebase

00:18:20.420 --> 00:18:23.870
ID, and you store that
on your app server.

00:18:23.870 --> 00:18:29.000
And now your app server will
tell Firebase Cloud Messaging

00:18:29.000 --> 00:18:31.890
the message is to send
to apps on your behalf.

00:18:31.890 --> 00:18:34.580
So, for example, you could
build a console here,

00:18:34.580 --> 00:18:36.800
like the Firebase Console
that you give access

00:18:36.800 --> 00:18:39.620
to your business people, or your
marketing people, or whatever.

00:18:39.620 --> 00:18:44.320
Or you can build code within
your app or your site that

00:18:44.320 --> 00:18:47.480
then talks to your
app server and says,

00:18:47.480 --> 00:18:50.510
send this message to this
topic, send this message

00:18:50.510 --> 00:18:52.140
to this device,
send this message

00:18:52.140 --> 00:18:53.750
to this group of devices.

00:18:53.750 --> 00:18:56.420
And then your app server would
actually service that message.

00:18:56.420 --> 00:18:58.580
And how it services
that message is

00:18:58.580 --> 00:19:01.550
it knows the IDs that the
message is supposed to go to,

00:19:01.550 --> 00:19:04.520
or it knows the topic that the
message is supposed to go to.

00:19:04.520 --> 00:19:05.990
And then Firebase
Cloud Messaging,

00:19:05.990 --> 00:19:10.010
this black box over here, has an
API that your server will call.

00:19:10.010 --> 00:19:13.090
And then your server will
say, here's my API key.

00:19:13.090 --> 00:19:14.630
I'm authenticating myself.

00:19:14.630 --> 00:19:16.500
I'm this person's application.

00:19:16.500 --> 00:19:18.520
Please send this
message to this topic.

00:19:18.520 --> 00:19:20.640
Please send this message
to these devices,

00:19:20.640 --> 00:19:22.000
and stuff like that.

00:19:22.000 --> 00:19:23.850
And then, as a
result, you've just

00:19:23.850 --> 00:19:25.770
built a messaging
infrastructure that

00:19:25.770 --> 00:19:28.432
has all the attributes that
I mentioned earlier on.

00:19:28.432 --> 00:19:30.640
So let's give a quick of
this and what it looks like.

00:19:34.810 --> 00:19:37.320
Now, this is a
live demo so if you

00:19:37.320 --> 00:19:39.570
take a look at
the URL at the top

00:19:39.570 --> 00:19:42.600
there, if you have a browser,
or a laptop, or something open,

00:19:42.600 --> 00:19:44.190
you can go visit now.

00:19:44.190 --> 00:19:46.190
And if you type in a
message it will send to it.

00:19:46.190 --> 00:19:48.150
It will actually
appear on my watch.

00:19:48.150 --> 00:19:49.920
So a lot of time,
I ask people, hey,

00:19:49.920 --> 00:19:51.600
if you want to
ask questions or--

00:19:51.600 --> 00:19:53.190
sometimes this backfires.

00:19:53.190 --> 00:19:55.420
I did this talk
recently in Germany,

00:19:55.420 --> 00:19:57.547
and people got the URL,
and then my watch just

00:19:57.547 --> 00:19:59.130
kept buzzing for the
rest of the talk,

00:19:59.130 --> 00:20:00.546
and I couldn't
concentrate on what

00:20:00.546 --> 00:20:01.890
I was supposed to be saying.

00:20:01.890 --> 00:20:04.952
But the idea is this is an
app server like the ones

00:20:04.952 --> 00:20:06.660
that I mentioned in
the previous diagram.

00:20:06.660 --> 00:20:08.400
I can show the
PHP code that this

00:20:08.400 --> 00:20:09.990
was written in in a moment.

00:20:09.990 --> 00:20:13.410
These big strings that you
see here are the Firebase IDs.

00:20:13.410 --> 00:20:15.750
So what's happened
is this tablet

00:20:15.750 --> 00:20:19.480
I've registered
with this website.

00:20:19.480 --> 00:20:20.670
The applications right here.

00:20:20.670 --> 00:20:22.560
It's, again, a very simple app.

00:20:22.560 --> 00:20:25.050
It's just got a single button
on it that says Register.

00:20:25.050 --> 00:20:27.150
When I touch that
button, the app

00:20:27.150 --> 00:20:31.920
is calling Firebase, getting
an instance ID for this device,

00:20:31.920 --> 00:20:34.630
sending that instance
ID up to my server.

00:20:34.630 --> 00:20:37.160
The instance ID looks
something like this.

00:20:37.160 --> 00:20:40.450
And then on my server, I just
created a simple PHP page

00:20:40.450 --> 00:20:43.440
that says for each instance ID,
I can type something and send

00:20:43.440 --> 00:20:46.650
it to that device
individually, or this top one,

00:20:46.650 --> 00:20:49.449
I can type something and
send it to all devices that

00:20:49.449 --> 00:20:50.490
are actually registering.

00:20:50.490 --> 00:20:51.948
And right now, I
have seven devices

00:20:51.948 --> 00:20:54.015
registered on this page.

00:20:54.015 --> 00:20:56.880
So if I go in and
type something--

00:20:56.880 --> 00:20:59.040
give me something
to say, anybody?

00:20:59.040 --> 00:21:01.470
AUDIENCE: Someone has
broken into your house.

00:21:01.470 --> 00:21:02.870
LAURENCE MORONEY: Someone
has broken into your house.

00:21:02.870 --> 00:21:03.370
Wow.

00:21:06.015 --> 00:21:08.003
I would have never
thought of that one.

00:21:08.003 --> 00:21:10.985
Someone has broken
into your house.

00:21:14.464 --> 00:21:15.955
Someone has broken
into your house.

00:21:15.955 --> 00:21:17.943
And if I send that--

00:21:17.943 --> 00:21:18.940
[DING]

00:21:18.940 --> 00:21:20.157
You probably heard the ding.

00:21:20.157 --> 00:21:21.240
And it's going to show up.

00:21:21.240 --> 00:21:21.960
Yep, and here it is.

00:21:21.960 --> 00:21:23.543
It's showing up on
my watch-- "someone

00:21:23.543 --> 00:21:26.320
has broken into your house."

00:21:26.320 --> 00:21:28.270
So I can see why
you picked that one.

00:21:28.270 --> 00:21:30.580
Hopefully my wife isn't
registered on the same thing,

00:21:30.580 --> 00:21:32.288
and now she's going
to call me panicking.

00:21:32.288 --> 00:21:33.340
[CHUCKLING]

00:21:33.340 --> 00:21:36.220
So the idea behind this is
that, again, it's very simple,

00:21:36.220 --> 00:21:37.276
this website.

00:21:37.276 --> 00:21:39.827
And, again, if you--
oh, somebody's doing it.

00:21:39.827 --> 00:21:41.410
Yeah, somebody just
sent me a message.

00:21:41.410 --> 00:21:42.860
I'm not going to answer it.

00:21:42.860 --> 00:21:47.020
So if you go onto this website,
and all this website is doing

00:21:47.020 --> 00:21:48.610
is this is a MYSQL database.

00:21:48.610 --> 00:21:52.630
The MYSQL database is storing
these registration IDs.

00:21:52.630 --> 00:21:55.390
This page is reading
that database,

00:21:55.390 --> 00:21:57.650
writing out HTML for
each of these IDs,

00:21:57.650 --> 00:22:00.280
and writing out HTML
for each of these forms,

00:22:00.280 --> 00:22:03.100
and then creating
another form here in HTML

00:22:03.100 --> 00:22:05.500
so that when somebody
types a message,

00:22:05.500 --> 00:22:07.750
if I type in the
top box, it reads

00:22:07.750 --> 00:22:10.920
from MySQL all of the
seven IDs, and tells

00:22:10.920 --> 00:22:14.270
FCM to send that message
to each of those seven IDs.

00:22:14.270 --> 00:22:16.340
Or if I do it in one of
these individual boxes,

00:22:16.340 --> 00:22:18.680
it's telling FCM to
send it to that one.

00:22:18.680 --> 00:22:20.700
So let's take a look
at the code for that

00:22:20.700 --> 00:22:22.410
and how that actually looks.

00:22:22.410 --> 00:22:26.310
So first of all, if I open
this one, you can see this is--

00:22:26.310 --> 00:22:28.690
I was just using MYSQL.

00:22:28.690 --> 00:22:30.860
I was using what's
called My PHP Admin.

00:22:30.860 --> 00:22:32.540
So if I go into My
PH Admin-- and I

00:22:32.540 --> 00:22:34.240
took this screenshot earlier on.

00:22:34.240 --> 00:22:35.450
This is just my database.

00:22:35.450 --> 00:22:38.560
If you've ever written
MYSQL databases,

00:22:38.560 --> 00:22:40.390
if you're familiar
with My PHP Admin,

00:22:40.390 --> 00:22:42.310
you'll see this is what it is.

00:22:42.310 --> 00:22:44.290
I just stored two fields
in here at the time

00:22:44.290 --> 00:22:47.400
that I created the record and
the actual registration ID

00:22:47.400 --> 00:22:48.331
in FCM.

00:22:48.331 --> 00:22:48.830
That's it.

00:22:48.830 --> 00:22:51.130
It's as simple as that.

00:22:51.130 --> 00:22:53.260
So now, if I go back
to-- let's take a look

00:22:53.260 --> 00:22:54.427
at some of the source code.

00:22:54.427 --> 00:22:56.010
And if anybody wants
this source code,

00:22:56.010 --> 00:22:58.400
I'm more than happy
to share it with you.

00:22:58.400 --> 00:23:01.640
So if I go homepage.php
first, can you read that?

00:23:01.640 --> 00:23:03.452
No, that's too small.

00:23:03.452 --> 00:23:05.090
Let me make it bigger.

00:23:18.620 --> 00:23:20.060
So if I look at
this source code,

00:23:20.060 --> 00:23:21.980
I don't know how easy
it is for you to read.

00:23:21.980 --> 00:23:23.090
Hopefully you can see it.

00:23:23.090 --> 00:23:25.048
So in this case, all this
source code is doing,

00:23:25.048 --> 00:23:27.650
this is the page that I
showed you a moment ago.

00:23:27.650 --> 00:23:29.450
And what I'm doing
here is that I just

00:23:29.450 --> 00:23:31.990
have a number of HTML forms.

00:23:31.990 --> 00:23:34.000
And in this case,
you can see this form

00:23:34.000 --> 00:23:38.960
is called [? AllForm ?] here,
and the method is to Post.

00:23:38.960 --> 00:23:40.400
And all I'm doing
on this form is

00:23:40.400 --> 00:23:43.790
when I get that Send button
I'm going to post this form,

00:23:43.790 --> 00:23:45.770
and when I post this
form, it's going

00:23:45.770 --> 00:23:48.960
to call another PHP module.

00:23:48.960 --> 00:23:53.195
And as we can see here, that
was called [INAUDIBLE] .php,

00:23:53.195 --> 00:23:55.820
and then telling it the message
and telling it the registration

00:23:55.820 --> 00:23:59.030
ID or the list of
registration IDs.

00:23:59.030 --> 00:24:00.449
So if we look at
that code in PHP,

00:24:00.449 --> 00:24:01.740
that's where the magic happens.

00:24:04.930 --> 00:24:06.090
And it's as simple as this.

00:24:06.090 --> 00:24:09.590
So at the top, you
can see there's a URL.

00:24:09.590 --> 00:24:15.130
And the URL is
fcm.googleapis.com/fcm/send.

00:24:15.130 --> 00:24:18.590
So as you can imagine
from the name of the URL,

00:24:18.590 --> 00:24:19.610
that's the URL.

00:24:19.610 --> 00:24:21.980
That's the endpoints
that FCM has given me

00:24:21.980 --> 00:24:24.560
to allow me to send messages.

00:24:24.560 --> 00:24:26.120
So then there's a
number of headers

00:24:26.120 --> 00:24:27.911
that you need when
you're calling that one.

00:24:27.911 --> 00:24:30.020
The top one is my
authorization key.

00:24:30.020 --> 00:24:32.840
So this authorization key
he is telling Firebase

00:24:32.840 --> 00:24:35.180
that it really is me
sending it so that you

00:24:35.180 --> 00:24:36.970
can't send to my devices.

00:24:36.970 --> 00:24:39.470
Or if somebody is using
my app, and they've

00:24:39.470 --> 00:24:41.390
registered with
my device ID, you

00:24:41.390 --> 00:24:44.780
can't send to them, like
a competitor of mine,

00:24:44.780 --> 00:24:46.730
or a pirate, or a
hacker, or something

00:24:46.730 --> 00:24:49.550
can't send to devices
using my app unless they

00:24:49.550 --> 00:24:51.350
have this authorization key.

00:24:51.350 --> 00:24:53.390
So the authorization
key is how you're

00:24:53.390 --> 00:24:56.240
telling us that this
is who you really are.

00:24:56.240 --> 00:24:58.550
So I'm setting the
authorization key in the header,

00:24:58.550 --> 00:25:00.770
and I'm just saying it's a JSON.

00:25:00.770 --> 00:25:03.350
And then I'm
creating this field.

00:25:03.350 --> 00:25:05.540
And then, within--
sorry-- this array

00:25:05.540 --> 00:25:08.210
is a set of the registration
IDs and then the data.

00:25:08.210 --> 00:25:10.390
And the data is the message
that I'm going to send,

00:25:10.390 --> 00:25:13.250
and the registration IDs
is just the JSON array

00:25:13.250 --> 00:25:16.250
of all those registration
ID that I want to send to.

00:25:16.250 --> 00:25:20.000
And then, it's as
simple as cURL.

00:25:20.000 --> 00:25:21.830
Anybody use cURL?

00:25:21.830 --> 00:25:24.170
Familiar with it?

00:25:24.170 --> 00:25:26.960
So cURL is just a great
way of calling URL.

00:25:26.960 --> 00:25:30.050
So cURL here, I just specified
the URL I want to call.

00:25:30.050 --> 00:25:31.030
I'm posting.

00:25:31.030 --> 00:25:33.786
Here's the headers that
I created, static blast,

00:25:33.786 --> 00:25:36.860
and here is my fields
of my actual data,

00:25:36.860 --> 00:25:41.210
and I'm telling FCM to send
that message to those people,

00:25:41.210 --> 00:25:41.999
and that's it.

00:25:41.999 --> 00:25:42.790
That's all it does.

00:25:42.790 --> 00:25:44.090
It's very, very simple.

00:25:44.090 --> 00:25:45.590
And that's what
gives me the website

00:25:45.590 --> 00:25:48.610
that we just saw a moment ago.

00:25:48.610 --> 00:25:50.970
And in my app, I'm just
linking the same library

00:25:50.970 --> 00:25:53.270
as I was using
for notifications.

00:25:53.270 --> 00:25:57.820
So in this app, when this app
receives the notification,

00:25:57.820 --> 00:26:00.500
I've tied my watch to this
phone, so notifications

00:26:00.500 --> 00:26:01.370
on this phone--

00:26:01.370 --> 00:26:04.490
sorry, on this tablet will
also show up on my watch.

00:26:04.490 --> 00:26:07.850
And as a result, I received
the notification on my watch.

00:26:07.850 --> 00:26:11.500
That's how easy it is to
build a very basic application

00:26:11.500 --> 00:26:12.800
with Cloud Messaging.

00:26:12.800 --> 00:26:14.966
Now, of course, if you want
to get a little bit more

00:26:14.966 --> 00:26:17.240
sophisticated, you can do so.

00:26:17.240 --> 00:26:20.300
I just got another "someone
has broken into your house."

00:26:20.300 --> 00:26:22.280
So, for example, if
you want to build

00:26:22.280 --> 00:26:24.650
a more sophisticated
application, maybe one that

00:26:24.650 --> 00:26:28.350
uses topics, maybe one that
use the location of users,

00:26:28.350 --> 00:26:30.950
that's entirely up
to you at this point.

00:26:30.950 --> 00:26:34.220
Because you have this
API on the back end

00:26:34.220 --> 00:26:36.880
that you can use to talk to
Firebase Cloud Messaging,

00:26:36.880 --> 00:26:38.612
it's up to you how to do that.

00:26:38.612 --> 00:26:40.070
And that was the
idea that we said,

00:26:40.070 --> 00:26:43.700
like we have notifications
that has this console that

00:26:43.700 --> 00:26:46.790
has tools and analytics to
drive what you're going to send.

00:26:46.790 --> 00:26:49.479
We also wanted to give
flexibility to developers

00:26:49.479 --> 00:26:51.770
so that you can build a
service-- if we can switch back

00:26:51.770 --> 00:26:53.690
to slides now, please--
so that you can build

00:26:53.690 --> 00:26:57.020
a service yourself that
intelligently manages

00:26:57.020 --> 00:27:00.905
the communications to developers
based on how you want.

00:27:00.905 --> 00:27:01.950
to do it.

00:27:01.950 --> 00:27:04.340
And that's the idea behind
Firebase Cloud Messaging

00:27:04.340 --> 00:27:06.890
and the idea behind
Firebase Notifications.

00:27:06.890 --> 00:27:09.200
We wanted to give
you tools that you

00:27:09.200 --> 00:27:13.670
can use to build notifications,
real time notifications, stuff

00:27:13.670 --> 00:27:16.340
that driven by analytics
or a programmable API,

00:27:16.340 --> 00:27:19.700
where you can build your
own infrastructure to send

00:27:19.700 --> 00:27:21.770
notifications to you end users.

00:27:21.770 --> 00:27:22.619
And that's it.

00:27:22.619 --> 00:27:24.410
That's the brief talk
I wanted to give you.

00:27:24.410 --> 00:27:26.390
Here's how Notifications works.

00:27:26.390 --> 00:27:27.807
Here's how Cloud
Messaging works.

00:27:27.807 --> 00:27:30.140
Here's how to build a simple
server for Cloud Messaging.

00:27:30.140 --> 00:27:33.450
So I've got some time for some
questions if anybody has any.

00:27:33.450 --> 00:27:35.700
At the front here.

00:27:35.700 --> 00:27:37.137
Just wait for the mic there.

00:27:37.137 --> 00:27:39.045
They're floating around.

00:27:46.402 --> 00:27:48.360
I just got a third
notification that "someone's

00:27:48.360 --> 00:27:49.396
broken into my house."

00:27:49.396 --> 00:27:50.270
[CHUCKLING]

00:27:50.270 --> 00:27:52.450
AUDIENCE: Hello, sir.

00:27:52.450 --> 00:27:56.490
My question is
what's the difference

00:27:56.490 --> 00:27:59.400
between the GCM and the FCM?

00:27:59.400 --> 00:28:01.267
LAURENCE MORONEY:
That's a great question.

00:28:01.267 --> 00:28:02.850
So just to repeat
the question, what's

00:28:02.850 --> 00:28:04.990
the difference between GCM,
Google Cloud Messaging,

00:28:04.990 --> 00:28:07.230
and FCM, FIrebase
Cloud Messaging?

00:28:07.230 --> 00:28:10.150
So FCM grew out of GCM.

00:28:10.150 --> 00:28:13.420
There's no great difference
between them at the moment.

00:28:13.420 --> 00:28:15.810
So GCM was what we had first.

00:28:15.810 --> 00:28:19.350
And then when we released
Firebase earlier this year,

00:28:19.350 --> 00:28:23.290
we migrated the
namespaces from GCM,

00:28:23.290 --> 00:28:26.520
from Google Cloud Messaging
into Firebase Cloud Messaging.

00:28:26.520 --> 00:28:28.980
As we go forward, when
we add new features,

00:28:28.980 --> 00:28:31.320
we'll add them to
Firebase Cloud Messaging,

00:28:31.320 --> 00:28:34.080
not necessarily to
Google Cloud Messaging.

00:28:34.080 --> 00:28:37.920
So we recommend that
people migrate over to FCM.

00:28:37.920 --> 00:28:40.440
When it comes to the back-end
infrastructure and everything

00:28:40.440 --> 00:28:43.470
that I've showed, they're
pretty much identical.

00:28:43.470 --> 00:28:45.720
The URL that I gave for the
endpoint you probably saw

00:28:45.720 --> 00:28:47.480
was FCM, not GCM.

00:28:47.480 --> 00:28:49.620
But other than that,
they're identical.

00:28:49.620 --> 00:28:52.090
But my recommendation would
be that as we move forward,

00:28:52.090 --> 00:28:54.990
we're moving forward with
Firebase Cloud Messaging.

00:28:54.990 --> 00:28:57.146
And I'd recommended that
you migrate to that.

00:28:57.146 --> 00:28:58.012
AUDIENCE: Yeah.

00:28:58.012 --> 00:28:58.880
Thank you.

00:28:58.880 --> 00:29:05.460
And I also want to
ask does the FCM--

00:29:05.460 --> 00:29:07.650
can work well in China?

00:29:10.410 --> 00:29:12.970
LAURENCE MORONEY:
So as of right now,

00:29:12.970 --> 00:29:16.800
Firebase, everything but
notifications and Admob

00:29:16.800 --> 00:29:19.740
is really aimed at the
international market.

00:29:19.740 --> 00:29:22.044
So if you're building
international applications,

00:29:22.044 --> 00:29:24.460
that's Firebase Cloud Messaging
and Firebase Notifications

00:29:24.460 --> 00:29:25.470
included.

00:29:25.470 --> 00:29:26.851
It's really designed for that.

00:29:26.851 --> 00:29:29.100
We're continuing to work on
it for the Chinese market,

00:29:29.100 --> 00:29:32.375
but we don't have any time
frame or anything like that yet.

00:29:32.375 --> 00:29:33.480
Sorry.

00:29:33.480 --> 00:29:34.518
AUDIENCE: Thank you.

00:29:34.518 --> 00:29:35.559
LAURENCE MORONEY: Thanks.

00:29:41.210 --> 00:29:44.050
AUDIENCE: So do we have data
after average [INAUDIBLE]

00:29:44.050 --> 00:29:47.146
about the Firebase
Notifications?

00:29:47.146 --> 00:29:50.510
So we have been using
this app for [INAUDIBLE],

00:29:50.510 --> 00:29:53.150
but when we're sending--

00:29:53.150 --> 00:29:56.150
we found that it's
actually not 100% message

00:29:56.150 --> 00:30:01.010
that we send can successfully
reach users [? overall. ?]

00:30:01.010 --> 00:30:03.920
So I just want to know
what's your average reach

00:30:03.920 --> 00:30:05.719
rate about this?

00:30:05.719 --> 00:30:07.760
LAURENCE MORONEY: I don't
have an average number,

00:30:07.760 --> 00:30:11.330
but we found that when it's
not 100% reaching mobile,

00:30:11.330 --> 00:30:13.740
it's usually-- it's a
disconnected device.

00:30:13.740 --> 00:30:16.850
So the [INAUDIBLE] that we give
or the the numbers that we give

00:30:16.850 --> 00:30:18.840
are for connected devices.

00:30:18.840 --> 00:30:21.160
So if the notification's
sent, and at the point

00:30:21.160 --> 00:30:23.450
it's sent the device is
disconnected, of course,

00:30:23.450 --> 00:30:25.200
it's not going to
receive it right away.

00:30:25.200 --> 00:30:28.070
When it comes back
online, it's usually

00:30:28.070 --> 00:30:29.680
within about four weeks.

00:30:29.680 --> 00:30:31.710
If it comes back online
within those four weeks,

00:30:31.710 --> 00:30:35.180
then it maintains the same
SLA that they should receive

00:30:35.180 --> 00:30:36.890
the notification in short time.

00:30:36.890 --> 00:30:40.730
But I have noticed somewhat of
a dropoff when the initial one

00:30:40.730 --> 00:30:42.809
was sent if the
device was offline,

00:30:42.809 --> 00:30:44.850
that it doesn't seem to
be quite as reliable when

00:30:44.850 --> 00:30:46.933
the device comes back
online, and that's something

00:30:46.933 --> 00:30:48.170
that we're working on.

00:30:48.170 --> 00:30:50.546
But I don't have an average
number or anything like that.

00:30:50.546 --> 00:30:52.503
So that's one we talked
about like it receiving

00:30:52.503 --> 00:30:55.030
in a very short time, that's
for actually connected devices.

00:30:55.030 --> 00:30:58.050
AUDIENCE: So basically, we
keep sending in four weeks

00:30:58.050 --> 00:30:59.827
until [INAUDIBLE]?

00:30:59.827 --> 00:31:00.910
LAURENCE MORONEY: Correct.

00:31:00.910 --> 00:31:01.410
Correct.

00:31:01.410 --> 00:31:04.110
I mean, as you saw when was like
doing the message that you saw

00:31:04.110 --> 00:31:06.855
the time to expire was four
weeks, you could change that,

00:31:06.855 --> 00:31:08.672
but that's typically
how it works.

00:31:11.900 --> 00:31:16.283
Any other questions?

00:31:16.283 --> 00:31:18.680
OK, well-- oh,
we've got one here.

00:31:18.680 --> 00:31:20.855
AUDIENCE: In the
Firebase Notifications,

00:31:20.855 --> 00:31:22.790
you had a target.

00:31:22.790 --> 00:31:25.390
So based on the type of
audience [INAUDIBLE],

00:31:25.390 --> 00:31:29.149
how is that target identified?

00:31:29.149 --> 00:31:30.065
LAURENCE MORONEY: So--

00:31:30.065 --> 00:31:33.530
AUDIENCE: Is it something that
we can also control and see,

00:31:33.530 --> 00:31:35.809
OK, this one gives
me better target.

00:31:35.809 --> 00:31:37.350
This one gives me
better [INAUDIBLE],

00:31:37.350 --> 00:31:39.280
something like that
we can think of that?

00:31:39.280 --> 00:31:40.196
LAURENCE MORONEY: Yes.

00:31:40.196 --> 00:31:43.440
So you can define your target
based on an audience defined

00:31:43.440 --> 00:31:45.240
in Google Analytics--

00:31:45.240 --> 00:31:46.860
sorry, in Firebase Analytics.

00:31:46.860 --> 00:31:49.050
So, for example, you
could set an audience

00:31:49.050 --> 00:31:50.800
in Firebase Analytics
to be people

00:31:50.800 --> 00:31:53.667
who've made an in-app
purchase in the last 30 days.

00:31:53.667 --> 00:31:55.250
And you can maybe
set another audience

00:31:55.250 --> 00:31:58.160
to people who made an in-app
purchase in the last 60 days.

00:31:58.160 --> 00:32:00.322
You can send a notification
to each of these

00:32:00.322 --> 00:32:03.040
and then analyze the performance
of that notification.

00:32:03.040 --> 00:32:04.810
So it's up to you to
define the audience,

00:32:04.810 --> 00:32:09.110
and that can be done
using analytics.

00:32:09.110 --> 00:32:10.790
Any last questions?

00:32:10.790 --> 00:32:12.120
Nope?

00:32:12.120 --> 00:32:14.653
Going, going.

00:32:14.653 --> 00:32:15.778
Oh, we got one here, sorry.

00:32:19.529 --> 00:32:21.820
AUDIENCE: I joined in the
middle, but my questions was,

00:32:21.820 --> 00:32:25.285
if I were developing a
cross-platform application

00:32:25.285 --> 00:32:28.520
using PhoneGap or
something, then

00:32:28.520 --> 00:32:36.410
is it useful for iOS or Apple
the same code notification?

00:32:36.410 --> 00:32:39.110
LAURENCE MORONEY: So if you're
using something like PhoneGap,

00:32:39.110 --> 00:32:42.340
I'm really not familiar
with how you would do

00:32:42.340 --> 00:32:44.460
the notifications in Firebase.

00:32:44.460 --> 00:32:47.100
Sorry.

00:32:47.100 --> 00:32:50.630
But we do support notifications
in Cloud Messaging

00:32:50.630 --> 00:32:51.880
across all three platforms.

00:32:51.880 --> 00:32:54.640
And that's iOS,
Android, and the WAN.

00:32:54.640 --> 00:32:57.800
With PhoneGap, I think you write
it in one like C# or something

00:32:57.800 --> 00:32:59.990
and then cross-compile
it to others.

00:32:59.990 --> 00:33:02.060
I'm not familiar with
that for notifications.

00:33:02.060 --> 00:33:03.352
Sorry.

00:33:03.352 --> 00:33:04.060
AUDIENCE: Thanks.

00:33:09.989 --> 00:33:12.030
LAURENCE MORONEY: Well,
in that case, xie xie ni.

00:33:12.030 --> 00:33:13.190
Thank you very much.

00:33:13.190 --> 00:33:15.398
And if you have any questions,
come see me afterward.

00:33:15.398 --> 00:33:17.660
[APPLAUSE]

