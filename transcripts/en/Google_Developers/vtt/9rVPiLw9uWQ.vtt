WEBVTT
Kind: captions
Language: en

00:00:01.020 --> 00:00:02.130
BILL LUAN: Shanghai
GDG is a very

00:00:02.130 --> 00:00:04.210
interesting developer community.

00:00:04.210 --> 00:00:05.040
FEMALE SPEAKER 1: I'm
glad somebody

00:00:05.040 --> 00:00:06.280
has asked this question.

00:00:06.280 --> 00:00:07.470
MALE SPEAKER 1: This is where
the magic happens.

00:00:07.470 --> 00:00:08.740
FEMALE SPEAKER 2: This is
primarily a question and

00:00:08.740 --> 00:00:10.610
answer show, so if any
of you out there

00:00:10.610 --> 00:00:11.860
would like to ask questions.

00:00:23.350 --> 00:00:26.200
IDO GREEN: So hello, and welcome
to another episode of

00:00:26.200 --> 00:00:28.580
GDL Israel.

00:00:28.580 --> 00:00:32.390
This week, we're going to
actually repeat a session that

00:00:32.390 --> 00:00:33.100
we did last week.

00:00:33.100 --> 00:00:36.044
Because last week we had some
problems, and then at the end

00:00:36.044 --> 00:00:39.330
of the show, the quality
of the video and the

00:00:39.330 --> 00:00:40.460
audio wasn't too good.

00:00:40.460 --> 00:00:43.030
So we're just going from
scratch today.

00:00:43.030 --> 00:00:45.710
And hopefully we'll do an even
a better job because we

00:00:45.710 --> 00:00:50.370
already did it once, so we'll
get better and better.

00:00:50.370 --> 00:00:53.970
So without further ado, let me
jump into the code and show

00:00:53.970 --> 00:00:57.790
you how it's really easy these
days to use and leverage

00:00:57.790 --> 00:01:01.780
Google Apps Script in order to
create a powerful backend.

00:01:01.780 --> 00:01:05.610
So you don't need to actually
create any service side

00:01:05.610 --> 00:01:08.750
coding, and have a nice web
app that could be quite

00:01:08.750 --> 00:01:09.690
functional.

00:01:09.690 --> 00:01:14.400
And the example that I chose for
this episode is actually a

00:01:14.400 --> 00:01:19.490
very simple one-page web app
that I built more than a year

00:01:19.490 --> 00:01:22.940
ago to help me manage a
HTML5 training days

00:01:22.940 --> 00:01:24.720
event that I ran.

00:01:24.720 --> 00:01:27.550
And as you can see here,
let me just share

00:01:27.550 --> 00:01:30.350
my screen with you.

00:01:30.350 --> 00:01:34.090
Let's make sure that we're
choosing the right--

00:01:34.090 --> 00:01:37.070
yes, this is the one.

00:01:37.070 --> 00:01:40.060
So hopefully you can see
what I'm showing now.

00:01:40.060 --> 00:01:43.650
And this is basically
the github page that

00:01:43.650 --> 00:01:45.040
contain all the code.

00:01:45.040 --> 00:01:47.245
And you are most welcome
to fork it and browse

00:01:47.245 --> 00:01:49.360
it and look at it.

00:01:49.360 --> 00:01:52.040
What you can see here is
basically a very simple

00:01:52.040 --> 00:01:55.530
one-page site that contain all
the functionality you wish to

00:01:55.530 --> 00:01:57.860
have when you're organizing
an event.

00:01:57.860 --> 00:02:03.600
And in this specific location,
under the directory of

00:02:03.600 --> 00:02:06.600
G-doc-scripts, you can see all
the JavaScript code that

00:02:06.600 --> 00:02:09.410
basically will help us
to run the service

00:02:09.410 --> 00:02:12.190
side of this website.

00:02:12.190 --> 00:02:16.230
The website is something
that you can expect

00:02:16.230 --> 00:02:17.880
from an event site.

00:02:17.880 --> 00:02:22.580
First, we're talking about the
event and giving a nice link

00:02:22.580 --> 00:02:23.970
to register.

00:02:23.970 --> 00:02:27.480
Later on, we'll want to open
and share with our users an

00:02:27.480 --> 00:02:29.750
update schedule, an
update document.

00:02:29.750 --> 00:02:32.810
And that's actually a nice, cool
feature that you can do

00:02:32.810 --> 00:02:34.200
with Google Docs.

00:02:34.200 --> 00:02:36.810
You just open one document
as a public.

00:02:36.810 --> 00:02:39.360
Let everyone write
and read with it.

00:02:39.360 --> 00:02:42.650
And because it's a long link,
you can pretty much be safe

00:02:42.650 --> 00:02:44.670
that no spammers will get it.

00:02:44.670 --> 00:02:48.310
Because if you're doing an event
for 50, 60 people, most

00:02:48.310 --> 00:02:48.930
of the cases--

00:02:48.930 --> 00:02:51.640
that most of them will
be good citizens.

00:02:51.640 --> 00:02:54.790
And the document will
be very productive.

00:02:54.790 --> 00:02:57.620
And then we're giving some
information about where the

00:02:57.620 --> 00:02:59.090
location of the event is.

00:02:59.090 --> 00:03:01.920
And in this case, we give a link
to another document that

00:03:01.920 --> 00:03:06.120
we prepared with the map, the
schedule, and even a back

00:03:06.120 --> 00:03:08.840
channel so people could
speak with each other.

00:03:08.840 --> 00:03:12.740
Last but not least, some
contacts to people that are

00:03:12.740 --> 00:03:14.110
speaking at that event.

00:03:14.110 --> 00:03:16.340
And then if you're clicking on
"Register," of course you're

00:03:16.340 --> 00:03:20.280
getting our Google Doc form
that basically gathered

00:03:20.280 --> 00:03:23.260
information from the
participants, and making sure

00:03:23.260 --> 00:03:26.410
that we'll be able to track
what they like us to speak

00:03:26.410 --> 00:03:28.770
about to aim and to make
sure that we know

00:03:28.770 --> 00:03:30.260
the audience in advance.

00:03:30.260 --> 00:03:33.180
And then we are gathering some
interesting information that

00:03:33.180 --> 00:03:35.870
later on, we could just
have it all in

00:03:35.870 --> 00:03:37.690
our spreadsheet here.

00:03:37.690 --> 00:03:40.820
Now, the magic here is that in
this spreadsheet, we get a

00:03:40.820 --> 00:03:45.910
very nice detailed data
from our participants.

00:03:45.910 --> 00:03:51.300
Let's run one of these just to
see how does it look like.

00:03:51.300 --> 00:03:54.810
So we go here to
the live form.

00:03:54.810 --> 00:04:00.570
And here I'll just
put my details.

00:04:00.570 --> 00:04:01.480
Doesn't really matter.

00:04:01.480 --> 00:04:02.880
Now the email.

00:04:02.880 --> 00:04:07.210
So let's do aaa@example.com.

00:04:07.210 --> 00:04:09.010
And company, Google.

00:04:09.010 --> 00:04:14.700
And title, developer advocate.

00:04:14.700 --> 00:04:16.170
That's my title.

00:04:16.170 --> 00:04:18.990
And then, let's say that
we are into Java,

00:04:18.990 --> 00:04:20.440
Python, Flash is dead.

00:04:20.440 --> 00:04:24.700
So HTML5, and of course maybe
Ruby and JavaScript.

00:04:24.700 --> 00:04:27.757
And we're looking both in
internal and external web

00:04:27.757 --> 00:04:30.860
apps, and which browser
do you target?

00:04:30.860 --> 00:04:36.270
Let's say that we want to target
Chrome and Firefox and

00:04:36.270 --> 00:04:38.200
IE9 and above.

00:04:38.200 --> 00:04:40.780
So more or less modern
browsers.

00:04:40.780 --> 00:04:43.090
And you know what--

00:04:43.090 --> 00:04:44.110
I'll add Opera and
Safari, as well.

00:04:44.110 --> 00:04:46.660
Give them some love.

00:04:46.660 --> 00:04:48.560
And have you heard about
Chrome Frame?

00:04:48.560 --> 00:04:49.740
Yes, of course.

00:04:49.740 --> 00:04:53.250
And we want to use it when we
can, because it's improved

00:04:53.250 --> 00:04:54.550
performance.

00:04:54.550 --> 00:04:57.180
And you can see how old it is
because now it's Sencha, we

00:04:57.180 --> 00:04:59.620
should probably change it.

00:04:59.620 --> 00:05:02.170
The Sencha actually-- we should
leave it, Sencha Touch

00:05:02.170 --> 00:05:03.030
maybe right here.

00:05:03.030 --> 00:05:05.970
But SproutCore should
be in there.

00:05:05.970 --> 00:05:09.450
And we don't have here Angular,
so let's put Other.

00:05:09.450 --> 00:05:10.330
And that's it.

00:05:10.330 --> 00:05:11.615
Let's submit it.

00:05:11.615 --> 00:05:14.480
After we submit it, we're
getting a "thank you." And you

00:05:14.480 --> 00:05:16.760
can see here that if
I refresh it--

00:05:20.320 --> 00:05:22.400
yeah, probably I'm using--

00:05:22.400 --> 00:05:24.100
yeah, it's a different
document, of course.

00:05:24.100 --> 00:05:27.350
Because you can see here that
I have the London HTML5

00:05:27.350 --> 00:05:28.060
training there.

00:05:28.060 --> 00:05:29.555
And here I have my
GDL example.

00:05:32.610 --> 00:05:35.790
But nevertheless, let's say we
have the information here.

00:05:35.790 --> 00:05:39.400
Later on, if we're opening
the script editor--

00:05:39.400 --> 00:05:42.250
and that's done from here,
Script Editor,

00:05:42.250 --> 00:05:43.520
it will take a second.

00:05:43.520 --> 00:05:45.820
Then basically, all the codes
that I showed you first in the

00:05:45.820 --> 00:05:48.050
github is right here.

00:05:48.050 --> 00:05:50.840
And here, let's go real
quick on what this

00:05:50.840 --> 00:05:52.150
code can do for us.

00:05:52.150 --> 00:05:55.960
So first, to the people that
didn't show in the past how

00:05:55.960 --> 00:05:58.170
Script Editor in Google
Apps look like.

00:05:58.170 --> 00:06:00.150
This is our environment.

00:06:00.150 --> 00:06:04.680
It's quite nice that you could
get more or less all the main

00:06:04.680 --> 00:06:09.300
functionality that you want,
like saving it, running it,

00:06:09.300 --> 00:06:10.520
debugging it.

00:06:10.520 --> 00:06:14.610
And in this specific example,
let's try and jump into the

00:06:14.610 --> 00:06:16.480
code and go over it when
we are basically

00:06:16.480 --> 00:06:17.770
debugging our code.

00:06:17.770 --> 00:06:20.755
So let's start with sending
an initial email to our

00:06:20.755 --> 00:06:21.380
participant.

00:06:21.380 --> 00:06:22.700
This is the function.

00:06:22.700 --> 00:06:26.290
And if I do click on the debug,
you can see quite

00:06:26.290 --> 00:06:30.480
quickly that basically I have
here a nice window of

00:06:30.480 --> 00:06:32.360
debugging the information.

00:06:32.360 --> 00:06:34.930
And it stopped on
the first line.

00:06:34.930 --> 00:06:37.355
And now, I can do many things.

00:06:40.550 --> 00:06:42.490
Of course, I can jump
into the function.

00:06:42.490 --> 00:06:44.190
I can go above.

00:06:44.190 --> 00:06:46.610
I can do many, many things
that you want.

00:06:46.610 --> 00:06:50.080
In this cell location, I'll get
all the information about

00:06:50.080 --> 00:06:54.010
different things, like the
variables that I'm watching,

00:06:54.010 --> 00:06:57.280
breakpoints that I'm
putting, and so on.

00:06:57.280 --> 00:07:00.150
Here what the first we're doing
is just to get a hold of

00:07:00.150 --> 00:07:01.930
our active spreadsheet.

00:07:01.930 --> 00:07:06.090
Then we have the specific sheet
that we're going to

00:07:06.090 --> 00:07:08.930
focus on-- in this case,
it's the registration.

00:07:08.930 --> 00:07:11.860
If you noticed, here
we have two

00:07:11.860 --> 00:07:13.370
spreadsheets at the bottom.

00:07:13.370 --> 00:07:15.940
One is for the registration,
which basically will be filled

00:07:15.940 --> 00:07:17.050
up with details.

00:07:17.050 --> 00:07:18.540
And the other is with the email

00:07:18.540 --> 00:07:20.810
templates that we prepared.

00:07:20.810 --> 00:07:25.440
So the nice thing here is that
basically you could use this

00:07:25.440 --> 00:07:29.590
same spreadsheet and have
several sheets for the

00:07:29.590 --> 00:07:32.240
metadata that you're going to
use, and one for the real data

00:07:32.240 --> 00:07:35.080
that you are collecting
for your forms.

00:07:35.080 --> 00:07:40.010
In our case, here we're using
the first email that we're

00:07:40.010 --> 00:07:45.490
going to confirm the application
of several

00:07:45.490 --> 00:07:46.430
participants.

00:07:46.430 --> 00:07:50.000
And then when we're filling our
maximum amount of people

00:07:50.000 --> 00:07:55.070
that we could host, we could
send a nice other email for

00:07:55.070 --> 00:07:57.930
telling them that we don't have
enough space, but we'll

00:07:57.930 --> 00:07:58.940
put them in the waiting list.

00:07:58.940 --> 00:08:01.250
And if people will
cancel, we'll be

00:08:01.250 --> 00:08:02.560
able to put them back.

00:08:02.560 --> 00:08:05.860
Then if spots are opened up,
we are able to send a new

00:08:05.860 --> 00:08:09.920
email and reassure them that
they are now in the event.

00:08:09.920 --> 00:08:13.650
And of course, a reminder a week
or few days before the

00:08:13.650 --> 00:08:16.180
event just to make sure that
everyone will bring the right

00:08:16.180 --> 00:08:20.650
things and will be at the
right time and place.

00:08:20.650 --> 00:08:23.780
And last but not least, to
send a feedback form.

00:08:23.780 --> 00:08:27.120
So to ask to gather feedback
after events so we can get

00:08:27.120 --> 00:08:28.770
better and better at it.

00:08:28.770 --> 00:08:33.100
So in our code, we jumping
back to this form.

00:08:33.100 --> 00:08:37.120
And we're collecting basically
a holder to our data sheet.

00:08:37.120 --> 00:08:39.650
Then in the data sheet,
it's very useful to

00:08:39.650 --> 00:08:40.990
declare a data range.

00:08:40.990 --> 00:08:45.120
And in our case, we're starting
in the second row,

00:08:45.120 --> 00:08:46.900
because the first one
is for the headers.

00:08:46.900 --> 00:08:49.850
And then we're going up to
maximum amount of columns that

00:08:49.850 --> 00:08:52.250
we have, which are basically
derived from the amount of

00:08:52.250 --> 00:08:55.830
questions that have in the form,
and for the max rows.

00:08:55.830 --> 00:08:58.300
All the functions here, the
util functions that we are

00:08:58.300 --> 00:09:00.560
using, are down the
road of this file.

00:09:00.560 --> 00:09:03.270
So you could browse them
and check them.

00:09:03.270 --> 00:09:06.650
Here we are setting some
variables to work with.

00:09:06.650 --> 00:09:10.560
And of course, we want to get a
hold of our email templates

00:09:10.560 --> 00:09:12.185
so we'll be able to send them.

00:09:12.185 --> 00:09:15.290
After we're doing that, there's
a nice function that

00:09:15.290 --> 00:09:19.330
we took from the tutorial of
transforming our rows into

00:09:19.330 --> 00:09:20.620
JavaScript objects.

00:09:20.620 --> 00:09:25.000
And get rows data basically down
this file is a function

00:09:25.000 --> 00:09:26.120
that does exactly that.

00:09:26.120 --> 00:09:28.515
Then in Objects, we're
getting the objects

00:09:28.515 --> 00:09:31.100
we could work with.

00:09:31.100 --> 00:09:32.280
Then we're getting--

00:09:32.280 --> 00:09:36.590
it's not the nicest thing to
do, but still very useful.

00:09:36.590 --> 00:09:39.360
We're going to our active
sheet on the data sheet.

00:09:39.360 --> 00:09:42.460
And in 02 in this
location, we're

00:09:42.460 --> 00:09:44.190
having some more metadata.

00:09:44.190 --> 00:09:47.160
So you can see here that
the max attendees

00:09:47.160 --> 00:09:49.080
that we set is 60.

00:09:49.080 --> 00:09:52.370
We could give a name to the
event and have some useful

00:09:52.370 --> 00:09:53.240
information.

00:09:53.240 --> 00:09:54.870
How are we setting it?

00:09:54.870 --> 00:09:56.860
Let's just start now that
we have a new menu

00:09:56.860 --> 00:09:57.930
that we edit here.

00:09:57.930 --> 00:10:01.260
And if we want to set a new
max attendee number, we're

00:10:01.260 --> 00:10:03.030
just clicking on the
first menu item.

00:10:03.030 --> 00:10:05.820
Let's say that we
have 80 spots.

00:10:05.820 --> 00:10:09.380
Clicking OK, and as you can see
here, we just change it.

00:10:09.380 --> 00:10:11.180
Let me make it bigger.

00:10:11.180 --> 00:10:12.430
It's here.

00:10:14.860 --> 00:10:17.040
So after we got this
number, we go here.

00:10:17.040 --> 00:10:21.280
And for every row in our data,
we just want to make sure that

00:10:21.280 --> 00:10:22.990
we don't have any
response yet.

00:10:22.990 --> 00:10:25.870
So for the ones that we want
to respond with yes, we'll

00:10:25.870 --> 00:10:29.830
fill this constant, or
no, or waiting list.

00:10:29.830 --> 00:10:34.320
And then, we're trying to sum
it up, and just go over the

00:10:34.320 --> 00:10:37.240
ones that are responded already
with "yes." For them,

00:10:37.240 --> 00:10:41.600
of course, we just want to make
sure they won't get too

00:10:41.600 --> 00:10:42.260
many emails.

00:10:42.260 --> 00:10:45.320
Actually, more than one,
it's not good for us,

00:10:45.320 --> 00:10:45.880
because it's spamming.

00:10:45.880 --> 00:10:50.740
So we want just one email
per person per action.

00:10:50.740 --> 00:10:54.530
Here we'll just see that our
number of yeses is still lower

00:10:54.530 --> 00:10:55.620
than the max amount.

00:10:55.620 --> 00:10:59.010
Because if it's bigger than the
max amount, we'll probably

00:10:59.010 --> 00:11:01.700
want to send emails to
the waiting list.

00:11:01.700 --> 00:11:04.140
But if it's lower than the max--
and that's what it is

00:11:04.140 --> 00:11:04.970
right now--

00:11:04.970 --> 00:11:06.320
we'll get a template email.

00:11:06.320 --> 00:11:08.910
The first one, if you can
remember, A1, which is just

00:11:08.910 --> 00:11:13.700
confirming the people that
are OK with the event.

00:11:13.700 --> 00:11:17.270
And then, when we have the right
email template here,

00:11:17.270 --> 00:11:21.200
we're setting the right place
here to make sure that we're

00:11:21.200 --> 00:11:23.750
setting the value of "yes,"
so we won't send this

00:11:23.750 --> 00:11:25.360
person a new email.

00:11:25.360 --> 00:11:27.590
Then here, we are just going--

00:11:27.590 --> 00:11:31.880
getting the right subject to
the email and sending it.

00:11:31.880 --> 00:11:34.670
So this is the email text
that we gather.

00:11:34.670 --> 00:11:36.820
This is the subject
of the email.

00:11:36.820 --> 00:11:40.670
And here, this is where
the magic is done.

00:11:40.670 --> 00:11:43.020
We'll just mail apps,
send emails, and

00:11:43.020 --> 00:11:44.440
everything is done for us.

00:11:44.440 --> 00:11:46.585
You should remember that for
the first time that you run

00:11:46.585 --> 00:11:52.080
it, it will put a big warning
sign, are you willing, and

00:11:52.080 --> 00:11:53.280
give the permission--

00:11:53.280 --> 00:11:55.320
give this script a permission
to run.

00:11:55.320 --> 00:11:57.170
And once you do that,
you could run it.

00:11:57.170 --> 00:12:00.930
All the emails will get
your Gmail address.

00:12:00.930 --> 00:12:06.870
But if you want to prevent your
specific Gmail from being

00:12:06.870 --> 00:12:11.390
presented, you could fill here
at the end with more choices,

00:12:11.390 --> 00:12:15.210
like no reply, or sending
an alias, and

00:12:15.210 --> 00:12:17.350
lots of other things.

00:12:17.350 --> 00:12:19.930
Last but not least, we are
updating our objects and

00:12:19.930 --> 00:12:23.200
moving forward on that.

00:12:23.200 --> 00:12:25.800
You can see here that when we
are updating the waiting list,

00:12:25.800 --> 00:12:27.930
basically it's more or
less the same logic.

00:12:27.930 --> 00:12:30.430
The only thing that we'll do
here is just to make sure that

00:12:30.430 --> 00:12:32.910
we are passing on all the ones
that we marked with waiting

00:12:32.910 --> 00:12:35.600
list, and just transforming
them to "yes"

00:12:35.600 --> 00:12:38.430
if we have the space.

00:12:38.430 --> 00:12:41.940
Now, when we are doing that,
the status here, of course,

00:12:41.940 --> 00:12:42.970
will change.

00:12:42.970 --> 00:12:46.260
And then we'll be able to
control who is coming to the

00:12:46.260 --> 00:12:48.700
event, and who is not coming.

00:12:48.700 --> 00:12:50.120
So that's in terms
of the back end.

00:12:50.120 --> 00:12:53.020
Other things that we have here,
as you can see here, you

00:12:53.020 --> 00:12:55.020
have a nice drop-down that's
showing you all the functions

00:12:55.020 --> 00:12:56.110
that we are using.

00:12:56.110 --> 00:12:59.810
For instance, if you want to see
how the set max attendance

00:12:59.810 --> 00:13:01.330
function looks like.

00:13:01.330 --> 00:13:05.070
Just a quick link on
it, and then let's

00:13:05.070 --> 00:13:07.780
go here with setMax.

00:13:07.780 --> 00:13:12.890
And let's find it again.

00:13:12.890 --> 00:13:14.830
And here, you can see
that it marked it

00:13:14.830 --> 00:13:18.240
for us in this section.

00:13:18.240 --> 00:13:21.500
And basically, what we have here
is a nice way to gather

00:13:21.500 --> 00:13:25.330
information from our users with
the browser input box.

00:13:25.330 --> 00:13:28.690
And then we just want to make
sure that we are only using

00:13:28.690 --> 00:13:30.500
digits in this case.

00:13:30.500 --> 00:13:33.410
And it seems that we are
using just digits, so

00:13:33.410 --> 00:13:35.150
everything is fine.

00:13:35.150 --> 00:13:40.640
And then we are just putting
it in the right spot.

00:13:40.640 --> 00:13:43.720
What I suggest to you when
you're doing a real big

00:13:43.720 --> 00:13:47.410
complicated application here is
just to make sure that you

00:13:47.410 --> 00:13:48.270
use constant here.

00:13:48.270 --> 00:13:50.730
It will make your life
much, much easier.

00:13:50.730 --> 00:13:54.460
And here is just a simple
warning message when the users

00:13:54.460 --> 00:14:00.590
are putting anything that is
different from digits.

00:14:00.590 --> 00:14:03.210
If you are wondering how you're
setting the nice, new

00:14:03.210 --> 00:14:06.990
menu that we have here, which
we call Hackathon, and you

00:14:06.990 --> 00:14:08.790
could give it the name
of the event.

00:14:08.790 --> 00:14:11.560
So you could be able to use
it again and again.

00:14:11.560 --> 00:14:13.940
This function has done
the magic for you.

00:14:13.940 --> 00:14:15.080
We call it onOpen.

00:14:15.080 --> 00:14:20.020
So it will know to run it when
your spreadsheet is being

00:14:20.020 --> 00:14:24.120
loaded, like in document ready
on a web page, when you are

00:14:24.120 --> 00:14:27.330
attaching jQuery, and waiting
for that document ready event.

00:14:27.330 --> 00:14:29.510
And in this case, we're
getting the active

00:14:29.510 --> 00:14:31.830
spreadsheet, having
some menu items.

00:14:31.830 --> 00:14:35.300
And basically, here you can
see this JSON object

00:14:35.300 --> 00:14:39.460
containing the two attributes
of name and action.

00:14:39.460 --> 00:14:43.030
So this is the menu item
that the user will see.

00:14:43.030 --> 00:14:44.240
And when they--

00:14:44.240 --> 00:14:46.580
she or he will click
on it, basically

00:14:46.580 --> 00:14:47.990
will run this function.

00:14:47.990 --> 00:14:51.670
And this function, as you saw
just now in our case, is

00:14:51.670 --> 00:14:54.430
opening a nice dialogue
that's gathering

00:14:54.430 --> 00:14:56.230
information from our users.

00:14:56.230 --> 00:14:58.620
And then, we're just adding
this menu and

00:14:58.620 --> 00:15:00.570
giving it a new name.

00:15:00.570 --> 00:15:02.750
What you can see here--

00:15:02.750 --> 00:15:08.090
it's very, very nice to make
changes, Command-S, it's

00:15:08.090 --> 00:15:09.780
saving it immediately.

00:15:09.780 --> 00:15:15.390
And now, if we'll refresh this
page, you will see the changes

00:15:15.390 --> 00:15:17.125
taking place almost
immediately.

00:15:23.660 --> 00:15:25.860
Let's open the script editor.

00:15:30.180 --> 00:15:35.150
And now you see that we have GDL
Example menu item, and not

00:15:35.150 --> 00:15:36.180
what it used to be.

00:15:36.180 --> 00:15:38.480
So everything is quite
responsive in giving you

00:15:38.480 --> 00:15:40.550
feedback for what you're
doing quite quickly.

00:15:40.550 --> 00:15:41.780
And that's really nice.

00:15:41.780 --> 00:15:45.240
And of course, if you are happy
with the results, you

00:15:45.240 --> 00:15:48.740
can always publish it and submit
it to the gallery.

00:15:48.740 --> 00:15:53.160
So for people that don't know
where the gallery, or how to

00:15:53.160 --> 00:15:54.230
approach it--

00:15:54.230 --> 00:15:57.590
in every new spreadsheet that
you're opening, you have under

00:15:57.590 --> 00:16:00.320
Tools, the script gallery.

00:16:00.320 --> 00:16:02.220
And when you're clicking on
it, you have this nice

00:16:02.220 --> 00:16:05.490
dialogue that's letting you
see lots of other useful

00:16:05.490 --> 00:16:07.420
things that other
developers did.

00:16:07.420 --> 00:16:10.720
And basically, I encourage you
to check it out before you are

00:16:10.720 --> 00:16:13.170
pulling your sleeves and
starting to code stuff.

00:16:13.170 --> 00:16:18.230
Although sometimes it's really
nice to gather things and

00:16:18.230 --> 00:16:21.090
build them just in order to
understand them better.

00:16:21.090 --> 00:16:25.260
Let's jump a bit to see
our simple code for

00:16:25.260 --> 00:16:28.760
the one-page site.

00:16:28.760 --> 00:16:31.470
As you so here, I opened
View source.

00:16:31.470 --> 00:16:34.330
And you can see quite quickly
that I'm using Modernizr

00:16:34.330 --> 00:16:39.720
because it's a great library
and tool that lets us do

00:16:39.720 --> 00:16:43.020
feature detection and browser
sniffing, so we know what we

00:16:43.020 --> 00:16:45.190
have in each and every item.

00:16:45.190 --> 00:16:47.440
And I'm using HTML5
boilerplate.

00:16:47.440 --> 00:16:50.220
And I'm getting for free all
these nice hacks that we need

00:16:50.220 --> 00:16:52.640
to do if we want to support
other browsers.

00:16:52.640 --> 00:16:57.850
And of course, I have
this one metatag.

00:16:57.850 --> 00:17:01.050
So if the user is running in
IE and they've got Chrome

00:17:01.050 --> 00:17:03.520
Frame, everything will work
faster to them, because it

00:17:03.520 --> 00:17:08.260
will know to detect them, and to
actually tell the IE to use

00:17:08.260 --> 00:17:11.109
the headless Chrome Frame.

00:17:11.109 --> 00:17:14.310
And from there on, it's a very,
very simple site that

00:17:14.310 --> 00:17:17.960
we're using, simple navigation
on the top.

00:17:17.960 --> 00:17:20.410
And then nothing
too fancy here.

00:17:20.410 --> 00:17:24.380
We tried with Bitly just to make
short links that people

00:17:24.380 --> 00:17:27.319
could remember, like HTML5
London feedback,

00:17:27.319 --> 00:17:28.750
and things like that.

00:17:28.750 --> 00:17:32.460
Let me make it even bigger so
it will be easier to read.

00:17:32.460 --> 00:17:35.350
So this is what I spoke about.

00:17:35.350 --> 00:17:38.020
So everything is quite
easy to understand--

00:17:38.020 --> 00:17:39.350
a description of the event.

00:17:39.350 --> 00:17:42.220
And then we're heavily
leveraging Google Docs'

00:17:42.220 --> 00:17:45.250
sharing capabilities just to
have a back channel to the

00:17:45.250 --> 00:17:47.370
people that are participating
in the hackathon.

00:17:47.370 --> 00:17:49.730
And just to make sure that we
have a schedule that we are

00:17:49.730 --> 00:17:53.210
able to update it on the fly,
so people have one source of

00:17:53.210 --> 00:17:54.810
truth during the event.

00:17:54.810 --> 00:17:57.690
So here, there is
nothing fancy.

00:17:57.690 --> 00:18:01.710
And it's pretty useful just to
have this site up and running,

00:18:01.710 --> 00:18:04.270
and doesn't need to worry
about any service side.

00:18:04.270 --> 00:18:07.510
Because all the service side, in
terms of information, this

00:18:07.510 --> 00:18:09.270
spreadsheet is our database.

00:18:09.270 --> 00:18:13.200
And this email template is
giving us the freedom and the

00:18:13.200 --> 00:18:17.110
ability to basically give
personal, customized email to

00:18:17.110 --> 00:18:18.210
the participants.

00:18:18.210 --> 00:18:20.430
As you can see here, we are
using a very simple

00:18:20.430 --> 00:18:24.480
methodology to have this dollar
sign, and then this

00:18:24.480 --> 00:18:26.630
specific template.

00:18:26.630 --> 00:18:29.780
So later on, in our code, and
let's see how we're doing it,

00:18:29.780 --> 00:18:34.530
we'll replace first name with
the first name that we have

00:18:34.530 --> 00:18:38.070
here in the B column.

00:18:38.070 --> 00:18:40.910
How we're doing it, it's
quite straightforward.

00:18:40.910 --> 00:18:50.920
You can see here that when
we're sending the email,

00:18:50.920 --> 00:18:56.100
basically we're having the
row data email address.

00:18:56.100 --> 00:19:00.270
And before that, we have a fill
in template from object.

00:19:00.270 --> 00:19:01.440
So this function--

00:19:01.440 --> 00:19:05.200
let's just do a quick
Find on it.

00:19:08.070 --> 00:19:10.950
Another one, and here it is.

00:19:10.950 --> 00:19:12.630
Basically, it's replaced--

00:19:12.630 --> 00:19:15.935
it's going into our regular
expression over the template

00:19:15.935 --> 00:19:20.060
that we set, and the template
looked like this.

00:19:20.060 --> 00:19:23.350
And we have another function
basically that before it, is

00:19:23.350 --> 00:19:27.920
just going and checking this
regular expression to know

00:19:27.920 --> 00:19:30.740
where or which column we
are talking about.

00:19:30.740 --> 00:19:34.840
And after we do that, the
function that I spoke about

00:19:34.840 --> 00:19:36.440
just now is the normalizeHeader,
which is

00:19:36.440 --> 00:19:39.140
basically taking and just making
sure that we won't work

00:19:39.140 --> 00:19:43.630
with any capital letters or
spaces just to make sure that

00:19:43.630 --> 00:19:46.870
we have keys to our objects.

00:19:46.870 --> 00:19:51.940
And after we're doing that,
we're just replacing the right

00:19:51.940 --> 00:19:53.660
template with the names
that we want.

00:19:53.660 --> 00:19:57.110
In our case here, when we're
giving the data, the data that

00:19:57.110 --> 00:19:59.620
we want to replace will
be the user name.

00:19:59.620 --> 00:20:01.740
and the user's first name.

00:20:01.740 --> 00:20:05.260
So when we're filling it from
the template, we're having the

00:20:05.260 --> 00:20:06.130
right name.

00:20:06.130 --> 00:20:11.890
And then we are able to have
this email text field with the

00:20:11.890 --> 00:20:14.720
right names.

00:20:14.720 --> 00:20:17.170
So that's very straightforward
and easy.

00:20:17.170 --> 00:20:21.200
And then the users are getting
nice, customized email with

00:20:21.200 --> 00:20:23.120
their first names at the top.

00:20:23.120 --> 00:20:26.930
And you can think about lots
of other ways to make those

00:20:26.930 --> 00:20:30.050
emails look better and
be more personalized.

00:20:30.050 --> 00:20:33.560
By the way, here the emails are
all in text format, but

00:20:33.560 --> 00:20:34.880
you could use HTML.

00:20:34.880 --> 00:20:38.970
And that's quite nice to be able
to use it, and then have

00:20:38.970 --> 00:20:42.400
even richer emails
to the users.

00:20:42.400 --> 00:20:49.080
All the information about how to
use it could be found here.

00:20:49.080 --> 00:20:52.130
Let's do this real quick.

00:20:52.130 --> 00:20:57.130
And this class of MailApp,
giving you all the different

00:20:57.130 --> 00:21:02.560
options that you want to do when
you're sending emails.

00:21:02.560 --> 00:21:09.940
And for instance here, you are
able to set attachments, and

00:21:09.940 --> 00:21:15.150
make sure that it won't be just
text, but HTML, and lots

00:21:15.150 --> 00:21:16.370
of other things.

00:21:16.370 --> 00:21:21.120
So I think we covered all the
main important parts.

00:21:21.120 --> 00:21:24.510
And if we have questions,
this is a good time.

00:21:24.510 --> 00:21:30.880
If not, please feel free to
check out this site, which is

00:21:30.880 --> 00:21:32.130
ido-green.appspot.com.

00:21:33.880 --> 00:21:37.410
Or just use--

00:21:37.410 --> 00:21:40.820
let's open the console,
and write it real big.

00:21:45.130 --> 00:21:54.800
So it will be @greenido
on Twitter, or

00:21:54.800 --> 00:21:58.960
plus.ly/greenido for G+.

00:21:58.960 --> 00:22:00.155
So thank you very much.

00:22:00.155 --> 00:22:03.220
And until next time, be strong.

