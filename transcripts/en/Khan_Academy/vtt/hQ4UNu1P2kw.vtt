WEBVTT
Kind: captions
Language: en

00:00:00.194 --> 00:00:02.246
- [Lecturer] All right, so
today I'm gonna be talking

00:00:02.246 --> 00:00:04.147
about the Lagrangian.

00:00:04.147 --> 00:00:06.107
Now we talked about Lagrange multipliers.

00:00:06.107 --> 00:00:08.038
This is a highly related concept.

00:00:08.038 --> 00:00:10.097
In fact, it's not really
teaching anything new.

00:00:10.097 --> 00:00:12.668
This is just repackaging
stuff that we already know.

00:00:12.668 --> 00:00:14.280
So to remind you of the setup,

00:00:14.280 --> 00:00:17.265
this is gonna be a constrained
optimization problem setup

00:00:17.265 --> 00:00:19.990
so we'll have some kind
of multivariable function.

00:00:19.990 --> 00:00:24.083
F of x, y, and the one
I have pictured here is,

00:00:24.083 --> 00:00:27.833
let's see, it's x squared times e to the y

00:00:28.798 --> 00:00:31.369
times y so what I have shown here

00:00:31.369 --> 00:00:34.103
is a contour line for this function.

00:00:34.103 --> 00:00:37.009
So that is, we say what
happens if we set this equal

00:00:37.009 --> 00:00:40.486
to some constant, and we ask
about all values of x and y

00:00:40.486 --> 00:00:41.612
such that this holds,

00:00:41.612 --> 00:00:43.738
such that this function
outputs that constant,

00:00:43.738 --> 00:00:45.253
and if I choose a different constant,

00:00:45.253 --> 00:00:47.654
and that contour line can
look a little bit different,

00:00:47.654 --> 00:00:49.694
it's kinda nice that it has similar shapes

00:00:49.694 --> 00:00:52.923
so that's the function, and
we're trying to maximize it.

00:00:52.923 --> 00:00:55.723
The goal is to maximize this guy,

00:00:55.723 --> 00:00:57.235
and of course, it's not just that.

00:00:57.235 --> 00:01:00.071
The reason we call it a
constrained optimization problem

00:01:00.071 --> 00:01:01.819
is 'cause there's some kind of constraint,

00:01:01.819 --> 00:01:05.069
some kind of other function, g of x, y.

00:01:06.172 --> 00:01:10.298
In this case, x squared plus y squared,

00:01:10.298 --> 00:01:12.715
and we want to say that this has to equal

00:01:12.715 --> 00:01:14.116
some specific amount.

00:01:14.116 --> 00:01:16.575
In this case, I'm gonna
set it equal to four.

00:01:16.575 --> 00:01:18.300
So we say you can't look at any x, y

00:01:18.300 --> 00:01:19.820
to maximize this function.

00:01:19.820 --> 00:01:21.933
You are limited to the values of x and y

00:01:21.933 --> 00:01:23.889
that satisfy this property,

00:01:23.889 --> 00:01:25.905
and I talked about this in
the last couple of videos,

00:01:25.905 --> 00:01:29.378
and kind of the cool thing
that we found was that you look

00:01:29.378 --> 00:01:32.096
through the various
different contour lines of f,

00:01:32.096 --> 00:01:35.182
and the maximum will be
achieved when that contour line

00:01:35.182 --> 00:01:38.709
is just perfectly parallel
to this contour of g,

00:01:38.709 --> 00:01:40.379
and you know, a pretty classic example

00:01:40.379 --> 00:01:42.919
for what these sorts of things could mean,

00:01:42.919 --> 00:01:45.342
or how it's used in
practice is if this was,

00:01:45.342 --> 00:01:47.612
say a revenue function
for some kind of company.

00:01:47.612 --> 00:01:48.947
You're kind of modeling your revenues

00:01:48.947 --> 00:01:50.337
based on different choices

00:01:50.337 --> 00:01:52.078
you could make running that company,

00:01:52.078 --> 00:01:53.500
and the constraint that
you'd have would be,

00:01:53.500 --> 00:01:55.635
let's say a budget so
I'm just gonna go ahead

00:01:55.635 --> 00:01:59.029
and write budget or B for budget here

00:01:59.029 --> 00:02:00.886
so you're trying to maximize revenues,

00:02:00.886 --> 00:02:03.163
and then you have some
sort of dollar limit

00:02:03.163 --> 00:02:05.163
for what you're willing to spend,

00:02:05.163 --> 00:02:06.900
and these, of course, are just
kind of made-up functions.

00:02:06.900 --> 00:02:09.105
You'd never have a budget
that looks like a circle

00:02:09.105 --> 00:02:11.485
and this kind of random
configuration for your revenue

00:02:11.485 --> 00:02:13.406
but in principle, you
know what I mean, right?

00:02:13.406 --> 00:02:16.709
So the way that we took advantage
of this tangency property,

00:02:16.709 --> 00:02:18.172
and I think this is pretty clever.

00:02:18.172 --> 00:02:20.164
Let me just kind of redraw it over here.

00:02:20.164 --> 00:02:22.485
You're looking at the point
where the two functions

00:02:22.485 --> 00:02:26.137
are just tangent to each
other is that the gradient,

00:02:26.137 --> 00:02:28.546
the gradient vector for
the thing we're maximizing,

00:02:28.546 --> 00:02:31.598
which in this case is
R, is gonna be parallel

00:02:31.598 --> 00:02:35.276
or proportional to the gradient
vector of the constraint,

00:02:35.276 --> 00:02:38.520
which in this case is B,
is gonna be proportional

00:02:38.520 --> 00:02:41.424
to the gradient of the constraint,

00:02:41.424 --> 00:02:44.153
and what this means is that
if we were going to solve

00:02:44.153 --> 00:02:46.270
a set of equations, what you set up

00:02:46.270 --> 00:02:48.269
is you compute that gradient of R,

00:02:48.269 --> 00:02:50.440
and it'll involve two
different partial derivatives,

00:02:50.440 --> 00:02:53.441
and you set it equal
not to the gradient of B

00:02:53.441 --> 00:02:54.879
'cause it's not necessarily equal

00:02:54.879 --> 00:02:57.705
to the gradient of B but it's proportional

00:02:57.705 --> 00:03:01.350
with some kind of
proportionality constant, lambda.

00:03:01.350 --> 00:03:03.471
That's kind of a squarely lambda.

00:03:03.471 --> 00:03:04.348
Lambda.

00:03:04.348 --> 00:03:06.950
That one doesn't look
good either, does it?

00:03:06.950 --> 00:03:08.766
Why are lambdas so hard to draw?

00:03:08.766 --> 00:03:10.039
Right, that looks fine.

00:03:10.039 --> 00:03:11.470
So the gradient of the revenue

00:03:11.470 --> 00:03:15.601
is proportional to the
gradient of the budget,

00:03:15.601 --> 00:03:16.874
and we did a couple of examples

00:03:16.874 --> 00:03:18.100
of solving this kind of thing.

00:03:18.100 --> 00:03:20.141
This gives you two separate equations

00:03:20.141 --> 00:03:21.652
from the two partial derivatives,

00:03:21.652 --> 00:03:24.881
and then you use this right
here, this budget constraint

00:03:24.881 --> 00:03:27.836
as your third equation,
and the Lagrangian,

00:03:27.836 --> 00:03:30.389
the point of this video,
this Lagrangian function

00:03:30.389 --> 00:03:33.888
is basically just a way to
package up this equation

00:03:33.888 --> 00:03:37.089
along with this equation
into a single entity

00:03:37.089 --> 00:03:38.668
so it's not really adding new information,

00:03:38.668 --> 00:03:40.044
and if you're solving things by hand,

00:03:40.044 --> 00:03:41.777
it doesn't really do anything for you

00:03:41.777 --> 00:03:44.781
but what makes it nice is
that it's something easier

00:03:44.781 --> 00:03:47.465
to hand a computer, and
I'll show you what I mean.

00:03:47.465 --> 00:03:49.918
So I'm gonna define the Lagrangian itself,

00:03:49.918 --> 00:03:52.991
which we write with this kind
of funky looking script, L,

00:03:52.991 --> 00:03:56.079
and it's a function with the same inputs

00:03:56.079 --> 00:03:57.616
that your revenue function

00:03:57.616 --> 00:04:00.829
or the thing that you're
maximizing has along with lambda,

00:04:00.829 --> 00:04:03.784
along with that Lagrange multiplier,

00:04:03.784 --> 00:04:05.664
and the way that we define it,

00:04:05.664 --> 00:04:07.312
and I'm gonna need some extra room

00:04:07.312 --> 00:04:09.023
so I'm gonna say it's equal to,

00:04:09.023 --> 00:04:10.670
and kinda define it down here,

00:04:10.670 --> 00:04:13.397
the revenue function or whatever it is

00:04:13.397 --> 00:04:16.358
that you're maximizing, the
function that you're maximizing

00:04:16.358 --> 00:04:19.127
minus lambda, that Lagrange multiplier

00:04:19.127 --> 00:04:21.407
so that's just another
input to this new function

00:04:21.407 --> 00:04:25.850
that we're defining multiplied
by the constraint function,

00:04:25.850 --> 00:04:28.600
in this case, B evaluated at x, y

00:04:29.942 --> 00:04:32.785
minus whatever that constraint value is.

00:04:32.785 --> 00:04:35.235
In this case, I put in four
so you write minus four.

00:04:35.235 --> 00:04:37.203
If we wanted to be more general,

00:04:37.203 --> 00:04:40.762
maybe we would write b for
whatever your budget is

00:04:40.762 --> 00:04:44.843
so over here, you're
subtracting off little b

00:04:44.843 --> 00:04:47.758
so this here is a new
multivariable function, right?

00:04:47.758 --> 00:04:50.799
It's something where you
could input x, y, and lambda,

00:04:50.799 --> 00:04:52.374
and just kind of plug it all in,

00:04:52.374 --> 00:04:53.937
and you'd get some kind of value,

00:04:53.937 --> 00:04:56.316
and remember b, in this
case, is a constant

00:04:56.316 --> 00:04:58.071
so I'll go ahead and write that

00:04:58.071 --> 00:05:01.698
that this right here is
not considered a variable.

00:05:01.698 --> 00:05:03.168
This is just some constant.

00:05:03.168 --> 00:05:06.010
Your variables are x, y, and lambda.

00:05:06.010 --> 00:05:08.367
And this would seem like a
totally weird and random thing

00:05:08.367 --> 00:05:10.524
to do if you just saw it out of context,

00:05:10.524 --> 00:05:13.289
or if it was unmotivated
but what's kind of neat,

00:05:13.289 --> 00:05:15.419
and we'll go ahead and
work through this right now

00:05:15.419 --> 00:05:18.141
is that when you take this,

00:05:18.141 --> 00:05:20.746
is that when you take the
gradient of this function

00:05:20.746 --> 00:05:24.498
called the Lagrangian, and
you set it equal to zero,

00:05:24.498 --> 00:05:28.896
that's gonna encapsulate all
three equations that you need,

00:05:28.896 --> 00:05:30.067
and I'll show you what I mean by that.

00:05:30.067 --> 00:05:34.019
So let's just remember the gradient of L,

00:05:34.019 --> 00:05:35.789
that's a vector.

00:05:35.789 --> 00:05:37.048
That's got three different components

00:05:37.048 --> 00:05:38.949
since L has three different inputs.

00:05:38.949 --> 00:05:42.006
You're gonna have the
partial derivative of L

00:05:42.006 --> 00:05:44.104
with respect to x.

00:05:44.104 --> 00:05:47.159
You're gonna have the
partial derivative of L

00:05:47.159 --> 00:05:49.266
with respect to y.

00:05:49.266 --> 00:05:52.593
And then finally the
partial derivative of L

00:05:52.593 --> 00:05:55.867
with respect to lambda,
our Lagrange multiplier,

00:05:55.867 --> 00:05:59.038
which we're considering
an input to this function.

00:05:59.038 --> 00:06:01.660
And remember whenever we write
that the vector equals zero,

00:06:01.660 --> 00:06:03.574
really we mean the zero vector.

00:06:03.574 --> 00:06:05.865
Often you'll see it in
bold if it's in a textbook

00:06:05.865 --> 00:06:06.882
but what we're really saying

00:06:06.882 --> 00:06:08.934
is we set those three different functions,

00:06:08.934 --> 00:06:13.101
the three different partial
derivatives all equal to zero

00:06:14.380 --> 00:06:17.722
so this is just a nice like
closed form, compact way

00:06:17.722 --> 00:06:19.676
of saying that all of
its partial derivatives

00:06:19.676 --> 00:06:21.667
is equal to zero, and let's go ahead

00:06:21.667 --> 00:06:25.268
and think about what those
partial derivatives actually are.

00:06:25.268 --> 00:06:28.188
So this first one, the
partial with respect to x,

00:06:28.188 --> 00:06:32.528
partial derivative of the
Lagrangian with respect to x.

00:06:32.528 --> 00:06:33.361
It's kinda funny.

00:06:33.361 --> 00:06:34.556
Now you have all these curly symbols,

00:06:34.556 --> 00:06:35.919
the curly d, the curly l.

00:06:35.919 --> 00:06:39.092
It makes it look like you're
doing some truly advanced math

00:06:39.092 --> 00:06:42.208
but really it's just kind of
artificial fanciness, right?

00:06:42.208 --> 00:06:43.918
But anyway so we take
the partial derivative

00:06:43.918 --> 00:06:46.823
with respect to x, and
what that equals is well,

00:06:46.823 --> 00:06:49.830
it's whatever the partial derivative of R

00:06:49.830 --> 00:06:53.682
with respect to x is
minus, and then lambda.

00:06:53.682 --> 00:06:56.848
From x's perspective, lambda
just looks like a constant.

00:06:56.848 --> 00:06:59.201
So this can be lambda.

00:06:59.201 --> 00:07:01.403
And then this inside the parenthesis,

00:07:01.403 --> 00:07:04.181
the partial derivative of
that with respect to x,

00:07:04.181 --> 00:07:08.348
well, it's gonna be whatever
the partial derivative of B is

00:07:09.846 --> 00:07:13.831
with respect to x but
subtracting off that constant,

00:07:13.831 --> 00:07:15.482
that doesn't change the derivative

00:07:15.482 --> 00:07:18.170
so this right here is the
partial derivative of lambda

00:07:18.170 --> 00:07:19.778
with respect to x.

00:07:19.778 --> 00:07:22.176
Now if you set that equal to zero.

00:07:22.176 --> 00:07:23.009
I don't know.

00:07:23.009 --> 00:07:24.645
I've kind of run out of
room on the right here

00:07:24.645 --> 00:07:26.781
but if you set that equal to zero,

00:07:26.781 --> 00:07:29.108
that's the same as just saying
that the partial derivative

00:07:29.108 --> 00:07:31.683
of R with respect to x equals lambda

00:07:31.683 --> 00:07:35.872
times the partial derivative
of B with respect to x,

00:07:35.872 --> 00:07:37.224
and if you think what's gonna happen

00:07:37.224 --> 00:07:39.285
when you unfold this property,

00:07:39.285 --> 00:07:42.264
the gradient of R is
proportional to the gradient of B

00:07:42.264 --> 00:07:43.225
written up here.

00:07:43.225 --> 00:07:45.282
That's just the first
portion of this, right?

00:07:45.282 --> 00:07:46.717
If we're setting the gradients equal,

00:07:46.717 --> 00:07:48.365
then the first component of that

00:07:48.365 --> 00:07:51.583
is to say that the partial derivative of R

00:07:51.583 --> 00:07:53.635
with respect to x is equal to lambda

00:07:53.635 --> 00:07:56.737
times the partial derivative
of B with respect to x.

00:07:56.737 --> 00:07:58.613
And then if you do this for y,

00:07:58.613 --> 00:08:00.683
if we take the partial derivative

00:08:00.683 --> 00:08:02.933
of this Lagrangian function

00:08:04.224 --> 00:08:05.724
with respect to y,

00:08:07.317 --> 00:08:08.267
it's very similar, right?

00:08:08.267 --> 00:08:10.467
It's gonna be, well, you just
take the partial derivative

00:08:10.467 --> 00:08:12.122
of R with respect to y.

00:08:12.122 --> 00:08:15.258
In fact, it all looks just identical.

00:08:15.258 --> 00:08:17.124
Whatever R is, you take
as partial derivative

00:08:17.124 --> 00:08:19.371
with respect to y, and
then we subtract off.

00:08:19.371 --> 00:08:22.196
Lambda looks like a constant
as far as y is concerned,

00:08:22.196 --> 00:08:24.407
and then that's multiplied by, well,

00:08:24.407 --> 00:08:26.885
what's the partial derivative of this term

00:08:26.885 --> 00:08:29.094
inside the parenthesis with respect to y?

00:08:29.094 --> 00:08:33.514
Well, it's the partial
of B with respect to y.

00:08:33.514 --> 00:08:37.268
And again, again, if you imagine
setting that equal to zero,

00:08:37.268 --> 00:08:38.499
that's gonna be the same

00:08:38.499 --> 00:08:40.619
as setting this partial derivative term

00:08:40.619 --> 00:08:43.364
equal to lambda times this
partial derivative term, right?

00:08:43.364 --> 00:08:45.895
You kind of just bring
one to the other side.

00:08:45.895 --> 00:08:47.036
So this second component

00:08:47.036 --> 00:08:50.708
of our Lagrangian equals zero equation

00:08:50.708 --> 00:08:52.818
is just the second
function that we've seen

00:08:52.818 --> 00:08:54.846
in a lot of these examples
that we've been doing

00:08:54.846 --> 00:08:56.268
where you set one of the gradient vectors

00:08:56.268 --> 00:08:58.051
proportional to the other one,

00:08:58.051 --> 00:09:00.338
and the only real difference here

00:09:00.338 --> 00:09:02.282
from stuff that we've seen already,

00:09:02.282 --> 00:09:04.116
and even then it's not that different

00:09:04.116 --> 00:09:07.272
is that what happens when we
take the partial derivative

00:09:07.272 --> 00:09:10.772
of this Lagrangian with respect to lambda,

00:09:11.649 --> 00:09:12.504
and I'll go ahead and give it

00:09:12.504 --> 00:09:15.387
that kind of green lambda color here.

00:09:15.387 --> 00:09:17.012
Well, when we take that
partial derivative,

00:09:17.012 --> 00:09:20.517
if we kinda look up with the
definition of the function,

00:09:20.517 --> 00:09:22.981
R, R never has a lambda in it, right?

00:09:22.981 --> 00:09:24.701
It's purely a function of x and y

00:09:24.701 --> 00:09:26.730
so that looks just like a constant

00:09:26.730 --> 00:09:29.058
when we're differentiating
with respect to lambda

00:09:29.058 --> 00:09:31.359
so that's just gonna be zero

00:09:31.359 --> 00:09:34.363
when we take its partial derivative.

00:09:34.363 --> 00:09:38.295
And then this next
component, B of x, y minus b,

00:09:38.295 --> 00:09:40.142
all of that just looks like a constant

00:09:40.142 --> 00:09:41.531
as far as lambda is concerned, right?

00:09:41.531 --> 00:09:44.311
There's x's, there's y,
there is this constant b

00:09:44.311 --> 00:09:46.296
but none of these things
have lambdas in them

00:09:46.296 --> 00:09:48.127
so when we take the partial derivative

00:09:48.127 --> 00:09:49.487
with respect to lambda,

00:09:49.487 --> 00:09:53.654
this just looks like some big
constant times lambda itself.

00:09:54.787 --> 00:09:56.009
So what we're gonna get

00:09:56.009 --> 00:09:57.264
is I guess we're subtracting off, right?

00:09:57.264 --> 00:09:59.595
Up here, we're kind of
writing a minus sign.

00:09:59.595 --> 00:10:01.345
We're subtracting off

00:10:02.999 --> 00:10:04.986
all the stuff that was
in those parenthesis,

00:10:04.986 --> 00:10:05.819
B of x, y

00:10:07.693 --> 00:10:09.610
minus b, that constant.

00:10:10.649 --> 00:10:11.618
And this whole thing,

00:10:11.618 --> 00:10:14.369
if we set that whole thing equal to zero,

00:10:14.369 --> 00:10:15.300
well, that's pretty much the same

00:10:15.300 --> 00:10:19.405
as setting B of x, y
minus b equal to zero,

00:10:19.405 --> 00:10:21.535
and that, that's really
just the same as saying,

00:10:21.535 --> 00:10:23.952
"Hey, we're setting B of x, y

00:10:25.476 --> 00:10:27.556
"equal to that little b," right?

00:10:27.556 --> 00:10:30.048
Setting this partial
derivative of the Lagrangian

00:10:30.048 --> 00:10:33.759
with respect to the Lagrange
multiplier equal to zero

00:10:33.759 --> 00:10:36.043
boils down to the constraint, right?

00:10:36.043 --> 00:10:40.148
The third equation that we need to solve.

00:10:40.148 --> 00:10:42.953
So in that way, setting the gradient

00:10:42.953 --> 00:10:45.357
of this Lagrangian function equal to zero

00:10:45.357 --> 00:10:47.045
is just a very compact way

00:10:47.045 --> 00:10:49.266
of packaging three separate
equations that we need

00:10:49.266 --> 00:10:53.344
to solve the constrained
optimization problem,

00:10:53.344 --> 00:10:56.439
and I'll emphasize that in practice,

00:10:56.439 --> 00:10:59.412
if you actually see a function for R

00:10:59.412 --> 00:11:00.782
for the thing that you're maximizing,

00:11:00.782 --> 00:11:03.394
and a function for the budget,
it's much better I think

00:11:03.394 --> 00:11:05.814
to just directly think about
these parallel gradients,

00:11:05.814 --> 00:11:07.352
and kind of solve it from there

00:11:07.352 --> 00:11:09.218
because if you construct the Lagrangian,

00:11:09.218 --> 00:11:10.463
and then compute its gradient,

00:11:10.463 --> 00:11:13.106
all you're really doing
is repackaging it up

00:11:13.106 --> 00:11:14.703
only to unpackage it again

00:11:14.703 --> 00:11:17.304
but the point of this, kind of the reason

00:11:17.304 --> 00:11:19.172
that this is a very useful construct

00:11:19.172 --> 00:11:21.930
is that computers often
have really fast ways

00:11:21.930 --> 00:11:24.099
of solving things like this,

00:11:24.099 --> 00:11:28.131
things like the gradient of
some function equals zero,

00:11:28.131 --> 00:11:30.280
and the reason is because
that's how you solve

00:11:30.280 --> 00:11:32.945
unconstrained maximization
problems, right?

00:11:32.945 --> 00:11:35.092
This is very similar
to as if we just looked

00:11:35.092 --> 00:11:37.796
at this function L out of
context, and we're asked,

00:11:37.796 --> 00:11:40.017
"Hey, what is its maximum value?

00:11:40.017 --> 00:11:42.068
"What are the critical
points that it has?"

00:11:42.068 --> 00:11:45.080
And you said it's gradient equal to zero.

00:11:45.080 --> 00:11:46.772
So kind of the whole
point of this Lagrangian

00:11:46.772 --> 00:11:49.692
is that it turns our
constrained optimization problem

00:11:49.692 --> 00:11:53.130
involving R and B and this
new made-up variable lambda

00:11:53.130 --> 00:11:56.161
into an unconstrained optimization problem

00:11:56.161 --> 00:11:58.982
where we're just setting the
gradient of some function

00:11:58.982 --> 00:12:02.146
equal to zero so computers can
often do that really quickly

00:12:02.146 --> 00:12:04.354
so if you just hand the
computer this function,

00:12:04.354 --> 00:12:06.227
it will be able to find you an answer

00:12:06.227 --> 00:12:08.352
whereas it's harder to say, "Hey computer,

00:12:08.352 --> 00:12:10.749
"I want you to think about when
the gradients are parallel,

00:12:10.749 --> 00:12:12.758
"and also consider this
constraint function."

00:12:12.758 --> 00:12:16.662
It's just sort of a cleaner
way to package it all up.

00:12:16.662 --> 00:12:17.984
So with that, I'll see you next video

00:12:17.984 --> 00:12:19.982
where I'm gonna talk
about the significance

00:12:19.982 --> 00:12:23.054
of this lambda term, how it's
not just a ghost variable

00:12:23.054 --> 00:12:25.432
but it actually has a
pretty nice interpretation

00:12:25.432 --> 00:12:27.516
for a given constrained problem.

