WEBVTT
Kind: captions
Language: en

00:00:07.600 --> 00:00:09.050
ARUN NAGARAJAN: Hello
and welcome.

00:00:09.050 --> 00:00:10.480
My name is Arun Nagarajan.

00:00:10.480 --> 00:00:13.260
And in this video tutorial,
we'll talk about adding custom

00:00:13.260 --> 00:00:14.680
menus to spreadsheet.

00:00:14.680 --> 00:00:17.910
So menus are the top bar where
you're able to inject things,

00:00:17.910 --> 00:00:20.550
like where you have file,
edit, and whatnot.

00:00:20.550 --> 00:00:22.700
And in this tutorial, at the end
of it, you'll be able to

00:00:22.700 --> 00:00:24.930
add your own custom
menus to that bar.

00:00:24.930 --> 00:00:26.770
So let's get started.

00:00:26.770 --> 00:00:29.480
So you will find the tutorial
under the Intermediate

00:00:29.480 --> 00:00:32.240
Tutorials and Other
Tutorials section.

00:00:32.240 --> 00:00:34.960
Just scroll down to the
section called User

00:00:34.960 --> 00:00:36.300
Interfaces.

00:00:36.300 --> 00:00:39.010
Click on Defining Spreadsheet
Menus.

00:00:39.010 --> 00:00:41.440
And that'll be all the
code we'll need.

00:00:41.440 --> 00:00:43.050
It actually says five minutes.

00:00:43.050 --> 00:00:44.460
But it'll take a lot
less than that.

00:00:44.460 --> 00:00:46.770
It's actually a very
straightforward process,

00:00:46.770 --> 00:00:47.810
you'll see.

00:00:47.810 --> 00:00:49.970
So in order to do this, the
first thing that you need to

00:00:49.970 --> 00:00:52.460
do is have a spreadsheet
available.

00:00:52.460 --> 00:00:55.600
So for this demo, I'll start
a new spreadsheet.

00:00:55.600 --> 00:00:56.820
But you can also
use an existing

00:00:56.820 --> 00:00:58.370
spreadsheet if you have one.

00:00:58.370 --> 00:01:00.210
I'll just name this--

00:01:00.210 --> 00:01:02.100
Custom menus.

00:01:02.100 --> 00:01:05.810
And I need to open the Script
Editor in the context of the

00:01:05.810 --> 00:01:07.470
spreadsheet.

00:01:07.470 --> 00:01:09.650
So in other demos, you may
have seen us go to

00:01:09.650 --> 00:01:12.730
script.google.com directly
and enter a code there.

00:01:12.730 --> 00:01:14.770
But in this particular example,
it's very important

00:01:14.770 --> 00:01:18.320
that the script is associated
with the spreadsheet.

00:01:18.320 --> 00:01:20.890
And when you go to the Script
Editor for the first time or

00:01:20.890 --> 00:01:24.350
if you have the welcome screen
still displayed, you may have

00:01:24.350 --> 00:01:26.890
to close out of it to come to
the Script Editor here.

00:01:26.890 --> 00:01:32.440
So as mentioned before, I'll
just copy and paste this code,

00:01:32.440 --> 00:01:34.310
just a few lines here.

00:01:34.310 --> 00:01:37.720
And I'll replace the stub
that we give you.

00:01:37.720 --> 00:01:38.380
We'll save it.

00:01:38.380 --> 00:01:41.620
We'll call it Custom menus.

00:01:41.620 --> 00:01:43.420
And it's ready to go
at this point.

00:01:43.420 --> 00:01:45.810
So you can see that the code
is actually pretty

00:01:45.810 --> 00:01:46.570
straightforward.

00:01:46.570 --> 00:01:48.550
We'll kind of break this
down in a second.

00:01:48.550 --> 00:01:50.630
But let's just make sure that
we know what we're trying to

00:01:50.630 --> 00:01:51.470
achieve here.

00:01:51.470 --> 00:01:53.700
So here's the menu bar.

00:01:53.700 --> 00:01:56.300
And the goal of this exercise,
at the end, is to be able to

00:01:56.300 --> 00:02:00.760
have your own menu logic
associated in this bar.

00:02:00.760 --> 00:02:02.110
So we're going to go in here.

00:02:02.110 --> 00:02:04.370
And for this demo, we're
going to manually

00:02:04.370 --> 00:02:06.860
run the onOpen function.

00:02:06.860 --> 00:02:10.330
So it's going to run this.

00:02:10.330 --> 00:02:13.770
And let's go ahead, and
I'll actually reload.

00:02:13.770 --> 00:02:14.800
There it is.

00:02:14.800 --> 00:02:16.770
And I'll reload this
page real quick.

00:02:19.700 --> 00:02:22.160
And the onOpen should run.

00:02:22.160 --> 00:02:24.890
So it gives a special meaning
to that function.

00:02:24.890 --> 00:02:26.190
And there it is.

00:02:26.190 --> 00:02:29.520
Now when I go ahead and
say, Say Hi, it's

00:02:29.520 --> 00:02:30.630
going to run the function.

00:02:30.630 --> 00:02:32.840
And all it's doing at this point
is showing a dialogue

00:02:32.840 --> 00:02:34.260
saying, Hi.

00:02:34.260 --> 00:02:38.710
As you can imagine, the
other one says, Hello.

00:02:38.710 --> 00:02:42.080
Not very creative, but gets you
the setup necessary to add

00:02:42.080 --> 00:02:43.420
your own custom menus.

00:02:43.420 --> 00:02:44.940
Now, let's go take a look
at the code real quick.

00:02:47.530 --> 00:02:50.590
And you saw that the onOpen
had special meaning.

00:02:50.590 --> 00:02:52.700
And when I refresh the
spreadsheet, I didn't have to

00:02:52.700 --> 00:02:54.040
run anything manually.

00:02:54.040 --> 00:02:57.360
It just ran by itself after a
few seconds after it checked

00:02:57.360 --> 00:02:59.470
for the existence
of the script.

00:02:59.470 --> 00:03:04.670
And what it is is essentially a
set of objects in an array.

00:03:04.670 --> 00:03:07.680
So this right here is
a JavaScript object.

00:03:07.680 --> 00:03:08.480
It's a map.

00:03:08.480 --> 00:03:10.150
It's got a name and a value.

00:03:10.150 --> 00:03:12.750
The value is the important
part here.

00:03:12.750 --> 00:03:16.420
This is the literal name of
the function without any

00:03:16.420 --> 00:03:17.120
parameters.

00:03:17.120 --> 00:03:20.410
So you don't have to put the
open-close parentheses there.

00:03:20.410 --> 00:03:21.420
That's very important.

00:03:21.420 --> 00:03:24.350
I've seen a few people
make that mistake.

00:03:24.350 --> 00:03:26.200
And the capitalization
is also important--

00:03:26.200 --> 00:03:28.010
functionName.

00:03:28.010 --> 00:03:28.820
And that's really it.

00:03:28.820 --> 00:03:31.170
And you can add any number
of menus you want.

00:03:31.170 --> 00:03:32.740
In this example, like
I said, all we're

00:03:32.740 --> 00:03:34.430
doing is show a dialogue.

00:03:34.430 --> 00:03:37.920
But you could have your own
custom calculation, your other

00:03:37.920 --> 00:03:41.380
business processes or workflows
that you can have in

00:03:41.380 --> 00:03:41.870
JavaScript.

00:03:41.870 --> 00:03:43.970
All could be injected in here.

00:03:43.970 --> 00:03:47.090
As a simple addition to
something that you can do

00:03:47.090 --> 00:03:49.790
that's beyond what's in the
tutorial, one of the things

00:03:49.790 --> 00:03:51.730
that you can do actually-- and
you may see this in other

00:03:51.730 --> 00:03:52.820
menus that we have--

00:03:52.820 --> 00:03:56.100
is that we have this concept
of a separator in a few of

00:03:56.100 --> 00:03:58.770
these tutorials, in a few of
these menus, I should say.

00:03:58.770 --> 00:04:04.570
So as a little pro tip, I
can just inject null.

00:04:04.570 --> 00:04:10.180
And now when I run this method,
I go in here, and

00:04:10.180 --> 00:04:13.360
there's the separator between
the two menu options.

00:04:13.360 --> 00:04:15.840
So that's a little nice thing
that you can do to really lay

00:04:15.840 --> 00:04:17.579
out your menus the
way you want to.

00:04:17.579 --> 00:04:19.589
And you can have multiple
menus as well.

00:04:19.589 --> 00:04:23.000
So this ss.addMenu, you can have
multiple calls of this.

00:04:23.000 --> 00:04:25.290
And it'll just stack left
to right in the

00:04:25.290 --> 00:04:26.385
order you call it.

00:04:26.385 --> 00:04:28.480
So I hope you found
this useful.

00:04:28.480 --> 00:04:31.040
Take this tutorial and start
building your own complex

00:04:31.040 --> 00:04:33.300
business processes and
interesting things that you

00:04:33.300 --> 00:04:35.410
can do with your workflow,
with your spreadsheets.

00:04:35.410 --> 00:04:36.660
Thank you.

