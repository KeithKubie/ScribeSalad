WEBVTT
Kind: captions
Language: en

00:00:00.000 --> 00:00:02.419
 
in this video we'll see how to compute

00:00:02.419 --> 00:00:02.429
in this video we'll see how to compute
 

00:00:02.429 --> 00:00:04.999
in this video we'll see how to compute
the pairwise lock factor parameter

00:00:04.999 --> 00:00:05.009
the pairwise lock factor parameter
 

00:00:05.009 --> 00:00:09.700
the pairwise lock factor parameter
gradients so we've seen before how to

00:00:09.700 --> 00:00:09.710
gradients so we've seen before how to
 

00:00:09.710 --> 00:00:12.080
gradients so we've seen before how to
what last function we would use for

00:00:12.080 --> 00:00:12.090
what last function we would use for
 

00:00:12.090 --> 00:00:14.270
what last function we would use for
training conditional random field and we

00:00:14.270 --> 00:00:14.280
training conditional random field and we
 

00:00:14.280 --> 00:00:16.550
training conditional random field and we
also partly saw how to compute the

00:00:16.550 --> 00:00:16.560
also partly saw how to compute the
 

00:00:16.560 --> 00:00:18.109
also partly saw how to compute the
parameter gradients of the last function

00:00:18.109 --> 00:00:18.119
parameter gradients of the last function
 

00:00:18.119 --> 00:00:21.080
parameter gradients of the last function
we've seen how to compute parameter

00:00:21.080 --> 00:00:21.090
we've seen how to compute parameter
 

00:00:21.090 --> 00:00:23.320
we've seen how to compute parameter
gradients for dollar involved in the log

00:00:23.320 --> 00:00:23.330
gradients for dollar involved in the log
 

00:00:23.330 --> 00:00:26.179
gradients for dollar involved in the log
factors the unary log factors and I will

00:00:26.179 --> 00:00:26.189
factors the unary log factors and I will
 

00:00:26.189 --> 00:00:30.890
factors the unary log factors and I will
see for the pairwise log factors so with

00:00:30.890 --> 00:00:30.900
see for the pairwise log factors so with
 

00:00:30.900 --> 00:00:32.930
see for the pairwise log factors so with
a derivation similar to what we've seen

00:00:32.930 --> 00:00:32.940
a derivation similar to what we've seen
 

00:00:32.940 --> 00:00:35.720
a derivation similar to what we've seen
in the previous video we can show that

00:00:35.720 --> 00:00:35.730
in the previous video we can show that
 

00:00:35.730 --> 00:00:37.850
in the previous video we can show that
the partial derivative of the negative

00:00:37.850 --> 00:00:37.860
the partial derivative of the negative
 

00:00:37.860 --> 00:00:40.580
the partial derivative of the negative
log problem

00:00:40.580 --> 00:00:40.590
 
 

00:00:40.590 --> 00:00:43.540
 
with respect to the pairwise factor

00:00:43.540 --> 00:00:43.550
with respect to the pairwise factor
 

00:00:43.550 --> 00:00:48.440
with respect to the pairwise factor
position K for observing Y the value of

00:00:48.440 --> 00:00:48.450
position K for observing Y the value of
 

00:00:48.450 --> 00:00:51.470
position K for observing Y the value of
the label y prime K followed by a value

00:00:51.470 --> 00:00:51.480
the label y prime K followed by a value
 

00:00:51.480 --> 00:00:54.069
the label y prime K followed by a value
of the label y prime K plus 1 is

00:00:54.069 --> 00:00:54.079
of the label y prime K plus 1 is
 

00:00:54.079 --> 00:00:58.760
of the label y prime K plus 1 is
actually equal to minus whether the KF

00:00:58.760 --> 00:00:58.770
actually equal to minus whether the KF
 

00:00:58.770 --> 00:01:02.029
actually equal to minus whether the KF
label in sequence Y is equal to Y prime

00:01:02.029 --> 00:01:02.039
label in sequence Y is equal to Y prime
 

00:01:02.039 --> 00:01:04.910
label in sequence Y is equal to Y prime
K and the k plus 1 yet label is equal to

00:01:04.910 --> 00:01:04.920
K and the k plus 1 yet label is equal to
 

00:01:04.920 --> 00:01:08.140
K and the k plus 1 yet label is equal to
BI prime K plus 1 minus the probability

00:01:08.140 --> 00:01:08.150
BI prime K plus 1 minus the probability
 

00:01:08.150 --> 00:01:10.429
BI prime K plus 1 minus the probability
according to the model that the Kiat

00:01:10.429 --> 00:01:10.439
according to the model that the Kiat
 

00:01:10.439 --> 00:01:13.250
according to the model that the Kiat
label would be Y prime K and the k plus

00:01:13.250 --> 00:01:13.260
label would be Y prime K and the k plus
 

00:01:13.260 --> 00:01:16.039
label would be Y prime K and the k plus
1 year label would be Y prime K plus 1

00:01:16.039 --> 00:01:16.049
1 year label would be Y prime K plus 1
 

00:01:16.049 --> 00:01:18.260
1 year label would be Y prime K plus 1
so we see it actually has a form which

00:01:18.260 --> 00:01:18.270
so we see it actually has a form which
 

00:01:18.270 --> 00:01:21.800
so we see it actually has a form which
is quite similar to the previous

00:01:21.800 --> 00:01:21.810
is quite similar to the previous
 

00:01:21.810 --> 00:01:26.679
is quite similar to the previous
gradient for the unary log factor

00:01:26.679 --> 00:01:26.689
gradient for the unary log factor
 

00:01:26.689 --> 00:01:31.460
gradient for the unary log factor
partial derivatives again it's what is

00:01:31.460 --> 00:01:31.470
partial derivatives again it's what is
 

00:01:31.470 --> 00:01:33.560
partial derivatives again it's what is
observed in the data - what the model

00:01:33.560 --> 00:01:33.570
observed in the data - what the model
 

00:01:33.570 --> 00:01:37.249
observed in the data - what the model
thinks and also the now the partial

00:01:37.249 --> 00:01:37.259
thinks and also the now the partial
 

00:01:37.259 --> 00:01:38.390
thinks and also the now the partial
derivatives with respect to the

00:01:38.390 --> 00:01:38.400
derivatives with respect to the
 

00:01:38.400 --> 00:01:40.730
derivatives with respect to the
parameters of the pairwise log factor is

00:01:40.730 --> 00:01:40.740
parameters of the pairwise log factor is
 

00:01:40.740 --> 00:01:43.940
parameters of the pairwise log factor is
quite simple because we're modeling

00:01:43.940 --> 00:01:43.950
quite simple because we're modeling
 

00:01:43.950 --> 00:01:48.230
quite simple because we're modeling
directly the pairwise log the pairwise

00:01:48.230 --> 00:01:48.240
directly the pairwise log the pairwise
 

00:01:48.240 --> 00:01:52.520
directly the pairwise log the pairwise
log factors with the matrix V then so in

00:01:52.520 --> 00:01:52.530
log factors with the matrix V then so in
 

00:01:52.530 --> 00:01:56.539
log factors with the matrix V then so in
other words the remove the ink here but

00:01:56.539 --> 00:01:56.549
other words the remove the ink here but
 

00:01:56.549 --> 00:02:00.109
other words the remove the ink here but
the pairwise factor value for y prime K

00:02:00.109 --> 00:02:00.119
the pairwise factor value for y prime K
 

00:02:00.119 --> 00:02:03.740
the pairwise factor value for y prime K
Y K Y prime K plus 1 is simply the

00:02:03.740 --> 00:02:03.750
Y K Y prime K plus 1 is simply the
 

00:02:03.750 --> 00:02:06.920
Y K Y prime K plus 1 is simply the
element that's row y prime k and column

00:02:06.920 --> 00:02:06.930
element that's row y prime k and column
 

00:02:06.930 --> 00:02:10.040
element that's row y prime k and column
Y prime K plus 1 in the matrix V well

00:02:10.040 --> 00:02:10.050
Y prime K plus 1 in the matrix V well
 

00:02:10.050 --> 00:02:11.900
Y prime K plus 1 in the matrix V well
because of that the partial derivatives

00:02:11.900 --> 00:02:11.910
because of that the partial derivatives
 

00:02:11.910 --> 00:02:13.850
because of that the partial derivatives
for that entry in the matrix

00:02:13.850 --> 00:02:13.860
for that entry in the matrix
 

00:02:13.860 --> 00:02:17.840
for that entry in the matrix
is the similar term that we saw here but

00:02:17.840 --> 00:02:17.850
is the similar term that we saw here but
 

00:02:17.850 --> 00:02:20.750
is the similar term that we saw here but
now we have to sum it over all position

00:02:20.750 --> 00:02:20.760
now we have to sum it over all position
 

00:02:20.760 --> 00:02:23.720
now we have to sum it over all position
K because this matrix is used for all

00:02:23.720 --> 00:02:23.730
K because this matrix is used for all
 

00:02:23.730 --> 00:02:27.740
K because this matrix is used for all
positions k for essentially for all the

00:02:27.740 --> 00:02:27.750
positions k for essentially for all the
 

00:02:27.750 --> 00:02:30.460
positions k for essentially for all the
pairwise log factor across the sequence

00:02:30.460 --> 00:02:30.470
pairwise log factor across the sequence
 

00:02:30.470 --> 00:02:33.200
pairwise log factor across the sequence
and now we can write it also in vector

00:02:33.200 --> 00:02:33.210
and now we can write it also in vector
 

00:02:33.210 --> 00:02:36.470
and now we can write it also in vector
form so get the gradient by so the

00:02:36.470 --> 00:02:36.480
form so get the gradient by so the
 

00:02:36.480 --> 00:02:38.630
form so get the gradient by so the
gradient of the loss with respect to the

00:02:38.630 --> 00:02:38.640
gradient of the loss with respect to the
 

00:02:38.640 --> 00:02:42.740
gradient of the loss with respect to the
full matrix P and we can show that it

00:02:42.740 --> 00:02:42.750
full matrix P and we can show that it
 

00:02:42.750 --> 00:02:46.610
full matrix P and we can show that it
corresponds to this sum of - the one on

00:02:46.610 --> 00:02:46.620
corresponds to this sum of - the one on
 

00:02:46.620 --> 00:02:50.510
corresponds to this sum of - the one on
vector with a 1 at position Y K times

00:02:50.510 --> 00:02:50.520
vector with a 1 at position Y K times
 

00:02:50.520 --> 00:02:52.790
vector with a 1 at position Y K times
the transpose at the one effector with a

00:02:52.790 --> 00:02:52.800
the transpose at the one effector with a
 

00:02:52.800 --> 00:02:57.020
the transpose at the one effector with a
1 at position YK plus 1 - the matrix

00:02:57.020 --> 00:02:57.030
1 at position YK plus 1 - the matrix
 

00:02:57.030 --> 00:03:00.800
1 at position YK plus 1 - the matrix
that contains all the pairwise marginal

00:03:00.800 --> 00:03:00.810
that contains all the pairwise marginal
 

00:03:00.810 --> 00:03:02.180
that contains all the pairwise marginal
probabilities that is all the

00:03:02.180 --> 00:03:02.190
probabilities that is all the
 

00:03:02.190 --> 00:03:05.540
probabilities that is all the
probabilities of decay at label being YK

00:03:05.540 --> 00:03:05.550
probabilities of decay at label being YK
 

00:03:05.550 --> 00:03:08.510
probabilities of decay at label being YK
and they keep plus 1 yes label being YK

00:03:08.510 --> 00:03:08.520
and they keep plus 1 yes label being YK
 

00:03:08.520 --> 00:03:11.840
and they keep plus 1 yes label being YK
plus 1 so this essentially this matrix

00:03:11.840 --> 00:03:11.850
plus 1 so this essentially this matrix
 

00:03:11.850 --> 00:03:14.630
plus 1 so this essentially this matrix
would contain all of these probabilities

00:03:14.630 --> 00:03:14.640
would contain all of these probabilities
 

00:03:14.640 --> 00:03:21.190
would contain all of these probabilities
here for a position k and k plus 1 and

00:03:21.190 --> 00:03:21.200
here for a position k and k plus 1 and
 

00:03:21.200 --> 00:03:24.320
here for a position k and k plus 1 and
another way of writing this is to

00:03:24.320 --> 00:03:24.330
another way of writing this is to
 

00:03:24.330 --> 00:03:27.830
another way of writing this is to
perform the sum here over these terms so

00:03:27.830 --> 00:03:27.840
perform the sum here over these terms so
 

00:03:27.840 --> 00:03:29.840
perform the sum here over these terms so
this root the sum here so I have the sum

00:03:29.840 --> 00:03:29.850
this root the sum here so I have the sum
 

00:03:29.850 --> 00:03:32.720
this root the sum here so I have the sum
over the pairwise matrix and then I can

00:03:32.720 --> 00:03:32.730
over the pairwise matrix and then I can
 

00:03:32.730 --> 00:03:36.620
over the pairwise matrix and then I can
just write this here as just a frequency

00:03:36.620 --> 00:03:36.630
just write this here as just a frequency
 

00:03:36.630 --> 00:03:40.280
just write this here as just a frequency
of observing a given label followed by

00:03:40.280 --> 00:03:40.290
of observing a given label followed by
 

00:03:40.290 --> 00:03:42.590
of observing a given label followed by
another given label so I'm writing it

00:03:42.590 --> 00:03:42.600
another given label so I'm writing it
 

00:03:42.600 --> 00:03:45.259
another given label so I'm writing it
I'm noting this down as frequents frac

00:03:45.259 --> 00:03:45.269
I'm noting this down as frequents frac
 

00:03:45.269 --> 00:03:48.650
I'm noting this down as frequents frac
YK YK plus 1 you know I could have

00:03:48.650 --> 00:03:48.660
YK YK plus 1 you know I could have
 

00:03:48.660 --> 00:03:52.580
YK YK plus 1 you know I could have
written just you know Y and say Y prime

00:03:52.580 --> 00:03:52.590
written just you know Y and say Y prime
 

00:03:52.590 --> 00:03:54.830
written just you know Y and say Y prime
the K is not important it's just the

00:03:54.830 --> 00:03:54.840
the K is not important it's just the
 

00:03:54.840 --> 00:03:56.810
the K is not important it's just the
number of times that a given label of Y

00:03:56.810 --> 00:03:56.820
number of times that a given label of Y
 

00:03:56.820 --> 00:03:59.720
number of times that a given label of Y
was followed by another label Y prime in

00:03:59.720 --> 00:03:59.730
was followed by another label Y prime in
 

00:03:59.730 --> 00:04:01.610
was followed by another label Y prime in
the sequence and I have the full matrix

00:04:01.610 --> 00:04:01.620
the sequence and I have the full matrix
 

00:04:01.620 --> 00:04:03.650
the sequence and I have the full matrix
that contains all of these pairwise

00:04:03.650 --> 00:04:03.660
that contains all of these pairwise
 

00:04:03.660 --> 00:04:06.140
that contains all of these pairwise
label frequencies so that's just another

00:04:06.140 --> 00:04:06.150
label frequencies so that's just another
 

00:04:06.150 --> 00:04:07.880
label frequencies so that's just another
way of writing down the expression for

00:04:07.880 --> 00:04:07.890
way of writing down the expression for
 

00:04:07.890 --> 00:04:14.180
way of writing down the expression for
the gradient which respectively so

00:04:14.180 --> 00:04:14.190
the gradient which respectively so
 

00:04:14.190 --> 00:04:15.860
the gradient which respectively so
that's pretty much all for the parameter

00:04:15.860 --> 00:04:15.870
that's pretty much all for the parameter
 

00:04:15.870 --> 00:04:18.069
that's pretty much all for the parameter
gradients a quick word on regularization

00:04:18.069 --> 00:04:18.079
gradients a quick word on regularization
 

00:04:18.079 --> 00:04:21.560
gradients a quick word on regularization
we can use the same regularizer as we

00:04:21.560 --> 00:04:21.570
we can use the same regularizer as we
 

00:04:21.570 --> 00:04:23.890
we can use the same regularizer as we
use in the non sequential neural network

00:04:23.890 --> 00:04:23.900
use in the non sequential neural network
 

00:04:23.900 --> 00:04:26.129
use in the non sequential neural network
and

00:04:26.129 --> 00:04:26.139
and
 

00:04:26.139 --> 00:04:28.080
and
normally we have a regular izing term

00:04:28.080 --> 00:04:28.090
normally we have a regular izing term
 

00:04:28.090 --> 00:04:30.209
normally we have a regular izing term
for the connection matrices the matrix

00:04:30.209 --> 00:04:30.219
for the connection matrices the matrix
 

00:04:30.219 --> 00:04:32.339
for the connection matrices the matrix
fee but we still don't recognize the

00:04:32.339 --> 00:04:32.349
fee but we still don't recognize the
 

00:04:32.349 --> 00:04:36.029
fee but we still don't recognize the
biases in the neural network we could

00:04:36.029 --> 00:04:36.039
biases in the neural network we could
 

00:04:36.039 --> 00:04:37.739
biases in the neural network we could
decide to scale the amount of

00:04:37.739 --> 00:04:37.749
decide to scale the amount of
 

00:04:37.749 --> 00:04:42.450
decide to scale the amount of
regularization by the sequence size so

00:04:42.450 --> 00:04:42.460
regularization by the sequence size so
 

00:04:42.460 --> 00:04:47.300
regularization by the sequence size so
if we thought that large sequences don't

00:04:47.300 --> 00:04:47.310
if we thought that large sequences don't
 

00:04:47.310 --> 00:04:50.939
if we thought that large sequences don't
necessarily have more information about

00:04:50.939 --> 00:04:50.949
necessarily have more information about
 

00:04:50.949 --> 00:04:52.830
necessarily have more information about
the right parameter should be them

00:04:52.830 --> 00:04:52.840
the right parameter should be them
 

00:04:52.840 --> 00:04:55.499
the right parameter should be them
shorter sequences then that would allow

00:04:55.499 --> 00:04:55.509
shorter sequences then that would allow
 

00:04:55.509 --> 00:04:58.320
shorter sequences then that would allow
us for instance to penalize so

00:04:58.320 --> 00:04:58.330
us for instance to penalize so
 

00:04:58.330 --> 00:05:00.240
us for instance to penalize so
regularize more on longer sequences and

00:05:00.240 --> 00:05:00.250
regularize more on longer sequences and
 

00:05:00.250 --> 00:05:02.610
regularize more on longer sequences and
less on smaller sequences so you know

00:05:02.610 --> 00:05:02.620
less on smaller sequences so you know
 

00:05:02.620 --> 00:05:04.800
less on smaller sequences so you know
that's a variant that you might see in

00:05:04.800 --> 00:05:04.810
that's a variant that you might see in
 

00:05:04.810 --> 00:05:08.550
that's a variant that you might see in
the literature that people might try to

00:05:08.550 --> 00:05:08.560
the literature that people might try to
 

00:05:08.560 --> 00:05:12.510
the literature that people might try to
adapt for some given problem but

00:05:12.510 --> 00:05:12.520
adapt for some given problem but
 

00:05:12.520 --> 00:05:15.089
adapt for some given problem but
otherwise the regularization gradients

00:05:15.089 --> 00:05:15.099
otherwise the regularization gradients
 

00:05:15.099 --> 00:05:16.950
otherwise the regularization gradients
are are essentially the same as we've

00:05:16.950 --> 00:05:16.960
are are essentially the same as we've
 

00:05:16.960 --> 00:05:19.550
are are essentially the same as we've
seen before and so now with the loss and

00:05:19.550 --> 00:05:19.560
seen before and so now with the loss and
 

00:05:19.560 --> 00:05:22.079
seen before and so now with the loss and
the regularization gradients and the

00:05:22.079 --> 00:05:22.089
the regularization gradients and the
 

00:05:22.089 --> 00:05:24.480
the regularization gradients and the
parameter gradients we have all the

00:05:24.480 --> 00:05:24.490
parameter gradients we have all the
 

00:05:24.490 --> 00:05:26.279
parameter gradients we have all the
greens we need to apply a stochastic

00:05:26.279 --> 00:05:26.289
greens we need to apply a stochastic
 

00:05:26.289 --> 00:05:28.950
greens we need to apply a stochastic
gradient descent and I haven't mentioned

00:05:28.950 --> 00:05:28.960
gradient descent and I haven't mentioned
 

00:05:28.960 --> 00:05:30.600
gradient descent and I haven't mentioned
the initialization but we use exactly

00:05:30.600 --> 00:05:30.610
the initialization but we use exactly
 

00:05:30.610 --> 00:05:33.629
the initialization but we use exactly
the same as we've used in the non

00:05:33.629 --> 00:05:33.639
the same as we've used in the non
 

00:05:33.639 --> 00:05:36.360
the same as we've used in the non
sequential neural networks and also

00:05:36.360 --> 00:05:36.370
sequential neural networks and also
 

00:05:36.370 --> 00:05:37.619
sequential neural networks and also
perhaps I should say that for

00:05:37.619 --> 00:05:37.629
perhaps I should say that for
 

00:05:37.629 --> 00:05:39.749
perhaps I should say that for
initialization for the matrix V it's

00:05:39.749 --> 00:05:39.759
initialization for the matrix V it's
 

00:05:39.759 --> 00:05:43.050
initialization for the matrix V it's
fine to initialize it to zero so that

00:05:43.050 --> 00:05:43.060
fine to initialize it to zero so that
 

00:05:43.060 --> 00:05:45.450
fine to initialize it to zero so that
pretty much gives us all the pieces we

00:05:45.450 --> 00:05:45.460
pretty much gives us all the pieces we
 

00:05:45.460 --> 00:05:46.980
pretty much gives us all the pieces we
need to apply stochastic gradient

00:05:46.980 --> 00:05:46.990
need to apply stochastic gradient
 

00:05:46.990 --> 00:05:48.869
need to apply stochastic gradient
descent training for conditional random

00:05:48.869 --> 00:05:48.879
descent training for conditional random
 

00:05:48.879 --> 00:05:53.939
descent training for conditional random
fields and that's it

