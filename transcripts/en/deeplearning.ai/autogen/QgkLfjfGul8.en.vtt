WEBVTT
Kind: captions
Language: en

00:00:00.030 --> 00:00:02.270
in the last video you saw how to define

00:00:02.270 --> 00:00:02.280
in the last video you saw how to define
 

00:00:02.280 --> 00:00:04.610
in the last video you saw how to define
the content cost function for neuro

00:00:04.610 --> 00:00:04.620
the content cost function for neuro
 

00:00:04.620 --> 00:00:07.160
the content cost function for neuro
style transfer mix let's take a look at

00:00:07.160 --> 00:00:07.170
style transfer mix let's take a look at
 

00:00:07.170 --> 00:00:10.190
style transfer mix let's take a look at
the style cost function so what is the

00:00:10.190 --> 00:00:10.200
the style cost function so what is the
 

00:00:10.200 --> 00:00:12.919
the style cost function so what is the
style of an image mean let's say you

00:00:12.919 --> 00:00:12.929
style of an image mean let's say you
 

00:00:12.929 --> 00:00:14.870
style of an image mean let's say you
have an input image like this you're

00:00:14.870 --> 00:00:14.880
have an input image like this you're
 

00:00:14.880 --> 00:00:16.580
have an input image like this you're
used to seeing a confident like that

00:00:16.580 --> 00:00:16.590
used to seeing a confident like that
 

00:00:16.590 --> 00:00:18.769
used to seeing a confident like that
compute features that there is different

00:00:18.769 --> 00:00:18.779
compute features that there is different
 

00:00:18.779 --> 00:00:20.900
compute features that there is different
hidden layers and let's say you've

00:00:20.900 --> 00:00:20.910
hidden layers and let's say you've
 

00:00:20.910 --> 00:00:24.050
hidden layers and let's say you've
chosen some layer L maybe that layer to

00:00:24.050 --> 00:00:24.060
chosen some layer L maybe that layer to
 

00:00:24.060 --> 00:00:27.830
chosen some layer L maybe that layer to
define the measure of the style of an

00:00:27.830 --> 00:00:27.840
define the measure of the style of an
 

00:00:27.840 --> 00:00:30.650
define the measure of the style of an
image what we're going to do is define

00:00:30.650 --> 00:00:30.660
image what we're going to do is define
 

00:00:30.660 --> 00:00:33.790
image what we're going to do is define
the style as the correlation between

00:00:33.790 --> 00:00:33.800
the style as the correlation between
 

00:00:33.800 --> 00:00:37.310
the style as the correlation between
activations across different channels in

00:00:37.310 --> 00:00:37.320
activations across different channels in
 

00:00:37.320 --> 00:00:41.420
activations across different channels in
this layer L activation so here's what I

00:00:41.420 --> 00:00:41.430
this layer L activation so here's what I
 

00:00:41.430 --> 00:00:43.220
this layer L activation so here's what I
mean by that let's say you take that

00:00:43.220 --> 00:00:43.230
mean by that let's say you take that
 

00:00:43.230 --> 00:00:45.290
mean by that let's say you take that
layer L activations so this is going to

00:00:45.290 --> 00:00:45.300
layer L activations so this is going to
 

00:00:45.300 --> 00:00:49.400
layer L activations so this is going to
be a niche by NW by NC block of

00:00:49.400 --> 00:00:49.410
be a niche by NW by NC block of
 

00:00:49.410 --> 00:00:52.160
be a niche by NW by NC block of
activations and we're going to ask how

00:00:52.160 --> 00:00:52.170
activations and we're going to ask how
 

00:00:52.170 --> 00:00:54.350
activations and we're going to ask how
correlated are the activations across

00:00:54.350 --> 00:00:54.360
correlated are the activations across
 

00:00:54.360 --> 00:00:57.110
correlated are the activations across
different channels so to explain what I

00:00:57.110 --> 00:00:57.120
different channels so to explain what I
 

00:00:57.120 --> 00:00:59.090
different channels so to explain what I
mean by this may be slightly cryptic

00:00:59.090 --> 00:00:59.100
mean by this may be slightly cryptic
 

00:00:59.100 --> 00:01:01.970
mean by this may be slightly cryptic
phrase let's take this block of

00:01:01.970 --> 00:01:01.980
phrase let's take this block of
 

00:01:01.980 --> 00:01:04.160
phrase let's take this block of
activations and let me shade the

00:01:04.160 --> 00:01:04.170
activations and let me shade the
 

00:01:04.170 --> 00:01:05.660
activations and let me shade the
different channels there are different

00:01:05.660 --> 00:01:05.670
different channels there are different
 

00:01:05.670 --> 00:01:08.840
different channels there are different
colors so in this lower example we have

00:01:08.840 --> 00:01:08.850
colors so in this lower example we have
 

00:01:08.850 --> 00:01:12.230
colors so in this lower example we have
say five channels and which is why I

00:01:12.230 --> 00:01:12.240
say five channels and which is why I
 

00:01:12.240 --> 00:01:14.210
say five channels and which is why I
have five shades of color here in

00:01:14.210 --> 00:01:14.220
have five shades of color here in
 

00:01:14.220 --> 00:01:16.219
have five shades of color here in
practice of course in your network we

00:01:16.219 --> 00:01:16.229
practice of course in your network we
 

00:01:16.229 --> 00:01:17.990
practice of course in your network we
usually have a lot more channels than

00:01:17.990 --> 00:01:18.000
usually have a lot more channels than
 

00:01:18.000 --> 00:01:20.359
usually have a lot more channels than
five but using just five makes the

00:01:20.359 --> 00:01:20.369
five but using just five makes the
 

00:01:20.369 --> 00:01:23.840
five but using just five makes the
drawing easier but to capture the style

00:01:23.840 --> 00:01:23.850
drawing easier but to capture the style
 

00:01:23.850 --> 00:01:25.940
drawing easier but to capture the style
of an image what you're gonna do is the

00:01:25.940 --> 00:01:25.950
of an image what you're gonna do is the
 

00:01:25.950 --> 00:01:28.219
of an image what you're gonna do is the
following let's look at the first two

00:01:28.219 --> 00:01:28.229
following let's look at the first two
 

00:01:28.229 --> 00:01:30.020
following let's look at the first two
channels let's look at the red Channel

00:01:30.020 --> 00:01:30.030
channels let's look at the red Channel
 

00:01:30.030 --> 00:01:33.289
channels let's look at the red Channel
and the yellow Channel and say how

00:01:33.289 --> 00:01:33.299
and the yellow Channel and say how
 

00:01:33.299 --> 00:01:36.289
and the yellow Channel and say how
correlated are activations in these

00:01:36.289 --> 00:01:36.299
correlated are activations in these
 

00:01:36.299 --> 00:01:39.319
correlated are activations in these
first two channels so for example in the

00:01:39.319 --> 00:01:39.329
first two channels so for example in the
 

00:01:39.329 --> 00:01:41.179
first two channels so for example in the
lower right hand corner you have some

00:01:41.179 --> 00:01:41.189
lower right hand corner you have some
 

00:01:41.189 --> 00:01:43.580
lower right hand corner you have some
activation in the first channel and some

00:01:43.580 --> 00:01:43.590
activation in the first channel and some
 

00:01:43.590 --> 00:01:45.590
activation in the first channel and some
activation in the second Channel

00:01:45.590 --> 00:01:45.600
activation in the second Channel
 

00:01:45.600 --> 00:01:47.569
activation in the second Channel
so that gives you a pair of numbers and

00:01:47.569 --> 00:01:47.579
so that gives you a pair of numbers and
 

00:01:47.579 --> 00:01:49.190
so that gives you a pair of numbers and
what you do is look at different

00:01:49.190 --> 00:01:49.200
what you do is look at different
 

00:01:49.200 --> 00:01:52.429
what you do is look at different
positions across this block live active

00:01:52.429 --> 00:01:52.439
positions across this block live active
 

00:01:52.439 --> 00:01:54.679
positions across this block live active
ations and just look at those two pairs

00:01:54.679 --> 00:01:54.689
ations and just look at those two pairs
 

00:01:54.689 --> 00:01:56.749
ations and just look at those two pairs
of numbers one in the first channel the

00:01:56.749 --> 00:01:56.759
of numbers one in the first channel the
 

00:01:56.759 --> 00:01:58.819
of numbers one in the first channel the
red channel one in the yellow channel

00:01:58.819 --> 00:01:58.829
red channel one in the yellow channel
 

00:01:58.829 --> 00:02:00.709
red channel one in the yellow channel
the second channel and you just look at

00:02:00.709 --> 00:02:00.719
the second channel and you just look at
 

00:02:00.719 --> 00:02:02.899
the second channel and you just look at
these two pairs of numbers and see when

00:02:02.899 --> 00:02:02.909
these two pairs of numbers and see when
 

00:02:02.909 --> 00:02:04.639
these two pairs of numbers and see when
you look across all of these positions

00:02:04.639 --> 00:02:04.649
you look across all of these positions
 

00:02:04.649 --> 00:02:07.069
you look across all of these positions
all of these and H bar and W positions

00:02:07.069 --> 00:02:07.079
all of these and H bar and W positions
 

00:02:07.079 --> 00:02:10.400
all of these and H bar and W positions
how correlated are these two numbers so

00:02:10.400 --> 00:02:10.410
how correlated are these two numbers so
 

00:02:10.410 --> 00:02:12.570
how correlated are these two numbers so
why does this capture style

00:02:12.570 --> 00:02:12.580
why does this capture style
 

00:02:12.580 --> 00:02:15.150
why does this capture style
let's look at an example here's one of

00:02:15.150 --> 00:02:15.160
let's look at an example here's one of
 

00:02:15.160 --> 00:02:17.010
let's look at an example here's one of
the visualizations from the earlier

00:02:17.010 --> 00:02:17.020
the visualizations from the earlier
 

00:02:17.020 --> 00:02:20.220
the visualizations from the earlier
video this comes from again the paper by

00:02:20.220 --> 00:02:20.230
video this comes from again the paper by
 

00:02:20.230 --> 00:02:21.930
video this comes from again the paper by
Matthews either and brought ferger's

00:02:21.930 --> 00:02:21.940
Matthews either and brought ferger's
 

00:02:21.940 --> 00:02:24.090
Matthews either and brought ferger's
that had reference earlier and let's say

00:02:24.090 --> 00:02:24.100
that had reference earlier and let's say
 

00:02:24.100 --> 00:02:26.130
that had reference earlier and let's say
for the sake of arguments that the event

00:02:26.130 --> 00:02:26.140
for the sake of arguments that the event
 

00:02:26.140 --> 00:02:28.950
for the sake of arguments that the event
neuron corresponds to and let's say for

00:02:28.950 --> 00:02:28.960
neuron corresponds to and let's say for
 

00:02:28.960 --> 00:02:31.290
neuron corresponds to and let's say for
the sake of arguments that the red

00:02:31.290 --> 00:02:31.300
the sake of arguments that the red
 

00:02:31.300 --> 00:02:34.770
the sake of arguments that the red
channel corresponds to this neuron says

00:02:34.770 --> 00:02:34.780
channel corresponds to this neuron says
 

00:02:34.780 --> 00:02:37.290
channel corresponds to this neuron says
trying to figure out if does this in a

00:02:37.290 --> 00:02:37.300
trying to figure out if does this in a
 

00:02:37.300 --> 00:02:40.350
trying to figure out if does this in a
little vertical texture or in a

00:02:40.350 --> 00:02:40.360
little vertical texture or in a
 

00:02:40.360 --> 00:02:42.590
little vertical texture or in a
particular position in the image and

00:02:42.590 --> 00:02:42.600
particular position in the image and
 

00:02:42.600 --> 00:02:46.500
particular position in the image and
let's say that this second channel this

00:02:46.500 --> 00:02:46.510
let's say that this second channel this
 

00:02:46.510 --> 00:02:49.670
let's say that this second channel this
yellow second channel corresponds to

00:02:49.670 --> 00:02:49.680
yellow second channel corresponds to
 

00:02:49.680 --> 00:02:53.100
yellow second channel corresponds to
this neuron which is you know vaguely

00:02:53.100 --> 00:02:53.110
this neuron which is you know vaguely
 

00:02:53.110 --> 00:02:56.790
this neuron which is you know vaguely
looking for orange colored patches so

00:02:56.790 --> 00:02:56.800
looking for orange colored patches so
 

00:02:56.800 --> 00:02:58.470
looking for orange colored patches so
what does it mean for these two channels

00:02:58.470 --> 00:02:58.480
what does it mean for these two channels
 

00:02:58.480 --> 00:03:01.920
what does it mean for these two channels
to be highly correlated well if they're

00:03:01.920 --> 00:03:01.930
to be highly correlated well if they're
 

00:03:01.930 --> 00:03:03.660
to be highly correlated well if they're
highly correlated what that means is

00:03:03.660 --> 00:03:03.670
highly correlated what that means is
 

00:03:03.670 --> 00:03:06.030
highly correlated what that means is
whenever part of the image has this type

00:03:06.030 --> 00:03:06.040
whenever part of the image has this type
 

00:03:06.040 --> 00:03:08.940
whenever part of the image has this type
of a subtle vertical texture that part

00:03:08.940 --> 00:03:08.950
of a subtle vertical texture that part
 

00:03:08.950 --> 00:03:10.740
of a subtle vertical texture that part
of the image will probably have this

00:03:10.740 --> 00:03:10.750
of the image will probably have this
 

00:03:10.750 --> 00:03:14.010
of the image will probably have this
orange tint and what does it mean for

00:03:14.010 --> 00:03:14.020
orange tint and what does it mean for
 

00:03:14.020 --> 00:03:16.440
orange tint and what does it mean for
them to be uncorrelated well it means

00:03:16.440 --> 00:03:16.450
them to be uncorrelated well it means
 

00:03:16.450 --> 00:03:18.810
them to be uncorrelated well it means
that whenever there is this vertical

00:03:18.810 --> 00:03:18.820
that whenever there is this vertical
 

00:03:18.820 --> 00:03:20.790
that whenever there is this vertical
texture it's probably won't have that

00:03:20.790 --> 00:03:20.800
texture it's probably won't have that
 

00:03:20.800 --> 00:03:24.720
texture it's probably won't have that
orange tint and so the correlation tells

00:03:24.720 --> 00:03:24.730
orange tint and so the correlation tells
 

00:03:24.730 --> 00:03:27.479
orange tint and so the correlation tells
you which of these high level texture

00:03:27.479 --> 00:03:27.489
you which of these high level texture
 

00:03:27.489 --> 00:03:30.060
you which of these high level texture
components tend to occur or not occur

00:03:30.060 --> 00:03:30.070
components tend to occur or not occur
 

00:03:30.070 --> 00:03:33.030
components tend to occur or not occur
together in part of an image and it's

00:03:33.030 --> 00:03:33.040
together in part of an image and it's
 

00:03:33.040 --> 00:03:35.460
together in part of an image and it's
the degree of correlation that gives you

00:03:35.460 --> 00:03:35.470
the degree of correlation that gives you
 

00:03:35.470 --> 00:03:37.949
the degree of correlation that gives you
one way of measuring how often these

00:03:37.949 --> 00:03:37.959
one way of measuring how often these
 

00:03:37.959 --> 00:03:41.190
one way of measuring how often these
different high level features such as

00:03:41.190 --> 00:03:41.200
different high level features such as
 

00:03:41.200 --> 00:03:43.500
different high level features such as
vertical texture or this orange tint or

00:03:43.500 --> 00:03:43.510
vertical texture or this orange tint or
 

00:03:43.510 --> 00:03:46.380
vertical texture or this orange tint or
other things as well how often they

00:03:46.380 --> 00:03:46.390
other things as well how often they
 

00:03:46.390 --> 00:03:48.330
other things as well how often they
occur and how often they occur together

00:03:48.330 --> 00:03:48.340
occur and how often they occur together
 

00:03:48.340 --> 00:03:50.610
occur and how often they occur together
and don't occur together in different

00:03:50.610 --> 00:03:50.620
and don't occur together in different
 

00:03:50.620 --> 00:03:53.160
and don't occur together in different
parts of an image and so if we use the

00:03:53.160 --> 00:03:53.170
parts of an image and so if we use the
 

00:03:53.170 --> 00:03:54.930
parts of an image and so if we use the
degree of correlation between channels

00:03:54.930 --> 00:03:54.940
degree of correlation between channels
 

00:03:54.940 --> 00:03:57.720
degree of correlation between channels
as a measure of the style then what you

00:03:57.720 --> 00:03:57.730
as a measure of the style then what you
 

00:03:57.730 --> 00:04:00.780
as a measure of the style then what you
can do is measure the degree to which in

00:04:00.780 --> 00:04:00.790
can do is measure the degree to which in
 

00:04:00.790 --> 00:04:03.780
can do is measure the degree to which in
your generated image this first channel

00:04:03.780 --> 00:04:03.790
your generated image this first channel
 

00:04:03.790 --> 00:04:06.780
your generated image this first channel
is correlated or uncorrelated with the

00:04:06.780 --> 00:04:06.790
is correlated or uncorrelated with the
 

00:04:06.790 --> 00:04:09.600
is correlated or uncorrelated with the
second channel and that will tell you in

00:04:09.600 --> 00:04:09.610
second channel and that will tell you in
 

00:04:09.610 --> 00:04:12.660
second channel and that will tell you in
the generated image how often this type

00:04:12.660 --> 00:04:12.670
the generated image how often this type
 

00:04:12.670 --> 00:04:14.850
the generated image how often this type
of vertical texture occurs or doesn't

00:04:14.850 --> 00:04:14.860
of vertical texture occurs or doesn't
 

00:04:14.860 --> 00:04:17.490
of vertical texture occurs or doesn't
occur with this orange tint and this

00:04:17.490 --> 00:04:17.500
occur with this orange tint and this
 

00:04:17.500 --> 00:04:19.349
occur with this orange tint and this
gives you a measure of how similar is

00:04:19.349 --> 00:04:19.359
gives you a measure of how similar is
 

00:04:19.359 --> 00:04:22.170
gives you a measure of how similar is
the style of the generated image to the

00:04:22.170 --> 00:04:22.180
the style of the generated image to the
 

00:04:22.180 --> 00:04:25.110
the style of the generated image to the
style of the input style image

00:04:25.110 --> 00:04:25.120
style of the input style image
 

00:04:25.120 --> 00:04:28.430
style of the input style image
so let's now formalize this intuition

00:04:28.430 --> 00:04:28.440
so let's now formalize this intuition
 

00:04:28.440 --> 00:04:31.409
so let's now formalize this intuition
for each of the two images the star

00:04:31.409 --> 00:04:31.419
for each of the two images the star
 

00:04:31.419 --> 00:04:33.450
for each of the two images the star
image and the generated image you're

00:04:33.450 --> 00:04:33.460
image and the generated image you're
 

00:04:33.460 --> 00:04:37.320
image and the generated image you're
going to compute a style matrix so more

00:04:37.320 --> 00:04:37.330
going to compute a style matrix so more
 

00:04:37.330 --> 00:04:39.689
going to compute a style matrix so more
formally let's say that you're using

00:04:39.689 --> 00:04:39.699
formally let's say that you're using
 

00:04:39.699 --> 00:04:42.750
formally let's say that you're using
layer L to measure the style let's let

00:04:42.750 --> 00:04:42.760
layer L to measure the style let's let
 

00:04:42.760 --> 00:04:46.200
layer L to measure the style let's let
any subscript IJ K be the activation at

00:04:46.200 --> 00:04:46.210
any subscript IJ K be the activation at
 

00:04:46.210 --> 00:04:50.969
any subscript IJ K be the activation at
position ijk in that hidden layer L so

00:04:50.969 --> 00:04:50.979
position ijk in that hidden layer L so
 

00:04:50.979 --> 00:04:54.600
position ijk in that hidden layer L so
this indexes into the position height

00:04:54.600 --> 00:04:54.610
this indexes into the position height
 

00:04:54.610 --> 00:04:57.120
this indexes into the position height
width and this indexes into the

00:04:57.120 --> 00:04:57.130
width and this indexes into the
 

00:04:57.130 --> 00:05:00.060
width and this indexes into the
different channels so what you're going

00:05:00.060 --> 00:05:00.070
different channels so what you're going
 

00:05:00.070 --> 00:05:03.360
different channels so what you're going
to do is compute a style matrix for

00:05:03.360 --> 00:05:03.370
to do is compute a style matrix for
 

00:05:03.370 --> 00:05:08.760
to do is compute a style matrix for
layer L and for the style image and this

00:05:08.760 --> 00:05:08.770
layer L and for the style image and this
 

00:05:08.770 --> 00:05:13.140
layer L and for the style image and this
will be a NC by NC dimensional matrix

00:05:13.140 --> 00:05:13.150
will be a NC by NC dimensional matrix
 

00:05:13.150 --> 00:05:17.570
will be a NC by NC dimensional matrix
and you do the same thing for the

00:05:17.570 --> 00:05:17.580
and you do the same thing for the
 

00:05:17.580 --> 00:05:20.460
and you do the same thing for the
generated image as well but now let's

00:05:20.460 --> 00:05:20.470
generated image as well but now let's
 

00:05:20.470 --> 00:05:25.170
generated image as well but now let's
define this style image so ye define

00:05:25.170 --> 00:05:25.180
define this style image so ye define
 

00:05:25.180 --> 00:05:28.409
define this style image so ye define
using layer L and on the style image

00:05:28.409 --> 00:05:28.419
using layer L and on the style image
 

00:05:28.419 --> 00:05:32.330
using layer L and on the style image
it's going to be a matrix where the

00:05:32.330 --> 00:05:32.340
it's going to be a matrix where the
 

00:05:32.340 --> 00:05:35.340
it's going to be a matrix where the
height and width of this matrix is the

00:05:35.340 --> 00:05:35.350
height and width of this matrix is the
 

00:05:35.350 --> 00:05:37.260
height and width of this matrix is the
number of channels by number of channels

00:05:37.260 --> 00:05:37.270
number of channels by number of channels
 

00:05:37.270 --> 00:05:43.260
number of channels by number of channels
so in this matrix the k k prime element

00:05:43.260 --> 00:05:43.270
so in this matrix the k k prime element
 

00:05:43.270 --> 00:05:45.830
so in this matrix the k k prime element
is going to measure how correlated our

00:05:45.830 --> 00:05:45.840
is going to measure how correlated our
 

00:05:45.840 --> 00:05:49.350
is going to measure how correlated our
channels K and K Prime so more formally

00:05:49.350 --> 00:05:49.360
channels K and K Prime so more formally
 

00:05:49.360 --> 00:05:53.400
channels K and K Prime so more formally
let me define this as sum over I sum

00:05:53.400 --> 00:05:53.410
let me define this as sum over I sum
 

00:05:53.410 --> 00:06:00.360
let me define this as sum over I sum
over J of the activation at position I J

00:06:00.360 --> 00:06:00.370
over J of the activation at position I J
 

00:06:00.370 --> 00:06:06.360
over J of the activation at position I J
of channel K times the activation at the

00:06:06.360 --> 00:06:06.370
of channel K times the activation at the
 

00:06:06.370 --> 00:06:09.810
of channel K times the activation at the
same position I J for that channel K

00:06:09.810 --> 00:06:09.820
same position I J for that channel K
 

00:06:09.820 --> 00:06:11.969
same position I J for that channel K
Prime and just multiply these two things

00:06:11.969 --> 00:06:11.979
Prime and just multiply these two things
 

00:06:11.979 --> 00:06:16.469
Prime and just multiply these two things
together so I and J sum over the height

00:06:16.469 --> 00:06:16.479
together so I and J sum over the height
 

00:06:16.479 --> 00:06:22.920
together so I and J sum over the height
and width right at that layer L so you

00:06:22.920 --> 00:06:22.930
and width right at that layer L so you
 

00:06:22.930 --> 00:06:25.670
and width right at that layer L so you
summing over the different positions the

00:06:25.670 --> 00:06:25.680
summing over the different positions the
 

00:06:25.680 --> 00:06:28.260
summing over the different positions the
X&amp;Y positions who is finally height and

00:06:28.260 --> 00:06:28.270
X&amp;Y positions who is finally height and
 

00:06:28.270 --> 00:06:30.210
X&amp;Y positions who is finally height and
width and then just multiplying out the

00:06:30.210 --> 00:06:30.220
width and then just multiplying out the
 

00:06:30.220 --> 00:06:31.570
width and then just multiplying out the
activations

00:06:31.570 --> 00:06:31.580
activations
 

00:06:31.580 --> 00:06:36.640
activations
at channel K with channel K Prime and so

00:06:36.640 --> 00:06:36.650
at channel K with channel K Prime and so
 

00:06:36.650 --> 00:06:38.500
at channel K with channel K Prime and so
far I've been using the term correlation

00:06:38.500 --> 00:06:38.510
far I've been using the term correlation
 

00:06:38.510 --> 00:06:41.020
far I've been using the term correlation
technically this is the unnormalized

00:06:41.020 --> 00:06:41.030
technically this is the unnormalized
 

00:06:41.030 --> 00:06:43.630
technically this is the unnormalized
cross covariance because we're not

00:06:43.630 --> 00:06:43.640
cross covariance because we're not
 

00:06:43.640 --> 00:06:45.460
cross covariance because we're not
subtracting a mean and you're just

00:06:45.460 --> 00:06:45.470
subtracting a mean and you're just
 

00:06:45.470 --> 00:06:49.090
subtracting a mean and you're just
multiplying all these things so this is

00:06:49.090 --> 00:06:49.100
multiplying all these things so this is
 

00:06:49.100 --> 00:06:51.430
multiplying all these things so this is
going to be the style matrix for the

00:06:51.430 --> 00:06:51.440
going to be the style matrix for the
 

00:06:51.440 --> 00:06:54.820
going to be the style matrix for the
input style image s and then you do the

00:06:54.820 --> 00:06:54.830
input style image s and then you do the
 

00:06:54.830 --> 00:06:59.350
input style image s and then you do the
same thing for the generated image so

00:06:59.350 --> 00:06:59.360
same thing for the generated image so
 

00:06:59.360 --> 00:07:01.480
same thing for the generated image so
this is going to be really the same

00:07:01.480 --> 00:07:01.490
this is going to be really the same
 

00:07:01.490 --> 00:07:10.080
this is going to be really the same
thing sum from J equals 1 equals n WL of

00:07:10.080 --> 00:07:10.090
thing sum from J equals 1 equals n WL of
 

00:07:10.090 --> 00:07:11.740
thing sum from J equals 1 equals n WL of
the same thing

00:07:11.740 --> 00:07:11.750
the same thing
 

00:07:11.750 --> 00:07:26.470
the same thing
IJ K a subscript IJ a subscript IJ K

00:07:26.470 --> 00:07:26.480
IJ K a subscript IJ a subscript IJ K
 

00:07:26.480 --> 00:07:29.590
IJ K a subscript IJ a subscript IJ K
Prime now and if you want to distinguish

00:07:29.590 --> 00:07:29.600
Prime now and if you want to distinguish
 

00:07:29.600 --> 00:07:31.420
Prime now and if you want to distinguish
these activations I guess you could put

00:07:31.420 --> 00:07:31.430
these activations I guess you could put
 

00:07:31.430 --> 00:07:34.990
these activations I guess you could put
a superscript round bracket s and G just

00:07:34.990 --> 00:07:35.000
a superscript round bracket s and G just
 

00:07:35.000 --> 00:07:36.730
a superscript round bracket s and G just
to distinguish that these are the

00:07:36.730 --> 00:07:36.740
to distinguish that these are the
 

00:07:36.740 --> 00:07:39.760
to distinguish that these are the
activations on the sow images and on the

00:07:39.760 --> 00:07:39.770
activations on the sow images and on the
 

00:07:39.770 --> 00:07:44.530
activations on the sow images and on the
generator image G and we denote these

00:07:44.530 --> 00:07:44.540
generator image G and we denote these
 

00:07:44.540 --> 00:07:46.990
generator image G and we denote these
matrices using the capital alphabet G

00:07:46.990 --> 00:07:47.000
matrices using the capital alphabet G
 

00:07:47.000 --> 00:07:49.630
matrices using the capital alphabet G
because in linear algebra this is

00:07:49.630 --> 00:07:49.640
because in linear algebra this is
 

00:07:49.640 --> 00:07:53.880
because in linear algebra this is
sometimes also called the DRAM matrix

00:07:53.880 --> 00:07:53.890
sometimes also called the DRAM matrix
 

00:07:53.890 --> 00:07:56.380
sometimes also called the DRAM matrix
but I'm just gonna call this the style

00:07:56.380 --> 00:07:56.390
but I'm just gonna call this the style
 

00:07:56.390 --> 00:08:00.310
but I'm just gonna call this the style
matrix in this video oh sorry just pick

00:08:00.310 --> 00:08:00.320
matrix in this video oh sorry just pick
 

00:08:00.320 --> 00:08:02.830
matrix in this video oh sorry just pick
up KK prime there right so these are the

00:08:02.830 --> 00:08:02.840
up KK prime there right so these are the
 

00:08:02.840 --> 00:08:06.850
up KK prime there right so these are the
formulas for defining the KK prime

00:08:06.850 --> 00:08:06.860
formulas for defining the KK prime
 

00:08:06.860 --> 00:08:11.230
formulas for defining the KK prime
elements of this NC by NC square matrix

00:08:11.230 --> 00:08:11.240
elements of this NC by NC square matrix
 

00:08:11.240 --> 00:08:14.470
elements of this NC by NC square matrix
so what you're going to do is given an

00:08:14.470 --> 00:08:14.480
so what you're going to do is given an
 

00:08:14.480 --> 00:08:17.290
so what you're going to do is given an
image computes something called a style

00:08:17.290 --> 00:08:17.300
image computes something called a style
 

00:08:17.300 --> 00:08:19.570
image computes something called a style
matrix which will measure all those

00:08:19.570 --> 00:08:19.580
matrix which will measure all those
 

00:08:19.580 --> 00:08:21.550
matrix which will measure all those
correlations we talked about on the last

00:08:21.550 --> 00:08:21.560
correlations we talked about on the last
 

00:08:21.560 --> 00:08:24.810
correlations we talked about on the last
slide so more formally let's let a

00:08:24.810 --> 00:08:24.820
slide so more formally let's let a
 

00:08:24.820 --> 00:08:29.230
slide so more formally let's let a
superscript L subscript IJ K denote the

00:08:29.230 --> 00:08:29.240
superscript L subscript IJ K denote the
 

00:08:29.240 --> 00:08:32.800
superscript L subscript IJ K denote the
activation at position ijk in hidden

00:08:32.800 --> 00:08:32.810
activation at position ijk in hidden
 

00:08:32.810 --> 00:08:37.210
activation at position ijk in hidden
layer L so I indexes into the height J

00:08:37.210 --> 00:08:37.220
layer L so I indexes into the height J
 

00:08:37.220 --> 00:08:40.079
layer L so I indexes into the height J
indexes into the width and K index

00:08:40.079 --> 00:08:40.089
indexes into the width and K index
 

00:08:40.089 --> 00:08:42.569
indexes into the width and K index
across the different channels so in the

00:08:42.569 --> 00:08:42.579
across the different channels so in the
 

00:08:42.579 --> 00:08:45.809
across the different channels so in the
previous slide we had five channels but

00:08:45.809 --> 00:08:45.819
previous slide we had five channels but
 

00:08:45.819 --> 00:08:48.230
previous slide we had five channels but
K will index across those five channels

00:08:48.230 --> 00:08:48.240
K will index across those five channels
 

00:08:48.240 --> 00:08:50.790
K will index across those five channels
so what the style matrix will do is

00:08:50.790 --> 00:08:50.800
so what the style matrix will do is
 

00:08:50.800 --> 00:08:53.069
so what the style matrix will do is
you're going to compute a matrix we call

00:08:53.069 --> 00:08:53.079
you're going to compute a matrix we call
 

00:08:53.079 --> 00:08:55.470
you're going to compute a matrix we call
this G superscript around the square

00:08:55.470 --> 00:08:55.480
this G superscript around the square
 

00:08:55.480 --> 00:08:58.350
this G superscript around the square
bracket L this is going to be an NC by

00:08:58.350 --> 00:08:58.360
bracket L this is going to be an NC by
 

00:08:58.360 --> 00:09:01.769
bracket L this is going to be an NC by
NC dimensional matrix so be a square

00:09:01.769 --> 00:09:01.779
NC dimensional matrix so be a square
 

00:09:01.779 --> 00:09:05.309
NC dimensional matrix so be a square
matrix remember you have NC channels and

00:09:05.309 --> 00:09:05.319
matrix remember you have NC channels and
 

00:09:05.319 --> 00:09:08.610
matrix remember you have NC channels and
so you have an NC by NC dimensional

00:09:08.610 --> 00:09:08.620
so you have an NC by NC dimensional
 

00:09:08.620 --> 00:09:10.319
so you have an NC by NC dimensional
matrix in order to measure how

00:09:10.319 --> 00:09:10.329
matrix in order to measure how
 

00:09:10.329 --> 00:09:13.499
matrix in order to measure how
correlated each pair of them is so

00:09:13.499 --> 00:09:13.509
correlated each pair of them is so
 

00:09:13.509 --> 00:09:14.150
correlated each pair of them is so
particular

00:09:14.150 --> 00:09:14.160
particular
 

00:09:14.160 --> 00:09:18.360
particular
g/l ke k prime will measure how

00:09:18.360 --> 00:09:18.370
g/l ke k prime will measure how
 

00:09:18.370 --> 00:09:20.220
g/l ke k prime will measure how
correlated are the activations in

00:09:20.220 --> 00:09:20.230
correlated are the activations in
 

00:09:20.230 --> 00:09:23.819
correlated are the activations in
channel k prepared to the activations in

00:09:23.819 --> 00:09:23.829
channel k prepared to the activations in
 

00:09:23.829 --> 00:09:27.179
channel k prepared to the activations in
channel k prime where here k and k prime

00:09:27.179 --> 00:09:27.189
channel k prime where here k and k prime
 

00:09:27.189 --> 00:09:30.420
channel k prime where here k and k prime
will range from 1 through and see the

00:09:30.420 --> 00:09:30.430
will range from 1 through and see the
 

00:09:30.430 --> 00:09:32.579
will range from 1 through and see the
number of channels there are in that

00:09:32.579 --> 00:09:32.589
number of channels there are in that
 

00:09:32.589 --> 00:09:37.980
number of channels there are in that
layer so more formally the way you

00:09:37.980 --> 00:09:37.990
layer so more formally the way you
 

00:09:37.990 --> 00:09:41.850
layer so more formally the way you
compute G L and I'm just going to write

00:09:41.850 --> 00:09:41.860
compute G L and I'm just going to write
 

00:09:41.860 --> 00:09:43.860
compute G L and I'm just going to write
down the formula for computing 1

00:09:43.860 --> 00:09:43.870
down the formula for computing 1
 

00:09:43.870 --> 00:09:46.379
down the formula for computing 1
elements of the KK prime elements of

00:09:46.379 --> 00:09:46.389
elements of the KK prime elements of
 

00:09:46.389 --> 00:09:51.629
elements of the KK prime elements of
this this is going to be sum of I sum of

00:09:51.629 --> 00:09:51.639
this this is going to be sum of I sum of
 

00:09:51.639 --> 00:09:58.220
this this is going to be sum of I sum of
a J of the activation in that layer IJ K

00:09:58.220 --> 00:09:58.230
a J of the activation in that layer IJ K
 

00:09:58.230 --> 00:10:06.900
a J of the activation in that layer IJ K
times the activation at i j k prime so

00:10:06.900 --> 00:10:06.910
times the activation at i j k prime so
 

00:10:06.910 --> 00:10:10.079
times the activation at i j k prime so
here remember I and J index across the

00:10:10.079 --> 00:10:10.089
here remember I and J index across the
 

00:10:10.089 --> 00:10:12.090
here remember I and J index across the
different positions in the block indexes

00:10:12.090 --> 00:10:12.100
different positions in the block indexes
 

00:10:12.100 --> 00:10:15.090
different positions in the block indexes
over the height and width so I is the

00:10:15.090 --> 00:10:15.100
over the height and width so I is the
 

00:10:15.100 --> 00:10:19.970
over the height and width so I is the
sum from 1 to N H and J is a sum from 1

00:10:19.970 --> 00:10:19.980
sum from 1 to N H and J is a sum from 1
 

00:10:19.980 --> 00:10:28.019
sum from 1 to N H and J is a sum from 1
to N W and K here and K prime index over

00:10:28.019 --> 00:10:28.029
to N W and K here and K prime index over
 

00:10:28.029 --> 00:10:30.720
to N W and K here and K prime index over
the channel so K and K Prime range from

00:10:30.720 --> 00:10:30.730
the channel so K and K Prime range from
 

00:10:30.730 --> 00:10:33.480
the channel so K and K Prime range from
1 to the total number of channels in

00:10:33.480 --> 00:10:33.490
1 to the total number of channels in
 

00:10:33.490 --> 00:10:38.309
1 to the total number of channels in
that layer of the neural network so all

00:10:38.309 --> 00:10:38.319
that layer of the neural network so all
 

00:10:38.319 --> 00:10:40.829
that layer of the neural network so all
this is doing is is summing over the

00:10:40.829 --> 00:10:40.839
this is doing is is summing over the
 

00:10:40.839 --> 00:10:42.389
this is doing is is summing over the
different positions of the image over

00:10:42.389 --> 00:10:42.399
different positions of the image over
 

00:10:42.399 --> 00:10:43.799
different positions of the image over
the height and width and just

00:10:43.799 --> 00:10:43.809
the height and width and just
 

00:10:43.809 --> 00:10:46.829
the height and width and just
multiplying the activations together of

00:10:46.829 --> 00:10:46.839
multiplying the activations together of
 

00:10:46.839 --> 00:10:50.160
multiplying the activations together of
the channels K and K Prime and that's

00:10:50.160 --> 00:10:50.170
the channels K and K Prime and that's
 

00:10:50.170 --> 00:10:52.350
the channels K and K Prime and that's
the definition of G cake

00:10:52.350 --> 00:10:52.360
the definition of G cake
 

00:10:52.360 --> 00:10:55.019
the definition of G cake
and you do this for every value of K and

00:10:55.019 --> 00:10:55.029
and you do this for every value of K and
 

00:10:55.029 --> 00:10:58.530
and you do this for every value of K and
K Prime to compute this matrix G also

00:10:58.530 --> 00:10:58.540
K Prime to compute this matrix G also
 

00:10:58.540 --> 00:11:02.939
K Prime to compute this matrix G also
called the style matrix and so notice

00:11:02.939 --> 00:11:02.949
called the style matrix and so notice
 

00:11:02.949 --> 00:11:05.579
called the style matrix and so notice
that if both of these activations tend

00:11:05.579 --> 00:11:05.589
that if both of these activations tend
 

00:11:05.589 --> 00:11:09.030
that if both of these activations tend
to be lashed together then G KK prime

00:11:09.030 --> 00:11:09.040
to be lashed together then G KK prime
 

00:11:09.040 --> 00:11:10.679
to be lashed together then G KK prime
will be launched where as that they are

00:11:10.679 --> 00:11:10.689
will be launched where as that they are
 

00:11:10.689 --> 00:11:13.259
will be launched where as that they are
uncorrelated then G QJ prime might be

00:11:13.259 --> 00:11:13.269
uncorrelated then G QJ prime might be
 

00:11:13.269 --> 00:11:15.569
uncorrelated then G QJ prime might be
small and technically I've been using

00:11:15.569 --> 00:11:15.579
small and technically I've been using
 

00:11:15.579 --> 00:11:18.569
small and technically I've been using
the term correlation to convey intuition

00:11:18.569 --> 00:11:18.579
the term correlation to convey intuition
 

00:11:18.579 --> 00:11:21.090
the term correlation to convey intuition
but this is actually the unnormalized

00:11:21.090 --> 00:11:21.100
but this is actually the unnormalized
 

00:11:21.100 --> 00:11:23.789
but this is actually the unnormalized
cross covariance because we're not

00:11:23.789 --> 00:11:23.799
cross covariance because we're not
 

00:11:23.799 --> 00:11:25.889
cross covariance because we're not
subtracting out the mean and this is

00:11:25.889 --> 00:11:25.899
subtracting out the mean and this is
 

00:11:25.899 --> 00:11:27.900
subtracting out the mean and this is
just multiplying how these elements

00:11:27.900 --> 00:11:27.910
just multiplying how these elements
 

00:11:27.910 --> 00:11:31.559
just multiplying how these elements
directly so this is how you compute the

00:11:31.559 --> 00:11:31.569
directly so this is how you compute the
 

00:11:31.569 --> 00:11:35.280
directly so this is how you compute the
style of an image and you'd actually do

00:11:35.280 --> 00:11:35.290
style of an image and you'd actually do
 

00:11:35.290 --> 00:11:37.769
style of an image and you'd actually do
this for both the style image s and for

00:11:37.769 --> 00:11:37.779
this for both the style image s and for
 

00:11:37.779 --> 00:11:40.499
this for both the style image s and for
the generated image G so just to

00:11:40.499 --> 00:11:40.509
the generated image G so just to
 

00:11:40.509 --> 00:11:45.439
the generated image G so just to
distinguish that this is the style image

00:11:45.439 --> 00:11:45.449
 

00:11:45.449 --> 00:11:48.569
you know maybe let me add a round

00:11:48.569 --> 00:11:48.579
you know maybe let me add a round
 

00:11:48.579 --> 00:11:52.169
you know maybe let me add a round
bracket s there just to denote that this

00:11:52.169 --> 00:11:52.179
bracket s there just to denote that this
 

00:11:52.179 --> 00:11:54.269
bracket s there just to denote that this
is the style image for the image s and

00:11:54.269 --> 00:11:54.279
is the style image for the image s and
 

00:11:54.279 --> 00:11:58.609
is the style image for the image s and
those are the activations on the image s

00:11:58.609 --> 00:11:58.619
 

00:11:58.619 --> 00:12:01.619
and what you do is then compute the same

00:12:01.619 --> 00:12:01.629
and what you do is then compute the same
 

00:12:01.629 --> 00:12:05.100
and what you do is then compute the same
thing for the generated image so it's

00:12:05.100 --> 00:12:05.110
thing for the generated image so it's
 

00:12:05.110 --> 00:12:06.109
thing for the generated image so it's
really the same thing

00:12:06.109 --> 00:12:06.119
really the same thing
 

00:12:06.119 --> 00:12:12.329
really the same thing
some of rice some of you J AI j k l AI j

00:12:12.329 --> 00:12:12.339
some of rice some of you J AI j k l AI j
 

00:12:12.339 --> 00:12:17.669
some of rice some of you J AI j k l AI j
k hello um and the summation indices are

00:12:17.669 --> 00:12:17.679
k hello um and the summation indices are
 

00:12:17.679 --> 00:12:25.729
k hello um and the summation indices are
the same right as follows and you wanna

00:12:25.729 --> 00:12:25.739
the same right as follows and you wanna
 

00:12:25.739 --> 00:12:29.429
the same right as follows and you wanna
just to note this is for the generated

00:12:29.429 --> 00:12:29.439
just to note this is for the generated
 

00:12:29.439 --> 00:12:32.039
just to note this is for the generated
image I'll just put the round practice G

00:12:32.039 --> 00:12:32.049
image I'll just put the round practice G
 

00:12:32.049 --> 00:12:37.619
image I'll just put the round practice G
there so now you have two matrices they

00:12:37.619 --> 00:12:37.629
there so now you have two matrices they
 

00:12:37.629 --> 00:12:39.359
there so now you have two matrices they
capture whether it's the style of the

00:12:39.359 --> 00:12:39.369
capture whether it's the style of the
 

00:12:39.369 --> 00:12:41.759
capture whether it's the style of the
image s and what is the style of the

00:12:41.759 --> 00:12:41.769
image s and what is the style of the
 

00:12:41.769 --> 00:12:44.669
image s and what is the style of the
image G and by the way I we've been

00:12:44.669 --> 00:12:44.679
image G and by the way I we've been
 

00:12:44.679 --> 00:12:47.280
image G and by the way I we've been
using the alphabet to capital G to

00:12:47.280 --> 00:12:47.290
using the alphabet to capital G to
 

00:12:47.290 --> 00:12:50.239
using the alphabet to capital G to
denote these matrices in linear algebra

00:12:50.239 --> 00:12:50.249
denote these matrices in linear algebra
 

00:12:50.249 --> 00:12:54.299
denote these matrices in linear algebra
these are also called the gram matrix

00:12:54.299 --> 00:12:54.309
these are also called the gram matrix
 

00:12:54.309 --> 00:12:56.579
these are also called the gram matrix
all these are called gram matrices but

00:12:56.579 --> 00:12:56.589
all these are called gram matrices but
 

00:12:56.589 --> 00:12:58.829
all these are called gram matrices but
in this video I'm just going to use the

00:12:58.829 --> 00:12:58.839
in this video I'm just going to use the
 

00:12:58.839 --> 00:13:01.259
in this video I'm just going to use the
term style matrix but this is term gram

00:13:01.259 --> 00:13:01.269
term style matrix but this is term gram
 

00:13:01.269 --> 00:13:04.390
term style matrix but this is term gram
matrix that motivates using capital

00:13:04.390 --> 00:13:04.400
matrix that motivates using capital
 

00:13:04.400 --> 00:13:08.500
matrix that motivates using capital
to denote these matrices finally the

00:13:08.500 --> 00:13:08.510
to denote these matrices finally the
 

00:13:08.510 --> 00:13:12.490
to denote these matrices finally the
cost function the style cost function if

00:13:12.490 --> 00:13:12.500
cost function the style cost function if
 

00:13:12.500 --> 00:13:16.030
cost function the style cost function if
you're doing this on layer L between s

00:13:16.030 --> 00:13:16.040
you're doing this on layer L between s
 

00:13:16.040 --> 00:13:20.620
you're doing this on layer L between s
and G you can now define that to be just

00:13:20.620 --> 00:13:20.630
and G you can now define that to be just
 

00:13:20.630 --> 00:13:25.480
and G you can now define that to be just
the UM you can now define that to be

00:13:25.480 --> 00:13:25.490
the UM you can now define that to be
 

00:13:25.490 --> 00:13:29.860
the UM you can now define that to be
just the difference between these two

00:13:29.860 --> 00:13:29.870
just the difference between these two
 

00:13:29.870 --> 00:13:37.480
just the difference between these two
matrices GL G squared and these are

00:13:37.480 --> 00:13:37.490
matrices GL G squared and these are
 

00:13:37.490 --> 00:13:38.980
matrices GL G squared and these are
matrices so I'll just take the previous

00:13:38.980 --> 00:13:38.990
matrices so I'll just take the previous
 

00:13:38.990 --> 00:13:42.040
matrices so I'll just take the previous
long so this is just the sum of squares

00:13:42.040 --> 00:13:42.050
long so this is just the sum of squares
 

00:13:42.050 --> 00:13:44.140
long so this is just the sum of squares
of the element-wise differences between

00:13:44.140 --> 00:13:44.150
of the element-wise differences between
 

00:13:44.150 --> 00:13:47.170
of the element-wise differences between
these two matrices and just the right

00:13:47.170 --> 00:13:47.180
these two matrices and just the right
 

00:13:47.180 --> 00:13:50.040
these two matrices and just the right
result this is going to be sum over k

00:13:50.040 --> 00:13:50.050
result this is going to be sum over k
 

00:13:50.050 --> 00:13:55.840
result this is going to be sum over k
sum of a k prime of these differences s

00:13:55.840 --> 00:13:55.850
sum of a k prime of these differences s
 

00:13:55.850 --> 00:14:04.210
sum of a k prime of these differences s
K prime minus G L g k k prime and then

00:14:04.210 --> 00:14:04.220
K prime minus G L g k k prime and then
 

00:14:04.220 --> 00:14:10.660
K prime minus G L g k k prime and then
the sum of squares of elements the

00:14:10.660 --> 00:14:10.670
the sum of squares of elements the
 

00:14:10.670 --> 00:14:11.890
the sum of squares of elements the
authors actually use this for

00:14:11.890 --> 00:14:11.900
authors actually use this for
 

00:14:11.900 --> 00:14:14.740
authors actually use this for
normalization constants two times R and

00:14:14.740 --> 00:14:14.750
normalization constants two times R and
 

00:14:14.750 --> 00:14:19.750
normalization constants two times R and
H and W that layer and see that layer

00:14:19.750 --> 00:14:19.760
H and W that layer and see that layer
 

00:14:19.760 --> 00:14:22.030
H and W that layer and see that layer
and then square this you can you know

00:14:22.030 --> 00:14:22.040
and then square this you can you know
 

00:14:22.040 --> 00:14:24.340
and then square this you can you know
put this up here as well but the

00:14:24.340 --> 00:14:24.350
put this up here as well but the
 

00:14:24.350 --> 00:14:25.810
put this up here as well but the
normalization constant doesn't matter

00:14:25.810 --> 00:14:25.820
normalization constant doesn't matter
 

00:14:25.820 --> 00:14:27.820
normalization constant doesn't matter
that much because this cost is

00:14:27.820 --> 00:14:27.830
that much because this cost is
 

00:14:27.830 --> 00:14:30.070
that much because this cost is
multiplied by some hyper parameter B

00:14:30.070 --> 00:14:30.080
multiplied by some hyper parameter B
 

00:14:30.080 --> 00:14:33.250
multiplied by some hyper parameter B
anyway so just to finish up this is the

00:14:33.250 --> 00:14:33.260
anyway so just to finish up this is the
 

00:14:33.260 --> 00:14:36.250
anyway so just to finish up this is the
style cost function defined using layer

00:14:36.250 --> 00:14:36.260
style cost function defined using layer
 

00:14:36.260 --> 00:14:39.250
style cost function defined using layer
L and as you saw under previous line

00:14:39.250 --> 00:14:39.260
L and as you saw under previous line
 

00:14:39.260 --> 00:14:41.950
L and as you saw under previous line
this is basically the Frobenius norm

00:14:41.950 --> 00:14:41.960
this is basically the Frobenius norm
 

00:14:41.960 --> 00:14:46.120
this is basically the Frobenius norm
between two style matrices computed on

00:14:46.120 --> 00:14:46.130
between two style matrices computed on
 

00:14:46.130 --> 00:14:50.470
between two style matrices computed on
the image s and on the image G for

00:14:50.470 --> 00:14:50.480
the image s and on the image G for
 

00:14:50.480 --> 00:14:52.510
the image s and on the image G for
business on squared and then we read

00:14:52.510 --> 00:14:52.520
business on squared and then we read
 

00:14:52.520 --> 00:14:54.640
business on squared and then we read
additional normalization constant which

00:14:54.640 --> 00:14:54.650
additional normalization constant which
 

00:14:54.650 --> 00:14:58.720
additional normalization constant which
isn't that important and finally it

00:14:58.720 --> 00:14:58.730
isn't that important and finally it
 

00:14:58.730 --> 00:15:00.730
isn't that important and finally it
turns out that you get more visually

00:15:00.730 --> 00:15:00.740
turns out that you get more visually
 

00:15:00.740 --> 00:15:03.460
turns out that you get more visually
pleasing results if you use the style

00:15:03.460 --> 00:15:03.470
pleasing results if you use the style
 

00:15:03.470 --> 00:15:05.440
pleasing results if you use the style
cost function from multiple different

00:15:05.440 --> 00:15:05.450
cost function from multiple different
 

00:15:05.450 --> 00:15:09.160
cost function from multiple different
layers so the overall style cost

00:15:09.160 --> 00:15:09.170
layers so the overall style cost
 

00:15:09.170 --> 00:15:10.910
layers so the overall style cost
function

00:15:10.910 --> 00:15:10.920
function
 

00:15:10.920 --> 00:15:15.240
function
you can define as sum over all the

00:15:15.240 --> 00:15:15.250
you can define as sum over all the
 

00:15:15.250 --> 00:15:18.870
you can define as sum over all the
different layers of the style cost

00:15:18.870 --> 00:15:18.880
different layers of the style cost
 

00:15:18.880 --> 00:15:21.570
different layers of the style cost
function for that layer you should

00:15:21.570 --> 00:15:21.580
function for that layer you should
 

00:15:21.580 --> 00:15:24.750
function for that layer you should
define the book weighted by some set of

00:15:24.750 --> 00:15:24.760
define the book weighted by some set of
 

00:15:24.760 --> 00:15:26.610
define the book weighted by some set of
parameters by some set of additional

00:15:26.610 --> 00:15:26.620
parameters by some set of additional
 

00:15:26.620 --> 00:15:28.740
parameters by some set of additional
hyper parameters which you only know as

00:15:28.740 --> 00:15:28.750
hyper parameters which you only know as
 

00:15:28.750 --> 00:15:31.500
hyper parameters which you only know as
lambda L here so what this does is

00:15:31.500 --> 00:15:31.510
lambda L here so what this does is
 

00:15:31.510 --> 00:15:34.470
lambda L here so what this does is
allows you to use different layers in

00:15:34.470 --> 00:15:34.480
allows you to use different layers in
 

00:15:34.480 --> 00:15:36.330
allows you to use different layers in
the neural network both the early ones

00:15:36.330 --> 00:15:36.340
the neural network both the early ones
 

00:15:36.340 --> 00:15:38.310
the neural network both the early ones
which measure relatively simpler

00:15:38.310 --> 00:15:38.320
which measure relatively simpler
 

00:15:38.320 --> 00:15:41.610
which measure relatively simpler
low-level features like edges as well as

00:15:41.610 --> 00:15:41.620
low-level features like edges as well as
 

00:15:41.620 --> 00:15:43.770
low-level features like edges as well as
some later layers which measure high

00:15:43.770 --> 00:15:43.780
some later layers which measure high
 

00:15:43.780 --> 00:15:45.840
some later layers which measure high
level features and cause the neural

00:15:45.840 --> 00:15:45.850
level features and cause the neural
 

00:15:45.850 --> 00:15:47.970
level features and cause the neural
network to take both low level and high

00:15:47.970 --> 00:15:47.980
network to take both low level and high
 

00:15:47.980 --> 00:15:50.490
network to take both low level and high
level correlations into account when

00:15:50.490 --> 00:15:50.500
level correlations into account when
 

00:15:50.500 --> 00:15:53.820
level correlations into account when
computing style and in the program

00:15:53.820 --> 00:15:53.830
computing style and in the program
 

00:15:53.830 --> 00:15:56.340
computing style and in the program
exercise you gain more intuition about

00:15:56.340 --> 00:15:56.350
exercise you gain more intuition about
 

00:15:56.350 --> 00:15:58.950
exercise you gain more intuition about
what might be reasonable choices for

00:15:58.950 --> 00:15:58.960
what might be reasonable choices for
 

00:15:58.960 --> 00:16:02.150
what might be reasonable choices for
this hyper parameter lambda as well and

00:16:02.150 --> 00:16:02.160
this hyper parameter lambda as well and
 

00:16:02.160 --> 00:16:05.340
this hyper parameter lambda as well and
so just to wrap this up you can now

00:16:05.340 --> 00:16:05.350
so just to wrap this up you can now
 

00:16:05.350 --> 00:16:09.110
so just to wrap this up you can now
define the overall cost function as

00:16:09.110 --> 00:16:09.120
define the overall cost function as
 

00:16:09.120 --> 00:16:12.900
define the overall cost function as
alpha times the content cost between C

00:16:12.900 --> 00:16:12.910
alpha times the content cost between C
 

00:16:12.910 --> 00:16:17.010
alpha times the content cost between C
and G plus beta times the style cost

00:16:17.010 --> 00:16:17.020
and G plus beta times the style cost
 

00:16:17.020 --> 00:16:20.700
and G plus beta times the style cost
between s and G and then use gradient

00:16:20.700 --> 00:16:20.710
between s and G and then use gradient
 

00:16:20.710 --> 00:16:22.320
between s and G and then use gradient
descent or a more sophisticated

00:16:22.320 --> 00:16:22.330
descent or a more sophisticated
 

00:16:22.330 --> 00:16:24.390
descent or a more sophisticated
optimization algorithm if you want in

00:16:24.390 --> 00:16:24.400
optimization algorithm if you want in
 

00:16:24.400 --> 00:16:27.300
optimization algorithm if you want in
order to try to find an image G that

00:16:27.300 --> 00:16:27.310
order to try to find an image G that
 

00:16:27.310 --> 00:16:30.450
order to try to find an image G that
human eyes that tries to minimize this

00:16:30.450 --> 00:16:30.460
human eyes that tries to minimize this
 

00:16:30.460 --> 00:16:33.030
human eyes that tries to minimize this
cost function J or P and if you do that

00:16:33.030 --> 00:16:33.040
cost function J or P and if you do that
 

00:16:33.040 --> 00:16:35.430
cost function J or P and if you do that
you can generate pretty good-looking

00:16:35.430 --> 00:16:35.440
you can generate pretty good-looking
 

00:16:35.440 --> 00:16:38.970
you can generate pretty good-looking
neuro artistic and if you do that you'll

00:16:38.970 --> 00:16:38.980
neuro artistic and if you do that you'll
 

00:16:38.980 --> 00:16:40.800
neuro artistic and if you do that you'll
be able to generate some pretty nice

00:16:40.800 --> 00:16:40.810
be able to generate some pretty nice
 

00:16:40.810 --> 00:16:44.190
be able to generate some pretty nice
novel artwork so that's it for neural

00:16:44.190 --> 00:16:44.200
novel artwork so that's it for neural
 

00:16:44.200 --> 00:16:45.930
novel artwork so that's it for neural
style transfer and I hope you have fun

00:16:45.930 --> 00:16:45.940
style transfer and I hope you have fun
 

00:16:45.940 --> 00:16:48.060
style transfer and I hope you have fun
implementing it in this week's for an

00:16:48.060 --> 00:16:48.070
implementing it in this week's for an
 

00:16:48.070 --> 00:16:50.250
implementing it in this week's for an
exercise before wrapping up this week

00:16:50.250 --> 00:16:50.260
exercise before wrapping up this week
 

00:16:50.260 --> 00:16:51.990
exercise before wrapping up this week
there's just one last thing on my share

00:16:51.990 --> 00:16:52.000
there's just one last thing on my share
 

00:16:52.000 --> 00:16:54.090
there's just one last thing on my share
of you which is how to do convolutions

00:16:54.090 --> 00:16:54.100
of you which is how to do convolutions
 

00:16:54.100 --> 00:16:57.870
of you which is how to do convolutions
over 1d or 3d data rather than over only

00:16:57.870 --> 00:16:57.880
over 1d or 3d data rather than over only
 

00:16:57.880 --> 00:17:02.640
over 1d or 3d data rather than over only
2d images let's go on to the last video

