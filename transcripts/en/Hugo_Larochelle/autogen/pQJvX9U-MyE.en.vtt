WEBVTT
Kind: captions
Language: en

00:00:00.030 --> 00:00:02.300
 
in this video we actually see how we can

00:00:02.300 --> 00:00:02.310
in this video we actually see how we can
 

00:00:02.310 --> 00:00:04.730
in this video we actually see how we can
perform sequence classification in a

00:00:04.730 --> 00:00:04.740
perform sequence classification in a
 

00:00:04.740 --> 00:00:09.320
perform sequence classification in a
linear chain conditional random field so

00:00:09.320 --> 00:00:09.330
linear chain conditional random field so
 

00:00:09.330 --> 00:00:11.360
linear chain conditional random field so
so far what we've seen is how we could

00:00:11.360 --> 00:00:11.370
so far what we've seen is how we could
 

00:00:11.370 --> 00:00:13.910
so far what we've seen is how we could
compute the probability the joint

00:00:13.910 --> 00:00:13.920
compute the probability the joint
 

00:00:13.920 --> 00:00:16.580
compute the probability the joint
probability of a whole sequence of

00:00:16.580 --> 00:00:16.590
probability of a whole sequence of
 

00:00:16.590 --> 00:00:19.970
probability of a whole sequence of
labels given an input sequence so we've

00:00:19.970 --> 00:00:19.980
labels given an input sequence so we've
 

00:00:19.980 --> 00:00:21.980
labels given an input sequence so we've
seen how we could compute in particular

00:00:21.980 --> 00:00:21.990
seen how we could compute in particular
 

00:00:21.990 --> 00:00:24.650
seen how we could compute in particular
this nasty partition function using

00:00:24.650 --> 00:00:24.660
this nasty partition function using
 

00:00:24.660 --> 00:00:28.490
this nasty partition function using
dynamic programming and we are also

00:00:28.490 --> 00:00:28.500
dynamic programming and we are also
 

00:00:28.500 --> 00:00:30.769
dynamic programming and we are also
seeing how we could compute marginal

00:00:30.769 --> 00:00:30.779
seeing how we could compute marginal
 

00:00:30.779 --> 00:00:33.110
seeing how we could compute marginal
probabilities for instance the marginal

00:00:33.110 --> 00:00:33.120
probabilities for instance the marginal
 

00:00:33.120 --> 00:00:35.870
probabilities for instance the marginal
probabilities of a label like given

00:00:35.870 --> 00:00:35.880
probabilities of a label like given
 

00:00:35.880 --> 00:00:38.780
probabilities of a label like given
position K given the full sequence and

00:00:38.780 --> 00:00:38.790
position K given the full sequence and
 

00:00:38.790 --> 00:00:41.630
position K given the full sequence and
again performing this computation

00:00:41.630 --> 00:00:41.640
again performing this computation
 

00:00:41.640 --> 00:00:45.139
again performing this computation
required the same dynamic program that

00:00:45.139 --> 00:00:45.149
required the same dynamic program that
 

00:00:45.149 --> 00:00:47.779
required the same dynamic program that
we can use for computing the partition

00:00:47.779 --> 00:00:47.789
we can use for computing the partition
 

00:00:47.789 --> 00:00:49.850
we can use for computing the partition
function or would compute these log

00:00:49.850 --> 00:00:49.860
function or would compute these log
 

00:00:49.860 --> 00:00:52.279
function or would compute these log
alpha and log beta tables and use them

00:00:52.279 --> 00:00:52.289
alpha and log beta tables and use them
 

00:00:52.289 --> 00:00:54.650
alpha and log beta tables and use them
in the computation of the marginal

00:00:54.650 --> 00:00:54.660
in the computation of the marginal
 

00:00:54.660 --> 00:00:59.330
in the computation of the marginal
probability now here what we'll see is

00:00:59.330 --> 00:00:59.340
probability now here what we'll see is
 

00:00:59.340 --> 00:01:00.910
probability now here what we'll see is
how we can actually perform

00:01:00.910 --> 00:01:00.920
how we can actually perform
 

00:01:00.920 --> 00:01:02.900
how we can actually perform
classification so if I give you a

00:01:02.900 --> 00:01:02.910
classification so if I give you a
 

00:01:02.910 --> 00:01:06.010
classification so if I give you a
sequence of inputs now I ask you to

00:01:06.010 --> 00:01:06.020
sequence of inputs now I ask you to
 

00:01:06.020 --> 00:01:09.530
sequence of inputs now I ask you to
provide with provide me a sequence of

00:01:09.530 --> 00:01:09.540
provide with provide me a sequence of
 

00:01:09.540 --> 00:01:11.630
provide with provide me a sequence of
labels that you think is a good

00:01:11.630 --> 00:01:11.640
labels that you think is a good
 

00:01:11.640 --> 00:01:14.359
labels that you think is a good
prediction for the sequence of the

00:01:14.359 --> 00:01:14.369
prediction for the sequence of the
 

00:01:14.369 --> 00:01:18.380
prediction for the sequence of the
actual true sequence of labels that that

00:01:18.380 --> 00:01:18.390
actual true sequence of labels that that
 

00:01:18.390 --> 00:01:20.390
actual true sequence of labels that that
say a human or an expert would have

00:01:20.390 --> 00:01:20.400
say a human or an expert would have
 

00:01:20.400 --> 00:01:24.649
say a human or an expert would have
predicted so there are two options here

00:01:24.649 --> 00:01:24.659
predicted so there are two options here
 

00:01:24.659 --> 00:01:26.210
predicted so there are two options here
so we'll see two different procedures

00:01:26.210 --> 00:01:26.220
so we'll see two different procedures
 

00:01:26.220 --> 00:01:28.670
so we'll see two different procedures
for performing that prediction the first

00:01:28.670 --> 00:01:28.680
for performing that prediction the first
 

00:01:28.680 --> 00:01:32.899
for performing that prediction the first
is perhaps the simplest what we do is

00:01:32.899 --> 00:01:32.909
is perhaps the simplest what we do is
 

00:01:32.909 --> 00:01:36.770
is perhaps the simplest what we do is
that for each position K we compute the

00:01:36.770 --> 00:01:36.780
that for each position K we compute the
 

00:01:36.780 --> 00:01:40.249
that for each position K we compute the
marginal P of YK given the sequence so

00:01:40.249 --> 00:01:40.259
marginal P of YK given the sequence so
 

00:01:40.259 --> 00:01:41.960
marginal P of YK given the sequence so
we compute the probability for any

00:01:41.960 --> 00:01:41.970
we compute the probability for any
 

00:01:41.970 --> 00:01:43.670
we compute the probability for any
potential label YK

00:01:43.670 --> 00:01:43.680
potential label YK
 

00:01:43.680 --> 00:01:46.010
potential label YK
of it being the true K of label in the

00:01:46.010 --> 00:01:46.020
of it being the true K of label in the
 

00:01:46.020 --> 00:01:48.770
of it being the true K of label in the
sequence and then as our prediction we

00:01:48.770 --> 00:01:48.780
sequence and then as our prediction we
 

00:01:48.780 --> 00:01:52.249
sequence and then as our prediction we
just say that in our predicted sequence

00:01:52.249 --> 00:01:52.259
just say that in our predicted sequence
 

00:01:52.259 --> 00:01:55.190
just say that in our predicted sequence
the label for the gift prediction the

00:01:55.190 --> 00:01:55.200
the label for the gift prediction the
 

00:01:55.200 --> 00:01:57.139
the label for the gift prediction the
key of the position is going to be the

00:01:57.139 --> 00:01:57.149
key of the position is going to be the
 

00:01:57.149 --> 00:01:58.819
key of the position is going to be the
label that has the highest marginal

00:01:58.819 --> 00:01:58.829
label that has the highest marginal
 

00:01:58.829 --> 00:02:03.530
label that has the highest marginal
probability now so this is very similar

00:02:03.530 --> 00:02:03.540
probability now so this is very similar
 

00:02:03.540 --> 00:02:06.649
probability now so this is very similar
to how for a neural network that would

00:02:06.649 --> 00:02:06.659
to how for a neural network that would
 

00:02:06.659 --> 00:02:08.330
to how for a neural network that would
take just a single input so not in the

00:02:08.330 --> 00:02:08.340
take just a single input so not in the
 

00:02:08.340 --> 00:02:10.880
take just a single input so not in the
sequence prediction setting we would

00:02:10.880 --> 00:02:10.890
sequence prediction setting we would
 

00:02:10.890 --> 00:02:13.010
sequence prediction setting we would
just feed the input to the neural net it

00:02:13.010 --> 00:02:13.020
just feed the input to the neural net it
 

00:02:13.020 --> 00:02:13.830
just feed the input to the neural net it
would produce

00:02:13.830 --> 00:02:13.840
would produce
 

00:02:13.840 --> 00:02:18.270
would produce
a output distribution for what the true

00:02:18.270 --> 00:02:18.280
a output distribution for what the true
 

00:02:18.280 --> 00:02:20.250
a output distribution for what the true
label would be for the given input and

00:02:20.250 --> 00:02:20.260
label would be for the given input and
 

00:02:20.260 --> 00:02:21.600
label would be for the given input and
we just take the label with the highest

00:02:21.600 --> 00:02:21.610
we just take the label with the highest
 

00:02:21.610 --> 00:02:25.110
we just take the label with the highest
probability now we can actually show

00:02:25.110 --> 00:02:25.120
probability now we can actually show
 

00:02:25.120 --> 00:02:27.570
probability now we can actually show
that this procedure for constructing a

00:02:27.570 --> 00:02:27.580
that this procedure for constructing a
 

00:02:27.580 --> 00:02:30.449
that this procedure for constructing a
prediction sequence so a sequence of

00:02:30.449 --> 00:02:30.459
prediction sequence so a sequence of
 

00:02:30.459 --> 00:02:32.339
prediction sequence so a sequence of
labels that we would provide as an

00:02:32.339 --> 00:02:32.349
labels that we would provide as an
 

00:02:32.349 --> 00:02:36.750
labels that we would provide as an
answer is corresponds to the prediction

00:02:36.750 --> 00:02:36.760
answer is corresponds to the prediction
 

00:02:36.760 --> 00:02:39.780
answer is corresponds to the prediction
that minimizes the sum of classification

00:02:39.780 --> 00:02:39.790
that minimizes the sum of classification
 

00:02:39.790 --> 00:02:42.509
that minimizes the sum of classification
errors over the whole sequence if we

00:02:42.509 --> 00:02:42.519
errors over the whole sequence if we
 

00:02:42.519 --> 00:02:44.729
errors over the whole sequence if we
assume that our linear conditional

00:02:44.729 --> 00:02:44.739
assume that our linear conditional
 

00:02:44.739 --> 00:02:47.009
assume that our linear conditional
random field so our model is actually

00:02:47.009 --> 00:02:47.019
random field so our model is actually
 

00:02:47.019 --> 00:02:49.080
random field so our model is actually
the true model is the true distribution

00:02:49.080 --> 00:02:49.090
the true model is the true distribution
 

00:02:49.090 --> 00:02:52.680
the true model is the true distribution
that produced the sequence labels in our

00:02:52.680 --> 00:02:52.690
that produced the sequence labels in our
 

00:02:52.690 --> 00:02:55.800
that produced the sequence labels in our
data set so we actually know this gives

00:02:55.800 --> 00:02:55.810
data set so we actually know this gives
 

00:02:55.810 --> 00:02:57.690
data set so we actually know this gives
some justification for using that

00:02:57.690 --> 00:02:57.700
some justification for using that
 

00:02:57.700 --> 00:03:01.500
some justification for using that
procedure and because this is an

00:03:01.500 --> 00:03:01.510
procedure and because this is an
 

00:03:01.510 --> 00:03:03.600
procedure and because this is an
interesting concept actually will

00:03:03.600 --> 00:03:03.610
interesting concept actually will
 

00:03:03.610 --> 00:03:06.140
interesting concept actually will
actually do the demonstration for why

00:03:06.140 --> 00:03:06.150
actually do the demonstration for why
 

00:03:06.150 --> 00:03:08.970
actually do the demonstration for why
maximizing for each position the

00:03:08.970 --> 00:03:08.980
maximizing for each position the
 

00:03:08.980 --> 00:03:10.880
maximizing for each position the
marginal distribution actually

00:03:10.880 --> 00:03:10.890
marginal distribution actually
 

00:03:10.890 --> 00:03:14.069
marginal distribution actually
corresponds to finding this minimizing

00:03:14.069 --> 00:03:14.079
corresponds to finding this minimizing
 

00:03:14.079 --> 00:03:15.960
corresponds to finding this minimizing
sequence of the sum of classification

00:03:15.960 --> 00:03:15.970
sequence of the sum of classification
 

00:03:15.970 --> 00:03:18.090
sequence of the sum of classification
error if we assume our model is the true

00:03:18.090 --> 00:03:18.100
error if we assume our model is the true
 

00:03:18.100 --> 00:03:24.890
error if we assume our model is the true
distribution so what we want to do is I

00:03:24.890 --> 00:03:24.900
distribution so what we want to do is I
 

00:03:24.900 --> 00:03:27.960
distribution so what we want to do is I
find the expression for what is the

00:03:27.960 --> 00:03:27.970
find the expression for what is the
 

00:03:27.970 --> 00:03:31.410
find the expression for what is the
predicted sequence Y star that minimizes

00:03:31.410 --> 00:03:31.420
predicted sequence Y star that minimizes
 

00:03:31.420 --> 00:03:33.720
predicted sequence Y star that minimizes
in expectation so I should say this is

00:03:33.720 --> 00:03:33.730
in expectation so I should say this is
 

00:03:33.730 --> 00:03:35.759
in expectation so I should say this is
the minimization in expectation

00:03:35.759 --> 00:03:35.769
the minimization in expectation
 

00:03:35.769 --> 00:03:38.819
the minimization in expectation
according to our model of the sum of the

00:03:38.819 --> 00:03:38.829
according to our model of the sum of the
 

00:03:38.829 --> 00:03:40.680
according to our model of the sum of the
classification error for each position

00:03:40.680 --> 00:03:40.690
classification error for each position
 

00:03:40.690 --> 00:03:43.440
classification error for each position
so we have the sum of the identity

00:03:43.440 --> 00:03:43.450
so we have the sum of the identity
 

00:03:43.450 --> 00:03:46.140
so we have the sum of the identity
function of whether the true labeled

00:03:46.140 --> 00:03:46.150
function of whether the true labeled
 

00:03:46.150 --> 00:03:48.509
function of whether the true labeled
according to our model YK so it's true

00:03:48.509 --> 00:03:48.519
according to our model YK so it's true
 

00:03:48.519 --> 00:03:51.210
according to our model YK so it's true
label in the sense that it's the label

00:03:51.210 --> 00:03:51.220
label in the sense that it's the label
 

00:03:51.220 --> 00:03:55.050
label in the sense that it's the label
that based on the distribution of our

00:03:55.050 --> 00:03:55.060
that based on the distribution of our
 

00:03:55.060 --> 00:03:58.470
that based on the distribution of our
model is different from the predicted

00:03:58.470 --> 00:03:58.480
model is different from the predicted
 

00:03:58.480 --> 00:04:01.830
model is different from the predicted
label at position K so Y star K so want

00:04:01.830 --> 00:04:01.840
label at position K so Y star K so want
 

00:04:01.840 --> 00:04:04.080
label at position K so Y star K so want
to minimize in expectation that's some

00:04:04.080 --> 00:04:04.090
to minimize in expectation that's some
 

00:04:04.090 --> 00:04:09.300
to minimize in expectation that's some
of classification error per position so

00:04:09.300 --> 00:04:09.310
of classification error per position so
 

00:04:09.310 --> 00:04:11.250
of classification error per position so
here I'm just writing explicitly what

00:04:11.250 --> 00:04:11.260
here I'm just writing explicitly what
 

00:04:11.260 --> 00:04:14.610
here I'm just writing explicitly what
this expectation here is it's the nested

00:04:14.610 --> 00:04:14.620
this expectation here is it's the nested
 

00:04:14.620 --> 00:04:17.849
this expectation here is it's the nested
sum over the first label up to the last

00:04:17.849 --> 00:04:17.859
sum over the first label up to the last
 

00:04:17.859 --> 00:04:21.690
sum over the first label up to the last
label of the sum of parrell per position

00:04:21.690 --> 00:04:21.700
label of the sum of parrell per position
 

00:04:21.700 --> 00:04:24.149
label of the sum of parrell per position
classification error weighted by the

00:04:24.149 --> 00:04:24.159
classification error weighted by the
 

00:04:24.159 --> 00:04:26.190
classification error weighted by the
probability according to my model that I

00:04:26.190 --> 00:04:26.200
probability according to my model that I
 

00:04:26.200 --> 00:04:27.540
probability according to my model that I
would observe this

00:04:27.540 --> 00:04:27.550
would observe this
 

00:04:27.550 --> 00:04:34.260
would observe this
of labels why so these YK is here hey

00:04:34.260 --> 00:04:34.270
of labels why so these YK is here hey
 

00:04:34.270 --> 00:04:35.820
of labels why so these YK is here hey
I'm writing the fact that the

00:04:35.820 --> 00:04:35.830
I'm writing the fact that the
 

00:04:35.830 --> 00:04:38.249
I'm writing the fact that the
minimization overall sequences y star is

00:04:38.249 --> 00:04:38.259
minimization overall sequences y star is
 

00:04:38.259 --> 00:04:40.499
minimization overall sequences y star is
equivalent to performing that mutation

00:04:40.499 --> 00:04:40.509
equivalent to performing that mutation
 

00:04:40.509 --> 00:04:43.640
equivalent to performing that mutation
it's the same as performing minimization

00:04:43.640 --> 00:04:43.650
it's the same as performing minimization
 

00:04:43.650 --> 00:04:47.610
it's the same as performing minimization
sequentially over the first label until

00:04:47.610 --> 00:04:47.620
sequentially over the first label until
 

00:04:47.620 --> 00:04:50.189
sequentially over the first label until
the last label so it's this minimization

00:04:50.189 --> 00:04:50.199
the last label so it's this minimization
 

00:04:50.199 --> 00:04:52.140
the last label so it's this minimization
over all sequences is the same as these

00:04:52.140 --> 00:04:52.150
over all sequences is the same as these
 

00:04:52.150 --> 00:04:54.480
over all sequences is the same as these
nested minimization over first seek

00:04:54.480 --> 00:04:54.490
nested minimization over first seek
 

00:04:54.490 --> 00:04:57.809
nested minimization over first seek
first position second position until the

00:04:57.809 --> 00:04:57.819
first position second position until the
 

00:04:57.819 --> 00:05:02.850
first position second position until the
last position now here what I'm doing is

00:05:02.850 --> 00:05:02.860
last position now here what I'm doing is
 

00:05:02.860 --> 00:05:05.370
last position now here what I'm doing is
that I'm going to take that first I'm

00:05:05.370 --> 00:05:05.380
that I'm going to take that first I'm
 

00:05:05.380 --> 00:05:08.700
that I'm going to take that first I'm
going to introduce this here which

00:05:08.700 --> 00:05:08.710
going to introduce this here which
 

00:05:08.710 --> 00:05:11.010
going to introduce this here which
allows me to just remove this

00:05:11.010 --> 00:05:11.020
allows me to just remove this
 

00:05:11.020 --> 00:05:13.350
allows me to just remove this
parenthesis and I'm going to change the

00:05:13.350 --> 00:05:13.360
parenthesis and I'm going to change the
 

00:05:13.360 --> 00:05:15.029
parenthesis and I'm going to change the
order of the sums so I'm going to

00:05:15.029 --> 00:05:15.039
order of the sums so I'm going to
 

00:05:15.039 --> 00:05:17.640
order of the sums so I'm going to
actually sum first over the position K

00:05:17.640 --> 00:05:17.650
actually sum first over the position K
 

00:05:17.650 --> 00:05:20.100
actually sum first over the position K
and then sum over the value of the first

00:05:20.100 --> 00:05:20.110
and then sum over the value of the first
 

00:05:20.110 --> 00:05:23.279
and then sum over the value of the first
label up to the last label so that's why

00:05:23.279 --> 00:05:23.289
label up to the last label so that's why
 

00:05:23.289 --> 00:05:25.950
label up to the last label so that's why
I have K here then first label up to the

00:05:25.950 --> 00:05:25.960
I have K here then first label up to the
 

00:05:25.960 --> 00:05:29.520
I have K here then first label up to the
last label okay so that that's all I've

00:05:29.520 --> 00:05:29.530
last label okay so that that's all I've
 

00:05:29.530 --> 00:05:31.649
last label okay so that that's all I've
done introduce this here and then change

00:05:31.649 --> 00:05:31.659
done introduce this here and then change
 

00:05:31.659 --> 00:05:33.330
done introduce this here and then change
the order of the sums of the nested

00:05:33.330 --> 00:05:33.340
the order of the sums of the nested
 

00:05:33.340 --> 00:05:41.550
the order of the sums of the nested
sounds now I notice that this term here

00:05:41.550 --> 00:05:41.560
sounds now I notice that this term here
 

00:05:41.560 --> 00:05:47.219
sounds now I notice that this term here
only depends on the value of YK for the

00:05:47.219 --> 00:05:47.229
only depends on the value of YK for the
 

00:05:47.229 --> 00:05:50.580
only depends on the value of YK for the
position K that's indexed here so I can

00:05:50.580 --> 00:05:50.590
position K that's indexed here so I can
 

00:05:50.590 --> 00:05:52.439
position K that's indexed here so I can
actually this is a constant with respect

00:05:52.439 --> 00:05:52.449
actually this is a constant with respect
 

00:05:52.449 --> 00:05:57.839
actually this is a constant with respect
to y 1y K minus 1 YK plus 1 up to so

00:05:57.839 --> 00:05:57.849
to y 1y K minus 1 YK plus 1 up to so
 

00:05:57.849 --> 00:06:00.360
to y 1y K minus 1 YK plus 1 up to so
there should be two three dots here up

00:06:00.360 --> 00:06:00.370
there should be two three dots here up
 

00:06:00.370 --> 00:06:03.959
there should be two three dots here up
to the last label so I can actually push

00:06:03.959 --> 00:06:03.969
to the last label so I can actually push
 

00:06:03.969 --> 00:06:07.709
to the last label so I can actually push
this here up upwards in the nested sums

00:06:07.709 --> 00:06:07.719
this here up upwards in the nested sums
 

00:06:07.719 --> 00:06:11.070
this here up upwards in the nested sums
right in front of the sum over the value

00:06:11.070 --> 00:06:11.080
right in front of the sum over the value
 

00:06:11.080 --> 00:06:14.430
right in front of the sum over the value
of the K at label and the sequence

00:06:14.430 --> 00:06:14.440
of the K at label and the sequence
 

00:06:14.440 --> 00:06:16.499
of the K at label and the sequence
position K at which I'm measuring the

00:06:16.499 --> 00:06:16.509
position K at which I'm measuring the
 

00:06:16.509 --> 00:06:22.589
position K at which I'm measuring the
error next I notice that this expression

00:06:22.589 --> 00:06:22.599
error next I notice that this expression
 

00:06:22.599 --> 00:06:25.800
error next I notice that this expression
here that's just the marginal P of YK

00:06:25.800 --> 00:06:25.810
here that's just the marginal P of YK
 

00:06:25.810 --> 00:06:28.260
here that's just the marginal P of YK
given the sequence so I've taken the

00:06:28.260 --> 00:06:28.270
given the sequence so I've taken the
 

00:06:28.270 --> 00:06:30.779
given the sequence so I've taken the
full joint distribution well conditioned

00:06:30.779 --> 00:06:30.789
full joint distribution well conditioned
 

00:06:30.789 --> 00:06:32.459
full joint distribution well conditioned
on the input sequence the junk

00:06:32.459 --> 00:06:32.469
on the input sequence the junk
 

00:06:32.469 --> 00:06:34.019
on the input sequence the junk
distribution over the whole sequence Y

00:06:34.019 --> 00:06:34.029
distribution over the whole sequence Y
 

00:06:34.029 --> 00:06:36.240
distribution over the whole sequence Y
but I'm summing over all the values that

00:06:36.240 --> 00:06:36.250
but I'm summing over all the values that
 

00:06:36.250 --> 00:06:39.300
but I'm summing over all the values that
every label can take take except the

00:06:39.300 --> 00:06:39.310
every label can take take except the
 

00:06:39.310 --> 00:06:40.260
every label can take take except the
label YK

00:06:40.260 --> 00:06:40.270
label YK
 

00:06:40.270 --> 00:06:41.370
label YK
so that's the marginal

00:06:41.370 --> 00:06:41.380
so that's the marginal
 

00:06:41.380 --> 00:06:50.100
so that's the marginal
P of Y given X next I realized that this

00:06:50.100 --> 00:06:50.110
P of Y given X next I realized that this
 

00:06:50.110 --> 00:06:53.700
P of Y given X next I realized that this
sum here overall position of what is

00:06:53.700 --> 00:06:53.710
sum here overall position of what is
 

00:06:53.710 --> 00:06:56.340
sum here overall position of what is
essentially the expected error for that

00:06:56.340 --> 00:06:56.350
essentially the expected error for that
 

00:06:56.350 --> 00:07:00.000
essentially the expected error for that
position well that's essentially the sum

00:07:00.000 --> 00:07:00.010
position well that's essentially the sum
 

00:07:00.010 --> 00:07:04.260
position well that's essentially the sum
of the sum over y1 of whether I'm making

00:07:04.260 --> 00:07:04.270
of the sum over y1 of whether I'm making
 

00:07:04.270 --> 00:07:07.130
of the sum over y1 of whether I'm making
an error by predicting Y star 1 x

00:07:07.130 --> 00:07:07.140
an error by predicting Y star 1 x
 

00:07:07.140 --> 00:07:09.630
an error by predicting Y star 1 x
weighted by the probability of actually

00:07:09.630 --> 00:07:09.640
weighted by the probability of actually
 

00:07:09.640 --> 00:07:13.470
weighted by the probability of actually
seeing y1 as the first label plus so I

00:07:13.470 --> 00:07:13.480
seeing y1 as the first label plus so I
 

00:07:13.480 --> 00:07:16.830
seeing y1 as the first label plus so I
do this this sum over all a K so then

00:07:16.830 --> 00:07:16.840
do this this sum over all a K so then
 

00:07:16.840 --> 00:07:21.540
do this this sum over all a K so then
sum up to the sum over Y capital K of

00:07:21.540 --> 00:07:21.550
sum up to the sum over Y capital K of
 

00:07:21.550 --> 00:07:22.890
sum up to the sum over Y capital K of
whether I'm making an error by

00:07:22.890 --> 00:07:22.900
whether I'm making an error by
 

00:07:22.900 --> 00:07:26.040
whether I'm making an error by
predicting Y prime Y star capital gay

00:07:26.040 --> 00:07:26.050
predicting Y prime Y star capital gay
 

00:07:26.050 --> 00:07:27.660
predicting Y prime Y star capital gay
weighted by the probability that the

00:07:27.660 --> 00:07:27.670
weighted by the probability that the
 

00:07:27.670 --> 00:07:30.090
weighted by the probability that the
true label would actually be Y Capital J

00:07:30.090 --> 00:07:30.100
true label would actually be Y Capital J
 

00:07:30.100 --> 00:07:33.990
true label would actually be Y Capital J
now so I have a sum and minimizing over

00:07:33.990 --> 00:07:34.000
now so I have a sum and minimizing over
 

00:07:34.000 --> 00:07:37.260
now so I have a sum and minimizing over
the sum for each label well because each

00:07:37.260 --> 00:07:37.270
the sum for each label well because each
 

00:07:37.270 --> 00:07:39.390
the sum for each label well because each
term in the sum actually depends on the

00:07:39.390 --> 00:07:39.400
term in the sum actually depends on the
 

00:07:39.400 --> 00:07:41.190
term in the sum actually depends on the
single label well that's the same as

00:07:41.190 --> 00:07:41.200
single label well that's the same as
 

00:07:41.200 --> 00:07:44.280
single label well that's the same as
minimizing the first term so with

00:07:44.280 --> 00:07:44.290
minimizing the first term so with
 

00:07:44.290 --> 00:07:47.910
minimizing the first term so with
respect to y 1 and actually I'm sorry Y

00:07:47.910 --> 00:07:47.920
respect to y 1 and actually I'm sorry Y
 

00:07:47.920 --> 00:07:52.020
respect to y 1 and actually I'm sorry Y
star 1 only and and I don't need to

00:07:52.020 --> 00:07:52.030
star 1 only and and I don't need to
 

00:07:52.030 --> 00:07:53.520
star 1 only and and I don't need to
minimize over the other terms because

00:07:53.520 --> 00:07:53.530
minimize over the other terms because
 

00:07:53.530 --> 00:07:55.200
minimize over the other terms because
they are not involved in that expression

00:07:55.200 --> 00:07:55.210
they are not involved in that expression
 

00:07:55.210 --> 00:07:58.080
they are not involved in that expression
plus the minimization with respect to Y

00:07:58.080 --> 00:07:58.090
plus the minimization with respect to Y
 

00:07:58.090 --> 00:08:02.340
plus the minimization with respect to Y
star to up to the so plus up to the

00:08:02.340 --> 00:08:02.350
star to up to the so plus up to the
 

00:08:02.350 --> 00:08:06.000
star to up to the so plus up to the
minimization over the last label of this

00:08:06.000 --> 00:08:06.010
minimization over the last label of this
 

00:08:06.010 --> 00:08:09.300
minimization over the last label of this
term here okay so that's because the

00:08:09.300 --> 00:08:09.310
term here okay so that's because the
 

00:08:09.310 --> 00:08:12.450
term here okay so that's because the
minimization over all labels for a term

00:08:12.450 --> 00:08:12.460
minimization over all labels for a term
 

00:08:12.460 --> 00:08:14.460
minimization over all labels for a term
that depends on only one label is the

00:08:14.460 --> 00:08:14.470
that depends on only one label is the
 

00:08:14.470 --> 00:08:17.550
that depends on only one label is the
same as minimization minimizing over a

00:08:17.550 --> 00:08:17.560
same as minimization minimizing over a
 

00:08:17.560 --> 00:08:24.780
same as minimization minimizing over a
single position or a single label and so

00:08:24.780 --> 00:08:24.790
single position or a single label and so
 

00:08:24.790 --> 00:08:29.190
single position or a single label and so
now the we notice that let me remove

00:08:29.190 --> 00:08:29.200
now the we notice that let me remove
 

00:08:29.200 --> 00:08:31.050
now the we notice that let me remove
some ink so we noticed that this

00:08:31.050 --> 00:08:31.060
some ink so we noticed that this
 

00:08:31.060 --> 00:08:35.120
some ink so we noticed that this
expression here which is the sum of 1 if

00:08:35.120 --> 00:08:35.130
expression here which is the sum of 1 if
 

00:08:35.130 --> 00:08:39.089
expression here which is the sum of 1 if
y1 is not Y star 1 weighted that by the

00:08:39.089 --> 00:08:39.099
y1 is not Y star 1 weighted that by the
 

00:08:39.099 --> 00:08:43.830
y1 is not Y star 1 weighted that by the
probability of observing y1 so that's

00:08:43.830 --> 00:08:43.840
probability of observing y1 so that's
 

00:08:43.840 --> 00:08:46.110
probability of observing y1 so that's
the sum of the probability of y 1 for

00:08:46.110 --> 00:08:46.120
the sum of the probability of y 1 for
 

00:08:46.120 --> 00:08:49.260
the sum of the probability of y 1 for
every case except when y1 is equal to Y

00:08:49.260 --> 00:08:49.270
every case except when y1 is equal to Y
 

00:08:49.270 --> 00:08:52.290
every case except when y1 is equal to Y
star 1 so in other words so that's the

00:08:52.290 --> 00:08:52.300
star 1 so in other words so that's the
 

00:08:52.300 --> 00:08:55.320
star 1 so in other words so that's the
probability of the first label not being

00:08:55.320 --> 00:08:55.330
probability of the first label not being
 

00:08:55.330 --> 00:08:58.050
probability of the first label not being
why star one which is equal to one minus

00:08:58.050 --> 00:08:58.060
why star one which is equal to one minus
 

00:08:58.060 --> 00:09:00.870
why star one which is equal to one minus
the probability of the label being Y

00:09:00.870 --> 00:09:00.880
the probability of the label being Y
 

00:09:00.880 --> 00:09:04.110
the probability of the label being Y
star one and so similarly for this term

00:09:04.110 --> 00:09:04.120
star one and so similarly for this term
 

00:09:04.120 --> 00:09:06.240
star one and so similarly for this term
we also get one minus the probability of

00:09:06.240 --> 00:09:06.250
we also get one minus the probability of
 

00:09:06.250 --> 00:09:11.250
we also get one minus the probability of
Y star capital K and then finally

00:09:11.250 --> 00:09:11.260
Y star capital K and then finally
 

00:09:11.260 --> 00:09:14.040
Y star capital K and then finally
performing each minimization minimizing

00:09:14.040 --> 00:09:14.050
performing each minimization minimizing
 

00:09:14.050 --> 00:09:17.130
performing each minimization minimizing
one minus this term is the same as doing

00:09:17.130 --> 00:09:17.140
one minus this term is the same as doing
 

00:09:17.140 --> 00:09:21.120
one minus this term is the same as doing
one minus the maximum of this term so

00:09:21.120 --> 00:09:21.130
one minus the maximum of this term so
 

00:09:21.130 --> 00:09:23.940
one minus the maximum of this term so
indeed this is a constant so I can't

00:09:23.940 --> 00:09:23.950
indeed this is a constant so I can't
 

00:09:23.950 --> 00:09:26.310
indeed this is a constant so I can't
minimize it really that the choice of y

00:09:26.310 --> 00:09:26.320
minimize it really that the choice of y
 

00:09:26.320 --> 00:09:28.530
minimize it really that the choice of y
star one won't change the value of one

00:09:28.530 --> 00:09:28.540
star one won't change the value of one
 

00:09:28.540 --> 00:09:31.350
star one won't change the value of one
and so I can introduce this here and the

00:09:31.350 --> 00:09:31.360
and so I can introduce this here and the
 

00:09:31.360 --> 00:09:33.120
and so I can introduce this here and the
minimization of the negative of

00:09:33.120 --> 00:09:33.130
minimization of the negative of
 

00:09:33.130 --> 00:09:36.590
minimization of the negative of
something is the same as minus the

00:09:36.590 --> 00:09:36.600
something is the same as minus the
 

00:09:36.600 --> 00:09:39.780
something is the same as minus the
maximization of that something so that's

00:09:39.780 --> 00:09:39.790
maximization of that something so that's
 

00:09:39.790 --> 00:09:44.430
maximization of that something so that's
what I have here so this is equivalent

00:09:44.430 --> 00:09:44.440
what I have here so this is equivalent
 

00:09:44.440 --> 00:09:48.210
what I have here so this is equivalent
to this and in particular the argument

00:09:48.210 --> 00:09:48.220
to this and in particular the argument
 

00:09:48.220 --> 00:09:51.300
to this and in particular the argument
the argument here or the arc max is the

00:09:51.300 --> 00:09:51.310
the argument here or the arc max is the
 

00:09:51.310 --> 00:09:54.680
the argument here or the arc max is the
arc max here and in other words it's the

00:09:54.680 --> 00:09:54.690
arc max here and in other words it's the
 

00:09:54.690 --> 00:09:58.350
arc max here and in other words it's the
sequence where the first label is the

00:09:58.350 --> 00:09:58.360
sequence where the first label is the
 

00:09:58.360 --> 00:10:01.110
sequence where the first label is the
one that maximizes the marginal

00:10:01.110 --> 00:10:01.120
one that maximizes the marginal
 

00:10:01.120 --> 00:10:03.510
one that maximizes the marginal
probability for the first element in the

00:10:03.510 --> 00:10:03.520
probability for the first element in the
 

00:10:03.520 --> 00:10:05.670
probability for the first element in the
sequence and then same thing for the

00:10:05.670 --> 00:10:05.680
sequence and then same thing for the
 

00:10:05.680 --> 00:10:07.829
sequence and then same thing for the
second label third label up to the last

00:10:07.829 --> 00:10:07.839
second label third label up to the last
 

00:10:07.839 --> 00:10:10.319
second label third label up to the last
label which in my prediction should be

00:10:10.319 --> 00:10:10.329
label which in my prediction should be
 

00:10:10.329 --> 00:10:15.000
label which in my prediction should be
the label y star K which maximizes the

00:10:15.000 --> 00:10:15.010
the label y star K which maximizes the
 

00:10:15.010 --> 00:10:19.860
the label y star K which maximizes the
marginal probability of the of the label

00:10:19.860 --> 00:10:19.870
marginal probability of the of the label
 

00:10:19.870 --> 00:10:22.139
marginal probability of the of the label
at the last position at the position

00:10:22.139 --> 00:10:22.149
at the last position at the position
 

00:10:22.149 --> 00:10:24.449
at the last position at the position
capital K okay so this ends our

00:10:24.449 --> 00:10:24.459
capital K okay so this ends our
 

00:10:24.459 --> 00:10:27.500
capital K okay so this ends our
demonstration that if I assume the true

00:10:27.500 --> 00:10:27.510
demonstration that if I assume the true
 

00:10:27.510 --> 00:10:31.079
demonstration that if I assume the true
labels were generated by my model my

00:10:31.079 --> 00:10:31.089
labels were generated by my model my
 

00:10:31.089 --> 00:10:33.420
labels were generated by my model my
linear conditional random field then if

00:10:33.420 --> 00:10:33.430
linear conditional random field then if
 

00:10:33.430 --> 00:10:37.460
linear conditional random field then if
I wanted to minimize the expected

00:10:37.460 --> 00:10:37.470
I wanted to minimize the expected
 

00:10:37.470 --> 00:10:40.680
I wanted to minimize the expected
classification error per position the

00:10:40.680 --> 00:10:40.690
classification error per position the
 

00:10:40.690 --> 00:10:42.420
classification error per position the
right thing to do would actually to be

00:10:42.420 --> 00:10:42.430
right thing to do would actually to be
 

00:10:42.430 --> 00:10:44.760
right thing to do would actually to be
to produce the sequence of all labels

00:10:44.760 --> 00:10:44.770
to produce the sequence of all labels
 

00:10:44.770 --> 00:10:46.710
to produce the sequence of all labels
that maximize the probability of being

00:10:46.710 --> 00:10:46.720
that maximize the probability of being
 

00:10:46.720 --> 00:10:49.110
that maximize the probability of being
observed according to my model for each

00:10:49.110 --> 00:10:49.120
observed according to my model for each
 

00:10:49.120 --> 00:10:51.420
observed according to my model for each
position in constructing my prediction

00:10:51.420 --> 00:10:51.430
position in constructing my prediction
 

00:10:51.430 --> 00:10:54.449
position in constructing my prediction
by concatenated all of these sequence

00:10:54.449 --> 00:10:54.459
by concatenated all of these sequence
 

00:10:54.459 --> 00:10:59.250
by concatenated all of these sequence
all of these labels so that's the first

00:10:59.250 --> 00:10:59.260
all of these labels so that's the first
 

00:10:59.260 --> 00:11:02.250
all of these labels so that's the first
option another option would be to do the

00:11:02.250 --> 00:11:02.260
option another option would be to do the
 

00:11:02.260 --> 00:11:05.490
option another option would be to do the
equivalent of what we were doing in the

00:11:05.490 --> 00:11:05.500
equivalent of what we were doing in the
 

00:11:05.500 --> 00:11:08.400
equivalent of what we were doing in the
non sequential prediction part that is

00:11:08.400 --> 00:11:08.410
non sequential prediction part that is
 

00:11:08.410 --> 00:11:08.970
non sequential prediction part that is
out

00:11:08.970 --> 00:11:08.980
out
 

00:11:08.980 --> 00:11:14.189
out
produced as my sequence output the so

00:11:14.189 --> 00:11:14.199
produced as my sequence output the so
 

00:11:14.199 --> 00:11:15.840
produced as my sequence output the so
actually this should be a star here I

00:11:15.840 --> 00:11:15.850
actually this should be a star here I
 

00:11:15.850 --> 00:11:19.319
actually this should be a star here I
just produce as the sequence output the

00:11:19.319 --> 00:11:19.329
just produce as the sequence output the
 

00:11:19.329 --> 00:11:21.420
just produce as the sequence output the
single sequence with the largest

00:11:21.420 --> 00:11:21.430
single sequence with the largest
 

00:11:21.430 --> 00:11:23.300
single sequence with the largest
probability the largest joint

00:11:23.300 --> 00:11:23.310
probability the largest joint
 

00:11:23.310 --> 00:11:26.160
probability the largest joint
probability condition on my input

00:11:26.160 --> 00:11:26.170
probability condition on my input
 

00:11:26.170 --> 00:11:29.040
probability condition on my input
sequence and so I'll go rapidly over

00:11:29.040 --> 00:11:29.050
sequence and so I'll go rapidly over
 

00:11:29.050 --> 00:11:32.009
sequence and so I'll go rapidly over
this but it turns out that much like

00:11:32.009 --> 00:11:32.019
this but it turns out that much like
 

00:11:32.019 --> 00:11:34.670
this but it turns out that much like
we've seen a way of actually summing

00:11:34.670 --> 00:11:34.680
we've seen a way of actually summing
 

00:11:34.680 --> 00:11:39.329
we've seen a way of actually summing
over the something like this term the

00:11:39.329 --> 00:11:39.339
over the something like this term the
 

00:11:39.339 --> 00:11:43.470
over the something like this term the
exponential and exponentiated sum of log

00:11:43.470 --> 00:11:43.480
exponential and exponentiated sum of log
 

00:11:43.480 --> 00:11:45.569
exponential and exponentiated sum of log
factors we can also perform the

00:11:45.569 --> 00:11:45.579
factors we can also perform the
 

00:11:45.579 --> 00:11:48.660
factors we can also perform the
maximization with the dynamic program so

00:11:48.660 --> 00:11:48.670
maximization with the dynamic program so
 

00:11:48.670 --> 00:11:51.120
maximization with the dynamic program so
we'll do what we get essentially as a

00:11:51.120 --> 00:11:51.130
we'll do what we get essentially as a
 

00:11:51.130 --> 00:11:52.590
we'll do what we get essentially as a
variant of the Viterbi decoding

00:11:52.590 --> 00:11:52.600
variant of the Viterbi decoding
 

00:11:52.600 --> 00:11:55.769
variant of the Viterbi decoding
algorithm where in the forward pass so

00:11:55.769 --> 00:11:55.779
algorithm where in the forward pass so
 

00:11:55.779 --> 00:11:58.980
algorithm where in the forward pass so
much like in the Alpha dynamic

00:11:58.980 --> 00:11:58.990
much like in the Alpha dynamic
 

00:11:58.990 --> 00:12:01.740
much like in the Alpha dynamic
programming where we for the log alpha

00:12:01.740 --> 00:12:01.750
programming where we for the log alpha
 

00:12:01.750 --> 00:12:03.780
programming where we for the log alpha
we had locked some expirations

00:12:03.780 --> 00:12:03.790
we had locked some expirations
 

00:12:03.790 --> 00:12:05.790
we had locked some expirations
well in the this Viterbi decoding

00:12:05.790 --> 00:12:05.800
well in the this Viterbi decoding
 

00:12:05.800 --> 00:12:08.000
well in the this Viterbi decoding
algorithm we replace those by the

00:12:08.000 --> 00:12:08.010
algorithm we replace those by the
 

00:12:08.010 --> 00:12:11.579
algorithm we replace those by the
maximization with respect to Y prime K

00:12:11.579 --> 00:12:11.589
maximization with respect to Y prime K
 

00:12:11.589 --> 00:12:13.680
maximization with respect to Y prime K
instead and then we fill the table with

00:12:13.680 --> 00:12:13.690
instead and then we fill the table with
 

00:12:13.690 --> 00:12:16.019
instead and then we fill the table with
those values and in fact if you think

00:12:16.019 --> 00:12:16.029
those values and in fact if you think
 

00:12:16.029 --> 00:12:19.559
those values and in fact if you think
about it lock some X is actually can be

00:12:19.559 --> 00:12:19.569
about it lock some X is actually can be
 

00:12:19.569 --> 00:12:21.720
about it lock some X is actually can be
thought of as a smooth version of the

00:12:21.720 --> 00:12:21.730
thought of as a smooth version of the
 

00:12:21.730 --> 00:12:23.850
thought of as a smooth version of the
maximization operation and that's

00:12:23.850 --> 00:12:23.860
maximization operation and that's
 

00:12:23.860 --> 00:12:26.090
maximization operation and that's
because because of the exponential

00:12:26.090 --> 00:12:26.100
because because of the exponential
 

00:12:26.100 --> 00:12:28.980
because because of the exponential
exponential hear the term diet is going

00:12:28.980 --> 00:12:28.990
exponential hear the term diet is going
 

00:12:28.990 --> 00:12:30.960
exponential hear the term diet is going
to dominate this sum is going to be the

00:12:30.960 --> 00:12:30.970
to dominate this sum is going to be the
 

00:12:30.970 --> 00:12:33.150
to dominate this sum is going to be the
term that is largest because the

00:12:33.150 --> 00:12:33.160
term that is largest because the
 

00:12:33.160 --> 00:12:35.550
term that is largest because the
exponential increases very rapidly with

00:12:35.550 --> 00:12:35.560
exponential increases very rapidly with
 

00:12:35.560 --> 00:12:38.040
exponential increases very rapidly with
large values of its argument and then

00:12:38.040 --> 00:12:38.050
large values of its argument and then
 

00:12:38.050 --> 00:12:40.079
large values of its argument and then
taking the log we go back to the

00:12:40.079 --> 00:12:40.089
taking the log we go back to the
 

00:12:40.089 --> 00:12:42.689
taking the log we go back to the
original scale and so really the term

00:12:42.689 --> 00:12:42.699
original scale and so really the term
 

00:12:42.699 --> 00:12:44.819
original scale and so really the term
that's going to dominate this whole term

00:12:44.819 --> 00:12:44.829
that's going to dominate this whole term
 

00:12:44.829 --> 00:12:47.939
that's going to dominate this whole term
here is going to be the maximum so so

00:12:47.939 --> 00:12:47.949
here is going to be the maximum so so
 

00:12:47.949 --> 00:12:49.829
here is going to be the maximum so so
that's just you know a nice fact to know

00:12:49.829 --> 00:12:49.839
that's just you know a nice fact to know
 

00:12:49.839 --> 00:12:52.050
that's just you know a nice fact to know
about the relationship between the logs

00:12:52.050 --> 00:12:52.060
about the relationship between the logs
 

00:12:52.060 --> 00:12:56.460
about the relationship between the logs
of X and the maximization and but so

00:12:56.460 --> 00:12:56.470
of X and the maximization and but so
 

00:12:56.470 --> 00:12:58.590
of X and the maximization and but so
yeah so we take the forward pass say in

00:12:58.590 --> 00:12:58.600
yeah so we take the forward pass say in
 

00:12:58.600 --> 00:13:00.960
yeah so we take the forward pass say in
the diamond program that computes the

00:13:00.960 --> 00:13:00.970
the diamond program that computes the
 

00:13:00.970 --> 00:13:02.910
the diamond program that computes the
log alpha table and which we place

00:13:02.910 --> 00:13:02.920
log alpha table and which we place
 

00:13:02.920 --> 00:13:04.680
log alpha table and which we place
deluged some X operations by a

00:13:04.680 --> 00:13:04.690
deluged some X operations by a
 

00:13:04.690 --> 00:13:07.470
deluged some X operations by a
maximization and then in the backward

00:13:07.470 --> 00:13:07.480
maximization and then in the backward
 

00:13:07.480 --> 00:13:09.420
maximization and then in the backward
then we have to produce a backward pass

00:13:09.420 --> 00:13:09.430
then we have to produce a backward pass
 

00:13:09.430 --> 00:13:12.300
then we have to produce a backward pass
and in the backward pass well we start

00:13:12.300 --> 00:13:12.310
and in the backward pass well we start
 

00:13:12.310 --> 00:13:16.500
and in the backward pass well we start
will essentially compose our decoded so

00:13:16.500 --> 00:13:16.510
will essentially compose our decoded so
 

00:13:16.510 --> 00:13:19.319
will essentially compose our decoded so
our predicted sequence by finding the

00:13:19.319 --> 00:13:19.329
our predicted sequence by finding the
 

00:13:19.329 --> 00:13:22.230
our predicted sequence by finding the
last label that maximizes the value in

00:13:22.230 --> 00:13:22.240
last label that maximizes the value in
 

00:13:22.240 --> 00:13:22.800
last label that maximizes the value in
our tail

00:13:22.800 --> 00:13:22.810
our tail
 

00:13:22.810 --> 00:13:26.340
our tail
and then following backward the trace of

00:13:26.340 --> 00:13:26.350
and then following backward the trace of
 

00:13:26.350 --> 00:13:28.620
and then following backward the trace of
the max operations so falling backward

00:13:28.620 --> 00:13:28.630
the max operations so falling backward
 

00:13:28.630 --> 00:13:30.690
the max operations so falling backward
the links that are going to correspond

00:13:30.690 --> 00:13:30.700
the links that are going to correspond
 

00:13:30.700 --> 00:13:33.900
the links that are going to correspond
to what were the arc max when I was

00:13:33.900 --> 00:13:33.910
to what were the arc max when I was
 

00:13:33.910 --> 00:13:38.070
to what were the arc max when I was
performing this maximization here so

00:13:38.070 --> 00:13:38.080
performing this maximization here so
 

00:13:38.080 --> 00:13:39.390
performing this maximization here so
more specifically let's look at the

00:13:39.390 --> 00:13:39.400
more specifically let's look at the
 

00:13:39.400 --> 00:13:43.350
more specifically let's look at the
pseudocode for this algorithm we first

00:13:43.350 --> 00:13:43.360
pseudocode for this algorithm we first
 

00:13:43.360 --> 00:13:47.130
pseudocode for this algorithm we first
initialize the value of my alpha star so

00:13:47.130 --> 00:13:47.140
initialize the value of my alpha star so
 

00:13:47.140 --> 00:13:49.110
initialize the value of my alpha star so
I'm going to start for the dynamic

00:13:49.110 --> 00:13:49.120
I'm going to start for the dynamic
 

00:13:49.120 --> 00:13:51.240
I'm going to start for the dynamic
program the Viterbi decoding algorithm

00:13:51.240 --> 00:13:51.250
program the Viterbi decoding algorithm
 

00:13:51.250 --> 00:13:54.570
program the Viterbi decoding algorithm
that is going to fill this alpha star

00:13:54.570 --> 00:13:54.580
that is going to fill this alpha star
 

00:13:54.580 --> 00:13:56.610
that is going to fill this alpha star
table as opposed to the alpha table and

00:13:56.610 --> 00:13:56.620
table as opposed to the alpha table and
 

00:13:56.620 --> 00:13:58.620
table as opposed to the alpha table and
notice that here we have a maximization

00:13:58.620 --> 00:13:58.630
notice that here we have a maximization
 

00:13:58.630 --> 00:14:02.130
notice that here we have a maximization
instead of lock some X operation or do a

00:14:02.130 --> 00:14:02.140
instead of lock some X operation or do a
 

00:14:02.140 --> 00:14:05.100
instead of lock some X operation or do a
maximization over what would be the

00:14:05.100 --> 00:14:05.110
maximization over what would be the
 

00:14:05.110 --> 00:14:08.630
maximization over what would be the
argument of Deluxe MX operation in the

00:14:08.630 --> 00:14:08.640
argument of Deluxe MX operation in the
 

00:14:08.640 --> 00:14:11.580
argument of Deluxe MX operation in the
computation of the log alpha table so I

00:14:11.580 --> 00:14:11.590
computation of the log alpha table so I
 

00:14:11.590 --> 00:14:13.980
computation of the log alpha table so I
initialize the first column of my alpha

00:14:13.980 --> 00:14:13.990
initialize the first column of my alpha
 

00:14:13.990 --> 00:14:15.840
initialize the first column of my alpha
star table by performing this

00:14:15.840 --> 00:14:15.850
star table by performing this
 

00:14:15.850 --> 00:14:18.720
star table by performing this
maximization and I also remember for

00:14:18.720 --> 00:14:18.730
maximization and I also remember for
 

00:14:18.730 --> 00:14:23.130
maximization and I also remember for
each value of y star sorry Y prime -

00:14:23.130 --> 00:14:23.140
each value of y star sorry Y prime -
 

00:14:23.140 --> 00:14:26.250
each value of y star sorry Y prime -
what was the actual value of y prime one

00:14:26.250 --> 00:14:26.260
what was the actual value of y prime one
 

00:14:26.260 --> 00:14:29.790
what was the actual value of y prime one
that was maximum is maximizing the sum

00:14:29.790 --> 00:14:29.800
that was maximum is maximizing the sum
 

00:14:29.800 --> 00:14:31.829
that was maximum is maximizing the sum
of the log factor so see here this is

00:14:31.829 --> 00:14:31.839
of the log factor so see here this is
 

00:14:31.839 --> 00:14:33.360
of the log factor so see here this is
the same thing as here so this is just

00:14:33.360 --> 00:14:33.370
the same thing as here so this is just
 

00:14:33.370 --> 00:14:36.350
the same thing as here so this is just
the Arg max of this maximization and

00:14:36.350 --> 00:14:36.360
the Arg max of this maximization and
 

00:14:36.360 --> 00:14:39.210
the Arg max of this maximization and
then much like in the log alpha table

00:14:39.210 --> 00:14:39.220
then much like in the log alpha table
 

00:14:39.220 --> 00:14:42.180
then much like in the log alpha table
I'll go from the first from K equals two

00:14:42.180 --> 00:14:42.190
I'll go from the first from K equals two
 

00:14:42.190 --> 00:14:44.730
I'll go from the first from K equals two
to the last till the last column and

00:14:44.730 --> 00:14:44.740
to the last till the last column and
 

00:14:44.740 --> 00:14:47.579
to the last till the last column and
then for each value of the label I'll

00:14:47.579 --> 00:14:47.589
then for each value of the label I'll
 

00:14:47.589 --> 00:14:49.980
then for each value of the label I'll
perform the similar similar computation

00:14:49.980 --> 00:14:49.990
perform the similar similar computation
 

00:14:49.990 --> 00:14:52.680
perform the similar similar computation
where I've replaced the lock some X by

00:14:52.680 --> 00:14:52.690
where I've replaced the lock some X by
 

00:14:52.690 --> 00:14:56.250
where I've replaced the lock some X by
the maximization and here I have unary

00:14:56.250 --> 00:14:56.260
the maximization and here I have unary
 

00:14:56.260 --> 00:14:59.490
the maximization and here I have unary
factor pairwise factor and the alpha

00:14:59.490 --> 00:14:59.500
factor pairwise factor and the alpha
 

00:14:59.500 --> 00:15:01.440
factor pairwise factor and the alpha
star so the value at my previous column

00:15:01.440 --> 00:15:01.450
star so the value at my previous column
 

00:15:01.450 --> 00:15:04.110
star so the value at my previous column
in my alpha star table and similarly

00:15:04.110 --> 00:15:04.120
in my alpha star table and similarly
 

00:15:04.120 --> 00:15:06.570
in my alpha star table and similarly
I'll remember what is the arc max I'll

00:15:06.570 --> 00:15:06.580
I'll remember what is the arc max I'll
 

00:15:06.580 --> 00:15:09.710
I'll remember what is the arc max I'll
put that into this other table which I'm

00:15:09.710 --> 00:15:09.720
put that into this other table which I'm
 

00:15:09.720 --> 00:15:12.900
put that into this other table which I'm
where I put the arrow to distinguish it

00:15:12.900 --> 00:15:12.910
where I put the arrow to distinguish it
 

00:15:12.910 --> 00:15:16.020
where I put the arrow to distinguish it
from the alpha star table and then

00:15:16.020 --> 00:15:16.030
from the alpha star table and then
 

00:15:16.030 --> 00:15:18.860
from the alpha star table and then
finally if I want to know what's the

00:15:18.860 --> 00:15:18.870
finally if I want to know what's the
 

00:15:18.870 --> 00:15:22.380
finally if I want to know what's the
probability of the most likely sequence

00:15:22.380 --> 00:15:22.390
probability of the most likely sequence
 

00:15:22.390 --> 00:15:25.890
probability of the most likely sequence
Y star so what's the maximum of Y star

00:15:25.890 --> 00:15:25.900
Y star so what's the maximum of Y star
 

00:15:25.900 --> 00:15:29.850
Y star so what's the maximum of Y star
of P of this should be Y star also well

00:15:29.850 --> 00:15:29.860
of P of this should be Y star also well
 

00:15:29.860 --> 00:15:32.130
of P of this should be Y star also well
it's just it just corresponds to taking

00:15:32.130 --> 00:15:32.140
it's just it just corresponds to taking
 

00:15:32.140 --> 00:15:36.389
it's just it just corresponds to taking
the maximum over this expression here

00:15:36.389 --> 00:15:36.399
the maximum over this expression here
 

00:15:36.399 --> 00:15:39.329
the maximum over this expression here
and so that's actually not exactly

00:15:39.329 --> 00:15:39.339
and so that's actually not exactly
 

00:15:39.339 --> 00:15:41.879
and so that's actually not exactly
taking I said they taking the max over

00:15:41.879 --> 00:15:41.889
taking I said they taking the max over
 

00:15:41.889 --> 00:15:43.199
taking I said they taking the max over
the last column but that's not exactly

00:15:43.199 --> 00:15:43.209
the last column but that's not exactly
 

00:15:43.209 --> 00:15:45.090
the last column but that's not exactly
true it's the max over the last column

00:15:45.090 --> 00:15:45.100
true it's the max over the last column
 

00:15:45.100 --> 00:15:48.660
true it's the max over the last column
plus the unary log factor for the last

00:15:48.660 --> 00:15:48.670
plus the unary log factor for the last
 

00:15:48.670 --> 00:15:52.710
plus the unary log factor for the last
position and then to perform decoding

00:15:52.710 --> 00:15:52.720
position and then to perform decoding
 

00:15:52.720 --> 00:15:54.449
position and then to perform decoding
that is to actually construct my

00:15:54.449 --> 00:15:54.459
that is to actually construct my
 

00:15:54.459 --> 00:15:56.189
that is to actually construct my
predicted sequence y star

00:15:56.189 --> 00:15:56.199
predicted sequence y star
 

00:15:56.199 --> 00:15:59.759
predicted sequence y star
I'll take D again the arc max of this

00:15:59.759 --> 00:15:59.769
I'll take D again the arc max of this
 

00:15:59.769 --> 00:16:01.829
I'll take D again the arc max of this
maximization here so the arc max of the

00:16:01.829 --> 00:16:01.839
maximization here so the arc max of the
 

00:16:01.839 --> 00:16:04.290
maximization here so the arc max of the
unary factor at the last position plus

00:16:04.290 --> 00:16:04.300
unary factor at the last position plus
 

00:16:04.300 --> 00:16:07.410
unary factor at the last position plus
the y at the alpha star for the last

00:16:07.410 --> 00:16:07.420
the y at the alpha star for the last
 

00:16:07.420 --> 00:16:10.049
the y at the alpha star for the last
column of my alpha star table so that's

00:16:10.049 --> 00:16:10.059
column of my alpha star table so that's
 

00:16:10.059 --> 00:16:12.030
column of my alpha star table so that's
going to be the predicted label for the

00:16:12.030 --> 00:16:12.040
going to be the predicted label for the
 

00:16:12.040 --> 00:16:14.460
going to be the predicted label for the
last position and then I'll go backwards

00:16:14.460 --> 00:16:14.470
last position and then I'll go backwards
 

00:16:14.470 --> 00:16:16.920
last position and then I'll go backwards
from the previous the last position till

00:16:16.920 --> 00:16:16.930
from the previous the last position till
 

00:16:16.930 --> 00:16:19.530
from the previous the last position till
the first and what I'll do is that Y

00:16:19.530 --> 00:16:19.540
the first and what I'll do is that Y
 

00:16:19.540 --> 00:16:23.040
the first and what I'll do is that Y
star K is just going to be what was the

00:16:23.040 --> 00:16:23.050
star K is just going to be what was the
 

00:16:23.050 --> 00:16:26.519
star K is just going to be what was the
arc max so we see the arrow here was

00:16:26.519 --> 00:16:26.529
arc max so we see the arrow here was
 

00:16:26.529 --> 00:16:30.210
arc max so we see the arrow here was
what was the arguments when I performed

00:16:30.210 --> 00:16:30.220
what was the arguments when I performed
 

00:16:30.220 --> 00:16:33.230
what was the arguments when I performed
the maximization for alpha star K

00:16:33.230 --> 00:16:33.240
the maximization for alpha star K
 

00:16:33.240 --> 00:16:36.749
the maximization for alpha star K
assuming that the value for y star K

00:16:36.749 --> 00:16:36.759
assuming that the value for y star K
 

00:16:36.759 --> 00:16:39.689
assuming that the value for y star K
plus 1 so for y prime K plus 1 is

00:16:39.689 --> 00:16:39.699
plus 1 so for y prime K plus 1 is
 

00:16:39.699 --> 00:16:42.449
plus 1 so for y prime K plus 1 is
actually Y star K plus 1 which is the

00:16:42.449 --> 00:16:42.459
actually Y star K plus 1 which is the
 

00:16:42.459 --> 00:16:45.660
actually Y star K plus 1 which is the
value Y star in my sequence that I

00:16:45.660 --> 00:16:45.670
value Y star in my sequence that I
 

00:16:45.670 --> 00:16:47.879
value Y star in my sequence that I
computed in a previous iteration so we

00:16:47.879 --> 00:16:47.889
computed in a previous iteration so we
 

00:16:47.889 --> 00:16:50.639
computed in a previous iteration so we
see that by initializing Y star capital

00:16:50.639 --> 00:16:50.649
see that by initializing Y star capital
 

00:16:50.649 --> 00:16:52.559
see that by initializing Y star capital
K here well I always have a value for

00:16:52.559 --> 00:16:52.569
K here well I always have a value for
 

00:16:52.569 --> 00:16:55.259
K here well I always have a value for
that so I'm going from right to left

00:16:55.259 --> 00:16:55.269
that so I'm going from right to left
 

00:16:55.269 --> 00:16:57.660
that so I'm going from right to left
using my previous Y star value to

00:16:57.660 --> 00:16:57.670
using my previous Y star value to
 

00:16:57.670 --> 00:17:01.230
using my previous Y star value to
construct my sorry or Matt I guess the

00:17:01.230 --> 00:17:01.240
construct my sorry or Matt I guess the
 

00:17:01.240 --> 00:17:05.039
construct my sorry or Matt I guess the
the value of Y star at the position to

00:17:05.039 --> 00:17:05.049
the value of Y star at the position to
 

00:17:05.049 --> 00:17:08.519
the value of Y star at the position to
the right to construct my prediction for

00:17:08.519 --> 00:17:08.529
the right to construct my prediction for
 

00:17:08.529 --> 00:17:10.529
the right to construct my prediction for
the position the current position K and

00:17:10.529 --> 00:17:10.539
the position the current position K and
 

00:17:10.539 --> 00:17:13.470
the position the current position K and
then going from right to left okay so

00:17:13.470 --> 00:17:13.480
then going from right to left okay so
 

00:17:13.480 --> 00:17:16.799
then going from right to left okay so
this is how I get this is an algorithm

00:17:16.799 --> 00:17:16.809
this is how I get this is an algorithm
 

00:17:16.809 --> 00:17:19.819
this is how I get this is an algorithm
but that is also that's you know a nice

00:17:19.819 --> 00:17:19.829
but that is also that's you know a nice
 

00:17:19.829 --> 00:17:23.279
but that is also that's you know a nice
complexity of that's polynomial in K and

00:17:23.279 --> 00:17:23.289
complexity of that's polynomial in K and
 

00:17:23.289 --> 00:17:27.680
complexity of that's polynomial in K and
capital K and capital C for computing

00:17:27.680 --> 00:17:27.690
capital K and capital C for computing
 

00:17:27.690 --> 00:17:29.700
capital K and capital C for computing
constructing a prediction and so

00:17:29.700 --> 00:17:29.710
constructing a prediction and so
 

00:17:29.710 --> 00:17:31.889
constructing a prediction and so
classifying a whole sequence of inputs

00:17:31.889 --> 00:17:31.899
classifying a whole sequence of inputs
 

00:17:31.899 --> 00:17:34.260
classifying a whole sequence of inputs
and producing a sequence of labels for

00:17:34.260 --> 00:17:34.270
and producing a sequence of labels for
 

00:17:34.270 --> 00:17:37.919
and producing a sequence of labels for
my sequence of inputs so the two types

00:17:37.919 --> 00:17:37.929
my sequence of inputs so the two types
 

00:17:37.929 --> 00:17:39.779
my sequence of inputs so the two types
of predictions this Viterbi decoding

00:17:39.779 --> 00:17:39.789
of predictions this Viterbi decoding
 

00:17:39.789 --> 00:17:41.039
of predictions this Viterbi decoding
approach and the other one that

00:17:41.039 --> 00:17:41.049
approach and the other one that
 

00:17:41.049 --> 00:17:43.830
approach and the other one that
maximizes the per position marginal are

00:17:43.830 --> 00:17:43.840
maximizes the per position marginal are
 

00:17:43.840 --> 00:17:47.130
maximizes the per position marginal are
two valid predictions to perform if we

00:17:47.130 --> 00:17:47.140
two valid predictions to perform if we
 

00:17:47.140 --> 00:17:49.620
two valid predictions to perform if we
really care about the some of

00:17:49.620 --> 00:17:49.630
really care about the some of
 

00:17:49.630 --> 00:17:54.660
really care about the some of
the sum of the per element the sum of

00:17:54.660 --> 00:17:54.670
the sum of the per element the sum of
 

00:17:54.670 --> 00:17:56.910
the sum of the per element the sum of
per element classification errors we

00:17:56.910 --> 00:17:56.920
per element classification errors we
 

00:17:56.920 --> 00:17:59.490
per element classification errors we
might want to prefer the first procedure

00:17:59.490 --> 00:17:59.500
might want to prefer the first procedure
 

00:17:59.500 --> 00:18:03.270
might want to prefer the first procedure
but if instead our prediction error if

00:18:03.270 --> 00:18:03.280
but if instead our prediction error if
 

00:18:03.280 --> 00:18:04.920
but if instead our prediction error if
the way we evaluate the performance of

00:18:04.920 --> 00:18:04.930
the way we evaluate the performance of
 

00:18:04.930 --> 00:18:07.920
the way we evaluate the performance of
our classification a sequence

00:18:07.920 --> 00:18:07.930
our classification a sequence
 

00:18:07.930 --> 00:18:11.130
our classification a sequence
classification system is different and

00:18:11.130 --> 00:18:11.140
classification system is different and
 

00:18:11.140 --> 00:18:12.930
classification system is different and
so for different systems like in speech

00:18:12.930 --> 00:18:12.940
so for different systems like in speech
 

00:18:12.940 --> 00:18:14.580
so for different systems like in speech
for instance we'd be more interested in

00:18:14.580 --> 00:18:14.590
for instance we'd be more interested in
 

00:18:14.590 --> 00:18:16.290
for instance we'd be more interested in
a phone error rate which is more

00:18:16.290 --> 00:18:16.300
a phone error rate which is more
 

00:18:16.300 --> 00:18:20.010
a phone error rate which is more
complicated than performing this Viterbi

00:18:20.010 --> 00:18:20.020
complicated than performing this Viterbi
 

00:18:20.020 --> 00:18:22.380
complicated than performing this Viterbi
decoding procedure is should be

00:18:22.380 --> 00:18:22.390
decoding procedure is should be
 

00:18:22.390 --> 00:18:24.150
decoding procedure is should be
preferred because then we're not

00:18:24.150 --> 00:18:24.160
preferred because then we're not
 

00:18:24.160 --> 00:18:28.470
preferred because then we're not
maximizing the sum of per position per

00:18:28.470 --> 00:18:28.480
maximizing the sum of per position per
 

00:18:28.480 --> 00:18:32.040
maximizing the sum of per position per
position errors

